// -----// IR Dump Before Inliner (inline) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc86 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc95 = loc("a_ptr"(#loc))
#loc96 = loc("b_ptr"(#loc))
#loc97 = loc("c_ptr"(#loc))
#loc98 = loc("M"(#loc))
#loc99 = loc("N"(#loc))
#loc100 = loc("K"(#loc))
#loc101 = loc("stride_am"(#loc))
#loc102 = loc("stride_bk"(#loc))
#loc103 = loc("stride_cm"(#loc))
#loc172 = loc("x"(#loc86))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc104)
    %num_pid_m = tt.call @triton.language.standard.cdiv__i32_c64(%M) : (i32) -> i32 loc(#loc105)
    %num_pid_n = tt.call @triton.language.standard.cdiv__i32_c32(%N) : (i32) -> i32 loc(#loc106)
    %num_pid_in_group = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_0 = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_1 = arith.extsi %num_pid_in_group_0 : i32 to i64 loc(#loc107)
    %num_pid_in_group_2 = arith.extsi %num_pid_n : i32 to i64 loc(#loc107)
    %num_pid_in_group_3 = arith.muli %num_pid_in_group_1, %num_pid_in_group_2 : i64 loc(#loc107)
    %num_pid_in_group_4 = arith.constant 2147483647 : i64 loc(#loc107)
    %num_pid_in_group_5 = arith.constant -2147483648 : i64 loc(#loc107)
    %num_pid_in_group_6 = arith.cmpi sle, %num_pid_in_group_3, %num_pid_in_group_4 : i64 loc(#loc107)
    %num_pid_in_group_7 = arith.cmpi sge, %num_pid_in_group_3, %num_pid_in_group_5 : i64 loc(#loc107)
    %num_pid_in_group_8 = arith.andi %num_pid_in_group_6, %num_pid_in_group_7 : i1 loc(#loc107)
    %num_pid_in_group_9 = arith.muli %num_pid_in_group_0, %num_pid_n : i32 loc(#loc107)
    %group_id = arith.divsi %pid, %num_pid_in_group_9 : i32 loc(#loc108)
    %first_pid_m = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_10 = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_11 = arith.extsi %group_id : i32 to i64 loc(#loc109)
    %first_pid_m_12 = arith.extsi %first_pid_m_10 : i32 to i64 loc(#loc109)
    %first_pid_m_13 = arith.muli %first_pid_m_11, %first_pid_m_12 : i64 loc(#loc109)
    %first_pid_m_14 = arith.constant 2147483647 : i64 loc(#loc109)
    %first_pid_m_15 = arith.constant -2147483648 : i64 loc(#loc109)
    %first_pid_m_16 = arith.cmpi sle, %first_pid_m_13, %first_pid_m_14 : i64 loc(#loc109)
    %first_pid_m_17 = arith.cmpi sge, %first_pid_m_13, %first_pid_m_15 : i64 loc(#loc109)
    %first_pid_m_18 = arith.andi %first_pid_m_16, %first_pid_m_17 : i1 loc(#loc109)
    %first_pid_m_19 = arith.muli %group_id, %first_pid_m_10 : i32 loc(#loc109)
    %group_size_m = arith.extsi %num_pid_m : i32 to i64 loc(#loc110)
    %group_size_m_20 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc110)
    %group_size_m_21 = arith.subi %group_size_m, %group_size_m_20 : i64 loc(#loc110)
    %group_size_m_22 = arith.constant 2147483647 : i64 loc(#loc110)
    %group_size_m_23 = arith.constant -2147483648 : i64 loc(#loc110)
    %group_size_m_24 = arith.cmpi sle, %group_size_m_21, %group_size_m_22 : i64 loc(#loc110)
    %group_size_m_25 = arith.cmpi sge, %group_size_m_21, %group_size_m_23 : i64 loc(#loc110)
    %group_size_m_26 = arith.andi %group_size_m_24, %group_size_m_25 : i1 loc(#loc110)
    %group_size_m_27 = arith.subi %num_pid_m, %first_pid_m_19 : i32 loc(#loc110)
    %group_size_m_28 = arith.constant 4 : i32 loc(#loc111)
    %group_size_m_29 = arith.minsi %group_size_m_27, %group_size_m_28 : i32 loc(#loc111)
    %pid_m = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc112)
    %pid_m_30 = arith.remsi %pid_m, %group_size_m_29 : i32 loc(#loc113)
    %pid_m_31 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc114)
    %pid_m_32 = arith.extsi %pid_m_30 : i32 to i64 loc(#loc114)
    %pid_m_33 = arith.addi %pid_m_31, %pid_m_32 : i64 loc(#loc114)
    %pid_m_34 = arith.constant 2147483647 : i64 loc(#loc114)
    %pid_m_35 = arith.constant -2147483648 : i64 loc(#loc114)
    %pid_m_36 = arith.cmpi sle, %pid_m_33, %pid_m_34 : i64 loc(#loc114)
    %pid_m_37 = arith.cmpi sge, %pid_m_33, %pid_m_35 : i64 loc(#loc114)
    %pid_m_38 = arith.andi %pid_m_36, %pid_m_37 : i1 loc(#loc114)
    %pid_m_39 = arith.addi %first_pid_m_19, %pid_m_30 : i32 loc(#loc114)
    %pid_n = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc115)
    %pid_n_40 = arith.divsi %pid_n, %group_size_m_29 : i32 loc(#loc116)
    %c0_i32 = arith.constant 0 : i32 loc(#loc14)
    %0 = arith.cmpi sge, %pid_m_39, %c0_i32 : i32 loc(#loc14)
    llvm.intr.assume %0 : i1 loc(#loc15)
    %c0_i32_41 = arith.constant 0 : i32 loc(#loc16)
    %1 = arith.cmpi sge, %pid_n_40, %c0_i32_41 : i32 loc(#loc16)
    llvm.intr.assume %1 : i1 loc(#loc17)
    %c0_i32_42 = arith.constant 0 : i32 loc(#loc18)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32_42 : i32 loc(#loc18)
    llvm.intr.assume %2 : i1 loc(#loc19)
    %true = arith.constant true loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc20)
    %true_43 = arith.constant true loc(#loc21)
    llvm.intr.assume %true_43 : i1 loc(#loc21)
    %c0_i32_44 = arith.constant 0 : i32 loc(#loc22)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32_44 : i32 loc(#loc22)
    llvm.intr.assume %3 : i1 loc(#loc23)
    %c0_i32_45 = arith.constant 0 : i32 loc(#loc24)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32_45 : i32 loc(#loc24)
    llvm.intr.assume %4 : i1 loc(#loc25)
    %true_46 = arith.constant true loc(#loc26)
    llvm.intr.assume %true_46 : i1 loc(#loc26)
    %offs_am = arith.constant 64 : i32 loc(#loc117)
    %offs_am_47 = arith.constant 64 : i32 loc(#loc117)
    %offs_am_48 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc117)
    %offs_am_49 = arith.extsi %offs_am_47 : i32 to i64 loc(#loc117)
    %offs_am_50 = arith.muli %offs_am_48, %offs_am_49 : i64 loc(#loc117)
    %offs_am_51 = arith.constant 2147483647 : i64 loc(#loc117)
    %offs_am_52 = arith.constant -2147483648 : i64 loc(#loc117)
    %offs_am_53 = arith.cmpi sle, %offs_am_50, %offs_am_51 : i64 loc(#loc117)
    %offs_am_54 = arith.cmpi sge, %offs_am_50, %offs_am_52 : i64 loc(#loc117)
    %offs_am_55 = arith.andi %offs_am_53, %offs_am_54 : i1 loc(#loc117)
    %offs_am_56 = arith.muli %pid_m_39, %offs_am_47 : i32 loc(#loc117)
    %offs_am_57 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %offs_am_58 = tt.splat %offs_am_56 : i32 -> tensor<64xi32> loc(#loc119)
    %offs_am_59 = arith.extsi %offs_am_58 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_60 = arith.extsi %offs_am_57 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_61 = arith.addi %offs_am_59, %offs_am_60 : tensor<64xi64> loc(#loc119)
    %offs_am_62 = arith.constant 2147483647 : i64 loc(#loc119)
    %offs_am_63 = arith.constant -2147483648 : i64 loc(#loc119)
    %offs_am_64 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc119)
    %offs_am_65 = arith.cmpi sle, %offs_am_61, %offs_am_64 : tensor<64xi64> loc(#loc119)
    %offs_am_66 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc119)
    %offs_am_67 = arith.cmpi sge, %offs_am_61, %offs_am_66 : tensor<64xi64> loc(#loc119)
    %offs_am_68 = arith.andi %offs_am_65, %offs_am_67 : tensor<64xi1> loc(#loc119)
    %offs_am_69 = arith.addi %offs_am_58, %offs_am_57 : tensor<64xi32> loc(#loc119)
    %offs_am_70 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc120)
    %offs_am_71 = arith.remsi %offs_am_69, %offs_am_70 : tensor<64xi32> loc(#loc120)
    %offs_bn = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_72 = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_73 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc121)
    %offs_bn_74 = arith.extsi %offs_bn_72 : i32 to i64 loc(#loc121)
    %offs_bn_75 = arith.muli %offs_bn_73, %offs_bn_74 : i64 loc(#loc121)
    %offs_bn_76 = arith.constant 2147483647 : i64 loc(#loc121)
    %offs_bn_77 = arith.constant -2147483648 : i64 loc(#loc121)
    %offs_bn_78 = arith.cmpi sle, %offs_bn_75, %offs_bn_76 : i64 loc(#loc121)
    %offs_bn_79 = arith.cmpi sge, %offs_bn_75, %offs_bn_77 : i64 loc(#loc121)
    %offs_bn_80 = arith.andi %offs_bn_78, %offs_bn_79 : i1 loc(#loc121)
    %offs_bn_81 = arith.muli %pid_n_40, %offs_bn_72 : i32 loc(#loc121)
    %offs_bn_82 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc122)
    %offs_bn_83 = tt.splat %offs_bn_81 : i32 -> tensor<32xi32> loc(#loc123)
    %offs_bn_84 = arith.extsi %offs_bn_83 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_85 = arith.extsi %offs_bn_82 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_86 = arith.addi %offs_bn_84, %offs_bn_85 : tensor<32xi64> loc(#loc123)
    %offs_bn_87 = arith.constant 2147483647 : i64 loc(#loc123)
    %offs_bn_88 = arith.constant -2147483648 : i64 loc(#loc123)
    %offs_bn_89 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc123)
    %offs_bn_90 = arith.cmpi sle, %offs_bn_86, %offs_bn_89 : tensor<32xi64> loc(#loc123)
    %offs_bn_91 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc123)
    %offs_bn_92 = arith.cmpi sge, %offs_bn_86, %offs_bn_91 : tensor<32xi64> loc(#loc123)
    %offs_bn_93 = arith.andi %offs_bn_90, %offs_bn_92 : tensor<32xi1> loc(#loc123)
    %offs_bn_94 = arith.addi %offs_bn_83, %offs_bn_82 : tensor<32xi32> loc(#loc123)
    %offs_bn_95 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc124)
    %offs_bn_96 = arith.remsi %offs_bn_94, %offs_bn_95 : tensor<32xi32> loc(#loc124)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc125)
    %a_ptrs = tt.expand_dims %offs_am_71 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc126)
    %a_ptrs_97 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc127)
    %a_ptrs_98 = arith.extsi %a_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_99 = arith.extsi %a_ptrs_97 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_100 = arith.muli %a_ptrs_98, %a_ptrs_99 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_101 = arith.constant 2147483647 : i64 loc(#loc127)
    %a_ptrs_102 = arith.constant -2147483648 : i64 loc(#loc127)
    %a_ptrs_103 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_104 = arith.cmpi sle, %a_ptrs_100, %a_ptrs_103 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_105 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_106 = arith.cmpi sge, %a_ptrs_100, %a_ptrs_105 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_107 = arith.andi %a_ptrs_104, %a_ptrs_106 : tensor<64x1xi1> loc(#loc127)
    %a_ptrs_108 = arith.muli %a_ptrs, %a_ptrs_97 : tensor<64x1xi32> loc(#loc127)
    %a_ptrs_109 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc128)
    %a_ptrs_110 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_111 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_112 = arith.constant dense<1> : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_113 = arith.extsi %a_ptrs_109 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_114 = arith.extsi %a_ptrs_112 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_115 = arith.muli %a_ptrs_113, %a_ptrs_114 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_116 = arith.constant 2147483647 : i64 loc(#loc129)
    %a_ptrs_117 = arith.constant -2147483648 : i64 loc(#loc129)
    %a_ptrs_118 = arith.constant dense<2147483647> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_119 = arith.cmpi sle, %a_ptrs_115, %a_ptrs_118 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_120 = arith.constant dense<-2147483648> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_121 = arith.cmpi sge, %a_ptrs_115, %a_ptrs_120 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_122 = arith.andi %a_ptrs_119, %a_ptrs_121 : tensor<1x64xi1> loc(#loc129)
    %a_ptrs_123 = arith.muli %a_ptrs_109, %a_ptrs_112 : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_124 = tt.broadcast %a_ptrs_108 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_125 = tt.broadcast %a_ptrs_123 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_126 = arith.extsi %a_ptrs_124 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_127 = arith.extsi %a_ptrs_125 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_128 = arith.addi %a_ptrs_126, %a_ptrs_127 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_129 = arith.constant 2147483647 : i64 loc(#loc130)
    %a_ptrs_130 = arith.constant -2147483648 : i64 loc(#loc130)
    %a_ptrs_131 = arith.constant dense<2147483647> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_132 = arith.cmpi sle, %a_ptrs_128, %a_ptrs_131 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_133 = arith.constant dense<-2147483648> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_134 = arith.cmpi sge, %a_ptrs_128, %a_ptrs_133 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_135 = arith.andi %a_ptrs_132, %a_ptrs_134 : tensor<64x64xi1> loc(#loc130)
    %a_ptrs_136 = arith.addi %a_ptrs_124, %a_ptrs_125 : tensor<64x64xi32> loc(#loc130)
    %a_ptrs_137 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc131)
    %a_ptrs_138 = tt.addptr %a_ptrs_137, %a_ptrs_136 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc131)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc132)
    %b_ptrs_139 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc133)
    %b_ptrs_140 = arith.extsi %b_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_141 = arith.extsi %b_ptrs_139 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_142 = arith.muli %b_ptrs_140, %b_ptrs_141 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_143 = arith.constant 2147483647 : i64 loc(#loc133)
    %b_ptrs_144 = arith.constant -2147483648 : i64 loc(#loc133)
    %b_ptrs_145 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_146 = arith.cmpi sle, %b_ptrs_142, %b_ptrs_145 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_147 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_148 = arith.cmpi sge, %b_ptrs_142, %b_ptrs_147 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_149 = arith.andi %b_ptrs_146, %b_ptrs_148 : tensor<64x1xi1> loc(#loc133)
    %b_ptrs_150 = arith.muli %b_ptrs, %b_ptrs_139 : tensor<64x1xi32> loc(#loc133)
    %b_ptrs_151 = tt.expand_dims %offs_bn_96 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc134)
    %b_ptrs_152 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_153 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_154 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_155 = arith.extsi %b_ptrs_151 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_156 = arith.extsi %b_ptrs_154 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_157 = arith.muli %b_ptrs_155, %b_ptrs_156 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_158 = arith.constant 2147483647 : i64 loc(#loc135)
    %b_ptrs_159 = arith.constant -2147483648 : i64 loc(#loc135)
    %b_ptrs_160 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_161 = arith.cmpi sle, %b_ptrs_157, %b_ptrs_160 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_162 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_163 = arith.cmpi sge, %b_ptrs_157, %b_ptrs_162 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_164 = arith.andi %b_ptrs_161, %b_ptrs_163 : tensor<1x32xi1> loc(#loc135)
    %b_ptrs_165 = arith.muli %b_ptrs_151, %b_ptrs_154 : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_166 = tt.broadcast %b_ptrs_150 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_167 = tt.broadcast %b_ptrs_165 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_168 = arith.extsi %b_ptrs_166 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_169 = arith.extsi %b_ptrs_167 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_170 = arith.addi %b_ptrs_168, %b_ptrs_169 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_171 = arith.constant 2147483647 : i64 loc(#loc136)
    %b_ptrs_172 = arith.constant -2147483648 : i64 loc(#loc136)
    %b_ptrs_173 = arith.constant dense<2147483647> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_174 = arith.cmpi sle, %b_ptrs_170, %b_ptrs_173 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_175 = arith.constant dense<-2147483648> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_176 = arith.cmpi sge, %b_ptrs_170, %b_ptrs_175 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_177 = arith.andi %b_ptrs_174, %b_ptrs_176 : tensor<64x32xi1> loc(#loc136)
    %b_ptrs_178 = arith.addi %b_ptrs_166, %b_ptrs_167 : tensor<64x32xi32> loc(#loc136)
    %b_ptrs_179 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc137)
    %b_ptrs_180 = tt.addptr %b_ptrs_179, %b_ptrs_178 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc137)
    %accumulator = tt.call @triton.language.standard.zeros__Tc64_c32T_cfp32() : () -> tensor<64x32xf32> loc(#loc138)
    %5 = tt.call @triton.language.standard.cdiv__i32_c64(%K) : (i32) -> i32 loc(#loc49)
    %c0_i32_181 = arith.constant 0 : i32 loc(#loc50)
    %c1_i32 = arith.constant 1 : i32 loc(#loc50)
    %6 = arith.bitcast %c0_i32_181 : i32 to i32 loc(#loc50)
    %7 = arith.bitcast %5 : i32 to i32 loc(#loc50)
    %8 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc50)
    %9 = ub.poison : i32 loc(#loc50)
    %accumulator_182:3 = scf.for %k = %6 to %7 step %8 iter_args(%a_ptrs_269 = %a_ptrs_138, %b_ptrs_270 = %b_ptrs_180, %accumulator_271 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc140)
      %a_272 = arith.constant 64 : i32 loc(#loc141)
      %a_273 = arith.constant 64 : i32 loc(#loc141)
      %a_274 = arith.extsi %k : i32 to i64 loc(#loc141)
      %a_275 = arith.extsi %a_273 : i32 to i64 loc(#loc141)
      %a_276 = arith.muli %a_274, %a_275 : i64 loc(#loc141)
      %a_277 = arith.constant 2147483647 : i64 loc(#loc141)
      %a_278 = arith.constant -2147483648 : i64 loc(#loc141)
      %a_279 = arith.cmpi sle, %a_276, %a_277 : i64 loc(#loc141)
      %a_280 = arith.cmpi sge, %a_276, %a_278 : i64 loc(#loc141)
      %a_281 = arith.andi %a_279, %a_280 : i1 loc(#loc141)
      %a_282 = arith.muli %k, %a_273 : i32 loc(#loc141)
      %a_283 = arith.extsi %K : i32 to i64 loc(#loc142)
      %a_284 = arith.extsi %a_282 : i32 to i64 loc(#loc142)
      %a_285 = arith.subi %a_283, %a_284 : i64 loc(#loc142)
      %a_286 = arith.constant 2147483647 : i64 loc(#loc142)
      %a_287 = arith.constant -2147483648 : i64 loc(#loc142)
      %a_288 = arith.cmpi sle, %a_285, %a_286 : i64 loc(#loc142)
      %a_289 = arith.cmpi sge, %a_285, %a_287 : i64 loc(#loc142)
      %a_290 = arith.andi %a_288, %a_289 : i1 loc(#loc142)
      %a_291 = arith.subi %K, %a_282 : i32 loc(#loc142)
      %a_292 = tt.splat %a_291 : i32 -> tensor<1x64xi32> loc(#loc143)
      %a_293 = arith.cmpi slt, %a, %a_292 : tensor<1x64xi32> loc(#loc143)
      %a_294 = arith.constant 0.000000e+00 : f32 loc(#loc144)
      %a_295 = tt.broadcast %a_293 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc144)
      %a_296 = arith.constant dense<0.000000e+00> : tensor<64x64xf32> loc(#loc144)
      %a_297 = arith.truncf %a_296 : tensor<64x64xf32> to tensor<64x64xf16> loc(#loc144)
      %a_298 = tt.load %a_ptrs_269, %a_295, %a_297 : tensor<64x64x!tt.ptr<f16>> loc(#loc144)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc145)
      %b_299 = arith.constant 64 : i32 loc(#loc146)
      %b_300 = arith.constant 64 : i32 loc(#loc146)
      %b_301 = arith.extsi %k : i32 to i64 loc(#loc146)
      %b_302 = arith.extsi %b_300 : i32 to i64 loc(#loc146)
      %b_303 = arith.muli %b_301, %b_302 : i64 loc(#loc146)
      %b_304 = arith.constant 2147483647 : i64 loc(#loc146)
      %b_305 = arith.constant -2147483648 : i64 loc(#loc146)
      %b_306 = arith.cmpi sle, %b_303, %b_304 : i64 loc(#loc146)
      %b_307 = arith.cmpi sge, %b_303, %b_305 : i64 loc(#loc146)
      %b_308 = arith.andi %b_306, %b_307 : i1 loc(#loc146)
      %b_309 = arith.muli %k, %b_300 : i32 loc(#loc146)
      %b_310 = arith.extsi %K : i32 to i64 loc(#loc147)
      %b_311 = arith.extsi %b_309 : i32 to i64 loc(#loc147)
      %b_312 = arith.subi %b_310, %b_311 : i64 loc(#loc147)
      %b_313 = arith.constant 2147483647 : i64 loc(#loc147)
      %b_314 = arith.constant -2147483648 : i64 loc(#loc147)
      %b_315 = arith.cmpi sle, %b_312, %b_313 : i64 loc(#loc147)
      %b_316 = arith.cmpi sge, %b_312, %b_314 : i64 loc(#loc147)
      %b_317 = arith.andi %b_315, %b_316 : i1 loc(#loc147)
      %b_318 = arith.subi %K, %b_309 : i32 loc(#loc147)
      %b_319 = tt.splat %b_318 : i32 -> tensor<64x1xi32> loc(#loc148)
      %b_320 = arith.cmpi slt, %b, %b_319 : tensor<64x1xi32> loc(#loc148)
      %b_321 = arith.constant 0.000000e+00 : f32 loc(#loc149)
      %b_322 = tt.broadcast %b_320 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc149)
      %b_323 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc149)
      %b_324 = arith.truncf %b_323 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc149)
      %b_325 = tt.load %b_ptrs_270, %b_322, %b_324 : tensor<64x32x!tt.ptr<f16>> loc(#loc149)
      %accumulator_326 = arith.constant 0.000000e+00 : f32 loc(#loc150)
      %accumulator_327 = tt.dot %a_298, %b_325, %accumulator_271, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc150)
      %a_ptrs_328 = arith.constant 64 : i32 loc(#loc151)
      %a_ptrs_329 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc151)
      %a_ptrs_330 = tt.addptr %a_ptrs_269, %a_ptrs_329 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc151)
      %b_ptrs_331 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_332 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_333 = arith.extsi %b_ptrs_332 : i32 to i64 loc(#loc152)
      %b_ptrs_334 = arith.extsi %stride_bk : i32 to i64 loc(#loc152)
      %b_ptrs_335 = arith.muli %b_ptrs_333, %b_ptrs_334 : i64 loc(#loc152)
      %b_ptrs_336 = arith.constant 2147483647 : i64 loc(#loc152)
      %b_ptrs_337 = arith.constant -2147483648 : i64 loc(#loc152)
      %b_ptrs_338 = arith.cmpi sle, %b_ptrs_335, %b_ptrs_336 : i64 loc(#loc152)
      %b_ptrs_339 = arith.cmpi sge, %b_ptrs_335, %b_ptrs_337 : i64 loc(#loc152)
      %b_ptrs_340 = arith.andi %b_ptrs_338, %b_ptrs_339 : i1 loc(#loc152)
      %b_ptrs_341 = arith.muli %b_ptrs_332, %stride_bk : i32 loc(#loc152)
      %b_ptrs_342 = tt.splat %b_ptrs_341 : i32 -> tensor<64x32xi32> loc(#loc153)
      %b_ptrs_343 = tt.addptr %b_ptrs_270, %b_ptrs_342 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc153)
      scf.yield %a_ptrs_330, %b_ptrs_343, %accumulator_327 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc65)
    } loc(#loc174)
    %c = arith.truncf %accumulator_182#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc154)
    %offs_cm = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_183 = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_184 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc155)
    %offs_cm_185 = arith.extsi %offs_cm_183 : i32 to i64 loc(#loc155)
    %offs_cm_186 = arith.muli %offs_cm_184, %offs_cm_185 : i64 loc(#loc155)
    %offs_cm_187 = arith.constant 2147483647 : i64 loc(#loc155)
    %offs_cm_188 = arith.constant -2147483648 : i64 loc(#loc155)
    %offs_cm_189 = arith.cmpi sle, %offs_cm_186, %offs_cm_187 : i64 loc(#loc155)
    %offs_cm_190 = arith.cmpi sge, %offs_cm_186, %offs_cm_188 : i64 loc(#loc155)
    %offs_cm_191 = arith.andi %offs_cm_189, %offs_cm_190 : i1 loc(#loc155)
    %offs_cm_192 = arith.muli %pid_m_39, %offs_cm_183 : i32 loc(#loc155)
    %offs_cm_193 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc156)
    %offs_cm_194 = tt.splat %offs_cm_192 : i32 -> tensor<64xi32> loc(#loc157)
    %offs_cm_195 = arith.extsi %offs_cm_194 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_196 = arith.extsi %offs_cm_193 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_197 = arith.addi %offs_cm_195, %offs_cm_196 : tensor<64xi64> loc(#loc157)
    %offs_cm_198 = arith.constant 2147483647 : i64 loc(#loc157)
    %offs_cm_199 = arith.constant -2147483648 : i64 loc(#loc157)
    %offs_cm_200 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc157)
    %offs_cm_201 = arith.cmpi sle, %offs_cm_197, %offs_cm_200 : tensor<64xi64> loc(#loc157)
    %offs_cm_202 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc157)
    %offs_cm_203 = arith.cmpi sge, %offs_cm_197, %offs_cm_202 : tensor<64xi64> loc(#loc157)
    %offs_cm_204 = arith.andi %offs_cm_201, %offs_cm_203 : tensor<64xi1> loc(#loc157)
    %offs_cm_205 = arith.addi %offs_cm_194, %offs_cm_193 : tensor<64xi32> loc(#loc157)
    %offs_cn = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_206 = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_207 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc158)
    %offs_cn_208 = arith.extsi %offs_cn_206 : i32 to i64 loc(#loc158)
    %offs_cn_209 = arith.muli %offs_cn_207, %offs_cn_208 : i64 loc(#loc158)
    %offs_cn_210 = arith.constant 2147483647 : i64 loc(#loc158)
    %offs_cn_211 = arith.constant -2147483648 : i64 loc(#loc158)
    %offs_cn_212 = arith.cmpi sle, %offs_cn_209, %offs_cn_210 : i64 loc(#loc158)
    %offs_cn_213 = arith.cmpi sge, %offs_cn_209, %offs_cn_211 : i64 loc(#loc158)
    %offs_cn_214 = arith.andi %offs_cn_212, %offs_cn_213 : i1 loc(#loc158)
    %offs_cn_215 = arith.muli %pid_n_40, %offs_cn_206 : i32 loc(#loc158)
    %offs_cn_216 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc159)
    %offs_cn_217 = tt.splat %offs_cn_215 : i32 -> tensor<32xi32> loc(#loc160)
    %offs_cn_218 = arith.extsi %offs_cn_217 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_219 = arith.extsi %offs_cn_216 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_220 = arith.addi %offs_cn_218, %offs_cn_219 : tensor<32xi64> loc(#loc160)
    %offs_cn_221 = arith.constant 2147483647 : i64 loc(#loc160)
    %offs_cn_222 = arith.constant -2147483648 : i64 loc(#loc160)
    %offs_cn_223 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc160)
    %offs_cn_224 = arith.cmpi sle, %offs_cn_220, %offs_cn_223 : tensor<32xi64> loc(#loc160)
    %offs_cn_225 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc160)
    %offs_cn_226 = arith.cmpi sge, %offs_cn_220, %offs_cn_225 : tensor<32xi64> loc(#loc160)
    %offs_cn_227 = arith.andi %offs_cn_224, %offs_cn_226 : tensor<32xi1> loc(#loc160)
    %offs_cn_228 = arith.addi %offs_cn_217, %offs_cn_216 : tensor<32xi32> loc(#loc160)
    %c_ptrs = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc161)
    %c_ptrs_229 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc162)
    %c_ptrs_230 = arith.extsi %c_ptrs_229 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_231 = arith.extsi %c_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_232 = arith.muli %c_ptrs_230, %c_ptrs_231 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_233 = arith.constant 2147483647 : i64 loc(#loc162)
    %c_ptrs_234 = arith.constant -2147483648 : i64 loc(#loc162)
    %c_ptrs_235 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_236 = arith.cmpi sle, %c_ptrs_232, %c_ptrs_235 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_237 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_238 = arith.cmpi sge, %c_ptrs_232, %c_ptrs_237 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_239 = arith.andi %c_ptrs_236, %c_ptrs_238 : tensor<64x1xi1> loc(#loc162)
    %c_ptrs_240 = arith.muli %c_ptrs_229, %c_ptrs : tensor<64x1xi32> loc(#loc162)
    %c_ptrs_241 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc163)
    %c_ptrs_242 = tt.addptr %c_ptrs_241, %c_ptrs_240 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc163)
    %c_ptrs_243 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc164)
    %c_ptrs_244 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_245 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_246 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_247 = arith.extsi %c_ptrs_246 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_248 = arith.extsi %c_ptrs_243 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_249 = arith.muli %c_ptrs_247, %c_ptrs_248 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_250 = arith.constant 2147483647 : i64 loc(#loc165)
    %c_ptrs_251 = arith.constant -2147483648 : i64 loc(#loc165)
    %c_ptrs_252 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_253 = arith.cmpi sle, %c_ptrs_249, %c_ptrs_252 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_254 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_255 = arith.cmpi sge, %c_ptrs_249, %c_ptrs_254 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_256 = arith.andi %c_ptrs_253, %c_ptrs_255 : tensor<1x32xi1> loc(#loc165)
    %c_ptrs_257 = arith.muli %c_ptrs_246, %c_ptrs_243 : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_258 = tt.broadcast %c_ptrs_242 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc166)
    %c_ptrs_259 = tt.broadcast %c_ptrs_257 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc166)
    %c_ptrs_260 = tt.addptr %c_ptrs_258, %c_ptrs_259 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc166)
    %c_mask = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc167)
    %c_mask_261 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc168)
    %c_mask_262 = arith.cmpi slt, %c_mask, %c_mask_261 : tensor<64x1xi32> loc(#loc168)
    %c_mask_263 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc169)
    %c_mask_264 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc170)
    %c_mask_265 = arith.cmpi slt, %c_mask_263, %c_mask_264 : tensor<1x32xi32> loc(#loc170)
    %c_mask_266 = tt.broadcast %c_mask_262 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_267 = tt.broadcast %c_mask_265 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_268 = arith.andi %c_mask_266, %c_mask_267 : tensor<64x32xi1> loc(#loc171)
    tt.store %c_ptrs_260, %c, %c_mask_268 : tensor<64x32x!tt.ptr<f16>> loc(#loc84)
    tt.return loc(#loc85)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c63_i32 = arith.constant 63 : i32 loc(#loc87)
    %c63_i32_0 = arith.constant 63 : i32 loc(#loc87)
    %0 = arith.extsi %x : i32 to i64 loc(#loc87)
    %1 = arith.extsi %c63_i32_0 : i32 to i64 loc(#loc87)
    %2 = arith.addi %0, %1 : i64 loc(#loc87)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc87)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc87)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc87)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc87)
    %5 = arith.andi %3, %4 : i1 loc(#loc87)
    %6 = arith.addi %x, %c63_i32_0 : i32 loc(#loc87)
    %c64_i32 = arith.constant 64 : i32 loc(#loc88)
    %c64_i32_1 = arith.constant 64 : i32 loc(#loc88)
    %7 = arith.divsi %6, %c64_i32_1 : i32 loc(#loc88)
    tt.return %7 : i32 loc(#loc89)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc90)
    tt.return %8 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c31_i32 = arith.constant 31 : i32 loc(#loc87)
    %c31_i32_0 = arith.constant 31 : i32 loc(#loc87)
    %0 = arith.extsi %x : i32 to i64 loc(#loc87)
    %1 = arith.extsi %c31_i32_0 : i32 to i64 loc(#loc87)
    %2 = arith.addi %0, %1 : i64 loc(#loc87)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc87)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc87)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc87)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc87)
    %5 = arith.andi %3, %4 : i1 loc(#loc87)
    %6 = arith.addi %x, %c31_i32_0 : i32 loc(#loc87)
    %c32_i32 = arith.constant 32 : i32 loc(#loc88)
    %c32_i32_1 = arith.constant 32 : i32 loc(#loc88)
    %7 = arith.divsi %6, %c32_i32_1 : i32 loc(#loc88)
    tt.return %7 : i32 loc(#loc89)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc90)
    tt.return %8 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc92)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc92)
    tt.return %cst_0 : tensor<64x32xf32> loc(#loc93)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x32xf32> loc(#loc94)
    tt.return %0 : tensor<64x32xf32> loc(#loc94)
  } loc(#loc91)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:71)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:71)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:64)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc89 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:11)
#loc90 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:4)
#loc91 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc92 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc93 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:11)
#loc94 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:4)
#loc104 = loc("pid"(#loc1))
#loc105 = loc("num_pid_m"(#loc2))
#loc106 = loc("num_pid_n"(#loc3))
#loc107 = loc("num_pid_in_group"(#loc4))
#loc108 = loc("group_id"(#loc5))
#loc109 = loc("first_pid_m"(#loc6))
#loc110 = loc("group_size_m"(#loc7))
#loc111 = loc("group_size_m"(#loc8))
#loc112 = loc("pid_m"(#loc9))
#loc113 = loc("pid_m"(#loc10))
#loc114 = loc("pid_m"(#loc11))
#loc115 = loc("pid_n"(#loc12))
#loc116 = loc("pid_n"(#loc13))
#loc117 = loc("offs_am"(#loc27))
#loc118 = loc("offs_am"(#loc28))
#loc119 = loc("offs_am"(#loc29))
#loc120 = loc("offs_am"(#loc30))
#loc121 = loc("offs_bn"(#loc31))
#loc122 = loc("offs_bn"(#loc32))
#loc123 = loc("offs_bn"(#loc33))
#loc124 = loc("offs_bn"(#loc34))
#loc125 = loc("offs_k"(#loc35))
#loc126 = loc("a_ptrs"(#loc36))
#loc127 = loc("a_ptrs"(#loc37))
#loc128 = loc("a_ptrs"(#loc38))
#loc129 = loc("a_ptrs"(#loc39))
#loc130 = loc("a_ptrs"(#loc40))
#loc131 = loc("a_ptrs"(#loc41))
#loc132 = loc("b_ptrs"(#loc42))
#loc133 = loc("b_ptrs"(#loc43))
#loc134 = loc("b_ptrs"(#loc44))
#loc135 = loc("b_ptrs"(#loc45))
#loc136 = loc("b_ptrs"(#loc46))
#loc137 = loc("b_ptrs"(#loc47))
#loc138 = loc("accumulator"(#loc48))
#loc139 = loc("a_ptrs"(#loc50))
#loc140 = loc("a"(#loc51))
#loc141 = loc("a"(#loc52))
#loc142 = loc("a"(#loc53))
#loc143 = loc("a"(#loc54))
#loc144 = loc("a"(#loc55))
#loc145 = loc("b"(#loc56))
#loc146 = loc("b"(#loc57))
#loc147 = loc("b"(#loc58))
#loc148 = loc("b"(#loc59))
#loc149 = loc("b"(#loc60))
#loc150 = loc("accumulator"(#loc61))
#loc151 = loc("a_ptrs"(#loc62))
#loc152 = loc("b_ptrs"(#loc63))
#loc153 = loc("b_ptrs"(#loc64))
#loc154 = loc("c"(#loc66))
#loc155 = loc("offs_cm"(#loc67))
#loc156 = loc("offs_cm"(#loc68))
#loc157 = loc("offs_cm"(#loc69))
#loc158 = loc("offs_cn"(#loc70))
#loc159 = loc("offs_cn"(#loc71))
#loc160 = loc("offs_cn"(#loc72))
#loc161 = loc("c_ptrs"(#loc73))
#loc162 = loc("c_ptrs"(#loc74))
#loc163 = loc("c_ptrs"(#loc75))
#loc164 = loc("c_ptrs"(#loc76))
#loc165 = loc("c_ptrs"(#loc77))
#loc166 = loc("c_ptrs"(#loc78))
#loc167 = loc("c_mask"(#loc79))
#loc168 = loc("c_mask"(#loc80))
#loc169 = loc("c_mask"(#loc81))
#loc170 = loc("c_mask"(#loc82))
#loc171 = loc("c_mask"(#loc83))
#loc173 = loc("b_ptrs"(#loc139))
#loc174 = loc("accumulator"(#loc173))


// -----// IR Dump Before Canonicalizer (canonicalize) ('tt.func' operation: @triton.language.standard.cdiv__i32_c64) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc86 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc95 = loc("a_ptr"(#loc))
#loc96 = loc("b_ptr"(#loc))
#loc97 = loc("c_ptr"(#loc))
#loc98 = loc("M"(#loc))
#loc99 = loc("N"(#loc))
#loc100 = loc("K"(#loc))
#loc101 = loc("stride_am"(#loc))
#loc102 = loc("stride_bk"(#loc))
#loc103 = loc("stride_cm"(#loc))
#loc172 = loc("x"(#loc86))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc104)
    %num_pid_m = tt.call @triton.language.standard.cdiv__i32_c64(%M) : (i32) -> i32 loc(#loc105)
    %num_pid_n = tt.call @triton.language.standard.cdiv__i32_c32(%N) : (i32) -> i32 loc(#loc106)
    %num_pid_in_group = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_0 = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_1 = arith.extsi %num_pid_in_group_0 : i32 to i64 loc(#loc107)
    %num_pid_in_group_2 = arith.extsi %num_pid_n : i32 to i64 loc(#loc107)
    %num_pid_in_group_3 = arith.muli %num_pid_in_group_1, %num_pid_in_group_2 : i64 loc(#loc107)
    %num_pid_in_group_4 = arith.constant 2147483647 : i64 loc(#loc107)
    %num_pid_in_group_5 = arith.constant -2147483648 : i64 loc(#loc107)
    %num_pid_in_group_6 = arith.cmpi sle, %num_pid_in_group_3, %num_pid_in_group_4 : i64 loc(#loc107)
    %num_pid_in_group_7 = arith.cmpi sge, %num_pid_in_group_3, %num_pid_in_group_5 : i64 loc(#loc107)
    %num_pid_in_group_8 = arith.andi %num_pid_in_group_6, %num_pid_in_group_7 : i1 loc(#loc107)
    %num_pid_in_group_9 = arith.muli %num_pid_in_group_0, %num_pid_n : i32 loc(#loc107)
    %group_id = arith.divsi %pid, %num_pid_in_group_9 : i32 loc(#loc108)
    %first_pid_m = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_10 = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_11 = arith.extsi %group_id : i32 to i64 loc(#loc109)
    %first_pid_m_12 = arith.extsi %first_pid_m_10 : i32 to i64 loc(#loc109)
    %first_pid_m_13 = arith.muli %first_pid_m_11, %first_pid_m_12 : i64 loc(#loc109)
    %first_pid_m_14 = arith.constant 2147483647 : i64 loc(#loc109)
    %first_pid_m_15 = arith.constant -2147483648 : i64 loc(#loc109)
    %first_pid_m_16 = arith.cmpi sle, %first_pid_m_13, %first_pid_m_14 : i64 loc(#loc109)
    %first_pid_m_17 = arith.cmpi sge, %first_pid_m_13, %first_pid_m_15 : i64 loc(#loc109)
    %first_pid_m_18 = arith.andi %first_pid_m_16, %first_pid_m_17 : i1 loc(#loc109)
    %first_pid_m_19 = arith.muli %group_id, %first_pid_m_10 : i32 loc(#loc109)
    %group_size_m = arith.extsi %num_pid_m : i32 to i64 loc(#loc110)
    %group_size_m_20 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc110)
    %group_size_m_21 = arith.subi %group_size_m, %group_size_m_20 : i64 loc(#loc110)
    %group_size_m_22 = arith.constant 2147483647 : i64 loc(#loc110)
    %group_size_m_23 = arith.constant -2147483648 : i64 loc(#loc110)
    %group_size_m_24 = arith.cmpi sle, %group_size_m_21, %group_size_m_22 : i64 loc(#loc110)
    %group_size_m_25 = arith.cmpi sge, %group_size_m_21, %group_size_m_23 : i64 loc(#loc110)
    %group_size_m_26 = arith.andi %group_size_m_24, %group_size_m_25 : i1 loc(#loc110)
    %group_size_m_27 = arith.subi %num_pid_m, %first_pid_m_19 : i32 loc(#loc110)
    %group_size_m_28 = arith.constant 4 : i32 loc(#loc111)
    %group_size_m_29 = arith.minsi %group_size_m_27, %group_size_m_28 : i32 loc(#loc111)
    %pid_m = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc112)
    %pid_m_30 = arith.remsi %pid_m, %group_size_m_29 : i32 loc(#loc113)
    %pid_m_31 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc114)
    %pid_m_32 = arith.extsi %pid_m_30 : i32 to i64 loc(#loc114)
    %pid_m_33 = arith.addi %pid_m_31, %pid_m_32 : i64 loc(#loc114)
    %pid_m_34 = arith.constant 2147483647 : i64 loc(#loc114)
    %pid_m_35 = arith.constant -2147483648 : i64 loc(#loc114)
    %pid_m_36 = arith.cmpi sle, %pid_m_33, %pid_m_34 : i64 loc(#loc114)
    %pid_m_37 = arith.cmpi sge, %pid_m_33, %pid_m_35 : i64 loc(#loc114)
    %pid_m_38 = arith.andi %pid_m_36, %pid_m_37 : i1 loc(#loc114)
    %pid_m_39 = arith.addi %first_pid_m_19, %pid_m_30 : i32 loc(#loc114)
    %pid_n = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc115)
    %pid_n_40 = arith.divsi %pid_n, %group_size_m_29 : i32 loc(#loc116)
    %c0_i32 = arith.constant 0 : i32 loc(#loc14)
    %0 = arith.cmpi sge, %pid_m_39, %c0_i32 : i32 loc(#loc14)
    llvm.intr.assume %0 : i1 loc(#loc15)
    %c0_i32_41 = arith.constant 0 : i32 loc(#loc16)
    %1 = arith.cmpi sge, %pid_n_40, %c0_i32_41 : i32 loc(#loc16)
    llvm.intr.assume %1 : i1 loc(#loc17)
    %c0_i32_42 = arith.constant 0 : i32 loc(#loc18)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32_42 : i32 loc(#loc18)
    llvm.intr.assume %2 : i1 loc(#loc19)
    %true = arith.constant true loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc20)
    %true_43 = arith.constant true loc(#loc21)
    llvm.intr.assume %true_43 : i1 loc(#loc21)
    %c0_i32_44 = arith.constant 0 : i32 loc(#loc22)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32_44 : i32 loc(#loc22)
    llvm.intr.assume %3 : i1 loc(#loc23)
    %c0_i32_45 = arith.constant 0 : i32 loc(#loc24)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32_45 : i32 loc(#loc24)
    llvm.intr.assume %4 : i1 loc(#loc25)
    %true_46 = arith.constant true loc(#loc26)
    llvm.intr.assume %true_46 : i1 loc(#loc26)
    %offs_am = arith.constant 64 : i32 loc(#loc117)
    %offs_am_47 = arith.constant 64 : i32 loc(#loc117)
    %offs_am_48 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc117)
    %offs_am_49 = arith.extsi %offs_am_47 : i32 to i64 loc(#loc117)
    %offs_am_50 = arith.muli %offs_am_48, %offs_am_49 : i64 loc(#loc117)
    %offs_am_51 = arith.constant 2147483647 : i64 loc(#loc117)
    %offs_am_52 = arith.constant -2147483648 : i64 loc(#loc117)
    %offs_am_53 = arith.cmpi sle, %offs_am_50, %offs_am_51 : i64 loc(#loc117)
    %offs_am_54 = arith.cmpi sge, %offs_am_50, %offs_am_52 : i64 loc(#loc117)
    %offs_am_55 = arith.andi %offs_am_53, %offs_am_54 : i1 loc(#loc117)
    %offs_am_56 = arith.muli %pid_m_39, %offs_am_47 : i32 loc(#loc117)
    %offs_am_57 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %offs_am_58 = tt.splat %offs_am_56 : i32 -> tensor<64xi32> loc(#loc119)
    %offs_am_59 = arith.extsi %offs_am_58 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_60 = arith.extsi %offs_am_57 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_61 = arith.addi %offs_am_59, %offs_am_60 : tensor<64xi64> loc(#loc119)
    %offs_am_62 = arith.constant 2147483647 : i64 loc(#loc119)
    %offs_am_63 = arith.constant -2147483648 : i64 loc(#loc119)
    %offs_am_64 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc119)
    %offs_am_65 = arith.cmpi sle, %offs_am_61, %offs_am_64 : tensor<64xi64> loc(#loc119)
    %offs_am_66 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc119)
    %offs_am_67 = arith.cmpi sge, %offs_am_61, %offs_am_66 : tensor<64xi64> loc(#loc119)
    %offs_am_68 = arith.andi %offs_am_65, %offs_am_67 : tensor<64xi1> loc(#loc119)
    %offs_am_69 = arith.addi %offs_am_58, %offs_am_57 : tensor<64xi32> loc(#loc119)
    %offs_am_70 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc120)
    %offs_am_71 = arith.remsi %offs_am_69, %offs_am_70 : tensor<64xi32> loc(#loc120)
    %offs_bn = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_72 = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_73 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc121)
    %offs_bn_74 = arith.extsi %offs_bn_72 : i32 to i64 loc(#loc121)
    %offs_bn_75 = arith.muli %offs_bn_73, %offs_bn_74 : i64 loc(#loc121)
    %offs_bn_76 = arith.constant 2147483647 : i64 loc(#loc121)
    %offs_bn_77 = arith.constant -2147483648 : i64 loc(#loc121)
    %offs_bn_78 = arith.cmpi sle, %offs_bn_75, %offs_bn_76 : i64 loc(#loc121)
    %offs_bn_79 = arith.cmpi sge, %offs_bn_75, %offs_bn_77 : i64 loc(#loc121)
    %offs_bn_80 = arith.andi %offs_bn_78, %offs_bn_79 : i1 loc(#loc121)
    %offs_bn_81 = arith.muli %pid_n_40, %offs_bn_72 : i32 loc(#loc121)
    %offs_bn_82 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc122)
    %offs_bn_83 = tt.splat %offs_bn_81 : i32 -> tensor<32xi32> loc(#loc123)
    %offs_bn_84 = arith.extsi %offs_bn_83 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_85 = arith.extsi %offs_bn_82 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_86 = arith.addi %offs_bn_84, %offs_bn_85 : tensor<32xi64> loc(#loc123)
    %offs_bn_87 = arith.constant 2147483647 : i64 loc(#loc123)
    %offs_bn_88 = arith.constant -2147483648 : i64 loc(#loc123)
    %offs_bn_89 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc123)
    %offs_bn_90 = arith.cmpi sle, %offs_bn_86, %offs_bn_89 : tensor<32xi64> loc(#loc123)
    %offs_bn_91 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc123)
    %offs_bn_92 = arith.cmpi sge, %offs_bn_86, %offs_bn_91 : tensor<32xi64> loc(#loc123)
    %offs_bn_93 = arith.andi %offs_bn_90, %offs_bn_92 : tensor<32xi1> loc(#loc123)
    %offs_bn_94 = arith.addi %offs_bn_83, %offs_bn_82 : tensor<32xi32> loc(#loc123)
    %offs_bn_95 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc124)
    %offs_bn_96 = arith.remsi %offs_bn_94, %offs_bn_95 : tensor<32xi32> loc(#loc124)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc125)
    %a_ptrs = tt.expand_dims %offs_am_71 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc126)
    %a_ptrs_97 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc127)
    %a_ptrs_98 = arith.extsi %a_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_99 = arith.extsi %a_ptrs_97 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_100 = arith.muli %a_ptrs_98, %a_ptrs_99 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_101 = arith.constant 2147483647 : i64 loc(#loc127)
    %a_ptrs_102 = arith.constant -2147483648 : i64 loc(#loc127)
    %a_ptrs_103 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_104 = arith.cmpi sle, %a_ptrs_100, %a_ptrs_103 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_105 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_106 = arith.cmpi sge, %a_ptrs_100, %a_ptrs_105 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_107 = arith.andi %a_ptrs_104, %a_ptrs_106 : tensor<64x1xi1> loc(#loc127)
    %a_ptrs_108 = arith.muli %a_ptrs, %a_ptrs_97 : tensor<64x1xi32> loc(#loc127)
    %a_ptrs_109 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc128)
    %a_ptrs_110 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_111 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_112 = arith.constant dense<1> : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_113 = arith.extsi %a_ptrs_109 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_114 = arith.extsi %a_ptrs_112 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_115 = arith.muli %a_ptrs_113, %a_ptrs_114 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_116 = arith.constant 2147483647 : i64 loc(#loc129)
    %a_ptrs_117 = arith.constant -2147483648 : i64 loc(#loc129)
    %a_ptrs_118 = arith.constant dense<2147483647> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_119 = arith.cmpi sle, %a_ptrs_115, %a_ptrs_118 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_120 = arith.constant dense<-2147483648> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_121 = arith.cmpi sge, %a_ptrs_115, %a_ptrs_120 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_122 = arith.andi %a_ptrs_119, %a_ptrs_121 : tensor<1x64xi1> loc(#loc129)
    %a_ptrs_123 = arith.muli %a_ptrs_109, %a_ptrs_112 : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_124 = tt.broadcast %a_ptrs_108 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_125 = tt.broadcast %a_ptrs_123 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_126 = arith.extsi %a_ptrs_124 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_127 = arith.extsi %a_ptrs_125 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_128 = arith.addi %a_ptrs_126, %a_ptrs_127 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_129 = arith.constant 2147483647 : i64 loc(#loc130)
    %a_ptrs_130 = arith.constant -2147483648 : i64 loc(#loc130)
    %a_ptrs_131 = arith.constant dense<2147483647> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_132 = arith.cmpi sle, %a_ptrs_128, %a_ptrs_131 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_133 = arith.constant dense<-2147483648> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_134 = arith.cmpi sge, %a_ptrs_128, %a_ptrs_133 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_135 = arith.andi %a_ptrs_132, %a_ptrs_134 : tensor<64x64xi1> loc(#loc130)
    %a_ptrs_136 = arith.addi %a_ptrs_124, %a_ptrs_125 : tensor<64x64xi32> loc(#loc130)
    %a_ptrs_137 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc131)
    %a_ptrs_138 = tt.addptr %a_ptrs_137, %a_ptrs_136 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc131)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc132)
    %b_ptrs_139 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc133)
    %b_ptrs_140 = arith.extsi %b_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_141 = arith.extsi %b_ptrs_139 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_142 = arith.muli %b_ptrs_140, %b_ptrs_141 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_143 = arith.constant 2147483647 : i64 loc(#loc133)
    %b_ptrs_144 = arith.constant -2147483648 : i64 loc(#loc133)
    %b_ptrs_145 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_146 = arith.cmpi sle, %b_ptrs_142, %b_ptrs_145 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_147 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_148 = arith.cmpi sge, %b_ptrs_142, %b_ptrs_147 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_149 = arith.andi %b_ptrs_146, %b_ptrs_148 : tensor<64x1xi1> loc(#loc133)
    %b_ptrs_150 = arith.muli %b_ptrs, %b_ptrs_139 : tensor<64x1xi32> loc(#loc133)
    %b_ptrs_151 = tt.expand_dims %offs_bn_96 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc134)
    %b_ptrs_152 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_153 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_154 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_155 = arith.extsi %b_ptrs_151 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_156 = arith.extsi %b_ptrs_154 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_157 = arith.muli %b_ptrs_155, %b_ptrs_156 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_158 = arith.constant 2147483647 : i64 loc(#loc135)
    %b_ptrs_159 = arith.constant -2147483648 : i64 loc(#loc135)
    %b_ptrs_160 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_161 = arith.cmpi sle, %b_ptrs_157, %b_ptrs_160 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_162 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_163 = arith.cmpi sge, %b_ptrs_157, %b_ptrs_162 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_164 = arith.andi %b_ptrs_161, %b_ptrs_163 : tensor<1x32xi1> loc(#loc135)
    %b_ptrs_165 = arith.muli %b_ptrs_151, %b_ptrs_154 : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_166 = tt.broadcast %b_ptrs_150 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_167 = tt.broadcast %b_ptrs_165 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_168 = arith.extsi %b_ptrs_166 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_169 = arith.extsi %b_ptrs_167 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_170 = arith.addi %b_ptrs_168, %b_ptrs_169 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_171 = arith.constant 2147483647 : i64 loc(#loc136)
    %b_ptrs_172 = arith.constant -2147483648 : i64 loc(#loc136)
    %b_ptrs_173 = arith.constant dense<2147483647> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_174 = arith.cmpi sle, %b_ptrs_170, %b_ptrs_173 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_175 = arith.constant dense<-2147483648> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_176 = arith.cmpi sge, %b_ptrs_170, %b_ptrs_175 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_177 = arith.andi %b_ptrs_174, %b_ptrs_176 : tensor<64x32xi1> loc(#loc136)
    %b_ptrs_178 = arith.addi %b_ptrs_166, %b_ptrs_167 : tensor<64x32xi32> loc(#loc136)
    %b_ptrs_179 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc137)
    %b_ptrs_180 = tt.addptr %b_ptrs_179, %b_ptrs_178 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc137)
    %accumulator = tt.call @triton.language.standard.zeros__Tc64_c32T_cfp32() : () -> tensor<64x32xf32> loc(#loc138)
    %5 = tt.call @triton.language.standard.cdiv__i32_c64(%K) : (i32) -> i32 loc(#loc49)
    %c0_i32_181 = arith.constant 0 : i32 loc(#loc50)
    %c1_i32 = arith.constant 1 : i32 loc(#loc50)
    %6 = arith.bitcast %c0_i32_181 : i32 to i32 loc(#loc50)
    %7 = arith.bitcast %5 : i32 to i32 loc(#loc50)
    %8 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc50)
    %9 = ub.poison : i32 loc(#loc50)
    %accumulator_182:3 = scf.for %k = %6 to %7 step %8 iter_args(%a_ptrs_269 = %a_ptrs_138, %b_ptrs_270 = %b_ptrs_180, %accumulator_271 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc140)
      %a_272 = arith.constant 64 : i32 loc(#loc141)
      %a_273 = arith.constant 64 : i32 loc(#loc141)
      %a_274 = arith.extsi %k : i32 to i64 loc(#loc141)
      %a_275 = arith.extsi %a_273 : i32 to i64 loc(#loc141)
      %a_276 = arith.muli %a_274, %a_275 : i64 loc(#loc141)
      %a_277 = arith.constant 2147483647 : i64 loc(#loc141)
      %a_278 = arith.constant -2147483648 : i64 loc(#loc141)
      %a_279 = arith.cmpi sle, %a_276, %a_277 : i64 loc(#loc141)
      %a_280 = arith.cmpi sge, %a_276, %a_278 : i64 loc(#loc141)
      %a_281 = arith.andi %a_279, %a_280 : i1 loc(#loc141)
      %a_282 = arith.muli %k, %a_273 : i32 loc(#loc141)
      %a_283 = arith.extsi %K : i32 to i64 loc(#loc142)
      %a_284 = arith.extsi %a_282 : i32 to i64 loc(#loc142)
      %a_285 = arith.subi %a_283, %a_284 : i64 loc(#loc142)
      %a_286 = arith.constant 2147483647 : i64 loc(#loc142)
      %a_287 = arith.constant -2147483648 : i64 loc(#loc142)
      %a_288 = arith.cmpi sle, %a_285, %a_286 : i64 loc(#loc142)
      %a_289 = arith.cmpi sge, %a_285, %a_287 : i64 loc(#loc142)
      %a_290 = arith.andi %a_288, %a_289 : i1 loc(#loc142)
      %a_291 = arith.subi %K, %a_282 : i32 loc(#loc142)
      %a_292 = tt.splat %a_291 : i32 -> tensor<1x64xi32> loc(#loc143)
      %a_293 = arith.cmpi slt, %a, %a_292 : tensor<1x64xi32> loc(#loc143)
      %a_294 = arith.constant 0.000000e+00 : f32 loc(#loc144)
      %a_295 = tt.broadcast %a_293 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc144)
      %a_296 = arith.constant dense<0.000000e+00> : tensor<64x64xf32> loc(#loc144)
      %a_297 = arith.truncf %a_296 : tensor<64x64xf32> to tensor<64x64xf16> loc(#loc144)
      %a_298 = tt.load %a_ptrs_269, %a_295, %a_297 : tensor<64x64x!tt.ptr<f16>> loc(#loc144)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc145)
      %b_299 = arith.constant 64 : i32 loc(#loc146)
      %b_300 = arith.constant 64 : i32 loc(#loc146)
      %b_301 = arith.extsi %k : i32 to i64 loc(#loc146)
      %b_302 = arith.extsi %b_300 : i32 to i64 loc(#loc146)
      %b_303 = arith.muli %b_301, %b_302 : i64 loc(#loc146)
      %b_304 = arith.constant 2147483647 : i64 loc(#loc146)
      %b_305 = arith.constant -2147483648 : i64 loc(#loc146)
      %b_306 = arith.cmpi sle, %b_303, %b_304 : i64 loc(#loc146)
      %b_307 = arith.cmpi sge, %b_303, %b_305 : i64 loc(#loc146)
      %b_308 = arith.andi %b_306, %b_307 : i1 loc(#loc146)
      %b_309 = arith.muli %k, %b_300 : i32 loc(#loc146)
      %b_310 = arith.extsi %K : i32 to i64 loc(#loc147)
      %b_311 = arith.extsi %b_309 : i32 to i64 loc(#loc147)
      %b_312 = arith.subi %b_310, %b_311 : i64 loc(#loc147)
      %b_313 = arith.constant 2147483647 : i64 loc(#loc147)
      %b_314 = arith.constant -2147483648 : i64 loc(#loc147)
      %b_315 = arith.cmpi sle, %b_312, %b_313 : i64 loc(#loc147)
      %b_316 = arith.cmpi sge, %b_312, %b_314 : i64 loc(#loc147)
      %b_317 = arith.andi %b_315, %b_316 : i1 loc(#loc147)
      %b_318 = arith.subi %K, %b_309 : i32 loc(#loc147)
      %b_319 = tt.splat %b_318 : i32 -> tensor<64x1xi32> loc(#loc148)
      %b_320 = arith.cmpi slt, %b, %b_319 : tensor<64x1xi32> loc(#loc148)
      %b_321 = arith.constant 0.000000e+00 : f32 loc(#loc149)
      %b_322 = tt.broadcast %b_320 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc149)
      %b_323 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc149)
      %b_324 = arith.truncf %b_323 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc149)
      %b_325 = tt.load %b_ptrs_270, %b_322, %b_324 : tensor<64x32x!tt.ptr<f16>> loc(#loc149)
      %accumulator_326 = arith.constant 0.000000e+00 : f32 loc(#loc150)
      %accumulator_327 = tt.dot %a_298, %b_325, %accumulator_271, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc150)
      %a_ptrs_328 = arith.constant 64 : i32 loc(#loc151)
      %a_ptrs_329 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc151)
      %a_ptrs_330 = tt.addptr %a_ptrs_269, %a_ptrs_329 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc151)
      %b_ptrs_331 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_332 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_333 = arith.extsi %b_ptrs_332 : i32 to i64 loc(#loc152)
      %b_ptrs_334 = arith.extsi %stride_bk : i32 to i64 loc(#loc152)
      %b_ptrs_335 = arith.muli %b_ptrs_333, %b_ptrs_334 : i64 loc(#loc152)
      %b_ptrs_336 = arith.constant 2147483647 : i64 loc(#loc152)
      %b_ptrs_337 = arith.constant -2147483648 : i64 loc(#loc152)
      %b_ptrs_338 = arith.cmpi sle, %b_ptrs_335, %b_ptrs_336 : i64 loc(#loc152)
      %b_ptrs_339 = arith.cmpi sge, %b_ptrs_335, %b_ptrs_337 : i64 loc(#loc152)
      %b_ptrs_340 = arith.andi %b_ptrs_338, %b_ptrs_339 : i1 loc(#loc152)
      %b_ptrs_341 = arith.muli %b_ptrs_332, %stride_bk : i32 loc(#loc152)
      %b_ptrs_342 = tt.splat %b_ptrs_341 : i32 -> tensor<64x32xi32> loc(#loc153)
      %b_ptrs_343 = tt.addptr %b_ptrs_270, %b_ptrs_342 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc153)
      scf.yield %a_ptrs_330, %b_ptrs_343, %accumulator_327 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc65)
    } loc(#loc174)
    %c = arith.truncf %accumulator_182#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc154)
    %offs_cm = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_183 = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_184 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc155)
    %offs_cm_185 = arith.extsi %offs_cm_183 : i32 to i64 loc(#loc155)
    %offs_cm_186 = arith.muli %offs_cm_184, %offs_cm_185 : i64 loc(#loc155)
    %offs_cm_187 = arith.constant 2147483647 : i64 loc(#loc155)
    %offs_cm_188 = arith.constant -2147483648 : i64 loc(#loc155)
    %offs_cm_189 = arith.cmpi sle, %offs_cm_186, %offs_cm_187 : i64 loc(#loc155)
    %offs_cm_190 = arith.cmpi sge, %offs_cm_186, %offs_cm_188 : i64 loc(#loc155)
    %offs_cm_191 = arith.andi %offs_cm_189, %offs_cm_190 : i1 loc(#loc155)
    %offs_cm_192 = arith.muli %pid_m_39, %offs_cm_183 : i32 loc(#loc155)
    %offs_cm_193 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc156)
    %offs_cm_194 = tt.splat %offs_cm_192 : i32 -> tensor<64xi32> loc(#loc157)
    %offs_cm_195 = arith.extsi %offs_cm_194 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_196 = arith.extsi %offs_cm_193 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_197 = arith.addi %offs_cm_195, %offs_cm_196 : tensor<64xi64> loc(#loc157)
    %offs_cm_198 = arith.constant 2147483647 : i64 loc(#loc157)
    %offs_cm_199 = arith.constant -2147483648 : i64 loc(#loc157)
    %offs_cm_200 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc157)
    %offs_cm_201 = arith.cmpi sle, %offs_cm_197, %offs_cm_200 : tensor<64xi64> loc(#loc157)
    %offs_cm_202 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc157)
    %offs_cm_203 = arith.cmpi sge, %offs_cm_197, %offs_cm_202 : tensor<64xi64> loc(#loc157)
    %offs_cm_204 = arith.andi %offs_cm_201, %offs_cm_203 : tensor<64xi1> loc(#loc157)
    %offs_cm_205 = arith.addi %offs_cm_194, %offs_cm_193 : tensor<64xi32> loc(#loc157)
    %offs_cn = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_206 = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_207 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc158)
    %offs_cn_208 = arith.extsi %offs_cn_206 : i32 to i64 loc(#loc158)
    %offs_cn_209 = arith.muli %offs_cn_207, %offs_cn_208 : i64 loc(#loc158)
    %offs_cn_210 = arith.constant 2147483647 : i64 loc(#loc158)
    %offs_cn_211 = arith.constant -2147483648 : i64 loc(#loc158)
    %offs_cn_212 = arith.cmpi sle, %offs_cn_209, %offs_cn_210 : i64 loc(#loc158)
    %offs_cn_213 = arith.cmpi sge, %offs_cn_209, %offs_cn_211 : i64 loc(#loc158)
    %offs_cn_214 = arith.andi %offs_cn_212, %offs_cn_213 : i1 loc(#loc158)
    %offs_cn_215 = arith.muli %pid_n_40, %offs_cn_206 : i32 loc(#loc158)
    %offs_cn_216 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc159)
    %offs_cn_217 = tt.splat %offs_cn_215 : i32 -> tensor<32xi32> loc(#loc160)
    %offs_cn_218 = arith.extsi %offs_cn_217 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_219 = arith.extsi %offs_cn_216 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_220 = arith.addi %offs_cn_218, %offs_cn_219 : tensor<32xi64> loc(#loc160)
    %offs_cn_221 = arith.constant 2147483647 : i64 loc(#loc160)
    %offs_cn_222 = arith.constant -2147483648 : i64 loc(#loc160)
    %offs_cn_223 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc160)
    %offs_cn_224 = arith.cmpi sle, %offs_cn_220, %offs_cn_223 : tensor<32xi64> loc(#loc160)
    %offs_cn_225 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc160)
    %offs_cn_226 = arith.cmpi sge, %offs_cn_220, %offs_cn_225 : tensor<32xi64> loc(#loc160)
    %offs_cn_227 = arith.andi %offs_cn_224, %offs_cn_226 : tensor<32xi1> loc(#loc160)
    %offs_cn_228 = arith.addi %offs_cn_217, %offs_cn_216 : tensor<32xi32> loc(#loc160)
    %c_ptrs = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc161)
    %c_ptrs_229 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc162)
    %c_ptrs_230 = arith.extsi %c_ptrs_229 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_231 = arith.extsi %c_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_232 = arith.muli %c_ptrs_230, %c_ptrs_231 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_233 = arith.constant 2147483647 : i64 loc(#loc162)
    %c_ptrs_234 = arith.constant -2147483648 : i64 loc(#loc162)
    %c_ptrs_235 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_236 = arith.cmpi sle, %c_ptrs_232, %c_ptrs_235 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_237 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_238 = arith.cmpi sge, %c_ptrs_232, %c_ptrs_237 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_239 = arith.andi %c_ptrs_236, %c_ptrs_238 : tensor<64x1xi1> loc(#loc162)
    %c_ptrs_240 = arith.muli %c_ptrs_229, %c_ptrs : tensor<64x1xi32> loc(#loc162)
    %c_ptrs_241 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc163)
    %c_ptrs_242 = tt.addptr %c_ptrs_241, %c_ptrs_240 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc163)
    %c_ptrs_243 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc164)
    %c_ptrs_244 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_245 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_246 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_247 = arith.extsi %c_ptrs_246 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_248 = arith.extsi %c_ptrs_243 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_249 = arith.muli %c_ptrs_247, %c_ptrs_248 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_250 = arith.constant 2147483647 : i64 loc(#loc165)
    %c_ptrs_251 = arith.constant -2147483648 : i64 loc(#loc165)
    %c_ptrs_252 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_253 = arith.cmpi sle, %c_ptrs_249, %c_ptrs_252 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_254 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_255 = arith.cmpi sge, %c_ptrs_249, %c_ptrs_254 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_256 = arith.andi %c_ptrs_253, %c_ptrs_255 : tensor<1x32xi1> loc(#loc165)
    %c_ptrs_257 = arith.muli %c_ptrs_246, %c_ptrs_243 : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_258 = tt.broadcast %c_ptrs_242 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc166)
    %c_ptrs_259 = tt.broadcast %c_ptrs_257 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc166)
    %c_ptrs_260 = tt.addptr %c_ptrs_258, %c_ptrs_259 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc166)
    %c_mask = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc167)
    %c_mask_261 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc168)
    %c_mask_262 = arith.cmpi slt, %c_mask, %c_mask_261 : tensor<64x1xi32> loc(#loc168)
    %c_mask_263 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc169)
    %c_mask_264 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc170)
    %c_mask_265 = arith.cmpi slt, %c_mask_263, %c_mask_264 : tensor<1x32xi32> loc(#loc170)
    %c_mask_266 = tt.broadcast %c_mask_262 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_267 = tt.broadcast %c_mask_265 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_268 = arith.andi %c_mask_266, %c_mask_267 : tensor<64x32xi1> loc(#loc171)
    tt.store %c_ptrs_260, %c, %c_mask_268 : tensor<64x32x!tt.ptr<f16>> loc(#loc84)
    tt.return loc(#loc85)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c63_i32 = arith.constant 63 : i32 loc(#loc87)
    %c63_i32_0 = arith.constant 63 : i32 loc(#loc87)
    %0 = arith.extsi %x : i32 to i64 loc(#loc87)
    %1 = arith.extsi %c63_i32_0 : i32 to i64 loc(#loc87)
    %2 = arith.addi %0, %1 : i64 loc(#loc87)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc87)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc87)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc87)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc87)
    %5 = arith.andi %3, %4 : i1 loc(#loc87)
    %6 = arith.addi %x, %c63_i32_0 : i32 loc(#loc87)
    %c64_i32 = arith.constant 64 : i32 loc(#loc88)
    %c64_i32_1 = arith.constant 64 : i32 loc(#loc88)
    %7 = arith.divsi %6, %c64_i32_1 : i32 loc(#loc88)
    tt.return %7 : i32 loc(#loc89)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc90)
    tt.return %8 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c31_i32 = arith.constant 31 : i32 loc(#loc87)
    %c31_i32_0 = arith.constant 31 : i32 loc(#loc87)
    %0 = arith.extsi %x : i32 to i64 loc(#loc87)
    %1 = arith.extsi %c31_i32_0 : i32 to i64 loc(#loc87)
    %2 = arith.addi %0, %1 : i64 loc(#loc87)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc87)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc87)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc87)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc87)
    %5 = arith.andi %3, %4 : i1 loc(#loc87)
    %6 = arith.addi %x, %c31_i32_0 : i32 loc(#loc87)
    %c32_i32 = arith.constant 32 : i32 loc(#loc88)
    %c32_i32_1 = arith.constant 32 : i32 loc(#loc88)
    %7 = arith.divsi %6, %c32_i32_1 : i32 loc(#loc88)
    tt.return %7 : i32 loc(#loc89)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc90)
    tt.return %8 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc92)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc92)
    tt.return %cst_0 : tensor<64x32xf32> loc(#loc93)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x32xf32> loc(#loc94)
    tt.return %0 : tensor<64x32xf32> loc(#loc94)
  } loc(#loc91)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:71)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:71)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:64)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc89 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:11)
#loc90 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:4)
#loc91 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc92 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc93 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:11)
#loc94 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:4)
#loc104 = loc("pid"(#loc1))
#loc105 = loc("num_pid_m"(#loc2))
#loc106 = loc("num_pid_n"(#loc3))
#loc107 = loc("num_pid_in_group"(#loc4))
#loc108 = loc("group_id"(#loc5))
#loc109 = loc("first_pid_m"(#loc6))
#loc110 = loc("group_size_m"(#loc7))
#loc111 = loc("group_size_m"(#loc8))
#loc112 = loc("pid_m"(#loc9))
#loc113 = loc("pid_m"(#loc10))
#loc114 = loc("pid_m"(#loc11))
#loc115 = loc("pid_n"(#loc12))
#loc116 = loc("pid_n"(#loc13))
#loc117 = loc("offs_am"(#loc27))
#loc118 = loc("offs_am"(#loc28))
#loc119 = loc("offs_am"(#loc29))
#loc120 = loc("offs_am"(#loc30))
#loc121 = loc("offs_bn"(#loc31))
#loc122 = loc("offs_bn"(#loc32))
#loc123 = loc("offs_bn"(#loc33))
#loc124 = loc("offs_bn"(#loc34))
#loc125 = loc("offs_k"(#loc35))
#loc126 = loc("a_ptrs"(#loc36))
#loc127 = loc("a_ptrs"(#loc37))
#loc128 = loc("a_ptrs"(#loc38))
#loc129 = loc("a_ptrs"(#loc39))
#loc130 = loc("a_ptrs"(#loc40))
#loc131 = loc("a_ptrs"(#loc41))
#loc132 = loc("b_ptrs"(#loc42))
#loc133 = loc("b_ptrs"(#loc43))
#loc134 = loc("b_ptrs"(#loc44))
#loc135 = loc("b_ptrs"(#loc45))
#loc136 = loc("b_ptrs"(#loc46))
#loc137 = loc("b_ptrs"(#loc47))
#loc138 = loc("accumulator"(#loc48))
#loc139 = loc("a_ptrs"(#loc50))
#loc140 = loc("a"(#loc51))
#loc141 = loc("a"(#loc52))
#loc142 = loc("a"(#loc53))
#loc143 = loc("a"(#loc54))
#loc144 = loc("a"(#loc55))
#loc145 = loc("b"(#loc56))
#loc146 = loc("b"(#loc57))
#loc147 = loc("b"(#loc58))
#loc148 = loc("b"(#loc59))
#loc149 = loc("b"(#loc60))
#loc150 = loc("accumulator"(#loc61))
#loc151 = loc("a_ptrs"(#loc62))
#loc152 = loc("b_ptrs"(#loc63))
#loc153 = loc("b_ptrs"(#loc64))
#loc154 = loc("c"(#loc66))
#loc155 = loc("offs_cm"(#loc67))
#loc156 = loc("offs_cm"(#loc68))
#loc157 = loc("offs_cm"(#loc69))
#loc158 = loc("offs_cn"(#loc70))
#loc159 = loc("offs_cn"(#loc71))
#loc160 = loc("offs_cn"(#loc72))
#loc161 = loc("c_ptrs"(#loc73))
#loc162 = loc("c_ptrs"(#loc74))
#loc163 = loc("c_ptrs"(#loc75))
#loc164 = loc("c_ptrs"(#loc76))
#loc165 = loc("c_ptrs"(#loc77))
#loc166 = loc("c_ptrs"(#loc78))
#loc167 = loc("c_mask"(#loc79))
#loc168 = loc("c_mask"(#loc80))
#loc169 = loc("c_mask"(#loc81))
#loc170 = loc("c_mask"(#loc82))
#loc171 = loc("c_mask"(#loc83))
#loc173 = loc("b_ptrs"(#loc139))
#loc174 = loc("accumulator"(#loc173))


// -----// IR Dump Before Canonicalizer (canonicalize) ('tt.func' operation: @triton.language.standard.cdiv__i32_c32) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc86 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc96 = loc("a_ptr"(#loc))
#loc97 = loc("b_ptr"(#loc))
#loc98 = loc("c_ptr"(#loc))
#loc99 = loc("M"(#loc))
#loc100 = loc("N"(#loc))
#loc101 = loc("K"(#loc))
#loc102 = loc("stride_am"(#loc))
#loc103 = loc("stride_bk"(#loc))
#loc104 = loc("stride_cm"(#loc))
#loc173 = loc("x"(#loc86))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc105)
    %num_pid_m = tt.call @triton.language.standard.cdiv__i32_c64(%M) : (i32) -> i32 loc(#loc106)
    %num_pid_n = tt.call @triton.language.standard.cdiv__i32_c32(%N) : (i32) -> i32 loc(#loc107)
    %num_pid_in_group = arith.constant 4 : i32 loc(#loc108)
    %num_pid_in_group_0 = arith.constant 4 : i32 loc(#loc108)
    %num_pid_in_group_1 = arith.extsi %num_pid_in_group_0 : i32 to i64 loc(#loc108)
    %num_pid_in_group_2 = arith.extsi %num_pid_n : i32 to i64 loc(#loc108)
    %num_pid_in_group_3 = arith.muli %num_pid_in_group_1, %num_pid_in_group_2 : i64 loc(#loc108)
    %num_pid_in_group_4 = arith.constant 2147483647 : i64 loc(#loc108)
    %num_pid_in_group_5 = arith.constant -2147483648 : i64 loc(#loc108)
    %num_pid_in_group_6 = arith.cmpi sle, %num_pid_in_group_3, %num_pid_in_group_4 : i64 loc(#loc108)
    %num_pid_in_group_7 = arith.cmpi sge, %num_pid_in_group_3, %num_pid_in_group_5 : i64 loc(#loc108)
    %num_pid_in_group_8 = arith.andi %num_pid_in_group_6, %num_pid_in_group_7 : i1 loc(#loc108)
    %num_pid_in_group_9 = arith.muli %num_pid_in_group_0, %num_pid_n : i32 loc(#loc108)
    %group_id = arith.divsi %pid, %num_pid_in_group_9 : i32 loc(#loc109)
    %first_pid_m = arith.constant 4 : i32 loc(#loc110)
    %first_pid_m_10 = arith.constant 4 : i32 loc(#loc110)
    %first_pid_m_11 = arith.extsi %group_id : i32 to i64 loc(#loc110)
    %first_pid_m_12 = arith.extsi %first_pid_m_10 : i32 to i64 loc(#loc110)
    %first_pid_m_13 = arith.muli %first_pid_m_11, %first_pid_m_12 : i64 loc(#loc110)
    %first_pid_m_14 = arith.constant 2147483647 : i64 loc(#loc110)
    %first_pid_m_15 = arith.constant -2147483648 : i64 loc(#loc110)
    %first_pid_m_16 = arith.cmpi sle, %first_pid_m_13, %first_pid_m_14 : i64 loc(#loc110)
    %first_pid_m_17 = arith.cmpi sge, %first_pid_m_13, %first_pid_m_15 : i64 loc(#loc110)
    %first_pid_m_18 = arith.andi %first_pid_m_16, %first_pid_m_17 : i1 loc(#loc110)
    %first_pid_m_19 = arith.muli %group_id, %first_pid_m_10 : i32 loc(#loc110)
    %group_size_m = arith.extsi %num_pid_m : i32 to i64 loc(#loc111)
    %group_size_m_20 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc111)
    %group_size_m_21 = arith.subi %group_size_m, %group_size_m_20 : i64 loc(#loc111)
    %group_size_m_22 = arith.constant 2147483647 : i64 loc(#loc111)
    %group_size_m_23 = arith.constant -2147483648 : i64 loc(#loc111)
    %group_size_m_24 = arith.cmpi sle, %group_size_m_21, %group_size_m_22 : i64 loc(#loc111)
    %group_size_m_25 = arith.cmpi sge, %group_size_m_21, %group_size_m_23 : i64 loc(#loc111)
    %group_size_m_26 = arith.andi %group_size_m_24, %group_size_m_25 : i1 loc(#loc111)
    %group_size_m_27 = arith.subi %num_pid_m, %first_pid_m_19 : i32 loc(#loc111)
    %group_size_m_28 = arith.constant 4 : i32 loc(#loc112)
    %group_size_m_29 = arith.minsi %group_size_m_27, %group_size_m_28 : i32 loc(#loc112)
    %pid_m = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc113)
    %pid_m_30 = arith.remsi %pid_m, %group_size_m_29 : i32 loc(#loc114)
    %pid_m_31 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc115)
    %pid_m_32 = arith.extsi %pid_m_30 : i32 to i64 loc(#loc115)
    %pid_m_33 = arith.addi %pid_m_31, %pid_m_32 : i64 loc(#loc115)
    %pid_m_34 = arith.constant 2147483647 : i64 loc(#loc115)
    %pid_m_35 = arith.constant -2147483648 : i64 loc(#loc115)
    %pid_m_36 = arith.cmpi sle, %pid_m_33, %pid_m_34 : i64 loc(#loc115)
    %pid_m_37 = arith.cmpi sge, %pid_m_33, %pid_m_35 : i64 loc(#loc115)
    %pid_m_38 = arith.andi %pid_m_36, %pid_m_37 : i1 loc(#loc115)
    %pid_m_39 = arith.addi %first_pid_m_19, %pid_m_30 : i32 loc(#loc115)
    %pid_n = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc116)
    %pid_n_40 = arith.divsi %pid_n, %group_size_m_29 : i32 loc(#loc117)
    %c0_i32 = arith.constant 0 : i32 loc(#loc14)
    %0 = arith.cmpi sge, %pid_m_39, %c0_i32 : i32 loc(#loc14)
    llvm.intr.assume %0 : i1 loc(#loc15)
    %c0_i32_41 = arith.constant 0 : i32 loc(#loc16)
    %1 = arith.cmpi sge, %pid_n_40, %c0_i32_41 : i32 loc(#loc16)
    llvm.intr.assume %1 : i1 loc(#loc17)
    %c0_i32_42 = arith.constant 0 : i32 loc(#loc18)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32_42 : i32 loc(#loc18)
    llvm.intr.assume %2 : i1 loc(#loc19)
    %true = arith.constant true loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc20)
    %true_43 = arith.constant true loc(#loc21)
    llvm.intr.assume %true_43 : i1 loc(#loc21)
    %c0_i32_44 = arith.constant 0 : i32 loc(#loc22)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32_44 : i32 loc(#loc22)
    llvm.intr.assume %3 : i1 loc(#loc23)
    %c0_i32_45 = arith.constant 0 : i32 loc(#loc24)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32_45 : i32 loc(#loc24)
    llvm.intr.assume %4 : i1 loc(#loc25)
    %true_46 = arith.constant true loc(#loc26)
    llvm.intr.assume %true_46 : i1 loc(#loc26)
    %offs_am = arith.constant 64 : i32 loc(#loc118)
    %offs_am_47 = arith.constant 64 : i32 loc(#loc118)
    %offs_am_48 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc118)
    %offs_am_49 = arith.extsi %offs_am_47 : i32 to i64 loc(#loc118)
    %offs_am_50 = arith.muli %offs_am_48, %offs_am_49 : i64 loc(#loc118)
    %offs_am_51 = arith.constant 2147483647 : i64 loc(#loc118)
    %offs_am_52 = arith.constant -2147483648 : i64 loc(#loc118)
    %offs_am_53 = arith.cmpi sle, %offs_am_50, %offs_am_51 : i64 loc(#loc118)
    %offs_am_54 = arith.cmpi sge, %offs_am_50, %offs_am_52 : i64 loc(#loc118)
    %offs_am_55 = arith.andi %offs_am_53, %offs_am_54 : i1 loc(#loc118)
    %offs_am_56 = arith.muli %pid_m_39, %offs_am_47 : i32 loc(#loc118)
    %offs_am_57 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc119)
    %offs_am_58 = tt.splat %offs_am_56 : i32 -> tensor<64xi32> loc(#loc120)
    %offs_am_59 = arith.extsi %offs_am_58 : tensor<64xi32> to tensor<64xi64> loc(#loc120)
    %offs_am_60 = arith.extsi %offs_am_57 : tensor<64xi32> to tensor<64xi64> loc(#loc120)
    %offs_am_61 = arith.addi %offs_am_59, %offs_am_60 : tensor<64xi64> loc(#loc120)
    %offs_am_62 = arith.constant 2147483647 : i64 loc(#loc120)
    %offs_am_63 = arith.constant -2147483648 : i64 loc(#loc120)
    %offs_am_64 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc120)
    %offs_am_65 = arith.cmpi sle, %offs_am_61, %offs_am_64 : tensor<64xi64> loc(#loc120)
    %offs_am_66 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc120)
    %offs_am_67 = arith.cmpi sge, %offs_am_61, %offs_am_66 : tensor<64xi64> loc(#loc120)
    %offs_am_68 = arith.andi %offs_am_65, %offs_am_67 : tensor<64xi1> loc(#loc120)
    %offs_am_69 = arith.addi %offs_am_58, %offs_am_57 : tensor<64xi32> loc(#loc120)
    %offs_am_70 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc121)
    %offs_am_71 = arith.remsi %offs_am_69, %offs_am_70 : tensor<64xi32> loc(#loc121)
    %offs_bn = arith.constant 32 : i32 loc(#loc122)
    %offs_bn_72 = arith.constant 32 : i32 loc(#loc122)
    %offs_bn_73 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc122)
    %offs_bn_74 = arith.extsi %offs_bn_72 : i32 to i64 loc(#loc122)
    %offs_bn_75 = arith.muli %offs_bn_73, %offs_bn_74 : i64 loc(#loc122)
    %offs_bn_76 = arith.constant 2147483647 : i64 loc(#loc122)
    %offs_bn_77 = arith.constant -2147483648 : i64 loc(#loc122)
    %offs_bn_78 = arith.cmpi sle, %offs_bn_75, %offs_bn_76 : i64 loc(#loc122)
    %offs_bn_79 = arith.cmpi sge, %offs_bn_75, %offs_bn_77 : i64 loc(#loc122)
    %offs_bn_80 = arith.andi %offs_bn_78, %offs_bn_79 : i1 loc(#loc122)
    %offs_bn_81 = arith.muli %pid_n_40, %offs_bn_72 : i32 loc(#loc122)
    %offs_bn_82 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc123)
    %offs_bn_83 = tt.splat %offs_bn_81 : i32 -> tensor<32xi32> loc(#loc124)
    %offs_bn_84 = arith.extsi %offs_bn_83 : tensor<32xi32> to tensor<32xi64> loc(#loc124)
    %offs_bn_85 = arith.extsi %offs_bn_82 : tensor<32xi32> to tensor<32xi64> loc(#loc124)
    %offs_bn_86 = arith.addi %offs_bn_84, %offs_bn_85 : tensor<32xi64> loc(#loc124)
    %offs_bn_87 = arith.constant 2147483647 : i64 loc(#loc124)
    %offs_bn_88 = arith.constant -2147483648 : i64 loc(#loc124)
    %offs_bn_89 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc124)
    %offs_bn_90 = arith.cmpi sle, %offs_bn_86, %offs_bn_89 : tensor<32xi64> loc(#loc124)
    %offs_bn_91 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc124)
    %offs_bn_92 = arith.cmpi sge, %offs_bn_86, %offs_bn_91 : tensor<32xi64> loc(#loc124)
    %offs_bn_93 = arith.andi %offs_bn_90, %offs_bn_92 : tensor<32xi1> loc(#loc124)
    %offs_bn_94 = arith.addi %offs_bn_83, %offs_bn_82 : tensor<32xi32> loc(#loc124)
    %offs_bn_95 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc125)
    %offs_bn_96 = arith.remsi %offs_bn_94, %offs_bn_95 : tensor<32xi32> loc(#loc125)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc126)
    %a_ptrs = tt.expand_dims %offs_am_71 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc127)
    %a_ptrs_97 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc128)
    %a_ptrs_98 = arith.extsi %a_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc128)
    %a_ptrs_99 = arith.extsi %a_ptrs_97 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc128)
    %a_ptrs_100 = arith.muli %a_ptrs_98, %a_ptrs_99 : tensor<64x1xi64> loc(#loc128)
    %a_ptrs_101 = arith.constant 2147483647 : i64 loc(#loc128)
    %a_ptrs_102 = arith.constant -2147483648 : i64 loc(#loc128)
    %a_ptrs_103 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc128)
    %a_ptrs_104 = arith.cmpi sle, %a_ptrs_100, %a_ptrs_103 : tensor<64x1xi64> loc(#loc128)
    %a_ptrs_105 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc128)
    %a_ptrs_106 = arith.cmpi sge, %a_ptrs_100, %a_ptrs_105 : tensor<64x1xi64> loc(#loc128)
    %a_ptrs_107 = arith.andi %a_ptrs_104, %a_ptrs_106 : tensor<64x1xi1> loc(#loc128)
    %a_ptrs_108 = arith.muli %a_ptrs, %a_ptrs_97 : tensor<64x1xi32> loc(#loc128)
    %a_ptrs_109 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc129)
    %a_ptrs_110 = arith.constant 1 : i32 loc(#loc130)
    %a_ptrs_111 = arith.constant 1 : i32 loc(#loc130)
    %a_ptrs_112 = arith.constant dense<1> : tensor<1x64xi32> loc(#loc130)
    %a_ptrs_113 = arith.extsi %a_ptrs_109 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc130)
    %a_ptrs_114 = arith.extsi %a_ptrs_112 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc130)
    %a_ptrs_115 = arith.muli %a_ptrs_113, %a_ptrs_114 : tensor<1x64xi64> loc(#loc130)
    %a_ptrs_116 = arith.constant 2147483647 : i64 loc(#loc130)
    %a_ptrs_117 = arith.constant -2147483648 : i64 loc(#loc130)
    %a_ptrs_118 = arith.constant dense<2147483647> : tensor<1x64xi64> loc(#loc130)
    %a_ptrs_119 = arith.cmpi sle, %a_ptrs_115, %a_ptrs_118 : tensor<1x64xi64> loc(#loc130)
    %a_ptrs_120 = arith.constant dense<-2147483648> : tensor<1x64xi64> loc(#loc130)
    %a_ptrs_121 = arith.cmpi sge, %a_ptrs_115, %a_ptrs_120 : tensor<1x64xi64> loc(#loc130)
    %a_ptrs_122 = arith.andi %a_ptrs_119, %a_ptrs_121 : tensor<1x64xi1> loc(#loc130)
    %a_ptrs_123 = arith.muli %a_ptrs_109, %a_ptrs_112 : tensor<1x64xi32> loc(#loc130)
    %a_ptrs_124 = tt.broadcast %a_ptrs_108 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc131)
    %a_ptrs_125 = tt.broadcast %a_ptrs_123 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc131)
    %a_ptrs_126 = arith.extsi %a_ptrs_124 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc131)
    %a_ptrs_127 = arith.extsi %a_ptrs_125 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc131)
    %a_ptrs_128 = arith.addi %a_ptrs_126, %a_ptrs_127 : tensor<64x64xi64> loc(#loc131)
    %a_ptrs_129 = arith.constant 2147483647 : i64 loc(#loc131)
    %a_ptrs_130 = arith.constant -2147483648 : i64 loc(#loc131)
    %a_ptrs_131 = arith.constant dense<2147483647> : tensor<64x64xi64> loc(#loc131)
    %a_ptrs_132 = arith.cmpi sle, %a_ptrs_128, %a_ptrs_131 : tensor<64x64xi64> loc(#loc131)
    %a_ptrs_133 = arith.constant dense<-2147483648> : tensor<64x64xi64> loc(#loc131)
    %a_ptrs_134 = arith.cmpi sge, %a_ptrs_128, %a_ptrs_133 : tensor<64x64xi64> loc(#loc131)
    %a_ptrs_135 = arith.andi %a_ptrs_132, %a_ptrs_134 : tensor<64x64xi1> loc(#loc131)
    %a_ptrs_136 = arith.addi %a_ptrs_124, %a_ptrs_125 : tensor<64x64xi32> loc(#loc131)
    %a_ptrs_137 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc132)
    %a_ptrs_138 = tt.addptr %a_ptrs_137, %a_ptrs_136 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc132)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc133)
    %b_ptrs_139 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc134)
    %b_ptrs_140 = arith.extsi %b_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc134)
    %b_ptrs_141 = arith.extsi %b_ptrs_139 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc134)
    %b_ptrs_142 = arith.muli %b_ptrs_140, %b_ptrs_141 : tensor<64x1xi64> loc(#loc134)
    %b_ptrs_143 = arith.constant 2147483647 : i64 loc(#loc134)
    %b_ptrs_144 = arith.constant -2147483648 : i64 loc(#loc134)
    %b_ptrs_145 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc134)
    %b_ptrs_146 = arith.cmpi sle, %b_ptrs_142, %b_ptrs_145 : tensor<64x1xi64> loc(#loc134)
    %b_ptrs_147 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc134)
    %b_ptrs_148 = arith.cmpi sge, %b_ptrs_142, %b_ptrs_147 : tensor<64x1xi64> loc(#loc134)
    %b_ptrs_149 = arith.andi %b_ptrs_146, %b_ptrs_148 : tensor<64x1xi1> loc(#loc134)
    %b_ptrs_150 = arith.muli %b_ptrs, %b_ptrs_139 : tensor<64x1xi32> loc(#loc134)
    %b_ptrs_151 = tt.expand_dims %offs_bn_96 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc135)
    %b_ptrs_152 = arith.constant 1 : i32 loc(#loc136)
    %b_ptrs_153 = arith.constant 1 : i32 loc(#loc136)
    %b_ptrs_154 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc136)
    %b_ptrs_155 = arith.extsi %b_ptrs_151 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc136)
    %b_ptrs_156 = arith.extsi %b_ptrs_154 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc136)
    %b_ptrs_157 = arith.muli %b_ptrs_155, %b_ptrs_156 : tensor<1x32xi64> loc(#loc136)
    %b_ptrs_158 = arith.constant 2147483647 : i64 loc(#loc136)
    %b_ptrs_159 = arith.constant -2147483648 : i64 loc(#loc136)
    %b_ptrs_160 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc136)
    %b_ptrs_161 = arith.cmpi sle, %b_ptrs_157, %b_ptrs_160 : tensor<1x32xi64> loc(#loc136)
    %b_ptrs_162 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc136)
    %b_ptrs_163 = arith.cmpi sge, %b_ptrs_157, %b_ptrs_162 : tensor<1x32xi64> loc(#loc136)
    %b_ptrs_164 = arith.andi %b_ptrs_161, %b_ptrs_163 : tensor<1x32xi1> loc(#loc136)
    %b_ptrs_165 = arith.muli %b_ptrs_151, %b_ptrs_154 : tensor<1x32xi32> loc(#loc136)
    %b_ptrs_166 = tt.broadcast %b_ptrs_150 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc137)
    %b_ptrs_167 = tt.broadcast %b_ptrs_165 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc137)
    %b_ptrs_168 = arith.extsi %b_ptrs_166 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc137)
    %b_ptrs_169 = arith.extsi %b_ptrs_167 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc137)
    %b_ptrs_170 = arith.addi %b_ptrs_168, %b_ptrs_169 : tensor<64x32xi64> loc(#loc137)
    %b_ptrs_171 = arith.constant 2147483647 : i64 loc(#loc137)
    %b_ptrs_172 = arith.constant -2147483648 : i64 loc(#loc137)
    %b_ptrs_173 = arith.constant dense<2147483647> : tensor<64x32xi64> loc(#loc137)
    %b_ptrs_174 = arith.cmpi sle, %b_ptrs_170, %b_ptrs_173 : tensor<64x32xi64> loc(#loc137)
    %b_ptrs_175 = arith.constant dense<-2147483648> : tensor<64x32xi64> loc(#loc137)
    %b_ptrs_176 = arith.cmpi sge, %b_ptrs_170, %b_ptrs_175 : tensor<64x32xi64> loc(#loc137)
    %b_ptrs_177 = arith.andi %b_ptrs_174, %b_ptrs_176 : tensor<64x32xi1> loc(#loc137)
    %b_ptrs_178 = arith.addi %b_ptrs_166, %b_ptrs_167 : tensor<64x32xi32> loc(#loc137)
    %b_ptrs_179 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc138)
    %b_ptrs_180 = tt.addptr %b_ptrs_179, %b_ptrs_178 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc138)
    %accumulator = tt.call @triton.language.standard.zeros__Tc64_c32T_cfp32() : () -> tensor<64x32xf32> loc(#loc139)
    %5 = tt.call @triton.language.standard.cdiv__i32_c64(%K) : (i32) -> i32 loc(#loc49)
    %c0_i32_181 = arith.constant 0 : i32 loc(#loc50)
    %c1_i32 = arith.constant 1 : i32 loc(#loc50)
    %6 = arith.bitcast %c0_i32_181 : i32 to i32 loc(#loc50)
    %7 = arith.bitcast %5 : i32 to i32 loc(#loc50)
    %8 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc50)
    %9 = ub.poison : i32 loc(#loc50)
    %accumulator_182:3 = scf.for %k = %6 to %7 step %8 iter_args(%a_ptrs_269 = %a_ptrs_138, %b_ptrs_270 = %b_ptrs_180, %accumulator_271 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc141)
      %a_272 = arith.constant 64 : i32 loc(#loc142)
      %a_273 = arith.constant 64 : i32 loc(#loc142)
      %a_274 = arith.extsi %k : i32 to i64 loc(#loc142)
      %a_275 = arith.extsi %a_273 : i32 to i64 loc(#loc142)
      %a_276 = arith.muli %a_274, %a_275 : i64 loc(#loc142)
      %a_277 = arith.constant 2147483647 : i64 loc(#loc142)
      %a_278 = arith.constant -2147483648 : i64 loc(#loc142)
      %a_279 = arith.cmpi sle, %a_276, %a_277 : i64 loc(#loc142)
      %a_280 = arith.cmpi sge, %a_276, %a_278 : i64 loc(#loc142)
      %a_281 = arith.andi %a_279, %a_280 : i1 loc(#loc142)
      %a_282 = arith.muli %k, %a_273 : i32 loc(#loc142)
      %a_283 = arith.extsi %K : i32 to i64 loc(#loc143)
      %a_284 = arith.extsi %a_282 : i32 to i64 loc(#loc143)
      %a_285 = arith.subi %a_283, %a_284 : i64 loc(#loc143)
      %a_286 = arith.constant 2147483647 : i64 loc(#loc143)
      %a_287 = arith.constant -2147483648 : i64 loc(#loc143)
      %a_288 = arith.cmpi sle, %a_285, %a_286 : i64 loc(#loc143)
      %a_289 = arith.cmpi sge, %a_285, %a_287 : i64 loc(#loc143)
      %a_290 = arith.andi %a_288, %a_289 : i1 loc(#loc143)
      %a_291 = arith.subi %K, %a_282 : i32 loc(#loc143)
      %a_292 = tt.splat %a_291 : i32 -> tensor<1x64xi32> loc(#loc144)
      %a_293 = arith.cmpi slt, %a, %a_292 : tensor<1x64xi32> loc(#loc144)
      %a_294 = arith.constant 0.000000e+00 : f32 loc(#loc145)
      %a_295 = tt.broadcast %a_293 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc145)
      %a_296 = arith.constant dense<0.000000e+00> : tensor<64x64xf32> loc(#loc145)
      %a_297 = arith.truncf %a_296 : tensor<64x64xf32> to tensor<64x64xf16> loc(#loc145)
      %a_298 = tt.load %a_ptrs_269, %a_295, %a_297 : tensor<64x64x!tt.ptr<f16>> loc(#loc145)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc146)
      %b_299 = arith.constant 64 : i32 loc(#loc147)
      %b_300 = arith.constant 64 : i32 loc(#loc147)
      %b_301 = arith.extsi %k : i32 to i64 loc(#loc147)
      %b_302 = arith.extsi %b_300 : i32 to i64 loc(#loc147)
      %b_303 = arith.muli %b_301, %b_302 : i64 loc(#loc147)
      %b_304 = arith.constant 2147483647 : i64 loc(#loc147)
      %b_305 = arith.constant -2147483648 : i64 loc(#loc147)
      %b_306 = arith.cmpi sle, %b_303, %b_304 : i64 loc(#loc147)
      %b_307 = arith.cmpi sge, %b_303, %b_305 : i64 loc(#loc147)
      %b_308 = arith.andi %b_306, %b_307 : i1 loc(#loc147)
      %b_309 = arith.muli %k, %b_300 : i32 loc(#loc147)
      %b_310 = arith.extsi %K : i32 to i64 loc(#loc148)
      %b_311 = arith.extsi %b_309 : i32 to i64 loc(#loc148)
      %b_312 = arith.subi %b_310, %b_311 : i64 loc(#loc148)
      %b_313 = arith.constant 2147483647 : i64 loc(#loc148)
      %b_314 = arith.constant -2147483648 : i64 loc(#loc148)
      %b_315 = arith.cmpi sle, %b_312, %b_313 : i64 loc(#loc148)
      %b_316 = arith.cmpi sge, %b_312, %b_314 : i64 loc(#loc148)
      %b_317 = arith.andi %b_315, %b_316 : i1 loc(#loc148)
      %b_318 = arith.subi %K, %b_309 : i32 loc(#loc148)
      %b_319 = tt.splat %b_318 : i32 -> tensor<64x1xi32> loc(#loc149)
      %b_320 = arith.cmpi slt, %b, %b_319 : tensor<64x1xi32> loc(#loc149)
      %b_321 = arith.constant 0.000000e+00 : f32 loc(#loc150)
      %b_322 = tt.broadcast %b_320 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc150)
      %b_323 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc150)
      %b_324 = arith.truncf %b_323 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc150)
      %b_325 = tt.load %b_ptrs_270, %b_322, %b_324 : tensor<64x32x!tt.ptr<f16>> loc(#loc150)
      %accumulator_326 = arith.constant 0.000000e+00 : f32 loc(#loc151)
      %accumulator_327 = tt.dot %a_298, %b_325, %accumulator_271, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc151)
      %a_ptrs_328 = arith.constant 64 : i32 loc(#loc152)
      %a_ptrs_329 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc152)
      %a_ptrs_330 = tt.addptr %a_ptrs_269, %a_ptrs_329 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc152)
      %b_ptrs_331 = arith.constant 64 : i32 loc(#loc153)
      %b_ptrs_332 = arith.constant 64 : i32 loc(#loc153)
      %b_ptrs_333 = arith.extsi %b_ptrs_332 : i32 to i64 loc(#loc153)
      %b_ptrs_334 = arith.extsi %stride_bk : i32 to i64 loc(#loc153)
      %b_ptrs_335 = arith.muli %b_ptrs_333, %b_ptrs_334 : i64 loc(#loc153)
      %b_ptrs_336 = arith.constant 2147483647 : i64 loc(#loc153)
      %b_ptrs_337 = arith.constant -2147483648 : i64 loc(#loc153)
      %b_ptrs_338 = arith.cmpi sle, %b_ptrs_335, %b_ptrs_336 : i64 loc(#loc153)
      %b_ptrs_339 = arith.cmpi sge, %b_ptrs_335, %b_ptrs_337 : i64 loc(#loc153)
      %b_ptrs_340 = arith.andi %b_ptrs_338, %b_ptrs_339 : i1 loc(#loc153)
      %b_ptrs_341 = arith.muli %b_ptrs_332, %stride_bk : i32 loc(#loc153)
      %b_ptrs_342 = tt.splat %b_ptrs_341 : i32 -> tensor<64x32xi32> loc(#loc154)
      %b_ptrs_343 = tt.addptr %b_ptrs_270, %b_ptrs_342 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc154)
      scf.yield %a_ptrs_330, %b_ptrs_343, %accumulator_327 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc65)
    } loc(#loc175)
    %c = arith.truncf %accumulator_182#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc155)
    %offs_cm = arith.constant 64 : i32 loc(#loc156)
    %offs_cm_183 = arith.constant 64 : i32 loc(#loc156)
    %offs_cm_184 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc156)
    %offs_cm_185 = arith.extsi %offs_cm_183 : i32 to i64 loc(#loc156)
    %offs_cm_186 = arith.muli %offs_cm_184, %offs_cm_185 : i64 loc(#loc156)
    %offs_cm_187 = arith.constant 2147483647 : i64 loc(#loc156)
    %offs_cm_188 = arith.constant -2147483648 : i64 loc(#loc156)
    %offs_cm_189 = arith.cmpi sle, %offs_cm_186, %offs_cm_187 : i64 loc(#loc156)
    %offs_cm_190 = arith.cmpi sge, %offs_cm_186, %offs_cm_188 : i64 loc(#loc156)
    %offs_cm_191 = arith.andi %offs_cm_189, %offs_cm_190 : i1 loc(#loc156)
    %offs_cm_192 = arith.muli %pid_m_39, %offs_cm_183 : i32 loc(#loc156)
    %offs_cm_193 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc157)
    %offs_cm_194 = tt.splat %offs_cm_192 : i32 -> tensor<64xi32> loc(#loc158)
    %offs_cm_195 = arith.extsi %offs_cm_194 : tensor<64xi32> to tensor<64xi64> loc(#loc158)
    %offs_cm_196 = arith.extsi %offs_cm_193 : tensor<64xi32> to tensor<64xi64> loc(#loc158)
    %offs_cm_197 = arith.addi %offs_cm_195, %offs_cm_196 : tensor<64xi64> loc(#loc158)
    %offs_cm_198 = arith.constant 2147483647 : i64 loc(#loc158)
    %offs_cm_199 = arith.constant -2147483648 : i64 loc(#loc158)
    %offs_cm_200 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc158)
    %offs_cm_201 = arith.cmpi sle, %offs_cm_197, %offs_cm_200 : tensor<64xi64> loc(#loc158)
    %offs_cm_202 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc158)
    %offs_cm_203 = arith.cmpi sge, %offs_cm_197, %offs_cm_202 : tensor<64xi64> loc(#loc158)
    %offs_cm_204 = arith.andi %offs_cm_201, %offs_cm_203 : tensor<64xi1> loc(#loc158)
    %offs_cm_205 = arith.addi %offs_cm_194, %offs_cm_193 : tensor<64xi32> loc(#loc158)
    %offs_cn = arith.constant 32 : i32 loc(#loc159)
    %offs_cn_206 = arith.constant 32 : i32 loc(#loc159)
    %offs_cn_207 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc159)
    %offs_cn_208 = arith.extsi %offs_cn_206 : i32 to i64 loc(#loc159)
    %offs_cn_209 = arith.muli %offs_cn_207, %offs_cn_208 : i64 loc(#loc159)
    %offs_cn_210 = arith.constant 2147483647 : i64 loc(#loc159)
    %offs_cn_211 = arith.constant -2147483648 : i64 loc(#loc159)
    %offs_cn_212 = arith.cmpi sle, %offs_cn_209, %offs_cn_210 : i64 loc(#loc159)
    %offs_cn_213 = arith.cmpi sge, %offs_cn_209, %offs_cn_211 : i64 loc(#loc159)
    %offs_cn_214 = arith.andi %offs_cn_212, %offs_cn_213 : i1 loc(#loc159)
    %offs_cn_215 = arith.muli %pid_n_40, %offs_cn_206 : i32 loc(#loc159)
    %offs_cn_216 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc160)
    %offs_cn_217 = tt.splat %offs_cn_215 : i32 -> tensor<32xi32> loc(#loc161)
    %offs_cn_218 = arith.extsi %offs_cn_217 : tensor<32xi32> to tensor<32xi64> loc(#loc161)
    %offs_cn_219 = arith.extsi %offs_cn_216 : tensor<32xi32> to tensor<32xi64> loc(#loc161)
    %offs_cn_220 = arith.addi %offs_cn_218, %offs_cn_219 : tensor<32xi64> loc(#loc161)
    %offs_cn_221 = arith.constant 2147483647 : i64 loc(#loc161)
    %offs_cn_222 = arith.constant -2147483648 : i64 loc(#loc161)
    %offs_cn_223 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc161)
    %offs_cn_224 = arith.cmpi sle, %offs_cn_220, %offs_cn_223 : tensor<32xi64> loc(#loc161)
    %offs_cn_225 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc161)
    %offs_cn_226 = arith.cmpi sge, %offs_cn_220, %offs_cn_225 : tensor<32xi64> loc(#loc161)
    %offs_cn_227 = arith.andi %offs_cn_224, %offs_cn_226 : tensor<32xi1> loc(#loc161)
    %offs_cn_228 = arith.addi %offs_cn_217, %offs_cn_216 : tensor<32xi32> loc(#loc161)
    %c_ptrs = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc162)
    %c_ptrs_229 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc163)
    %c_ptrs_230 = arith.extsi %c_ptrs_229 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc163)
    %c_ptrs_231 = arith.extsi %c_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc163)
    %c_ptrs_232 = arith.muli %c_ptrs_230, %c_ptrs_231 : tensor<64x1xi64> loc(#loc163)
    %c_ptrs_233 = arith.constant 2147483647 : i64 loc(#loc163)
    %c_ptrs_234 = arith.constant -2147483648 : i64 loc(#loc163)
    %c_ptrs_235 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc163)
    %c_ptrs_236 = arith.cmpi sle, %c_ptrs_232, %c_ptrs_235 : tensor<64x1xi64> loc(#loc163)
    %c_ptrs_237 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc163)
    %c_ptrs_238 = arith.cmpi sge, %c_ptrs_232, %c_ptrs_237 : tensor<64x1xi64> loc(#loc163)
    %c_ptrs_239 = arith.andi %c_ptrs_236, %c_ptrs_238 : tensor<64x1xi1> loc(#loc163)
    %c_ptrs_240 = arith.muli %c_ptrs_229, %c_ptrs : tensor<64x1xi32> loc(#loc163)
    %c_ptrs_241 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc164)
    %c_ptrs_242 = tt.addptr %c_ptrs_241, %c_ptrs_240 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc164)
    %c_ptrs_243 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc165)
    %c_ptrs_244 = arith.constant 1 : i32 loc(#loc166)
    %c_ptrs_245 = arith.constant 1 : i32 loc(#loc166)
    %c_ptrs_246 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc166)
    %c_ptrs_247 = arith.extsi %c_ptrs_246 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc166)
    %c_ptrs_248 = arith.extsi %c_ptrs_243 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc166)
    %c_ptrs_249 = arith.muli %c_ptrs_247, %c_ptrs_248 : tensor<1x32xi64> loc(#loc166)
    %c_ptrs_250 = arith.constant 2147483647 : i64 loc(#loc166)
    %c_ptrs_251 = arith.constant -2147483648 : i64 loc(#loc166)
    %c_ptrs_252 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc166)
    %c_ptrs_253 = arith.cmpi sle, %c_ptrs_249, %c_ptrs_252 : tensor<1x32xi64> loc(#loc166)
    %c_ptrs_254 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc166)
    %c_ptrs_255 = arith.cmpi sge, %c_ptrs_249, %c_ptrs_254 : tensor<1x32xi64> loc(#loc166)
    %c_ptrs_256 = arith.andi %c_ptrs_253, %c_ptrs_255 : tensor<1x32xi1> loc(#loc166)
    %c_ptrs_257 = arith.muli %c_ptrs_246, %c_ptrs_243 : tensor<1x32xi32> loc(#loc166)
    %c_ptrs_258 = tt.broadcast %c_ptrs_242 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc167)
    %c_ptrs_259 = tt.broadcast %c_ptrs_257 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc167)
    %c_ptrs_260 = tt.addptr %c_ptrs_258, %c_ptrs_259 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc167)
    %c_mask = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc168)
    %c_mask_261 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc169)
    %c_mask_262 = arith.cmpi slt, %c_mask, %c_mask_261 : tensor<64x1xi32> loc(#loc169)
    %c_mask_263 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc170)
    %c_mask_264 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc171)
    %c_mask_265 = arith.cmpi slt, %c_mask_263, %c_mask_264 : tensor<1x32xi32> loc(#loc171)
    %c_mask_266 = tt.broadcast %c_mask_262 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc172)
    %c_mask_267 = tt.broadcast %c_mask_265 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc172)
    %c_mask_268 = arith.andi %c_mask_266, %c_mask_267 : tensor<64x32xi1> loc(#loc172)
    tt.store %c_ptrs_260, %c, %c_mask_268 : tensor<64x32x!tt.ptr<f16>> loc(#loc84)
    tt.return loc(#loc85)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc87)
    %c63_i32 = arith.constant 63 : i32 loc(#loc87)
    %0 = arith.addi %x, %c63_i32 : i32 loc(#loc88)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc89)
    tt.return %1 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c31_i32 = arith.constant 31 : i32 loc(#loc88)
    %c31_i32_0 = arith.constant 31 : i32 loc(#loc88)
    %0 = arith.extsi %x : i32 to i64 loc(#loc88)
    %1 = arith.extsi %c31_i32_0 : i32 to i64 loc(#loc88)
    %2 = arith.addi %0, %1 : i64 loc(#loc88)
    %c2147483647_i64 = arith.constant 2147483647 : i64 loc(#loc88)
    %c-2147483648_i64 = arith.constant -2147483648 : i64 loc(#loc88)
    %3 = arith.cmpi sle, %2, %c2147483647_i64 : i64 loc(#loc88)
    %4 = arith.cmpi sge, %2, %c-2147483648_i64 : i64 loc(#loc88)
    %5 = arith.andi %3, %4 : i1 loc(#loc88)
    %6 = arith.addi %x, %c31_i32_0 : i32 loc(#loc88)
    %c32_i32 = arith.constant 32 : i32 loc(#loc89)
    %c32_i32_1 = arith.constant 32 : i32 loc(#loc89)
    %7 = arith.divsi %6, %c32_i32_1 : i32 loc(#loc89)
    tt.return %7 : i32 loc(#loc90)
  ^bb1:  // no predecessors
    %8 = ub.poison : i32 loc(#loc91)
    tt.return %8 : i32 loc(#loc91)
  } loc(#loc86)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc93)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc93)
    tt.return %cst_0 : tensor<64x32xf32> loc(#loc94)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x32xf32> loc(#loc95)
    tt.return %0 : tensor<64x32xf32> loc(#loc95)
  } loc(#loc92)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:71)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:71)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:64)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc(unknown)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc89 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc90 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:11)
#loc91 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:4)
#loc92 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc93 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc94 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:11)
#loc95 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:4)
#loc105 = loc("pid"(#loc1))
#loc106 = loc("num_pid_m"(#loc2))
#loc107 = loc("num_pid_n"(#loc3))
#loc108 = loc("num_pid_in_group"(#loc4))
#loc109 = loc("group_id"(#loc5))
#loc110 = loc("first_pid_m"(#loc6))
#loc111 = loc("group_size_m"(#loc7))
#loc112 = loc("group_size_m"(#loc8))
#loc113 = loc("pid_m"(#loc9))
#loc114 = loc("pid_m"(#loc10))
#loc115 = loc("pid_m"(#loc11))
#loc116 = loc("pid_n"(#loc12))
#loc117 = loc("pid_n"(#loc13))
#loc118 = loc("offs_am"(#loc27))
#loc119 = loc("offs_am"(#loc28))
#loc120 = loc("offs_am"(#loc29))
#loc121 = loc("offs_am"(#loc30))
#loc122 = loc("offs_bn"(#loc31))
#loc123 = loc("offs_bn"(#loc32))
#loc124 = loc("offs_bn"(#loc33))
#loc125 = loc("offs_bn"(#loc34))
#loc126 = loc("offs_k"(#loc35))
#loc127 = loc("a_ptrs"(#loc36))
#loc128 = loc("a_ptrs"(#loc37))
#loc129 = loc("a_ptrs"(#loc38))
#loc130 = loc("a_ptrs"(#loc39))
#loc131 = loc("a_ptrs"(#loc40))
#loc132 = loc("a_ptrs"(#loc41))
#loc133 = loc("b_ptrs"(#loc42))
#loc134 = loc("b_ptrs"(#loc43))
#loc135 = loc("b_ptrs"(#loc44))
#loc136 = loc("b_ptrs"(#loc45))
#loc137 = loc("b_ptrs"(#loc46))
#loc138 = loc("b_ptrs"(#loc47))
#loc139 = loc("accumulator"(#loc48))
#loc140 = loc("a_ptrs"(#loc50))
#loc141 = loc("a"(#loc51))
#loc142 = loc("a"(#loc52))
#loc143 = loc("a"(#loc53))
#loc144 = loc("a"(#loc54))
#loc145 = loc("a"(#loc55))
#loc146 = loc("b"(#loc56))
#loc147 = loc("b"(#loc57))
#loc148 = loc("b"(#loc58))
#loc149 = loc("b"(#loc59))
#loc150 = loc("b"(#loc60))
#loc151 = loc("accumulator"(#loc61))
#loc152 = loc("a_ptrs"(#loc62))
#loc153 = loc("b_ptrs"(#loc63))
#loc154 = loc("b_ptrs"(#loc64))
#loc155 = loc("c"(#loc66))
#loc156 = loc("offs_cm"(#loc67))
#loc157 = loc("offs_cm"(#loc68))
#loc158 = loc("offs_cm"(#loc69))
#loc159 = loc("offs_cn"(#loc70))
#loc160 = loc("offs_cn"(#loc71))
#loc161 = loc("offs_cn"(#loc72))
#loc162 = loc("c_ptrs"(#loc73))
#loc163 = loc("c_ptrs"(#loc74))
#loc164 = loc("c_ptrs"(#loc75))
#loc165 = loc("c_ptrs"(#loc76))
#loc166 = loc("c_ptrs"(#loc77))
#loc167 = loc("c_ptrs"(#loc78))
#loc168 = loc("c_mask"(#loc79))
#loc169 = loc("c_mask"(#loc80))
#loc170 = loc("c_mask"(#loc81))
#loc171 = loc("c_mask"(#loc82))
#loc172 = loc("c_mask"(#loc83))
#loc174 = loc("b_ptrs"(#loc140))
#loc175 = loc("accumulator"(#loc174))


// -----// IR Dump Before Canonicalizer (canonicalize) ('tt.func' operation: @triton.language.standard.zeros__Tc64_c32T_cfp32) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc86 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc95 = loc("a_ptr"(#loc))
#loc96 = loc("b_ptr"(#loc))
#loc97 = loc("c_ptr"(#loc))
#loc98 = loc("M"(#loc))
#loc99 = loc("N"(#loc))
#loc100 = loc("K"(#loc))
#loc101 = loc("stride_am"(#loc))
#loc102 = loc("stride_bk"(#loc))
#loc103 = loc("stride_cm"(#loc))
#loc172 = loc("x"(#loc86))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc104)
    %num_pid_m = tt.call @triton.language.standard.cdiv__i32_c64(%M) : (i32) -> i32 loc(#loc105)
    %num_pid_n = tt.call @triton.language.standard.cdiv__i32_c32(%N) : (i32) -> i32 loc(#loc106)
    %num_pid_in_group = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_0 = arith.constant 4 : i32 loc(#loc107)
    %num_pid_in_group_1 = arith.extsi %num_pid_in_group_0 : i32 to i64 loc(#loc107)
    %num_pid_in_group_2 = arith.extsi %num_pid_n : i32 to i64 loc(#loc107)
    %num_pid_in_group_3 = arith.muli %num_pid_in_group_1, %num_pid_in_group_2 : i64 loc(#loc107)
    %num_pid_in_group_4 = arith.constant 2147483647 : i64 loc(#loc107)
    %num_pid_in_group_5 = arith.constant -2147483648 : i64 loc(#loc107)
    %num_pid_in_group_6 = arith.cmpi sle, %num_pid_in_group_3, %num_pid_in_group_4 : i64 loc(#loc107)
    %num_pid_in_group_7 = arith.cmpi sge, %num_pid_in_group_3, %num_pid_in_group_5 : i64 loc(#loc107)
    %num_pid_in_group_8 = arith.andi %num_pid_in_group_6, %num_pid_in_group_7 : i1 loc(#loc107)
    %num_pid_in_group_9 = arith.muli %num_pid_in_group_0, %num_pid_n : i32 loc(#loc107)
    %group_id = arith.divsi %pid, %num_pid_in_group_9 : i32 loc(#loc108)
    %first_pid_m = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_10 = arith.constant 4 : i32 loc(#loc109)
    %first_pid_m_11 = arith.extsi %group_id : i32 to i64 loc(#loc109)
    %first_pid_m_12 = arith.extsi %first_pid_m_10 : i32 to i64 loc(#loc109)
    %first_pid_m_13 = arith.muli %first_pid_m_11, %first_pid_m_12 : i64 loc(#loc109)
    %first_pid_m_14 = arith.constant 2147483647 : i64 loc(#loc109)
    %first_pid_m_15 = arith.constant -2147483648 : i64 loc(#loc109)
    %first_pid_m_16 = arith.cmpi sle, %first_pid_m_13, %first_pid_m_14 : i64 loc(#loc109)
    %first_pid_m_17 = arith.cmpi sge, %first_pid_m_13, %first_pid_m_15 : i64 loc(#loc109)
    %first_pid_m_18 = arith.andi %first_pid_m_16, %first_pid_m_17 : i1 loc(#loc109)
    %first_pid_m_19 = arith.muli %group_id, %first_pid_m_10 : i32 loc(#loc109)
    %group_size_m = arith.extsi %num_pid_m : i32 to i64 loc(#loc110)
    %group_size_m_20 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc110)
    %group_size_m_21 = arith.subi %group_size_m, %group_size_m_20 : i64 loc(#loc110)
    %group_size_m_22 = arith.constant 2147483647 : i64 loc(#loc110)
    %group_size_m_23 = arith.constant -2147483648 : i64 loc(#loc110)
    %group_size_m_24 = arith.cmpi sle, %group_size_m_21, %group_size_m_22 : i64 loc(#loc110)
    %group_size_m_25 = arith.cmpi sge, %group_size_m_21, %group_size_m_23 : i64 loc(#loc110)
    %group_size_m_26 = arith.andi %group_size_m_24, %group_size_m_25 : i1 loc(#loc110)
    %group_size_m_27 = arith.subi %num_pid_m, %first_pid_m_19 : i32 loc(#loc110)
    %group_size_m_28 = arith.constant 4 : i32 loc(#loc111)
    %group_size_m_29 = arith.minsi %group_size_m_27, %group_size_m_28 : i32 loc(#loc111)
    %pid_m = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc112)
    %pid_m_30 = arith.remsi %pid_m, %group_size_m_29 : i32 loc(#loc113)
    %pid_m_31 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc114)
    %pid_m_32 = arith.extsi %pid_m_30 : i32 to i64 loc(#loc114)
    %pid_m_33 = arith.addi %pid_m_31, %pid_m_32 : i64 loc(#loc114)
    %pid_m_34 = arith.constant 2147483647 : i64 loc(#loc114)
    %pid_m_35 = arith.constant -2147483648 : i64 loc(#loc114)
    %pid_m_36 = arith.cmpi sle, %pid_m_33, %pid_m_34 : i64 loc(#loc114)
    %pid_m_37 = arith.cmpi sge, %pid_m_33, %pid_m_35 : i64 loc(#loc114)
    %pid_m_38 = arith.andi %pid_m_36, %pid_m_37 : i1 loc(#loc114)
    %pid_m_39 = arith.addi %first_pid_m_19, %pid_m_30 : i32 loc(#loc114)
    %pid_n = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc115)
    %pid_n_40 = arith.divsi %pid_n, %group_size_m_29 : i32 loc(#loc116)
    %c0_i32 = arith.constant 0 : i32 loc(#loc14)
    %0 = arith.cmpi sge, %pid_m_39, %c0_i32 : i32 loc(#loc14)
    llvm.intr.assume %0 : i1 loc(#loc15)
    %c0_i32_41 = arith.constant 0 : i32 loc(#loc16)
    %1 = arith.cmpi sge, %pid_n_40, %c0_i32_41 : i32 loc(#loc16)
    llvm.intr.assume %1 : i1 loc(#loc17)
    %c0_i32_42 = arith.constant 0 : i32 loc(#loc18)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32_42 : i32 loc(#loc18)
    llvm.intr.assume %2 : i1 loc(#loc19)
    %true = arith.constant true loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc20)
    %true_43 = arith.constant true loc(#loc21)
    llvm.intr.assume %true_43 : i1 loc(#loc21)
    %c0_i32_44 = arith.constant 0 : i32 loc(#loc22)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32_44 : i32 loc(#loc22)
    llvm.intr.assume %3 : i1 loc(#loc23)
    %c0_i32_45 = arith.constant 0 : i32 loc(#loc24)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32_45 : i32 loc(#loc24)
    llvm.intr.assume %4 : i1 loc(#loc25)
    %true_46 = arith.constant true loc(#loc26)
    llvm.intr.assume %true_46 : i1 loc(#loc26)
    %offs_am = arith.constant 64 : i32 loc(#loc117)
    %offs_am_47 = arith.constant 64 : i32 loc(#loc117)
    %offs_am_48 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc117)
    %offs_am_49 = arith.extsi %offs_am_47 : i32 to i64 loc(#loc117)
    %offs_am_50 = arith.muli %offs_am_48, %offs_am_49 : i64 loc(#loc117)
    %offs_am_51 = arith.constant 2147483647 : i64 loc(#loc117)
    %offs_am_52 = arith.constant -2147483648 : i64 loc(#loc117)
    %offs_am_53 = arith.cmpi sle, %offs_am_50, %offs_am_51 : i64 loc(#loc117)
    %offs_am_54 = arith.cmpi sge, %offs_am_50, %offs_am_52 : i64 loc(#loc117)
    %offs_am_55 = arith.andi %offs_am_53, %offs_am_54 : i1 loc(#loc117)
    %offs_am_56 = arith.muli %pid_m_39, %offs_am_47 : i32 loc(#loc117)
    %offs_am_57 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %offs_am_58 = tt.splat %offs_am_56 : i32 -> tensor<64xi32> loc(#loc119)
    %offs_am_59 = arith.extsi %offs_am_58 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_60 = arith.extsi %offs_am_57 : tensor<64xi32> to tensor<64xi64> loc(#loc119)
    %offs_am_61 = arith.addi %offs_am_59, %offs_am_60 : tensor<64xi64> loc(#loc119)
    %offs_am_62 = arith.constant 2147483647 : i64 loc(#loc119)
    %offs_am_63 = arith.constant -2147483648 : i64 loc(#loc119)
    %offs_am_64 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc119)
    %offs_am_65 = arith.cmpi sle, %offs_am_61, %offs_am_64 : tensor<64xi64> loc(#loc119)
    %offs_am_66 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc119)
    %offs_am_67 = arith.cmpi sge, %offs_am_61, %offs_am_66 : tensor<64xi64> loc(#loc119)
    %offs_am_68 = arith.andi %offs_am_65, %offs_am_67 : tensor<64xi1> loc(#loc119)
    %offs_am_69 = arith.addi %offs_am_58, %offs_am_57 : tensor<64xi32> loc(#loc119)
    %offs_am_70 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc120)
    %offs_am_71 = arith.remsi %offs_am_69, %offs_am_70 : tensor<64xi32> loc(#loc120)
    %offs_bn = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_72 = arith.constant 32 : i32 loc(#loc121)
    %offs_bn_73 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc121)
    %offs_bn_74 = arith.extsi %offs_bn_72 : i32 to i64 loc(#loc121)
    %offs_bn_75 = arith.muli %offs_bn_73, %offs_bn_74 : i64 loc(#loc121)
    %offs_bn_76 = arith.constant 2147483647 : i64 loc(#loc121)
    %offs_bn_77 = arith.constant -2147483648 : i64 loc(#loc121)
    %offs_bn_78 = arith.cmpi sle, %offs_bn_75, %offs_bn_76 : i64 loc(#loc121)
    %offs_bn_79 = arith.cmpi sge, %offs_bn_75, %offs_bn_77 : i64 loc(#loc121)
    %offs_bn_80 = arith.andi %offs_bn_78, %offs_bn_79 : i1 loc(#loc121)
    %offs_bn_81 = arith.muli %pid_n_40, %offs_bn_72 : i32 loc(#loc121)
    %offs_bn_82 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc122)
    %offs_bn_83 = tt.splat %offs_bn_81 : i32 -> tensor<32xi32> loc(#loc123)
    %offs_bn_84 = arith.extsi %offs_bn_83 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_85 = arith.extsi %offs_bn_82 : tensor<32xi32> to tensor<32xi64> loc(#loc123)
    %offs_bn_86 = arith.addi %offs_bn_84, %offs_bn_85 : tensor<32xi64> loc(#loc123)
    %offs_bn_87 = arith.constant 2147483647 : i64 loc(#loc123)
    %offs_bn_88 = arith.constant -2147483648 : i64 loc(#loc123)
    %offs_bn_89 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc123)
    %offs_bn_90 = arith.cmpi sle, %offs_bn_86, %offs_bn_89 : tensor<32xi64> loc(#loc123)
    %offs_bn_91 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc123)
    %offs_bn_92 = arith.cmpi sge, %offs_bn_86, %offs_bn_91 : tensor<32xi64> loc(#loc123)
    %offs_bn_93 = arith.andi %offs_bn_90, %offs_bn_92 : tensor<32xi1> loc(#loc123)
    %offs_bn_94 = arith.addi %offs_bn_83, %offs_bn_82 : tensor<32xi32> loc(#loc123)
    %offs_bn_95 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc124)
    %offs_bn_96 = arith.remsi %offs_bn_94, %offs_bn_95 : tensor<32xi32> loc(#loc124)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc125)
    %a_ptrs = tt.expand_dims %offs_am_71 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc126)
    %a_ptrs_97 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc127)
    %a_ptrs_98 = arith.extsi %a_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_99 = arith.extsi %a_ptrs_97 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc127)
    %a_ptrs_100 = arith.muli %a_ptrs_98, %a_ptrs_99 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_101 = arith.constant 2147483647 : i64 loc(#loc127)
    %a_ptrs_102 = arith.constant -2147483648 : i64 loc(#loc127)
    %a_ptrs_103 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_104 = arith.cmpi sle, %a_ptrs_100, %a_ptrs_103 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_105 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_106 = arith.cmpi sge, %a_ptrs_100, %a_ptrs_105 : tensor<64x1xi64> loc(#loc127)
    %a_ptrs_107 = arith.andi %a_ptrs_104, %a_ptrs_106 : tensor<64x1xi1> loc(#loc127)
    %a_ptrs_108 = arith.muli %a_ptrs, %a_ptrs_97 : tensor<64x1xi32> loc(#loc127)
    %a_ptrs_109 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc128)
    %a_ptrs_110 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_111 = arith.constant 1 : i32 loc(#loc129)
    %a_ptrs_112 = arith.constant dense<1> : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_113 = arith.extsi %a_ptrs_109 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_114 = arith.extsi %a_ptrs_112 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc129)
    %a_ptrs_115 = arith.muli %a_ptrs_113, %a_ptrs_114 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_116 = arith.constant 2147483647 : i64 loc(#loc129)
    %a_ptrs_117 = arith.constant -2147483648 : i64 loc(#loc129)
    %a_ptrs_118 = arith.constant dense<2147483647> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_119 = arith.cmpi sle, %a_ptrs_115, %a_ptrs_118 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_120 = arith.constant dense<-2147483648> : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_121 = arith.cmpi sge, %a_ptrs_115, %a_ptrs_120 : tensor<1x64xi64> loc(#loc129)
    %a_ptrs_122 = arith.andi %a_ptrs_119, %a_ptrs_121 : tensor<1x64xi1> loc(#loc129)
    %a_ptrs_123 = arith.muli %a_ptrs_109, %a_ptrs_112 : tensor<1x64xi32> loc(#loc129)
    %a_ptrs_124 = tt.broadcast %a_ptrs_108 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_125 = tt.broadcast %a_ptrs_123 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc130)
    %a_ptrs_126 = arith.extsi %a_ptrs_124 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_127 = arith.extsi %a_ptrs_125 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc130)
    %a_ptrs_128 = arith.addi %a_ptrs_126, %a_ptrs_127 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_129 = arith.constant 2147483647 : i64 loc(#loc130)
    %a_ptrs_130 = arith.constant -2147483648 : i64 loc(#loc130)
    %a_ptrs_131 = arith.constant dense<2147483647> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_132 = arith.cmpi sle, %a_ptrs_128, %a_ptrs_131 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_133 = arith.constant dense<-2147483648> : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_134 = arith.cmpi sge, %a_ptrs_128, %a_ptrs_133 : tensor<64x64xi64> loc(#loc130)
    %a_ptrs_135 = arith.andi %a_ptrs_132, %a_ptrs_134 : tensor<64x64xi1> loc(#loc130)
    %a_ptrs_136 = arith.addi %a_ptrs_124, %a_ptrs_125 : tensor<64x64xi32> loc(#loc130)
    %a_ptrs_137 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc131)
    %a_ptrs_138 = tt.addptr %a_ptrs_137, %a_ptrs_136 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc131)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc132)
    %b_ptrs_139 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc133)
    %b_ptrs_140 = arith.extsi %b_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_141 = arith.extsi %b_ptrs_139 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc133)
    %b_ptrs_142 = arith.muli %b_ptrs_140, %b_ptrs_141 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_143 = arith.constant 2147483647 : i64 loc(#loc133)
    %b_ptrs_144 = arith.constant -2147483648 : i64 loc(#loc133)
    %b_ptrs_145 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_146 = arith.cmpi sle, %b_ptrs_142, %b_ptrs_145 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_147 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_148 = arith.cmpi sge, %b_ptrs_142, %b_ptrs_147 : tensor<64x1xi64> loc(#loc133)
    %b_ptrs_149 = arith.andi %b_ptrs_146, %b_ptrs_148 : tensor<64x1xi1> loc(#loc133)
    %b_ptrs_150 = arith.muli %b_ptrs, %b_ptrs_139 : tensor<64x1xi32> loc(#loc133)
    %b_ptrs_151 = tt.expand_dims %offs_bn_96 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc134)
    %b_ptrs_152 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_153 = arith.constant 1 : i32 loc(#loc135)
    %b_ptrs_154 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_155 = arith.extsi %b_ptrs_151 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_156 = arith.extsi %b_ptrs_154 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc135)
    %b_ptrs_157 = arith.muli %b_ptrs_155, %b_ptrs_156 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_158 = arith.constant 2147483647 : i64 loc(#loc135)
    %b_ptrs_159 = arith.constant -2147483648 : i64 loc(#loc135)
    %b_ptrs_160 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_161 = arith.cmpi sle, %b_ptrs_157, %b_ptrs_160 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_162 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_163 = arith.cmpi sge, %b_ptrs_157, %b_ptrs_162 : tensor<1x32xi64> loc(#loc135)
    %b_ptrs_164 = arith.andi %b_ptrs_161, %b_ptrs_163 : tensor<1x32xi1> loc(#loc135)
    %b_ptrs_165 = arith.muli %b_ptrs_151, %b_ptrs_154 : tensor<1x32xi32> loc(#loc135)
    %b_ptrs_166 = tt.broadcast %b_ptrs_150 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_167 = tt.broadcast %b_ptrs_165 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc136)
    %b_ptrs_168 = arith.extsi %b_ptrs_166 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_169 = arith.extsi %b_ptrs_167 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc136)
    %b_ptrs_170 = arith.addi %b_ptrs_168, %b_ptrs_169 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_171 = arith.constant 2147483647 : i64 loc(#loc136)
    %b_ptrs_172 = arith.constant -2147483648 : i64 loc(#loc136)
    %b_ptrs_173 = arith.constant dense<2147483647> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_174 = arith.cmpi sle, %b_ptrs_170, %b_ptrs_173 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_175 = arith.constant dense<-2147483648> : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_176 = arith.cmpi sge, %b_ptrs_170, %b_ptrs_175 : tensor<64x32xi64> loc(#loc136)
    %b_ptrs_177 = arith.andi %b_ptrs_174, %b_ptrs_176 : tensor<64x32xi1> loc(#loc136)
    %b_ptrs_178 = arith.addi %b_ptrs_166, %b_ptrs_167 : tensor<64x32xi32> loc(#loc136)
    %b_ptrs_179 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc137)
    %b_ptrs_180 = tt.addptr %b_ptrs_179, %b_ptrs_178 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc137)
    %accumulator = tt.call @triton.language.standard.zeros__Tc64_c32T_cfp32() : () -> tensor<64x32xf32> loc(#loc138)
    %5 = tt.call @triton.language.standard.cdiv__i32_c64(%K) : (i32) -> i32 loc(#loc49)
    %c0_i32_181 = arith.constant 0 : i32 loc(#loc50)
    %c1_i32 = arith.constant 1 : i32 loc(#loc50)
    %6 = arith.bitcast %c0_i32_181 : i32 to i32 loc(#loc50)
    %7 = arith.bitcast %5 : i32 to i32 loc(#loc50)
    %8 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc50)
    %9 = ub.poison : i32 loc(#loc50)
    %accumulator_182:3 = scf.for %k = %6 to %7 step %8 iter_args(%a_ptrs_269 = %a_ptrs_138, %b_ptrs_270 = %b_ptrs_180, %accumulator_271 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc140)
      %a_272 = arith.constant 64 : i32 loc(#loc141)
      %a_273 = arith.constant 64 : i32 loc(#loc141)
      %a_274 = arith.extsi %k : i32 to i64 loc(#loc141)
      %a_275 = arith.extsi %a_273 : i32 to i64 loc(#loc141)
      %a_276 = arith.muli %a_274, %a_275 : i64 loc(#loc141)
      %a_277 = arith.constant 2147483647 : i64 loc(#loc141)
      %a_278 = arith.constant -2147483648 : i64 loc(#loc141)
      %a_279 = arith.cmpi sle, %a_276, %a_277 : i64 loc(#loc141)
      %a_280 = arith.cmpi sge, %a_276, %a_278 : i64 loc(#loc141)
      %a_281 = arith.andi %a_279, %a_280 : i1 loc(#loc141)
      %a_282 = arith.muli %k, %a_273 : i32 loc(#loc141)
      %a_283 = arith.extsi %K : i32 to i64 loc(#loc142)
      %a_284 = arith.extsi %a_282 : i32 to i64 loc(#loc142)
      %a_285 = arith.subi %a_283, %a_284 : i64 loc(#loc142)
      %a_286 = arith.constant 2147483647 : i64 loc(#loc142)
      %a_287 = arith.constant -2147483648 : i64 loc(#loc142)
      %a_288 = arith.cmpi sle, %a_285, %a_286 : i64 loc(#loc142)
      %a_289 = arith.cmpi sge, %a_285, %a_287 : i64 loc(#loc142)
      %a_290 = arith.andi %a_288, %a_289 : i1 loc(#loc142)
      %a_291 = arith.subi %K, %a_282 : i32 loc(#loc142)
      %a_292 = tt.splat %a_291 : i32 -> tensor<1x64xi32> loc(#loc143)
      %a_293 = arith.cmpi slt, %a, %a_292 : tensor<1x64xi32> loc(#loc143)
      %a_294 = arith.constant 0.000000e+00 : f32 loc(#loc144)
      %a_295 = tt.broadcast %a_293 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc144)
      %a_296 = arith.constant dense<0.000000e+00> : tensor<64x64xf32> loc(#loc144)
      %a_297 = arith.truncf %a_296 : tensor<64x64xf32> to tensor<64x64xf16> loc(#loc144)
      %a_298 = tt.load %a_ptrs_269, %a_295, %a_297 : tensor<64x64x!tt.ptr<f16>> loc(#loc144)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc145)
      %b_299 = arith.constant 64 : i32 loc(#loc146)
      %b_300 = arith.constant 64 : i32 loc(#loc146)
      %b_301 = arith.extsi %k : i32 to i64 loc(#loc146)
      %b_302 = arith.extsi %b_300 : i32 to i64 loc(#loc146)
      %b_303 = arith.muli %b_301, %b_302 : i64 loc(#loc146)
      %b_304 = arith.constant 2147483647 : i64 loc(#loc146)
      %b_305 = arith.constant -2147483648 : i64 loc(#loc146)
      %b_306 = arith.cmpi sle, %b_303, %b_304 : i64 loc(#loc146)
      %b_307 = arith.cmpi sge, %b_303, %b_305 : i64 loc(#loc146)
      %b_308 = arith.andi %b_306, %b_307 : i1 loc(#loc146)
      %b_309 = arith.muli %k, %b_300 : i32 loc(#loc146)
      %b_310 = arith.extsi %K : i32 to i64 loc(#loc147)
      %b_311 = arith.extsi %b_309 : i32 to i64 loc(#loc147)
      %b_312 = arith.subi %b_310, %b_311 : i64 loc(#loc147)
      %b_313 = arith.constant 2147483647 : i64 loc(#loc147)
      %b_314 = arith.constant -2147483648 : i64 loc(#loc147)
      %b_315 = arith.cmpi sle, %b_312, %b_313 : i64 loc(#loc147)
      %b_316 = arith.cmpi sge, %b_312, %b_314 : i64 loc(#loc147)
      %b_317 = arith.andi %b_315, %b_316 : i1 loc(#loc147)
      %b_318 = arith.subi %K, %b_309 : i32 loc(#loc147)
      %b_319 = tt.splat %b_318 : i32 -> tensor<64x1xi32> loc(#loc148)
      %b_320 = arith.cmpi slt, %b, %b_319 : tensor<64x1xi32> loc(#loc148)
      %b_321 = arith.constant 0.000000e+00 : f32 loc(#loc149)
      %b_322 = tt.broadcast %b_320 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc149)
      %b_323 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc149)
      %b_324 = arith.truncf %b_323 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc149)
      %b_325 = tt.load %b_ptrs_270, %b_322, %b_324 : tensor<64x32x!tt.ptr<f16>> loc(#loc149)
      %accumulator_326 = arith.constant 0.000000e+00 : f32 loc(#loc150)
      %accumulator_327 = tt.dot %a_298, %b_325, %accumulator_271, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc150)
      %a_ptrs_328 = arith.constant 64 : i32 loc(#loc151)
      %a_ptrs_329 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc151)
      %a_ptrs_330 = tt.addptr %a_ptrs_269, %a_ptrs_329 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc151)
      %b_ptrs_331 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_332 = arith.constant 64 : i32 loc(#loc152)
      %b_ptrs_333 = arith.extsi %b_ptrs_332 : i32 to i64 loc(#loc152)
      %b_ptrs_334 = arith.extsi %stride_bk : i32 to i64 loc(#loc152)
      %b_ptrs_335 = arith.muli %b_ptrs_333, %b_ptrs_334 : i64 loc(#loc152)
      %b_ptrs_336 = arith.constant 2147483647 : i64 loc(#loc152)
      %b_ptrs_337 = arith.constant -2147483648 : i64 loc(#loc152)
      %b_ptrs_338 = arith.cmpi sle, %b_ptrs_335, %b_ptrs_336 : i64 loc(#loc152)
      %b_ptrs_339 = arith.cmpi sge, %b_ptrs_335, %b_ptrs_337 : i64 loc(#loc152)
      %b_ptrs_340 = arith.andi %b_ptrs_338, %b_ptrs_339 : i1 loc(#loc152)
      %b_ptrs_341 = arith.muli %b_ptrs_332, %stride_bk : i32 loc(#loc152)
      %b_ptrs_342 = tt.splat %b_ptrs_341 : i32 -> tensor<64x32xi32> loc(#loc153)
      %b_ptrs_343 = tt.addptr %b_ptrs_270, %b_ptrs_342 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc153)
      scf.yield %a_ptrs_330, %b_ptrs_343, %accumulator_327 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc65)
    } loc(#loc174)
    %c = arith.truncf %accumulator_182#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc154)
    %offs_cm = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_183 = arith.constant 64 : i32 loc(#loc155)
    %offs_cm_184 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc155)
    %offs_cm_185 = arith.extsi %offs_cm_183 : i32 to i64 loc(#loc155)
    %offs_cm_186 = arith.muli %offs_cm_184, %offs_cm_185 : i64 loc(#loc155)
    %offs_cm_187 = arith.constant 2147483647 : i64 loc(#loc155)
    %offs_cm_188 = arith.constant -2147483648 : i64 loc(#loc155)
    %offs_cm_189 = arith.cmpi sle, %offs_cm_186, %offs_cm_187 : i64 loc(#loc155)
    %offs_cm_190 = arith.cmpi sge, %offs_cm_186, %offs_cm_188 : i64 loc(#loc155)
    %offs_cm_191 = arith.andi %offs_cm_189, %offs_cm_190 : i1 loc(#loc155)
    %offs_cm_192 = arith.muli %pid_m_39, %offs_cm_183 : i32 loc(#loc155)
    %offs_cm_193 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc156)
    %offs_cm_194 = tt.splat %offs_cm_192 : i32 -> tensor<64xi32> loc(#loc157)
    %offs_cm_195 = arith.extsi %offs_cm_194 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_196 = arith.extsi %offs_cm_193 : tensor<64xi32> to tensor<64xi64> loc(#loc157)
    %offs_cm_197 = arith.addi %offs_cm_195, %offs_cm_196 : tensor<64xi64> loc(#loc157)
    %offs_cm_198 = arith.constant 2147483647 : i64 loc(#loc157)
    %offs_cm_199 = arith.constant -2147483648 : i64 loc(#loc157)
    %offs_cm_200 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc157)
    %offs_cm_201 = arith.cmpi sle, %offs_cm_197, %offs_cm_200 : tensor<64xi64> loc(#loc157)
    %offs_cm_202 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc157)
    %offs_cm_203 = arith.cmpi sge, %offs_cm_197, %offs_cm_202 : tensor<64xi64> loc(#loc157)
    %offs_cm_204 = arith.andi %offs_cm_201, %offs_cm_203 : tensor<64xi1> loc(#loc157)
    %offs_cm_205 = arith.addi %offs_cm_194, %offs_cm_193 : tensor<64xi32> loc(#loc157)
    %offs_cn = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_206 = arith.constant 32 : i32 loc(#loc158)
    %offs_cn_207 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc158)
    %offs_cn_208 = arith.extsi %offs_cn_206 : i32 to i64 loc(#loc158)
    %offs_cn_209 = arith.muli %offs_cn_207, %offs_cn_208 : i64 loc(#loc158)
    %offs_cn_210 = arith.constant 2147483647 : i64 loc(#loc158)
    %offs_cn_211 = arith.constant -2147483648 : i64 loc(#loc158)
    %offs_cn_212 = arith.cmpi sle, %offs_cn_209, %offs_cn_210 : i64 loc(#loc158)
    %offs_cn_213 = arith.cmpi sge, %offs_cn_209, %offs_cn_211 : i64 loc(#loc158)
    %offs_cn_214 = arith.andi %offs_cn_212, %offs_cn_213 : i1 loc(#loc158)
    %offs_cn_215 = arith.muli %pid_n_40, %offs_cn_206 : i32 loc(#loc158)
    %offs_cn_216 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc159)
    %offs_cn_217 = tt.splat %offs_cn_215 : i32 -> tensor<32xi32> loc(#loc160)
    %offs_cn_218 = arith.extsi %offs_cn_217 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_219 = arith.extsi %offs_cn_216 : tensor<32xi32> to tensor<32xi64> loc(#loc160)
    %offs_cn_220 = arith.addi %offs_cn_218, %offs_cn_219 : tensor<32xi64> loc(#loc160)
    %offs_cn_221 = arith.constant 2147483647 : i64 loc(#loc160)
    %offs_cn_222 = arith.constant -2147483648 : i64 loc(#loc160)
    %offs_cn_223 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc160)
    %offs_cn_224 = arith.cmpi sle, %offs_cn_220, %offs_cn_223 : tensor<32xi64> loc(#loc160)
    %offs_cn_225 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc160)
    %offs_cn_226 = arith.cmpi sge, %offs_cn_220, %offs_cn_225 : tensor<32xi64> loc(#loc160)
    %offs_cn_227 = arith.andi %offs_cn_224, %offs_cn_226 : tensor<32xi1> loc(#loc160)
    %offs_cn_228 = arith.addi %offs_cn_217, %offs_cn_216 : tensor<32xi32> loc(#loc160)
    %c_ptrs = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc161)
    %c_ptrs_229 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc162)
    %c_ptrs_230 = arith.extsi %c_ptrs_229 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_231 = arith.extsi %c_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc162)
    %c_ptrs_232 = arith.muli %c_ptrs_230, %c_ptrs_231 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_233 = arith.constant 2147483647 : i64 loc(#loc162)
    %c_ptrs_234 = arith.constant -2147483648 : i64 loc(#loc162)
    %c_ptrs_235 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_236 = arith.cmpi sle, %c_ptrs_232, %c_ptrs_235 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_237 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_238 = arith.cmpi sge, %c_ptrs_232, %c_ptrs_237 : tensor<64x1xi64> loc(#loc162)
    %c_ptrs_239 = arith.andi %c_ptrs_236, %c_ptrs_238 : tensor<64x1xi1> loc(#loc162)
    %c_ptrs_240 = arith.muli %c_ptrs_229, %c_ptrs : tensor<64x1xi32> loc(#loc162)
    %c_ptrs_241 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc163)
    %c_ptrs_242 = tt.addptr %c_ptrs_241, %c_ptrs_240 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc163)
    %c_ptrs_243 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc164)
    %c_ptrs_244 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_245 = arith.constant 1 : i32 loc(#loc165)
    %c_ptrs_246 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_247 = arith.extsi %c_ptrs_246 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_248 = arith.extsi %c_ptrs_243 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc165)
    %c_ptrs_249 = arith.muli %c_ptrs_247, %c_ptrs_248 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_250 = arith.constant 2147483647 : i64 loc(#loc165)
    %c_ptrs_251 = arith.constant -2147483648 : i64 loc(#loc165)
    %c_ptrs_252 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_253 = arith.cmpi sle, %c_ptrs_249, %c_ptrs_252 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_254 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_255 = arith.cmpi sge, %c_ptrs_249, %c_ptrs_254 : tensor<1x32xi64> loc(#loc165)
    %c_ptrs_256 = arith.andi %c_ptrs_253, %c_ptrs_255 : tensor<1x32xi1> loc(#loc165)
    %c_ptrs_257 = arith.muli %c_ptrs_246, %c_ptrs_243 : tensor<1x32xi32> loc(#loc165)
    %c_ptrs_258 = tt.broadcast %c_ptrs_242 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc166)
    %c_ptrs_259 = tt.broadcast %c_ptrs_257 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc166)
    %c_ptrs_260 = tt.addptr %c_ptrs_258, %c_ptrs_259 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc166)
    %c_mask = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc167)
    %c_mask_261 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc168)
    %c_mask_262 = arith.cmpi slt, %c_mask, %c_mask_261 : tensor<64x1xi32> loc(#loc168)
    %c_mask_263 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc169)
    %c_mask_264 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc170)
    %c_mask_265 = arith.cmpi slt, %c_mask_263, %c_mask_264 : tensor<1x32xi32> loc(#loc170)
    %c_mask_266 = tt.broadcast %c_mask_262 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_267 = tt.broadcast %c_mask_265 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc171)
    %c_mask_268 = arith.andi %c_mask_266, %c_mask_267 : tensor<64x32xi1> loc(#loc171)
    tt.store %c_ptrs_260, %c, %c_mask_268 : tensor<64x32x!tt.ptr<f16>> loc(#loc84)
    tt.return loc(#loc85)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc87)
    %c63_i32 = arith.constant 63 : i32 loc(#loc87)
    %0 = arith.addi %x, %c63_i32 : i32 loc(#loc88)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc89)
    tt.return %1 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c32_i32 = arith.constant 32 : i32 loc(#loc87)
    %c31_i32 = arith.constant 31 : i32 loc(#loc87)
    %0 = arith.addi %x, %c31_i32 : i32 loc(#loc88)
    %1 = arith.divsi %0, %c32_i32 : i32 loc(#loc89)
    tt.return %1 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} {
    %cst = arith.constant 0.000000e+00 : f32 loc(#loc92)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc92)
    tt.return %cst_0 : tensor<64x32xf32> loc(#loc93)
  ^bb1:  // no predecessors
    %0 = ub.poison : tensor<64x32xf32> loc(#loc94)
    tt.return %0 : tensor<64x32xf32> loc(#loc94)
  } loc(#loc91)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:71)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:71)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:64)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc(unknown)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc89 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc90 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:11)
#loc91 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc92 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc93 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:11)
#loc94 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:4)
#loc104 = loc("pid"(#loc1))
#loc105 = loc("num_pid_m"(#loc2))
#loc106 = loc("num_pid_n"(#loc3))
#loc107 = loc("num_pid_in_group"(#loc4))
#loc108 = loc("group_id"(#loc5))
#loc109 = loc("first_pid_m"(#loc6))
#loc110 = loc("group_size_m"(#loc7))
#loc111 = loc("group_size_m"(#loc8))
#loc112 = loc("pid_m"(#loc9))
#loc113 = loc("pid_m"(#loc10))
#loc114 = loc("pid_m"(#loc11))
#loc115 = loc("pid_n"(#loc12))
#loc116 = loc("pid_n"(#loc13))
#loc117 = loc("offs_am"(#loc27))
#loc118 = loc("offs_am"(#loc28))
#loc119 = loc("offs_am"(#loc29))
#loc120 = loc("offs_am"(#loc30))
#loc121 = loc("offs_bn"(#loc31))
#loc122 = loc("offs_bn"(#loc32))
#loc123 = loc("offs_bn"(#loc33))
#loc124 = loc("offs_bn"(#loc34))
#loc125 = loc("offs_k"(#loc35))
#loc126 = loc("a_ptrs"(#loc36))
#loc127 = loc("a_ptrs"(#loc37))
#loc128 = loc("a_ptrs"(#loc38))
#loc129 = loc("a_ptrs"(#loc39))
#loc130 = loc("a_ptrs"(#loc40))
#loc131 = loc("a_ptrs"(#loc41))
#loc132 = loc("b_ptrs"(#loc42))
#loc133 = loc("b_ptrs"(#loc43))
#loc134 = loc("b_ptrs"(#loc44))
#loc135 = loc("b_ptrs"(#loc45))
#loc136 = loc("b_ptrs"(#loc46))
#loc137 = loc("b_ptrs"(#loc47))
#loc138 = loc("accumulator"(#loc48))
#loc139 = loc("a_ptrs"(#loc50))
#loc140 = loc("a"(#loc51))
#loc141 = loc("a"(#loc52))
#loc142 = loc("a"(#loc53))
#loc143 = loc("a"(#loc54))
#loc144 = loc("a"(#loc55))
#loc145 = loc("b"(#loc56))
#loc146 = loc("b"(#loc57))
#loc147 = loc("b"(#loc58))
#loc148 = loc("b"(#loc59))
#loc149 = loc("b"(#loc60))
#loc150 = loc("accumulator"(#loc61))
#loc151 = loc("a_ptrs"(#loc62))
#loc152 = loc("b_ptrs"(#loc63))
#loc153 = loc("b_ptrs"(#loc64))
#loc154 = loc("c"(#loc66))
#loc155 = loc("offs_cm"(#loc67))
#loc156 = loc("offs_cm"(#loc68))
#loc157 = loc("offs_cm"(#loc69))
#loc158 = loc("offs_cn"(#loc70))
#loc159 = loc("offs_cn"(#loc71))
#loc160 = loc("offs_cn"(#loc72))
#loc161 = loc("c_ptrs"(#loc73))
#loc162 = loc("c_ptrs"(#loc74))
#loc163 = loc("c_ptrs"(#loc75))
#loc164 = loc("c_ptrs"(#loc76))
#loc165 = loc("c_ptrs"(#loc77))
#loc166 = loc("c_ptrs"(#loc78))
#loc167 = loc("c_mask"(#loc79))
#loc168 = loc("c_mask"(#loc80))
#loc169 = loc("c_mask"(#loc81))
#loc170 = loc("c_mask"(#loc82))
#loc171 = loc("c_mask"(#loc83))
#loc173 = loc("b_ptrs"(#loc139))
#loc174 = loc("accumulator"(#loc173))


// -----// IR Dump Before Canonicalizer (canonicalize) ('tt.func' operation: @matmul_kernel) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc86 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc94 = loc("a_ptr"(#loc))
#loc95 = loc("b_ptr"(#loc))
#loc96 = loc("c_ptr"(#loc))
#loc97 = loc("M"(#loc))
#loc98 = loc("N"(#loc))
#loc99 = loc("K"(#loc))
#loc100 = loc("stride_am"(#loc))
#loc101 = loc("stride_bk"(#loc))
#loc102 = loc("stride_cm"(#loc))
#loc171 = loc("x"(#loc86))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %pid = tt.get_program_id x : i32 loc(#loc103)
    %num_pid_m = tt.call @triton.language.standard.cdiv__i32_c64(%M) : (i32) -> i32 loc(#loc104)
    %num_pid_n = tt.call @triton.language.standard.cdiv__i32_c32(%N) : (i32) -> i32 loc(#loc105)
    %num_pid_in_group = arith.constant 4 : i32 loc(#loc106)
    %num_pid_in_group_0 = arith.constant 4 : i32 loc(#loc106)
    %num_pid_in_group_1 = arith.extsi %num_pid_in_group_0 : i32 to i64 loc(#loc106)
    %num_pid_in_group_2 = arith.extsi %num_pid_n : i32 to i64 loc(#loc106)
    %num_pid_in_group_3 = arith.muli %num_pid_in_group_1, %num_pid_in_group_2 : i64 loc(#loc106)
    %num_pid_in_group_4 = arith.constant 2147483647 : i64 loc(#loc106)
    %num_pid_in_group_5 = arith.constant -2147483648 : i64 loc(#loc106)
    %num_pid_in_group_6 = arith.cmpi sle, %num_pid_in_group_3, %num_pid_in_group_4 : i64 loc(#loc106)
    %num_pid_in_group_7 = arith.cmpi sge, %num_pid_in_group_3, %num_pid_in_group_5 : i64 loc(#loc106)
    %num_pid_in_group_8 = arith.andi %num_pid_in_group_6, %num_pid_in_group_7 : i1 loc(#loc106)
    %num_pid_in_group_9 = arith.muli %num_pid_in_group_0, %num_pid_n : i32 loc(#loc106)
    %group_id = arith.divsi %pid, %num_pid_in_group_9 : i32 loc(#loc107)
    %first_pid_m = arith.constant 4 : i32 loc(#loc108)
    %first_pid_m_10 = arith.constant 4 : i32 loc(#loc108)
    %first_pid_m_11 = arith.extsi %group_id : i32 to i64 loc(#loc108)
    %first_pid_m_12 = arith.extsi %first_pid_m_10 : i32 to i64 loc(#loc108)
    %first_pid_m_13 = arith.muli %first_pid_m_11, %first_pid_m_12 : i64 loc(#loc108)
    %first_pid_m_14 = arith.constant 2147483647 : i64 loc(#loc108)
    %first_pid_m_15 = arith.constant -2147483648 : i64 loc(#loc108)
    %first_pid_m_16 = arith.cmpi sle, %first_pid_m_13, %first_pid_m_14 : i64 loc(#loc108)
    %first_pid_m_17 = arith.cmpi sge, %first_pid_m_13, %first_pid_m_15 : i64 loc(#loc108)
    %first_pid_m_18 = arith.andi %first_pid_m_16, %first_pid_m_17 : i1 loc(#loc108)
    %first_pid_m_19 = arith.muli %group_id, %first_pid_m_10 : i32 loc(#loc108)
    %group_size_m = arith.extsi %num_pid_m : i32 to i64 loc(#loc109)
    %group_size_m_20 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc109)
    %group_size_m_21 = arith.subi %group_size_m, %group_size_m_20 : i64 loc(#loc109)
    %group_size_m_22 = arith.constant 2147483647 : i64 loc(#loc109)
    %group_size_m_23 = arith.constant -2147483648 : i64 loc(#loc109)
    %group_size_m_24 = arith.cmpi sle, %group_size_m_21, %group_size_m_22 : i64 loc(#loc109)
    %group_size_m_25 = arith.cmpi sge, %group_size_m_21, %group_size_m_23 : i64 loc(#loc109)
    %group_size_m_26 = arith.andi %group_size_m_24, %group_size_m_25 : i1 loc(#loc109)
    %group_size_m_27 = arith.subi %num_pid_m, %first_pid_m_19 : i32 loc(#loc109)
    %group_size_m_28 = arith.constant 4 : i32 loc(#loc110)
    %group_size_m_29 = arith.minsi %group_size_m_27, %group_size_m_28 : i32 loc(#loc110)
    %pid_m = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc111)
    %pid_m_30 = arith.remsi %pid_m, %group_size_m_29 : i32 loc(#loc112)
    %pid_m_31 = arith.extsi %first_pid_m_19 : i32 to i64 loc(#loc113)
    %pid_m_32 = arith.extsi %pid_m_30 : i32 to i64 loc(#loc113)
    %pid_m_33 = arith.addi %pid_m_31, %pid_m_32 : i64 loc(#loc113)
    %pid_m_34 = arith.constant 2147483647 : i64 loc(#loc113)
    %pid_m_35 = arith.constant -2147483648 : i64 loc(#loc113)
    %pid_m_36 = arith.cmpi sle, %pid_m_33, %pid_m_34 : i64 loc(#loc113)
    %pid_m_37 = arith.cmpi sge, %pid_m_33, %pid_m_35 : i64 loc(#loc113)
    %pid_m_38 = arith.andi %pid_m_36, %pid_m_37 : i1 loc(#loc113)
    %pid_m_39 = arith.addi %first_pid_m_19, %pid_m_30 : i32 loc(#loc113)
    %pid_n = arith.remsi %pid, %num_pid_in_group_9 : i32 loc(#loc114)
    %pid_n_40 = arith.divsi %pid_n, %group_size_m_29 : i32 loc(#loc115)
    %c0_i32 = arith.constant 0 : i32 loc(#loc14)
    %0 = arith.cmpi sge, %pid_m_39, %c0_i32 : i32 loc(#loc14)
    llvm.intr.assume %0 : i1 loc(#loc15)
    %c0_i32_41 = arith.constant 0 : i32 loc(#loc16)
    %1 = arith.cmpi sge, %pid_n_40, %c0_i32_41 : i32 loc(#loc16)
    llvm.intr.assume %1 : i1 loc(#loc17)
    %c0_i32_42 = arith.constant 0 : i32 loc(#loc18)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32_42 : i32 loc(#loc18)
    llvm.intr.assume %2 : i1 loc(#loc19)
    %true = arith.constant true loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc20)
    %true_43 = arith.constant true loc(#loc21)
    llvm.intr.assume %true_43 : i1 loc(#loc21)
    %c0_i32_44 = arith.constant 0 : i32 loc(#loc22)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32_44 : i32 loc(#loc22)
    llvm.intr.assume %3 : i1 loc(#loc23)
    %c0_i32_45 = arith.constant 0 : i32 loc(#loc24)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32_45 : i32 loc(#loc24)
    llvm.intr.assume %4 : i1 loc(#loc25)
    %true_46 = arith.constant true loc(#loc26)
    llvm.intr.assume %true_46 : i1 loc(#loc26)
    %offs_am = arith.constant 64 : i32 loc(#loc116)
    %offs_am_47 = arith.constant 64 : i32 loc(#loc116)
    %offs_am_48 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc116)
    %offs_am_49 = arith.extsi %offs_am_47 : i32 to i64 loc(#loc116)
    %offs_am_50 = arith.muli %offs_am_48, %offs_am_49 : i64 loc(#loc116)
    %offs_am_51 = arith.constant 2147483647 : i64 loc(#loc116)
    %offs_am_52 = arith.constant -2147483648 : i64 loc(#loc116)
    %offs_am_53 = arith.cmpi sle, %offs_am_50, %offs_am_51 : i64 loc(#loc116)
    %offs_am_54 = arith.cmpi sge, %offs_am_50, %offs_am_52 : i64 loc(#loc116)
    %offs_am_55 = arith.andi %offs_am_53, %offs_am_54 : i1 loc(#loc116)
    %offs_am_56 = arith.muli %pid_m_39, %offs_am_47 : i32 loc(#loc116)
    %offs_am_57 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc117)
    %offs_am_58 = tt.splat %offs_am_56 : i32 -> tensor<64xi32> loc(#loc118)
    %offs_am_59 = arith.extsi %offs_am_58 : tensor<64xi32> to tensor<64xi64> loc(#loc118)
    %offs_am_60 = arith.extsi %offs_am_57 : tensor<64xi32> to tensor<64xi64> loc(#loc118)
    %offs_am_61 = arith.addi %offs_am_59, %offs_am_60 : tensor<64xi64> loc(#loc118)
    %offs_am_62 = arith.constant 2147483647 : i64 loc(#loc118)
    %offs_am_63 = arith.constant -2147483648 : i64 loc(#loc118)
    %offs_am_64 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc118)
    %offs_am_65 = arith.cmpi sle, %offs_am_61, %offs_am_64 : tensor<64xi64> loc(#loc118)
    %offs_am_66 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc118)
    %offs_am_67 = arith.cmpi sge, %offs_am_61, %offs_am_66 : tensor<64xi64> loc(#loc118)
    %offs_am_68 = arith.andi %offs_am_65, %offs_am_67 : tensor<64xi1> loc(#loc118)
    %offs_am_69 = arith.addi %offs_am_58, %offs_am_57 : tensor<64xi32> loc(#loc118)
    %offs_am_70 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc119)
    %offs_am_71 = arith.remsi %offs_am_69, %offs_am_70 : tensor<64xi32> loc(#loc119)
    %offs_bn = arith.constant 32 : i32 loc(#loc120)
    %offs_bn_72 = arith.constant 32 : i32 loc(#loc120)
    %offs_bn_73 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc120)
    %offs_bn_74 = arith.extsi %offs_bn_72 : i32 to i64 loc(#loc120)
    %offs_bn_75 = arith.muli %offs_bn_73, %offs_bn_74 : i64 loc(#loc120)
    %offs_bn_76 = arith.constant 2147483647 : i64 loc(#loc120)
    %offs_bn_77 = arith.constant -2147483648 : i64 loc(#loc120)
    %offs_bn_78 = arith.cmpi sle, %offs_bn_75, %offs_bn_76 : i64 loc(#loc120)
    %offs_bn_79 = arith.cmpi sge, %offs_bn_75, %offs_bn_77 : i64 loc(#loc120)
    %offs_bn_80 = arith.andi %offs_bn_78, %offs_bn_79 : i1 loc(#loc120)
    %offs_bn_81 = arith.muli %pid_n_40, %offs_bn_72 : i32 loc(#loc120)
    %offs_bn_82 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc121)
    %offs_bn_83 = tt.splat %offs_bn_81 : i32 -> tensor<32xi32> loc(#loc122)
    %offs_bn_84 = arith.extsi %offs_bn_83 : tensor<32xi32> to tensor<32xi64> loc(#loc122)
    %offs_bn_85 = arith.extsi %offs_bn_82 : tensor<32xi32> to tensor<32xi64> loc(#loc122)
    %offs_bn_86 = arith.addi %offs_bn_84, %offs_bn_85 : tensor<32xi64> loc(#loc122)
    %offs_bn_87 = arith.constant 2147483647 : i64 loc(#loc122)
    %offs_bn_88 = arith.constant -2147483648 : i64 loc(#loc122)
    %offs_bn_89 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc122)
    %offs_bn_90 = arith.cmpi sle, %offs_bn_86, %offs_bn_89 : tensor<32xi64> loc(#loc122)
    %offs_bn_91 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc122)
    %offs_bn_92 = arith.cmpi sge, %offs_bn_86, %offs_bn_91 : tensor<32xi64> loc(#loc122)
    %offs_bn_93 = arith.andi %offs_bn_90, %offs_bn_92 : tensor<32xi1> loc(#loc122)
    %offs_bn_94 = arith.addi %offs_bn_83, %offs_bn_82 : tensor<32xi32> loc(#loc122)
    %offs_bn_95 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc123)
    %offs_bn_96 = arith.remsi %offs_bn_94, %offs_bn_95 : tensor<32xi32> loc(#loc123)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc124)
    %a_ptrs = tt.expand_dims %offs_am_71 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc125)
    %a_ptrs_97 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc126)
    %a_ptrs_98 = arith.extsi %a_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc126)
    %a_ptrs_99 = arith.extsi %a_ptrs_97 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc126)
    %a_ptrs_100 = arith.muli %a_ptrs_98, %a_ptrs_99 : tensor<64x1xi64> loc(#loc126)
    %a_ptrs_101 = arith.constant 2147483647 : i64 loc(#loc126)
    %a_ptrs_102 = arith.constant -2147483648 : i64 loc(#loc126)
    %a_ptrs_103 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc126)
    %a_ptrs_104 = arith.cmpi sle, %a_ptrs_100, %a_ptrs_103 : tensor<64x1xi64> loc(#loc126)
    %a_ptrs_105 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc126)
    %a_ptrs_106 = arith.cmpi sge, %a_ptrs_100, %a_ptrs_105 : tensor<64x1xi64> loc(#loc126)
    %a_ptrs_107 = arith.andi %a_ptrs_104, %a_ptrs_106 : tensor<64x1xi1> loc(#loc126)
    %a_ptrs_108 = arith.muli %a_ptrs, %a_ptrs_97 : tensor<64x1xi32> loc(#loc126)
    %a_ptrs_109 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc127)
    %a_ptrs_110 = arith.constant 1 : i32 loc(#loc128)
    %a_ptrs_111 = arith.constant 1 : i32 loc(#loc128)
    %a_ptrs_112 = arith.constant dense<1> : tensor<1x64xi32> loc(#loc128)
    %a_ptrs_113 = arith.extsi %a_ptrs_109 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc128)
    %a_ptrs_114 = arith.extsi %a_ptrs_112 : tensor<1x64xi32> to tensor<1x64xi64> loc(#loc128)
    %a_ptrs_115 = arith.muli %a_ptrs_113, %a_ptrs_114 : tensor<1x64xi64> loc(#loc128)
    %a_ptrs_116 = arith.constant 2147483647 : i64 loc(#loc128)
    %a_ptrs_117 = arith.constant -2147483648 : i64 loc(#loc128)
    %a_ptrs_118 = arith.constant dense<2147483647> : tensor<1x64xi64> loc(#loc128)
    %a_ptrs_119 = arith.cmpi sle, %a_ptrs_115, %a_ptrs_118 : tensor<1x64xi64> loc(#loc128)
    %a_ptrs_120 = arith.constant dense<-2147483648> : tensor<1x64xi64> loc(#loc128)
    %a_ptrs_121 = arith.cmpi sge, %a_ptrs_115, %a_ptrs_120 : tensor<1x64xi64> loc(#loc128)
    %a_ptrs_122 = arith.andi %a_ptrs_119, %a_ptrs_121 : tensor<1x64xi1> loc(#loc128)
    %a_ptrs_123 = arith.muli %a_ptrs_109, %a_ptrs_112 : tensor<1x64xi32> loc(#loc128)
    %a_ptrs_124 = tt.broadcast %a_ptrs_108 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc129)
    %a_ptrs_125 = tt.broadcast %a_ptrs_123 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc129)
    %a_ptrs_126 = arith.extsi %a_ptrs_124 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc129)
    %a_ptrs_127 = arith.extsi %a_ptrs_125 : tensor<64x64xi32> to tensor<64x64xi64> loc(#loc129)
    %a_ptrs_128 = arith.addi %a_ptrs_126, %a_ptrs_127 : tensor<64x64xi64> loc(#loc129)
    %a_ptrs_129 = arith.constant 2147483647 : i64 loc(#loc129)
    %a_ptrs_130 = arith.constant -2147483648 : i64 loc(#loc129)
    %a_ptrs_131 = arith.constant dense<2147483647> : tensor<64x64xi64> loc(#loc129)
    %a_ptrs_132 = arith.cmpi sle, %a_ptrs_128, %a_ptrs_131 : tensor<64x64xi64> loc(#loc129)
    %a_ptrs_133 = arith.constant dense<-2147483648> : tensor<64x64xi64> loc(#loc129)
    %a_ptrs_134 = arith.cmpi sge, %a_ptrs_128, %a_ptrs_133 : tensor<64x64xi64> loc(#loc129)
    %a_ptrs_135 = arith.andi %a_ptrs_132, %a_ptrs_134 : tensor<64x64xi1> loc(#loc129)
    %a_ptrs_136 = arith.addi %a_ptrs_124, %a_ptrs_125 : tensor<64x64xi32> loc(#loc129)
    %a_ptrs_137 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc130)
    %a_ptrs_138 = tt.addptr %a_ptrs_137, %a_ptrs_136 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc130)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc131)
    %b_ptrs_139 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc132)
    %b_ptrs_140 = arith.extsi %b_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc132)
    %b_ptrs_141 = arith.extsi %b_ptrs_139 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc132)
    %b_ptrs_142 = arith.muli %b_ptrs_140, %b_ptrs_141 : tensor<64x1xi64> loc(#loc132)
    %b_ptrs_143 = arith.constant 2147483647 : i64 loc(#loc132)
    %b_ptrs_144 = arith.constant -2147483648 : i64 loc(#loc132)
    %b_ptrs_145 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc132)
    %b_ptrs_146 = arith.cmpi sle, %b_ptrs_142, %b_ptrs_145 : tensor<64x1xi64> loc(#loc132)
    %b_ptrs_147 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc132)
    %b_ptrs_148 = arith.cmpi sge, %b_ptrs_142, %b_ptrs_147 : tensor<64x1xi64> loc(#loc132)
    %b_ptrs_149 = arith.andi %b_ptrs_146, %b_ptrs_148 : tensor<64x1xi1> loc(#loc132)
    %b_ptrs_150 = arith.muli %b_ptrs, %b_ptrs_139 : tensor<64x1xi32> loc(#loc132)
    %b_ptrs_151 = tt.expand_dims %offs_bn_96 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc133)
    %b_ptrs_152 = arith.constant 1 : i32 loc(#loc134)
    %b_ptrs_153 = arith.constant 1 : i32 loc(#loc134)
    %b_ptrs_154 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc134)
    %b_ptrs_155 = arith.extsi %b_ptrs_151 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc134)
    %b_ptrs_156 = arith.extsi %b_ptrs_154 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc134)
    %b_ptrs_157 = arith.muli %b_ptrs_155, %b_ptrs_156 : tensor<1x32xi64> loc(#loc134)
    %b_ptrs_158 = arith.constant 2147483647 : i64 loc(#loc134)
    %b_ptrs_159 = arith.constant -2147483648 : i64 loc(#loc134)
    %b_ptrs_160 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc134)
    %b_ptrs_161 = arith.cmpi sle, %b_ptrs_157, %b_ptrs_160 : tensor<1x32xi64> loc(#loc134)
    %b_ptrs_162 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc134)
    %b_ptrs_163 = arith.cmpi sge, %b_ptrs_157, %b_ptrs_162 : tensor<1x32xi64> loc(#loc134)
    %b_ptrs_164 = arith.andi %b_ptrs_161, %b_ptrs_163 : tensor<1x32xi1> loc(#loc134)
    %b_ptrs_165 = arith.muli %b_ptrs_151, %b_ptrs_154 : tensor<1x32xi32> loc(#loc134)
    %b_ptrs_166 = tt.broadcast %b_ptrs_150 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc135)
    %b_ptrs_167 = tt.broadcast %b_ptrs_165 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc135)
    %b_ptrs_168 = arith.extsi %b_ptrs_166 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc135)
    %b_ptrs_169 = arith.extsi %b_ptrs_167 : tensor<64x32xi32> to tensor<64x32xi64> loc(#loc135)
    %b_ptrs_170 = arith.addi %b_ptrs_168, %b_ptrs_169 : tensor<64x32xi64> loc(#loc135)
    %b_ptrs_171 = arith.constant 2147483647 : i64 loc(#loc135)
    %b_ptrs_172 = arith.constant -2147483648 : i64 loc(#loc135)
    %b_ptrs_173 = arith.constant dense<2147483647> : tensor<64x32xi64> loc(#loc135)
    %b_ptrs_174 = arith.cmpi sle, %b_ptrs_170, %b_ptrs_173 : tensor<64x32xi64> loc(#loc135)
    %b_ptrs_175 = arith.constant dense<-2147483648> : tensor<64x32xi64> loc(#loc135)
    %b_ptrs_176 = arith.cmpi sge, %b_ptrs_170, %b_ptrs_175 : tensor<64x32xi64> loc(#loc135)
    %b_ptrs_177 = arith.andi %b_ptrs_174, %b_ptrs_176 : tensor<64x32xi1> loc(#loc135)
    %b_ptrs_178 = arith.addi %b_ptrs_166, %b_ptrs_167 : tensor<64x32xi32> loc(#loc135)
    %b_ptrs_179 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc136)
    %b_ptrs_180 = tt.addptr %b_ptrs_179, %b_ptrs_178 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc136)
    %accumulator = tt.call @triton.language.standard.zeros__Tc64_c32T_cfp32() : () -> tensor<64x32xf32> loc(#loc137)
    %5 = tt.call @triton.language.standard.cdiv__i32_c64(%K) : (i32) -> i32 loc(#loc49)
    %c0_i32_181 = arith.constant 0 : i32 loc(#loc50)
    %c1_i32 = arith.constant 1 : i32 loc(#loc50)
    %6 = arith.bitcast %c0_i32_181 : i32 to i32 loc(#loc50)
    %7 = arith.bitcast %5 : i32 to i32 loc(#loc50)
    %8 = arith.bitcast %c1_i32 : i32 to i32 loc(#loc50)
    %9 = ub.poison : i32 loc(#loc50)
    %accumulator_182:3 = scf.for %k = %6 to %7 step %8 iter_args(%a_ptrs_269 = %a_ptrs_138, %b_ptrs_270 = %b_ptrs_180, %accumulator_271 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc139)
      %a_272 = arith.constant 64 : i32 loc(#loc140)
      %a_273 = arith.constant 64 : i32 loc(#loc140)
      %a_274 = arith.extsi %k : i32 to i64 loc(#loc140)
      %a_275 = arith.extsi %a_273 : i32 to i64 loc(#loc140)
      %a_276 = arith.muli %a_274, %a_275 : i64 loc(#loc140)
      %a_277 = arith.constant 2147483647 : i64 loc(#loc140)
      %a_278 = arith.constant -2147483648 : i64 loc(#loc140)
      %a_279 = arith.cmpi sle, %a_276, %a_277 : i64 loc(#loc140)
      %a_280 = arith.cmpi sge, %a_276, %a_278 : i64 loc(#loc140)
      %a_281 = arith.andi %a_279, %a_280 : i1 loc(#loc140)
      %a_282 = arith.muli %k, %a_273 : i32 loc(#loc140)
      %a_283 = arith.extsi %K : i32 to i64 loc(#loc141)
      %a_284 = arith.extsi %a_282 : i32 to i64 loc(#loc141)
      %a_285 = arith.subi %a_283, %a_284 : i64 loc(#loc141)
      %a_286 = arith.constant 2147483647 : i64 loc(#loc141)
      %a_287 = arith.constant -2147483648 : i64 loc(#loc141)
      %a_288 = arith.cmpi sle, %a_285, %a_286 : i64 loc(#loc141)
      %a_289 = arith.cmpi sge, %a_285, %a_287 : i64 loc(#loc141)
      %a_290 = arith.andi %a_288, %a_289 : i1 loc(#loc141)
      %a_291 = arith.subi %K, %a_282 : i32 loc(#loc141)
      %a_292 = tt.splat %a_291 : i32 -> tensor<1x64xi32> loc(#loc142)
      %a_293 = arith.cmpi slt, %a, %a_292 : tensor<1x64xi32> loc(#loc142)
      %a_294 = arith.constant 0.000000e+00 : f32 loc(#loc143)
      %a_295 = tt.broadcast %a_293 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc143)
      %a_296 = arith.constant dense<0.000000e+00> : tensor<64x64xf32> loc(#loc143)
      %a_297 = arith.truncf %a_296 : tensor<64x64xf32> to tensor<64x64xf16> loc(#loc143)
      %a_298 = tt.load %a_ptrs_269, %a_295, %a_297 : tensor<64x64x!tt.ptr<f16>> loc(#loc143)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc144)
      %b_299 = arith.constant 64 : i32 loc(#loc145)
      %b_300 = arith.constant 64 : i32 loc(#loc145)
      %b_301 = arith.extsi %k : i32 to i64 loc(#loc145)
      %b_302 = arith.extsi %b_300 : i32 to i64 loc(#loc145)
      %b_303 = arith.muli %b_301, %b_302 : i64 loc(#loc145)
      %b_304 = arith.constant 2147483647 : i64 loc(#loc145)
      %b_305 = arith.constant -2147483648 : i64 loc(#loc145)
      %b_306 = arith.cmpi sle, %b_303, %b_304 : i64 loc(#loc145)
      %b_307 = arith.cmpi sge, %b_303, %b_305 : i64 loc(#loc145)
      %b_308 = arith.andi %b_306, %b_307 : i1 loc(#loc145)
      %b_309 = arith.muli %k, %b_300 : i32 loc(#loc145)
      %b_310 = arith.extsi %K : i32 to i64 loc(#loc146)
      %b_311 = arith.extsi %b_309 : i32 to i64 loc(#loc146)
      %b_312 = arith.subi %b_310, %b_311 : i64 loc(#loc146)
      %b_313 = arith.constant 2147483647 : i64 loc(#loc146)
      %b_314 = arith.constant -2147483648 : i64 loc(#loc146)
      %b_315 = arith.cmpi sle, %b_312, %b_313 : i64 loc(#loc146)
      %b_316 = arith.cmpi sge, %b_312, %b_314 : i64 loc(#loc146)
      %b_317 = arith.andi %b_315, %b_316 : i1 loc(#loc146)
      %b_318 = arith.subi %K, %b_309 : i32 loc(#loc146)
      %b_319 = tt.splat %b_318 : i32 -> tensor<64x1xi32> loc(#loc147)
      %b_320 = arith.cmpi slt, %b, %b_319 : tensor<64x1xi32> loc(#loc147)
      %b_321 = arith.constant 0.000000e+00 : f32 loc(#loc148)
      %b_322 = tt.broadcast %b_320 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc148)
      %b_323 = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc148)
      %b_324 = arith.truncf %b_323 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc148)
      %b_325 = tt.load %b_ptrs_270, %b_322, %b_324 : tensor<64x32x!tt.ptr<f16>> loc(#loc148)
      %accumulator_326 = arith.constant 0.000000e+00 : f32 loc(#loc149)
      %accumulator_327 = tt.dot %a_298, %b_325, %accumulator_271, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc149)
      %a_ptrs_328 = arith.constant 64 : i32 loc(#loc150)
      %a_ptrs_329 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc150)
      %a_ptrs_330 = tt.addptr %a_ptrs_269, %a_ptrs_329 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc150)
      %b_ptrs_331 = arith.constant 64 : i32 loc(#loc151)
      %b_ptrs_332 = arith.constant 64 : i32 loc(#loc151)
      %b_ptrs_333 = arith.extsi %b_ptrs_332 : i32 to i64 loc(#loc151)
      %b_ptrs_334 = arith.extsi %stride_bk : i32 to i64 loc(#loc151)
      %b_ptrs_335 = arith.muli %b_ptrs_333, %b_ptrs_334 : i64 loc(#loc151)
      %b_ptrs_336 = arith.constant 2147483647 : i64 loc(#loc151)
      %b_ptrs_337 = arith.constant -2147483648 : i64 loc(#loc151)
      %b_ptrs_338 = arith.cmpi sle, %b_ptrs_335, %b_ptrs_336 : i64 loc(#loc151)
      %b_ptrs_339 = arith.cmpi sge, %b_ptrs_335, %b_ptrs_337 : i64 loc(#loc151)
      %b_ptrs_340 = arith.andi %b_ptrs_338, %b_ptrs_339 : i1 loc(#loc151)
      %b_ptrs_341 = arith.muli %b_ptrs_332, %stride_bk : i32 loc(#loc151)
      %b_ptrs_342 = tt.splat %b_ptrs_341 : i32 -> tensor<64x32xi32> loc(#loc152)
      %b_ptrs_343 = tt.addptr %b_ptrs_270, %b_ptrs_342 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc152)
      scf.yield %a_ptrs_330, %b_ptrs_343, %accumulator_327 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc65)
    } loc(#loc173)
    %c = arith.truncf %accumulator_182#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc153)
    %offs_cm = arith.constant 64 : i32 loc(#loc154)
    %offs_cm_183 = arith.constant 64 : i32 loc(#loc154)
    %offs_cm_184 = arith.extsi %pid_m_39 : i32 to i64 loc(#loc154)
    %offs_cm_185 = arith.extsi %offs_cm_183 : i32 to i64 loc(#loc154)
    %offs_cm_186 = arith.muli %offs_cm_184, %offs_cm_185 : i64 loc(#loc154)
    %offs_cm_187 = arith.constant 2147483647 : i64 loc(#loc154)
    %offs_cm_188 = arith.constant -2147483648 : i64 loc(#loc154)
    %offs_cm_189 = arith.cmpi sle, %offs_cm_186, %offs_cm_187 : i64 loc(#loc154)
    %offs_cm_190 = arith.cmpi sge, %offs_cm_186, %offs_cm_188 : i64 loc(#loc154)
    %offs_cm_191 = arith.andi %offs_cm_189, %offs_cm_190 : i1 loc(#loc154)
    %offs_cm_192 = arith.muli %pid_m_39, %offs_cm_183 : i32 loc(#loc154)
    %offs_cm_193 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc155)
    %offs_cm_194 = tt.splat %offs_cm_192 : i32 -> tensor<64xi32> loc(#loc156)
    %offs_cm_195 = arith.extsi %offs_cm_194 : tensor<64xi32> to tensor<64xi64> loc(#loc156)
    %offs_cm_196 = arith.extsi %offs_cm_193 : tensor<64xi32> to tensor<64xi64> loc(#loc156)
    %offs_cm_197 = arith.addi %offs_cm_195, %offs_cm_196 : tensor<64xi64> loc(#loc156)
    %offs_cm_198 = arith.constant 2147483647 : i64 loc(#loc156)
    %offs_cm_199 = arith.constant -2147483648 : i64 loc(#loc156)
    %offs_cm_200 = arith.constant dense<2147483647> : tensor<64xi64> loc(#loc156)
    %offs_cm_201 = arith.cmpi sle, %offs_cm_197, %offs_cm_200 : tensor<64xi64> loc(#loc156)
    %offs_cm_202 = arith.constant dense<-2147483648> : tensor<64xi64> loc(#loc156)
    %offs_cm_203 = arith.cmpi sge, %offs_cm_197, %offs_cm_202 : tensor<64xi64> loc(#loc156)
    %offs_cm_204 = arith.andi %offs_cm_201, %offs_cm_203 : tensor<64xi1> loc(#loc156)
    %offs_cm_205 = arith.addi %offs_cm_194, %offs_cm_193 : tensor<64xi32> loc(#loc156)
    %offs_cn = arith.constant 32 : i32 loc(#loc157)
    %offs_cn_206 = arith.constant 32 : i32 loc(#loc157)
    %offs_cn_207 = arith.extsi %pid_n_40 : i32 to i64 loc(#loc157)
    %offs_cn_208 = arith.extsi %offs_cn_206 : i32 to i64 loc(#loc157)
    %offs_cn_209 = arith.muli %offs_cn_207, %offs_cn_208 : i64 loc(#loc157)
    %offs_cn_210 = arith.constant 2147483647 : i64 loc(#loc157)
    %offs_cn_211 = arith.constant -2147483648 : i64 loc(#loc157)
    %offs_cn_212 = arith.cmpi sle, %offs_cn_209, %offs_cn_210 : i64 loc(#loc157)
    %offs_cn_213 = arith.cmpi sge, %offs_cn_209, %offs_cn_211 : i64 loc(#loc157)
    %offs_cn_214 = arith.andi %offs_cn_212, %offs_cn_213 : i1 loc(#loc157)
    %offs_cn_215 = arith.muli %pid_n_40, %offs_cn_206 : i32 loc(#loc157)
    %offs_cn_216 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc158)
    %offs_cn_217 = tt.splat %offs_cn_215 : i32 -> tensor<32xi32> loc(#loc159)
    %offs_cn_218 = arith.extsi %offs_cn_217 : tensor<32xi32> to tensor<32xi64> loc(#loc159)
    %offs_cn_219 = arith.extsi %offs_cn_216 : tensor<32xi32> to tensor<32xi64> loc(#loc159)
    %offs_cn_220 = arith.addi %offs_cn_218, %offs_cn_219 : tensor<32xi64> loc(#loc159)
    %offs_cn_221 = arith.constant 2147483647 : i64 loc(#loc159)
    %offs_cn_222 = arith.constant -2147483648 : i64 loc(#loc159)
    %offs_cn_223 = arith.constant dense<2147483647> : tensor<32xi64> loc(#loc159)
    %offs_cn_224 = arith.cmpi sle, %offs_cn_220, %offs_cn_223 : tensor<32xi64> loc(#loc159)
    %offs_cn_225 = arith.constant dense<-2147483648> : tensor<32xi64> loc(#loc159)
    %offs_cn_226 = arith.cmpi sge, %offs_cn_220, %offs_cn_225 : tensor<32xi64> loc(#loc159)
    %offs_cn_227 = arith.andi %offs_cn_224, %offs_cn_226 : tensor<32xi1> loc(#loc159)
    %offs_cn_228 = arith.addi %offs_cn_217, %offs_cn_216 : tensor<32xi32> loc(#loc159)
    %c_ptrs = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc160)
    %c_ptrs_229 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc161)
    %c_ptrs_230 = arith.extsi %c_ptrs_229 : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc161)
    %c_ptrs_231 = arith.extsi %c_ptrs : tensor<64x1xi32> to tensor<64x1xi64> loc(#loc161)
    %c_ptrs_232 = arith.muli %c_ptrs_230, %c_ptrs_231 : tensor<64x1xi64> loc(#loc161)
    %c_ptrs_233 = arith.constant 2147483647 : i64 loc(#loc161)
    %c_ptrs_234 = arith.constant -2147483648 : i64 loc(#loc161)
    %c_ptrs_235 = arith.constant dense<2147483647> : tensor<64x1xi64> loc(#loc161)
    %c_ptrs_236 = arith.cmpi sle, %c_ptrs_232, %c_ptrs_235 : tensor<64x1xi64> loc(#loc161)
    %c_ptrs_237 = arith.constant dense<-2147483648> : tensor<64x1xi64> loc(#loc161)
    %c_ptrs_238 = arith.cmpi sge, %c_ptrs_232, %c_ptrs_237 : tensor<64x1xi64> loc(#loc161)
    %c_ptrs_239 = arith.andi %c_ptrs_236, %c_ptrs_238 : tensor<64x1xi1> loc(#loc161)
    %c_ptrs_240 = arith.muli %c_ptrs_229, %c_ptrs : tensor<64x1xi32> loc(#loc161)
    %c_ptrs_241 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc162)
    %c_ptrs_242 = tt.addptr %c_ptrs_241, %c_ptrs_240 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc162)
    %c_ptrs_243 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc163)
    %c_ptrs_244 = arith.constant 1 : i32 loc(#loc164)
    %c_ptrs_245 = arith.constant 1 : i32 loc(#loc164)
    %c_ptrs_246 = arith.constant dense<1> : tensor<1x32xi32> loc(#loc164)
    %c_ptrs_247 = arith.extsi %c_ptrs_246 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc164)
    %c_ptrs_248 = arith.extsi %c_ptrs_243 : tensor<1x32xi32> to tensor<1x32xi64> loc(#loc164)
    %c_ptrs_249 = arith.muli %c_ptrs_247, %c_ptrs_248 : tensor<1x32xi64> loc(#loc164)
    %c_ptrs_250 = arith.constant 2147483647 : i64 loc(#loc164)
    %c_ptrs_251 = arith.constant -2147483648 : i64 loc(#loc164)
    %c_ptrs_252 = arith.constant dense<2147483647> : tensor<1x32xi64> loc(#loc164)
    %c_ptrs_253 = arith.cmpi sle, %c_ptrs_249, %c_ptrs_252 : tensor<1x32xi64> loc(#loc164)
    %c_ptrs_254 = arith.constant dense<-2147483648> : tensor<1x32xi64> loc(#loc164)
    %c_ptrs_255 = arith.cmpi sge, %c_ptrs_249, %c_ptrs_254 : tensor<1x32xi64> loc(#loc164)
    %c_ptrs_256 = arith.andi %c_ptrs_253, %c_ptrs_255 : tensor<1x32xi1> loc(#loc164)
    %c_ptrs_257 = arith.muli %c_ptrs_246, %c_ptrs_243 : tensor<1x32xi32> loc(#loc164)
    %c_ptrs_258 = tt.broadcast %c_ptrs_242 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc165)
    %c_ptrs_259 = tt.broadcast %c_ptrs_257 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc165)
    %c_ptrs_260 = tt.addptr %c_ptrs_258, %c_ptrs_259 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc165)
    %c_mask = tt.expand_dims %offs_cm_205 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc166)
    %c_mask_261 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc167)
    %c_mask_262 = arith.cmpi slt, %c_mask, %c_mask_261 : tensor<64x1xi32> loc(#loc167)
    %c_mask_263 = tt.expand_dims %offs_cn_228 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc168)
    %c_mask_264 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc169)
    %c_mask_265 = arith.cmpi slt, %c_mask_263, %c_mask_264 : tensor<1x32xi32> loc(#loc169)
    %c_mask_266 = tt.broadcast %c_mask_262 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc170)
    %c_mask_267 = tt.broadcast %c_mask_265 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc170)
    %c_mask_268 = arith.andi %c_mask_266, %c_mask_267 : tensor<64x32xi1> loc(#loc170)
    tt.store %c_ptrs_260, %c, %c_mask_268 : tensor<64x32x!tt.ptr<f16>> loc(#loc84)
    tt.return loc(#loc85)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c64_i32 = arith.constant 64 : i32 loc(#loc87)
    %c63_i32 = arith.constant 63 : i32 loc(#loc87)
    %0 = arith.addi %x, %c63_i32 : i32 loc(#loc88)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc89)
    tt.return %1 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.cdiv__i32_c32(%x: i32 loc("x"(#loc86))) -> i32 attributes {noinline = false} {
    %c32_i32 = arith.constant 32 : i32 loc(#loc87)
    %c31_i32 = arith.constant 31 : i32 loc(#loc87)
    %0 = arith.addi %x, %c31_i32 : i32 loc(#loc88)
    %1 = arith.divsi %0, %c32_i32 : i32 loc(#loc89)
    tt.return %1 : i32 loc(#loc90)
  } loc(#loc86)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} {
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc92)
    tt.return %cst : tensor<64x32xf32> loc(#loc93)
  } loc(#loc91)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:71)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:71)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:64)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc(unknown)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc89 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc90 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:11)
#loc91 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc92 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc93 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:11)
#loc103 = loc("pid"(#loc1))
#loc104 = loc("num_pid_m"(#loc2))
#loc105 = loc("num_pid_n"(#loc3))
#loc106 = loc("num_pid_in_group"(#loc4))
#loc107 = loc("group_id"(#loc5))
#loc108 = loc("first_pid_m"(#loc6))
#loc109 = loc("group_size_m"(#loc7))
#loc110 = loc("group_size_m"(#loc8))
#loc111 = loc("pid_m"(#loc9))
#loc112 = loc("pid_m"(#loc10))
#loc113 = loc("pid_m"(#loc11))
#loc114 = loc("pid_n"(#loc12))
#loc115 = loc("pid_n"(#loc13))
#loc116 = loc("offs_am"(#loc27))
#loc117 = loc("offs_am"(#loc28))
#loc118 = loc("offs_am"(#loc29))
#loc119 = loc("offs_am"(#loc30))
#loc120 = loc("offs_bn"(#loc31))
#loc121 = loc("offs_bn"(#loc32))
#loc122 = loc("offs_bn"(#loc33))
#loc123 = loc("offs_bn"(#loc34))
#loc124 = loc("offs_k"(#loc35))
#loc125 = loc("a_ptrs"(#loc36))
#loc126 = loc("a_ptrs"(#loc37))
#loc127 = loc("a_ptrs"(#loc38))
#loc128 = loc("a_ptrs"(#loc39))
#loc129 = loc("a_ptrs"(#loc40))
#loc130 = loc("a_ptrs"(#loc41))
#loc131 = loc("b_ptrs"(#loc42))
#loc132 = loc("b_ptrs"(#loc43))
#loc133 = loc("b_ptrs"(#loc44))
#loc134 = loc("b_ptrs"(#loc45))
#loc135 = loc("b_ptrs"(#loc46))
#loc136 = loc("b_ptrs"(#loc47))
#loc137 = loc("accumulator"(#loc48))
#loc138 = loc("a_ptrs"(#loc50))
#loc139 = loc("a"(#loc51))
#loc140 = loc("a"(#loc52))
#loc141 = loc("a"(#loc53))
#loc142 = loc("a"(#loc54))
#loc143 = loc("a"(#loc55))
#loc144 = loc("b"(#loc56))
#loc145 = loc("b"(#loc57))
#loc146 = loc("b"(#loc58))
#loc147 = loc("b"(#loc59))
#loc148 = loc("b"(#loc60))
#loc149 = loc("accumulator"(#loc61))
#loc150 = loc("a_ptrs"(#loc62))
#loc151 = loc("b_ptrs"(#loc63))
#loc152 = loc("b_ptrs"(#loc64))
#loc153 = loc("c"(#loc66))
#loc154 = loc("offs_cm"(#loc67))
#loc155 = loc("offs_cm"(#loc68))
#loc156 = loc("offs_cm"(#loc69))
#loc157 = loc("offs_cn"(#loc70))
#loc158 = loc("offs_cn"(#loc71))
#loc159 = loc("offs_cn"(#loc72))
#loc160 = loc("c_ptrs"(#loc73))
#loc161 = loc("c_ptrs"(#loc74))
#loc162 = loc("c_ptrs"(#loc75))
#loc163 = loc("c_ptrs"(#loc76))
#loc164 = loc("c_ptrs"(#loc77))
#loc165 = loc("c_ptrs"(#loc78))
#loc166 = loc("c_mask"(#loc79))
#loc167 = loc("c_mask"(#loc80))
#loc168 = loc("c_mask"(#loc81))
#loc169 = loc("c_mask"(#loc82))
#loc170 = loc("c_mask"(#loc83))
#loc172 = loc("b_ptrs"(#loc138))
#loc173 = loc("accumulator"(#loc172))


// -----// IR Dump Before Canonicalizer (canonicalize) ('tt.func' operation: @matmul_kernel) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc89 = loc("a_ptr"(#loc))
#loc90 = loc("b_ptr"(#loc))
#loc91 = loc("c_ptr"(#loc))
#loc92 = loc("M"(#loc))
#loc93 = loc("N"(#loc))
#loc94 = loc("K"(#loc))
#loc95 = loc("stride_am"(#loc))
#loc96 = loc("stride_bk"(#loc))
#loc97 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.constant 64 : i32 loc(#loc166)
    %num_pid_m_2 = arith.constant 63 : i32 loc(#loc166)
    %num_pid_m_3 = arith.addi %M, %num_pid_m_2 : i32 loc(#loc167)
    %num_pid_m_4 = arith.divsi %num_pid_m_3, %num_pid_m : i32 loc(#loc168)
    %num_pid_n = arith.constant 32 : i32 loc(#loc169)
    %num_pid_n_5 = arith.constant 31 : i32 loc(#loc169)
    %num_pid_n_6 = arith.addi %N, %num_pid_n_5 : i32 loc(#loc170)
    %num_pid_n_7 = arith.divsi %num_pid_n_6, %num_pid_n : i32 loc(#loc171)
    %num_pid_in_group = arith.muli %num_pid_n_7, %c4_i32 : i32 loc(#loc101)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc102)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc103)
    %group_size_m = arith.subi %num_pid_m_4, %first_pid_m : i32 loc(#loc104)
    %group_size_m_8 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc105)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc106)
    %pid_m_9 = arith.remsi %pid_m, %group_size_m_8 : i32 loc(#loc107)
    %pid_m_10 = arith.addi %first_pid_m, %pid_m_9 : i32 loc(#loc108)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc109)
    %pid_n_11 = arith.divsi %pid_n, %group_size_m_8 : i32 loc(#loc110)
    %0 = arith.cmpi sge, %pid_m_10, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n_11, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_10, %c64_i32 : i32 loc(#loc111)
    %offs_am_12 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc112)
    %offs_am_13 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_14 = arith.addi %offs_am_13, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_am_15 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc114)
    %offs_am_16 = arith.remsi %offs_am_14, %offs_am_15 : tensor<64xi32> loc(#loc114)
    %offs_bn = arith.muli %pid_n_11, %c32_i32 : i32 loc(#loc115)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc116)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_19 = arith.addi %offs_bn_18, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc118)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32> loc(#loc118)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc119)
    %a_ptrs = tt.expand_dims %offs_am_16 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_22 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc121)
    %a_ptrs_23 = arith.muli %a_ptrs, %a_ptrs_22 : tensor<64x1xi32> loc(#loc121)
    %a_ptrs_24 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.broadcast %a_ptrs_23 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc123)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc123)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32> loc(#loc123)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc124)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc124)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_30 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc126)
    %b_ptrs_31 = arith.muli %b_ptrs, %b_ptrs_30 : tensor<64x1xi32> loc(#loc126)
    %b_ptrs_32 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.broadcast %b_ptrs_31 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc128)
    %b_ptrs_34 = tt.broadcast %b_ptrs_32 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc128)
    %b_ptrs_35 = arith.addi %b_ptrs_33, %b_ptrs_34 : tensor<64x32xi32> loc(#loc128)
    %b_ptrs_36 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc129)
    %b_ptrs_37 = tt.addptr %b_ptrs_36, %b_ptrs_35 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc129)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc172)
    %c64_i32_38 = arith.constant 64 : i32 loc(#loc131)
    %c63_i32 = arith.constant 63 : i32 loc(#loc131)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc132)
    %6 = arith.divsi %5, %c64_i32_38 : i32 loc(#loc133)
    %accumulator_39:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_37, %accumulator_64 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc135)
      %a_65 = arith.muli %k, %c64_i32 : i32 loc(#loc136)
      %a_66 = arith.subi %K, %a_65 : i32 loc(#loc137)
      %a_67 = tt.splat %a_66 : i32 -> tensor<1x64xi32> loc(#loc138)
      %a_68 = arith.cmpi slt, %a, %a_67 : tensor<1x64xi32> loc(#loc138)
      %a_69 = tt.broadcast %a_68 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc139)
      %a_70 = tt.load %a_ptrs_62, %a_69, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc139)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc140)
      %b_71 = arith.muli %k, %c64_i32 : i32 loc(#loc141)
      %b_72 = arith.subi %K, %b_71 : i32 loc(#loc142)
      %b_73 = tt.splat %b_72 : i32 -> tensor<64x1xi32> loc(#loc143)
      %b_74 = arith.cmpi slt, %b, %b_73 : tensor<64x1xi32> loc(#loc143)
      %b_75 = tt.broadcast %b_74 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc144)
      %b_76 = tt.load %b_ptrs_63, %b_75, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc144)
      %accumulator_77 = tt.dot %a_70, %b_76, %accumulator_64, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc145)
      %a_ptrs_78 = tt.addptr %a_ptrs_62, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc146)
      %b_ptrs_79 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc147)
      %b_ptrs_80 = tt.splat %b_ptrs_79 : i32 -> tensor<64x32xi32> loc(#loc148)
      %b_ptrs_81 = tt.addptr %b_ptrs_63, %b_ptrs_80 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc148)
      scf.yield %a_ptrs_78, %b_ptrs_81, %accumulator_77 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc174)
    %c = arith.truncf %accumulator_39#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc149)
    %offs_cm = arith.muli %pid_m_10, %c64_i32 : i32 loc(#loc150)
    %offs_cm_40 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc151)
    %offs_cm_41 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc152)
    %offs_cm_42 = arith.addi %offs_cm_41, %offs_cm_40 : tensor<64xi32> loc(#loc152)
    %offs_cn = arith.muli %pid_n_11, %c32_i32 : i32 loc(#loc153)
    %offs_cn_43 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc154)
    %offs_cn_44 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc155)
    %offs_cn_45 = arith.addi %offs_cn_44, %offs_cn_43 : tensor<32xi32> loc(#loc155)
    %c_ptrs = tt.expand_dims %offs_cm_42 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc156)
    %c_ptrs_46 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc157)
    %c_ptrs_47 = arith.muli %c_ptrs_46, %c_ptrs : tensor<64x1xi32> loc(#loc157)
    %c_ptrs_48 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc158)
    %c_ptrs_49 = tt.addptr %c_ptrs_48, %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc158)
    %c_ptrs_50 = tt.expand_dims %offs_cn_45 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc159)
    %c_ptrs_51 = tt.broadcast %c_ptrs_49 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc160)
    %c_ptrs_52 = tt.broadcast %c_ptrs_50 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc160)
    %c_ptrs_53 = tt.addptr %c_ptrs_51, %c_ptrs_52 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc160)
    %c_mask = tt.expand_dims %offs_cm_42 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc161)
    %c_mask_54 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc162)
    %c_mask_55 = arith.cmpi slt, %c_mask, %c_mask_54 : tensor<64x1xi32> loc(#loc162)
    %c_mask_56 = tt.expand_dims %offs_cn_45 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc163)
    %c_mask_57 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc164)
    %c_mask_58 = arith.cmpi slt, %c_mask_56, %c_mask_57 : tensor<1x32xi32> loc(#loc164)
    %c_mask_59 = tt.broadcast %c_mask_55 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc165)
    %c_mask_60 = tt.broadcast %c_mask_58 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc165)
    %c_mask_61 = arith.andi %c_mask_59, %c_mask_60 : tensor<64x32xi1> loc(#loc165)
    tt.store %c_ptrs_53, %c, %c_mask_61 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
  tt.func private @triton.language.standard.cdiv__i32_c64(i32) -> i32 attributes {noinline = false} loc(#loc87)
  tt.func private @triton.language.standard.cdiv__i32_c32(i32) -> i32 attributes {noinline = false} loc(#loc87)
  tt.func private @triton.language.standard.zeros__Tc64_c32T_cfp32() -> tensor<64x32xf32> attributes {noinline = false} loc(#loc88)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc5 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc87 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":34:0)
#loc88 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":120:0)
#loc98 = loc("pid"(#loc3))
#loc99 = loc("num_pid_m"(#loc4))
#loc100 = loc("num_pid_n"(#loc7))
#loc101 = loc("num_pid_in_group"(#loc8))
#loc102 = loc("group_id"(#loc9))
#loc103 = loc("first_pid_m"(#loc10))
#loc104 = loc("group_size_m"(#loc11))
#loc105 = loc("group_size_m"(#loc12))
#loc106 = loc("pid_m"(#loc13))
#loc107 = loc("pid_m"(#loc14))
#loc108 = loc("pid_m"(#loc15))
#loc109 = loc("pid_n"(#loc16))
#loc110 = loc("pid_n"(#loc17))
#loc111 = loc("offs_am"(#loc31))
#loc112 = loc("offs_am"(#loc32))
#loc113 = loc("offs_am"(#loc33))
#loc114 = loc("offs_am"(#loc34))
#loc115 = loc("offs_bn"(#loc35))
#loc116 = loc("offs_bn"(#loc36))
#loc117 = loc("offs_bn"(#loc37))
#loc118 = loc("offs_bn"(#loc38))
#loc119 = loc("offs_k"(#loc39))
#loc120 = loc("a_ptrs"(#loc40))
#loc121 = loc("a_ptrs"(#loc41))
#loc122 = loc("a_ptrs"(#loc42))
#loc123 = loc("a_ptrs"(#loc43))
#loc124 = loc("a_ptrs"(#loc44))
#loc125 = loc("b_ptrs"(#loc45))
#loc126 = loc("b_ptrs"(#loc46))
#loc127 = loc("b_ptrs"(#loc47))
#loc128 = loc("b_ptrs"(#loc48))
#loc129 = loc("b_ptrs"(#loc49))
#loc130 = loc("accumulator"(#loc51))
#loc131 = loc(callsite(#loc1 at #loc52))
#loc132 = loc(callsite(#loc5 at #loc52))
#loc133 = loc(callsite(#loc6 at #loc52))
#loc134 = loc("a_ptrs"(#loc2))
#loc135 = loc("a"(#loc53))
#loc136 = loc("a"(#loc54))
#loc137 = loc("a"(#loc55))
#loc138 = loc("a"(#loc56))
#loc139 = loc("a"(#loc57))
#loc140 = loc("b"(#loc58))
#loc141 = loc("b"(#loc59))
#loc142 = loc("b"(#loc60))
#loc143 = loc("b"(#loc61))
#loc144 = loc("b"(#loc62))
#loc145 = loc("accumulator"(#loc63))
#loc146 = loc("a_ptrs"(#loc64))
#loc147 = loc("b_ptrs"(#loc65))
#loc148 = loc("b_ptrs"(#loc66))
#loc149 = loc("c"(#loc68))
#loc150 = loc("offs_cm"(#loc69))
#loc151 = loc("offs_cm"(#loc70))
#loc152 = loc("offs_cm"(#loc71))
#loc153 = loc("offs_cn"(#loc72))
#loc154 = loc("offs_cn"(#loc73))
#loc155 = loc("offs_cn"(#loc74))
#loc156 = loc("c_ptrs"(#loc75))
#loc157 = loc("c_ptrs"(#loc76))
#loc158 = loc("c_ptrs"(#loc77))
#loc159 = loc("c_ptrs"(#loc78))
#loc160 = loc("c_ptrs"(#loc79))
#loc161 = loc("c_mask"(#loc80))
#loc162 = loc("c_mask"(#loc81))
#loc163 = loc("c_mask"(#loc82))
#loc164 = loc("c_mask"(#loc83))
#loc165 = loc("c_mask"(#loc84))
#loc166 = loc(callsite(#loc1 at #loc99))
#loc167 = loc(callsite(#loc5 at #loc99))
#loc168 = loc(callsite(#loc6 at #loc99))
#loc169 = loc(callsite(#loc1 at #loc100))
#loc170 = loc(callsite(#loc5 at #loc100))
#loc171 = loc(callsite(#loc6 at #loc100))
#loc172 = loc(callsite(#loc50 at #loc130))
#loc173 = loc("b_ptrs"(#loc134))
#loc174 = loc("accumulator"(#loc173))


// -----// IR Dump Before TritonRewriteTensorPointer (triton-rewrite-tensor-pointer) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before TritonRewriteTensorDescriptorToPointer (triton-rewrite-tensor-descriptor-to-pointer) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before TritonCombineOps (triton-combine) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before TritonReorderBroadcast (triton-reorder-broadcast) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before CSE (cse) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc87 = loc("a_ptr"(#loc))
#loc88 = loc("b_ptr"(#loc))
#loc89 = loc("c_ptr"(#loc))
#loc90 = loc("M"(#loc))
#loc91 = loc("N"(#loc))
#loc92 = loc("K"(#loc))
#loc93 = loc("stride_am"(#loc))
#loc94 = loc("stride_bk"(#loc))
#loc95 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc163)
    %num_pid_n = arith.constant 31 : i32 loc(#loc164)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc98)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc165)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc166)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc167)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc168)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc100)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc101)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc102)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc103)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc104)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc105)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc106)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc107)
    %pid_n = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc108)
    %pid_n_8 = arith.divsi %pid_n, %group_size_m_5 : i32 loc(#loc109)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %0 : i1 loc(#loc21)
    %1 = arith.cmpi sge, %pid_n_8, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %1 : i1 loc(#loc23)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc24)
    llvm.intr.assume %2 : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    llvm.intr.assume %true : i1 loc(#loc27)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %3 : i1 loc(#loc29)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc30)
    llvm.intr.assume %4 : i1 loc(#loc31)
    llvm.intr.assume %true : i1 loc(#loc32)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc110)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc111)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc112)
    %offs_am_11 = arith.addi %offs_am_10, %offs_am_9 : tensor<64xi32> loc(#loc112)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc113)
    %offs_am_13 = arith.remsi %offs_am_11, %offs_am_12 : tensor<64xi32> loc(#loc113)
    %offs_bn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc114)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc115)
    %offs_bn_15 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc116)
    %offs_bn_16 = arith.addi %offs_bn_15, %offs_bn_14 : tensor<32xi32> loc(#loc116)
    %offs_bn_17 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc117)
    %offs_bn_18 = arith.remsi %offs_bn_16, %offs_bn_17 : tensor<32xi32> loc(#loc117)
    %offs_k = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc118)
    %a_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc119)
    %a_ptrs_19 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc120)
    %a_ptrs_20 = arith.muli %a_ptrs, %a_ptrs_19 : tensor<64x1xi32> loc(#loc120)
    %a_ptrs_21 = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc121)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_23 = tt.broadcast %a_ptrs_21 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc122)
    %a_ptrs_24 = arith.addi %a_ptrs_22, %a_ptrs_23 : tensor<64x64xi32> loc(#loc122)
    %a_ptrs_25 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc123)
    %a_ptrs_26 = tt.addptr %a_ptrs_25, %a_ptrs_24 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
    %b_ptrs = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc124)
    %b_ptrs_27 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc125)
    %b_ptrs_28 = arith.muli %b_ptrs, %b_ptrs_27 : tensor<64x1xi32> loc(#loc125)
    %b_ptrs_29 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc126)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_31 = tt.broadcast %b_ptrs_29 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc127)
    %b_ptrs_32 = arith.addi %b_ptrs_30, %b_ptrs_31 : tensor<64x32xi32> loc(#loc127)
    %b_ptrs_33 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc128)
    %b_ptrs_34 = tt.addptr %b_ptrs_33, %b_ptrs_32 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc128)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc129)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc130)
    %accumulator_35:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_58 = %a_ptrs_26, %b_ptrs_59 = %b_ptrs_34, %accumulator_60 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = tt.expand_dims %offs_k {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc132)
      %a_61 = arith.muli %k, %c64_i32 : i32 loc(#loc133)
      %a_62 = arith.subi %K, %a_61 : i32 loc(#loc134)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32> loc(#loc135)
      %a_64 = arith.cmpi slt, %a, %a_63 : tensor<1x64xi32> loc(#loc135)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc136)
      %a_66 = tt.load %a_ptrs_58, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc136)
      %b = tt.expand_dims %offs_k {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc137)
      %b_67 = arith.muli %k, %c64_i32 : i32 loc(#loc138)
      %b_68 = arith.subi %K, %b_67 : i32 loc(#loc139)
      %b_69 = tt.splat %b_68 : i32 -> tensor<64x1xi32> loc(#loc140)
      %b_70 = arith.cmpi slt, %b, %b_69 : tensor<64x1xi32> loc(#loc140)
      %b_71 = tt.broadcast %b_70 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc141)
      %b_72 = tt.load %b_ptrs_59, %b_71, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc141)
      %accumulator_73 = tt.dot %a_66, %b_72, %accumulator_60, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc142)
      %a_ptrs_74 = tt.addptr %a_ptrs_58, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc143)
      %b_ptrs_75 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc144)
      %b_ptrs_76 = tt.splat %b_ptrs_75 : i32 -> tensor<64x32xi32> loc(#loc145)
      %b_ptrs_77 = tt.addptr %b_ptrs_59, %b_ptrs_76 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc145)
      scf.yield %a_ptrs_74, %b_ptrs_77, %accumulator_73 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc67)
    } loc(#loc170)
    %c = arith.truncf %accumulator_35#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc146)
    %offs_cm = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc147)
    %offs_cm_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc148)
    %offs_cm_37 = tt.splat %offs_cm : i32 -> tensor<64xi32> loc(#loc149)
    %offs_cm_38 = arith.addi %offs_cm_37, %offs_cm_36 : tensor<64xi32> loc(#loc149)
    %offs_cn = arith.muli %pid_n_8, %c32_i32 : i32 loc(#loc150)
    %offs_cn_39 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc151)
    %offs_cn_40 = tt.splat %offs_cn : i32 -> tensor<32xi32> loc(#loc152)
    %offs_cn_41 = arith.addi %offs_cn_40, %offs_cn_39 : tensor<32xi32> loc(#loc152)
    %c_ptrs = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc153)
    %c_ptrs_42 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc154)
    %c_ptrs_43 = arith.muli %c_ptrs_42, %c_ptrs : tensor<64x1xi32> loc(#loc154)
    %c_ptrs_44 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc155)
    %c_ptrs_45 = tt.addptr %c_ptrs_44, %c_ptrs_43 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc155)
    %c_ptrs_46 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc156)
    %c_ptrs_47 = tt.broadcast %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc157)
    %c_ptrs_48 = tt.broadcast %c_ptrs_46 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc157)
    %c_ptrs_49 = tt.addptr %c_ptrs_47, %c_ptrs_48 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc157)
    %c_mask = tt.expand_dims %offs_cm_38 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc158)
    %c_mask_50 = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc159)
    %c_mask_51 = arith.cmpi slt, %c_mask, %c_mask_50 : tensor<64x1xi32> loc(#loc159)
    %c_mask_52 = tt.expand_dims %offs_cn_41 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc160)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc161)
    %c_mask_54 = arith.cmpi slt, %c_mask_52, %c_mask_53 : tensor<1x32xi32> loc(#loc161)
    %c_mask_55 = tt.broadcast %c_mask_51 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc162)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1> loc(#loc162)
    tt.store %c_ptrs_49, %c, %c_mask_57 : tensor<64x32x!tt.ptr<f16>> loc(#loc85)
    tt.return loc(#loc86)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:19)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":288:26)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:40)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:40)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:55)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:22)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:50)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":316:37)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:22)
#loc73 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:50)
#loc74 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":317:37)
#loc75 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc76 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc77 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc78 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc79 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc80 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:22)
#loc81 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc82 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:47)
#loc83 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc84 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc85 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc86 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc96 = loc("accumulator"(#loc2))
#loc97 = loc("num_pid_n"(#loc4))
#loc98 = loc("pid"(#loc6))
#loc99 = loc("num_pid_m"(#loc8))
#loc100 = loc("num_pid_in_group"(#loc10))
#loc101 = loc("group_id"(#loc11))
#loc102 = loc("first_pid_m"(#loc12))
#loc103 = loc("group_size_m"(#loc13))
#loc104 = loc("group_size_m"(#loc14))
#loc105 = loc("pid_m"(#loc15))
#loc106 = loc("pid_m"(#loc16))
#loc107 = loc("pid_m"(#loc17))
#loc108 = loc("pid_n"(#loc18))
#loc109 = loc("pid_n"(#loc19))
#loc110 = loc("offs_am"(#loc33))
#loc111 = loc("offs_am"(#loc34))
#loc112 = loc("offs_am"(#loc35))
#loc113 = loc("offs_am"(#loc36))
#loc114 = loc("offs_bn"(#loc37))
#loc115 = loc("offs_bn"(#loc38))
#loc116 = loc("offs_bn"(#loc39))
#loc117 = loc("offs_bn"(#loc40))
#loc118 = loc("offs_k"(#loc41))
#loc119 = loc("a_ptrs"(#loc42))
#loc120 = loc("a_ptrs"(#loc43))
#loc121 = loc("a_ptrs"(#loc44))
#loc122 = loc("a_ptrs"(#loc45))
#loc123 = loc("a_ptrs"(#loc46))
#loc124 = loc("b_ptrs"(#loc47))
#loc125 = loc("b_ptrs"(#loc48))
#loc126 = loc("b_ptrs"(#loc49))
#loc127 = loc("b_ptrs"(#loc50))
#loc128 = loc("b_ptrs"(#loc51))
#loc129 = loc(callsite(#loc7 at #loc52))
#loc130 = loc(callsite(#loc9 at #loc52))
#loc131 = loc("a_ptrs"(#loc5))
#loc132 = loc("a"(#loc53))
#loc133 = loc("a"(#loc54))
#loc134 = loc("a"(#loc55))
#loc135 = loc("a"(#loc56))
#loc136 = loc("a"(#loc57))
#loc137 = loc("b"(#loc58))
#loc138 = loc("b"(#loc59))
#loc139 = loc("b"(#loc60))
#loc140 = loc("b"(#loc61))
#loc141 = loc("b"(#loc62))
#loc142 = loc("accumulator"(#loc63))
#loc143 = loc("a_ptrs"(#loc64))
#loc144 = loc("b_ptrs"(#loc65))
#loc145 = loc("b_ptrs"(#loc66))
#loc146 = loc("c"(#loc68))
#loc147 = loc("offs_cm"(#loc69))
#loc148 = loc("offs_cm"(#loc70))
#loc149 = loc("offs_cm"(#loc71))
#loc150 = loc("offs_cn"(#loc72))
#loc151 = loc("offs_cn"(#loc73))
#loc152 = loc("offs_cn"(#loc74))
#loc153 = loc("c_ptrs"(#loc75))
#loc154 = loc("c_ptrs"(#loc76))
#loc155 = loc("c_ptrs"(#loc77))
#loc156 = loc("c_ptrs"(#loc78))
#loc157 = loc("c_ptrs"(#loc79))
#loc158 = loc("c_mask"(#loc80))
#loc159 = loc("c_mask"(#loc81))
#loc160 = loc("c_mask"(#loc82))
#loc161 = loc("c_mask"(#loc83))
#loc162 = loc("c_mask"(#loc84))
#loc163 = loc(callsite(#loc1 at #loc96))
#loc164 = loc(callsite(#loc3 at #loc97))
#loc165 = loc(callsite(#loc7 at #loc99))
#loc166 = loc(callsite(#loc9 at #loc99))
#loc167 = loc(callsite(#loc7 at #loc97))
#loc168 = loc(callsite(#loc9 at #loc97))
#loc169 = loc("b_ptrs"(#loc131))
#loc170 = loc("accumulator"(#loc169))


// -----// IR Dump Before TritonLoopInvariantCodeMotion (triton-licm) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_12 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc103)
    %a_ptrs_18 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc104)
    %a_ptrs_19 = arith.muli %a_ptrs, %a_ptrs_18 : tensor<64x1xi32> loc(#loc104)
    %a_ptrs_20 = tt.expand_dims %offs_am_8 {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc105)
    %a_ptrs_21 = tt.broadcast %a_ptrs_19 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_23 = arith.addi %a_ptrs_21, %a_ptrs_22 : tensor<64x64xi32> loc(#loc106)
    %a_ptrs_24 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc107)
    %a_ptrs_25 = tt.addptr %a_ptrs_24, %a_ptrs_23 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc107)
    %b_ptrs = tt.expand_dims %offs_am_8 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc108)
    %b_ptrs_26 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc109)
    %b_ptrs_27 = arith.muli %b_ptrs, %b_ptrs_26 : tensor<64x1xi32> loc(#loc109)
    %b_ptrs_28 = tt.expand_dims %offs_bn_17 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc110)
    %b_ptrs_29 = tt.broadcast %b_ptrs_27 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_31 = arith.addi %b_ptrs_29, %b_ptrs_30 : tensor<64x32xi32> loc(#loc111)
    %b_ptrs_32 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc112)
    %b_ptrs_33 = tt.addptr %b_ptrs_32, %b_ptrs_31 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %accumulator_34:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_49 = %a_ptrs_25, %b_ptrs_50 = %b_ptrs_33, %accumulator_51 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc116)
      %a_52 = arith.subi %K, %a : i32 loc(#loc117)
      %a_53 = tt.splat %a_52 : i32 -> tensor<1x64xi32> loc(#loc118)
      %a_54 = arith.cmpi slt, %a_ptrs_20, %a_53 : tensor<1x64xi32> loc(#loc118)
      %a_55 = tt.broadcast %a_54 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc119)
      %a_56 = tt.load %a_ptrs_49, %a_55, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc119)
      %b = tt.splat %a_52 : i32 -> tensor<64x1xi32> loc(#loc120)
      %b_57 = arith.cmpi slt, %b_ptrs, %b : tensor<64x1xi32> loc(#loc120)
      %b_58 = tt.broadcast %b_57 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc121)
      %b_59 = tt.load %b_ptrs_50, %b_58, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc121)
      %accumulator_60 = tt.dot %a_56, %b_59, %accumulator_51, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc122)
      %a_ptrs_61 = tt.addptr %a_ptrs_49, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc123)
      %b_ptrs_62 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc124)
      %b_ptrs_63 = tt.splat %b_ptrs_62 : i32 -> tensor<64x32xi32> loc(#loc125)
      %b_ptrs_64 = tt.addptr %b_ptrs_50, %b_ptrs_63 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc125)
      scf.yield %a_ptrs_61, %b_ptrs_64, %accumulator_60 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_34#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_10 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc127)
    %c_ptrs_35 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc128)
    %c_ptrs_36 = arith.muli %c_ptrs_35, %c_ptrs : tensor<64x1xi32> loc(#loc128)
    %c_ptrs_37 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc129)
    %c_ptrs_38 = tt.addptr %c_ptrs_37, %c_ptrs_36 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc129)
    %c_ptrs_39 = tt.expand_dims %offs_bn_15 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc130)
    %c_ptrs_40 = tt.broadcast %c_ptrs_38 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc131)
    %c_ptrs_41 = tt.broadcast %c_ptrs_39 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc131)
    %c_ptrs_42 = tt.addptr %c_ptrs_40, %c_ptrs_41 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc132)
    %c_mask_43 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32> loc(#loc132)
    %c_mask_44 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc133)
    %c_mask_45 = arith.cmpi slt, %c_ptrs_39, %c_mask_44 : tensor<1x32xi32> loc(#loc133)
    %c_mask_46 = tt.broadcast %c_mask_43 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_47 = tt.broadcast %c_mask_45 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_48 = arith.andi %c_mask_46, %c_mask_47 : tensor<64x32xi1> loc(#loc134)
    tt.store %c_ptrs_42, %c, %c_mask_48 : tensor<64x32x!tt.ptr<f16>> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("a_ptrs"(#loc5))
#loc116 = loc("a"(#loc51))
#loc117 = loc("a"(#loc52))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("b"(#loc55))
#loc121 = loc("b"(#loc56))
#loc122 = loc("accumulator"(#loc57))
#loc123 = loc("a_ptrs"(#loc58))
#loc124 = loc("b_ptrs"(#loc59))
#loc125 = loc("b_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc115))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before SymbolDCE (symbol-dce) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_12 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc103)
    %a_ptrs_18 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc104)
    %a_ptrs_19 = arith.muli %a_ptrs, %a_ptrs_18 : tensor<64x1xi32> loc(#loc104)
    %a_ptrs_20 = tt.expand_dims %offs_am_8 {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc105)
    %a_ptrs_21 = tt.broadcast %a_ptrs_19 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_23 = arith.addi %a_ptrs_21, %a_ptrs_22 : tensor<64x64xi32> loc(#loc106)
    %a_ptrs_24 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc107)
    %a_ptrs_25 = tt.addptr %a_ptrs_24, %a_ptrs_23 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc107)
    %b_ptrs = tt.expand_dims %offs_am_8 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc108)
    %b_ptrs_26 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc109)
    %b_ptrs_27 = arith.muli %b_ptrs, %b_ptrs_26 : tensor<64x1xi32> loc(#loc109)
    %b_ptrs_28 = tt.expand_dims %offs_bn_17 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc110)
    %b_ptrs_29 = tt.broadcast %b_ptrs_27 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_31 = arith.addi %b_ptrs_29, %b_ptrs_30 : tensor<64x32xi32> loc(#loc111)
    %b_ptrs_32 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc112)
    %b_ptrs_33 = tt.addptr %b_ptrs_32, %b_ptrs_31 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_34 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_35 = tt.splat %b_ptrs_34 : i32 -> tensor<64x32xi32> loc(#loc116)
    %accumulator_36:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_51 = %a_ptrs_25, %b_ptrs_52 = %b_ptrs_33, %accumulator_53 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_54 = arith.subi %K, %a : i32 loc(#loc119)
      %a_55 = tt.splat %a_54 : i32 -> tensor<1x64xi32> loc(#loc120)
      %a_56 = arith.cmpi slt, %a_ptrs_20, %a_55 : tensor<1x64xi32> loc(#loc120)
      %a_57 = tt.broadcast %a_56 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc121)
      %a_58 = tt.load %a_ptrs_51, %a_57, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc121)
      %b = tt.splat %a_54 : i32 -> tensor<64x1xi32> loc(#loc122)
      %b_59 = arith.cmpi slt, %b_ptrs, %b : tensor<64x1xi32> loc(#loc122)
      %b_60 = tt.broadcast %b_59 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc123)
      %b_61 = tt.load %b_ptrs_52, %b_60, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc123)
      %accumulator_62 = tt.dot %a_58, %b_61, %accumulator_53, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc124)
      %a_ptrs_63 = tt.addptr %a_ptrs_51, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc125)
      %b_ptrs_64 = tt.addptr %b_ptrs_52, %b_ptrs_35 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc116)
      scf.yield %a_ptrs_63, %b_ptrs_64, %accumulator_62 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_36#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_10 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc127)
    %c_ptrs_37 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc128)
    %c_ptrs_38 = arith.muli %c_ptrs_37, %c_ptrs : tensor<64x1xi32> loc(#loc128)
    %c_ptrs_39 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc129)
    %c_ptrs_40 = tt.addptr %c_ptrs_39, %c_ptrs_38 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc129)
    %c_ptrs_41 = tt.expand_dims %offs_bn_15 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc130)
    %c_ptrs_42 = tt.broadcast %c_ptrs_40 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc131)
    %c_ptrs_43 = tt.broadcast %c_ptrs_41 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc131)
    %c_ptrs_44 = tt.addptr %c_ptrs_42, %c_ptrs_43 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc132)
    %c_mask_45 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32> loc(#loc132)
    %c_mask_46 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc133)
    %c_mask_47 = arith.cmpi slt, %c_ptrs_41, %c_mask_46 : tensor<1x32xi32> loc(#loc133)
    %c_mask_48 = tt.broadcast %c_mask_45 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_49 = tt.broadcast %c_mask_47 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_50 = arith.andi %c_mask_48, %c_mask_49 : tensor<64x32xi1> loc(#loc134)
    tt.store %c_ptrs_44, %c, %c_mask_50 : tensor<64x32x!tt.ptr<f16>> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonLoopUnroll (triton-loop-unroll) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_12 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc103)
    %a_ptrs_18 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc104)
    %a_ptrs_19 = arith.muli %a_ptrs, %a_ptrs_18 : tensor<64x1xi32> loc(#loc104)
    %a_ptrs_20 = tt.expand_dims %offs_am_8 {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc105)
    %a_ptrs_21 = tt.broadcast %a_ptrs_19 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_23 = arith.addi %a_ptrs_21, %a_ptrs_22 : tensor<64x64xi32> loc(#loc106)
    %a_ptrs_24 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc107)
    %a_ptrs_25 = tt.addptr %a_ptrs_24, %a_ptrs_23 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc107)
    %b_ptrs = tt.expand_dims %offs_am_8 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc108)
    %b_ptrs_26 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc109)
    %b_ptrs_27 = arith.muli %b_ptrs, %b_ptrs_26 : tensor<64x1xi32> loc(#loc109)
    %b_ptrs_28 = tt.expand_dims %offs_bn_17 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc110)
    %b_ptrs_29 = tt.broadcast %b_ptrs_27 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_31 = arith.addi %b_ptrs_29, %b_ptrs_30 : tensor<64x32xi32> loc(#loc111)
    %b_ptrs_32 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc112)
    %b_ptrs_33 = tt.addptr %b_ptrs_32, %b_ptrs_31 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_34 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_35 = tt.splat %b_ptrs_34 : i32 -> tensor<64x32xi32> loc(#loc116)
    %accumulator_36:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_51 = %a_ptrs_25, %b_ptrs_52 = %b_ptrs_33, %accumulator_53 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_54 = arith.subi %K, %a : i32 loc(#loc119)
      %a_55 = tt.splat %a_54 : i32 -> tensor<1x64xi32> loc(#loc120)
      %a_56 = arith.cmpi slt, %a_ptrs_20, %a_55 : tensor<1x64xi32> loc(#loc120)
      %a_57 = tt.broadcast %a_56 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc121)
      %a_58 = tt.load %a_ptrs_51, %a_57, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc121)
      %b = tt.splat %a_54 : i32 -> tensor<64x1xi32> loc(#loc122)
      %b_59 = arith.cmpi slt, %b_ptrs, %b : tensor<64x1xi32> loc(#loc122)
      %b_60 = tt.broadcast %b_59 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc123)
      %b_61 = tt.load %b_ptrs_52, %b_60, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc123)
      %accumulator_62 = tt.dot %a_58, %b_61, %accumulator_53, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc124)
      %a_ptrs_63 = tt.addptr %a_ptrs_51, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc125)
      %b_ptrs_64 = tt.addptr %b_ptrs_52, %b_ptrs_35 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc116)
      scf.yield %a_ptrs_63, %b_ptrs_64, %accumulator_62 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_36#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_10 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc127)
    %c_ptrs_37 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc128)
    %c_ptrs_38 = arith.muli %c_ptrs_37, %c_ptrs : tensor<64x1xi32> loc(#loc128)
    %c_ptrs_39 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc129)
    %c_ptrs_40 = tt.addptr %c_ptrs_39, %c_ptrs_38 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc129)
    %c_ptrs_41 = tt.expand_dims %offs_bn_15 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc130)
    %c_ptrs_42 = tt.broadcast %c_ptrs_40 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc131)
    %c_ptrs_43 = tt.broadcast %c_ptrs_41 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc131)
    %c_ptrs_44 = tt.addptr %c_ptrs_42, %c_ptrs_43 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc132)
    %c_mask_45 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32> loc(#loc132)
    %c_mask_46 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc133)
    %c_mask_47 = arith.cmpi slt, %c_ptrs_41, %c_mask_46 : tensor<1x32xi32> loc(#loc133)
    %c_mask_48 = tt.broadcast %c_mask_45 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_49 = tt.broadcast %c_mask_47 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_50 = arith.andi %c_mask_48, %c_mask_49 : tensor<64x32xi1> loc(#loc134)
    tt.store %c_ptrs_44, %c, %c_mask_50 : tensor<64x32x!tt.ptr<f16>> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before ConvertTritonToTritonGPU (convert-triton-to-tritongpu) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_12 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc103)
    %a_ptrs_18 = tt.splat %stride_am : i32 -> tensor<64x1xi32> loc(#loc104)
    %a_ptrs_19 = arith.muli %a_ptrs, %a_ptrs_18 : tensor<64x1xi32> loc(#loc104)
    %a_ptrs_20 = tt.expand_dims %offs_am_8 {axis = 0 : i32} : tensor<64xi32> -> tensor<1x64xi32> loc(#loc105)
    %a_ptrs_21 = tt.broadcast %a_ptrs_19 : tensor<64x1xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_22 = tt.broadcast %a_ptrs_20 : tensor<1x64xi32> -> tensor<64x64xi32> loc(#loc106)
    %a_ptrs_23 = arith.addi %a_ptrs_21, %a_ptrs_22 : tensor<64x64xi32> loc(#loc106)
    %a_ptrs_24 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>> loc(#loc107)
    %a_ptrs_25 = tt.addptr %a_ptrs_24, %a_ptrs_23 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc107)
    %b_ptrs = tt.expand_dims %offs_am_8 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc108)
    %b_ptrs_26 = tt.splat %stride_bk : i32 -> tensor<64x1xi32> loc(#loc109)
    %b_ptrs_27 = arith.muli %b_ptrs, %b_ptrs_26 : tensor<64x1xi32> loc(#loc109)
    %b_ptrs_28 = tt.expand_dims %offs_bn_17 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc110)
    %b_ptrs_29 = tt.broadcast %b_ptrs_27 : tensor<64x1xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_30 = tt.broadcast %b_ptrs_28 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc111)
    %b_ptrs_31 = arith.addi %b_ptrs_29, %b_ptrs_30 : tensor<64x32xi32> loc(#loc111)
    %b_ptrs_32 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>> loc(#loc112)
    %b_ptrs_33 = tt.addptr %b_ptrs_32, %b_ptrs_31 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_34 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_35 = tt.splat %b_ptrs_34 : i32 -> tensor<64x32xi32> loc(#loc116)
    %accumulator_36:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_51 = %a_ptrs_25, %b_ptrs_52 = %b_ptrs_33, %accumulator_53 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_54 = arith.subi %K, %a : i32 loc(#loc119)
      %a_55 = tt.splat %a_54 : i32 -> tensor<1x64xi32> loc(#loc120)
      %a_56 = arith.cmpi slt, %a_ptrs_20, %a_55 : tensor<1x64xi32> loc(#loc120)
      %a_57 = tt.broadcast %a_56 : tensor<1x64xi1> -> tensor<64x64xi1> loc(#loc121)
      %a_58 = tt.load %a_ptrs_51, %a_57, %cst_0 : tensor<64x64x!tt.ptr<f16>> loc(#loc121)
      %b = tt.splat %a_54 : i32 -> tensor<64x1xi32> loc(#loc122)
      %b_59 = arith.cmpi slt, %b_ptrs, %b : tensor<64x1xi32> loc(#loc122)
      %b_60 = tt.broadcast %b_59 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc123)
      %b_61 = tt.load %b_ptrs_52, %b_60, %cst : tensor<64x32x!tt.ptr<f16>> loc(#loc123)
      %accumulator_62 = tt.dot %a_58, %b_61, %accumulator_53, inputPrecision = tf32 : tensor<64x64xf16> * tensor<64x32xf16> -> tensor<64x32xf32> loc(#loc124)
      %a_ptrs_63 = tt.addptr %a_ptrs_51, %cst_1 : tensor<64x64x!tt.ptr<f16>>, tensor<64x64xi32> loc(#loc125)
      %b_ptrs_64 = tt.addptr %b_ptrs_52, %b_ptrs_35 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc116)
      scf.yield %a_ptrs_63, %b_ptrs_64, %accumulator_62 : tensor<64x64x!tt.ptr<f16>>, tensor<64x32x!tt.ptr<f16>>, tensor<64x32xf32> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_36#2 : tensor<64x32xf32> to tensor<64x32xf16> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_10 {axis = 1 : i32} : tensor<64xi32> -> tensor<64x1xi32> loc(#loc127)
    %c_ptrs_37 = tt.splat %stride_cm : i32 -> tensor<64x1xi32> loc(#loc128)
    %c_ptrs_38 = arith.muli %c_ptrs_37, %c_ptrs : tensor<64x1xi32> loc(#loc128)
    %c_ptrs_39 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>> loc(#loc129)
    %c_ptrs_40 = tt.addptr %c_ptrs_39, %c_ptrs_38 : tensor<64x1x!tt.ptr<f16>>, tensor<64x1xi32> loc(#loc129)
    %c_ptrs_41 = tt.expand_dims %offs_bn_15 {axis = 0 : i32} : tensor<32xi32> -> tensor<1x32xi32> loc(#loc130)
    %c_ptrs_42 = tt.broadcast %c_ptrs_40 : tensor<64x1x!tt.ptr<f16>> -> tensor<64x32x!tt.ptr<f16>> loc(#loc131)
    %c_ptrs_43 = tt.broadcast %c_ptrs_41 : tensor<1x32xi32> -> tensor<64x32xi32> loc(#loc131)
    %c_ptrs_44 = tt.addptr %c_ptrs_42, %c_ptrs_43 : tensor<64x32x!tt.ptr<f16>>, tensor<64x32xi32> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32> loc(#loc132)
    %c_mask_45 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32> loc(#loc132)
    %c_mask_46 = tt.splat %N : i32 -> tensor<1x32xi32> loc(#loc133)
    %c_mask_47 = arith.cmpi slt, %c_ptrs_41, %c_mask_46 : tensor<1x32xi32> loc(#loc133)
    %c_mask_48 = tt.broadcast %c_mask_45 : tensor<64x1xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_49 = tt.broadcast %c_mask_47 : tensor<1x32xi1> -> tensor<64x32xi1> loc(#loc134)
    %c_mask_50 = arith.andi %c_mask_48, %c_mask_49 : tensor<64x32xi1> loc(#loc134)
    tt.store %c_ptrs_44, %c, %c_mask_50 : tensor<64x32x!tt.ptr<f16>> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPUCoalesce (tritongpu-coalesce) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [2, 32], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1], threadsPerWarp = [64], warpsPerCTA = [8], order = [0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [0, 1]}>
#blocked4 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [1, 8], order = [0, 1]}>
#blocked6 = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked1> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked1> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #blocked2> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32, #blocked2> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32, #blocked2> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #blocked2> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32, #blocked2> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32, #blocked2> loc(#loc102)
    %a_ptrs = ttg.convert_layout %offs_am_12 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc103)
    %a_ptrs_18 = tt.expand_dims %a_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc103)
    %a_ptrs_19 = ttg.convert_layout %a_ptrs_18 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_20 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_21 = arith.muli %a_ptrs_19, %a_ptrs_20 : tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_22 = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc105)
    %a_ptrs_23 = tt.expand_dims %a_ptrs_22 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x64xi32, #blocked5> loc(#loc105)
    %a_ptrs_24 = ttg.convert_layout %a_ptrs_23 : tensor<1x64xi32, #blocked5> -> tensor<1x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_25 = tt.broadcast %a_ptrs_21 : tensor<64x1xi32, #blocked4> -> tensor<64x64xi32, #blocked4> loc(#loc106)
    %a_ptrs_26 = ttg.convert_layout %a_ptrs_25 : tensor<64x64xi32, #blocked4> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_27 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked1> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_29 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked1> loc(#loc107)
    %a_ptrs_30 = tt.addptr %a_ptrs_29, %a_ptrs_28 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc107)
    %b_ptrs = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc108)
    %b_ptrs_32 = ttg.convert_layout %b_ptrs_31 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_32, %b_ptrs_33 : tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_35 = ttg.convert_layout %offs_bn_17 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc110)
    %b_ptrs_36 = tt.expand_dims %b_ptrs_35 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc110)
    %b_ptrs_37 = ttg.convert_layout %b_ptrs_36 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc111)
    %b_ptrs_38 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked4> -> tensor<64x32xi32, #blocked4> loc(#loc111)
    %b_ptrs_39 = ttg.convert_layout %b_ptrs_38 : tensor<64x32xi32, #blocked4> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_40 = tt.broadcast %b_ptrs_37 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc112)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked> loc(#loc116)
    %accumulator_46:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_67 = %a_ptrs_30, %b_ptrs_68 = %b_ptrs_43, %accumulator_69 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_70 = arith.subi %K, %a : i32 loc(#loc119)
      %a_71 = tt.splat %a_70 : i32 -> tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_72 = arith.cmpi slt, %a_ptrs_24, %a_71 : tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_73 = tt.broadcast %a_72 : tensor<1x64xi1, #blocked1> -> tensor<64x64xi1, #blocked1> loc(#loc121)
      %a_74 = tt.load %a_ptrs_67, %a_73, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked1> loc(#loc121)
      %b = tt.splat %a_70 : i32 -> tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_75 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_76 = tt.broadcast %b_75 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc123)
      %b_77 = ttg.convert_layout %b_76 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc123)
      %b_78 = tt.load %b_ptrs_68, %b_77, %cst : tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc123)
      %a_79 = ttg.convert_layout %a_74 : tensor<64x64xf16, #blocked1> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked6}>> loc(#loc121)
      %b_80 = ttg.convert_layout %b_78 : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked6}>> loc(#loc123)
      %accumulator_81 = ttg.convert_layout %accumulator_69 : tensor<64x32xf32, #blocked> -> tensor<64x32xf32, #blocked6> loc(#loc142)
      %accumulator_82 = tt.dot %a_79, %b_80, %accumulator_81, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked6}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked6}>> -> tensor<64x32xf32, #blocked6> loc(#loc124)
      %7 = ttg.convert_layout %accumulator_82 : tensor<64x32xf32, #blocked6> -> tensor<64x32xf32, #blocked> loc(#loc60)
      %a_ptrs_83 = tt.addptr %a_ptrs_67, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc125)
      %b_ptrs_84 = tt.addptr %b_ptrs_68, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc116)
      scf.yield %a_ptrs_83, %b_ptrs_84, %7 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked> loc(#loc60)
    } loc(#loc143)
    %c = arith.truncf %accumulator_46#2 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = ttg.convert_layout %offs_am_10 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc127)
    %c_ptrs_47 = tt.expand_dims %c_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc127)
    %c_ptrs_48 = ttg.convert_layout %c_ptrs_47 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_49 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_50 = arith.muli %c_ptrs_49, %c_ptrs_48 : tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_51 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked4> loc(#loc129)
    %c_ptrs_52 = tt.addptr %c_ptrs_51, %c_ptrs_50 : tensor<64x1x!tt.ptr<f16>, #blocked4>, tensor<64x1xi32, #blocked4> loc(#loc129)
    %c_ptrs_53 = ttg.convert_layout %offs_bn_15 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc130)
    %c_ptrs_54 = tt.expand_dims %c_ptrs_53 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc130)
    %c_ptrs_55 = ttg.convert_layout %c_ptrs_54 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc131)
    %c_ptrs_56 = tt.broadcast %c_ptrs_52 : tensor<64x1x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked4> loc(#loc131)
    %c_ptrs_57 = ttg.convert_layout %c_ptrs_56 : tensor<64x32x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc131)
    %c_ptrs_58 = tt.broadcast %c_ptrs_55 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc131)
    %c_ptrs_59 = tt.addptr %c_ptrs_57, %c_ptrs_58 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_60 = arith.cmpi slt, %c_ptrs_48, %c_mask : tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_61 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_62 = arith.cmpi slt, %c_ptrs_55, %c_mask_61 : tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_63 = tt.broadcast %c_mask_60 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc134)
    %c_mask_64 = ttg.convert_layout %c_mask_63 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_65 = tt.broadcast %c_mask_62 : tensor<1x32xi1, #blocked> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_66 = arith.andi %c_mask_64, %c_mask_65 : tensor<64x32xi1, #blocked> loc(#loc134)
    tt.store %c_ptrs_59, %c, %c_mask_66 : tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc61))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc82))
#loc143 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPUF32DotTC (tritongpu-F32DotTC) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [2, 32], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1], threadsPerWarp = [64], warpsPerCTA = [8], order = [0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [0, 1]}>
#blocked4 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [1, 8], order = [0, 1]}>
#blocked6 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked7 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked8 = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked1> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked1> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #blocked2> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32, #blocked2> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32, #blocked2> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #blocked2> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32, #blocked2> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32, #blocked2> loc(#loc102)
    %a_ptrs = ttg.convert_layout %offs_am_12 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc103)
    %a_ptrs_18 = tt.expand_dims %a_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc103)
    %a_ptrs_19 = ttg.convert_layout %a_ptrs_18 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_20 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_21 = arith.muli %a_ptrs_19, %a_ptrs_20 : tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_22 = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc105)
    %a_ptrs_23 = tt.expand_dims %a_ptrs_22 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x64xi32, #blocked5> loc(#loc105)
    %a_ptrs_24 = ttg.convert_layout %a_ptrs_23 : tensor<1x64xi32, #blocked5> -> tensor<1x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_25 = tt.broadcast %a_ptrs_21 : tensor<64x1xi32, #blocked4> -> tensor<64x64xi32, #blocked4> loc(#loc106)
    %a_ptrs_26 = ttg.convert_layout %a_ptrs_25 : tensor<64x64xi32, #blocked4> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_27 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked1> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_29 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked1> loc(#loc107)
    %a_ptrs_30 = tt.addptr %a_ptrs_29, %a_ptrs_28 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc107)
    %b_ptrs = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc108)
    %b_ptrs_32 = ttg.convert_layout %b_ptrs_31 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_32, %b_ptrs_33 : tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_35 = ttg.convert_layout %offs_bn_17 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc110)
    %b_ptrs_36 = tt.expand_dims %b_ptrs_35 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc110)
    %b_ptrs_37 = ttg.convert_layout %b_ptrs_36 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc111)
    %b_ptrs_38 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked4> -> tensor<64x32xi32, #blocked4> loc(#loc111)
    %b_ptrs_39 = ttg.convert_layout %b_ptrs_38 : tensor<64x32xi32, #blocked4> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_40 = tt.broadcast %b_ptrs_37 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc112)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked> loc(#loc116)
    %accumulator_46:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_67 = %a_ptrs_30, %b_ptrs_68 = %b_ptrs_43, %accumulator_69 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_70 = arith.subi %K, %a : i32 loc(#loc119)
      %a_71 = tt.splat %a_70 : i32 -> tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_72 = arith.cmpi slt, %a_ptrs_24, %a_71 : tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_73 = tt.broadcast %a_72 : tensor<1x64xi1, #blocked1> -> tensor<64x64xi1, #blocked1> loc(#loc121)
      %a_74 = ttg.convert_layout %a_ptrs_67 : tensor<64x64x!tt.ptr<f16>, #blocked1> -> tensor<64x64x!tt.ptr<f16>, #blocked6> loc(#loc121)
      %a_75 = ttg.convert_layout %a_73 : tensor<64x64xi1, #blocked1> -> tensor<64x64xi1, #blocked6> loc(#loc121)
      %a_76 = ttg.convert_layout %cst_0 : tensor<64x64xf16, #blocked1> -> tensor<64x64xf16, #blocked6> loc(#loc121)
      %a_77 = tt.load %a_74, %a_75, %a_76 : tensor<64x64x!tt.ptr<f16>, #blocked6> loc(#loc121)
      %a_78 = ttg.convert_layout %a_77 : tensor<64x64xf16, #blocked6> -> tensor<64x64xf16, #blocked1> loc(#loc121)
      %b = tt.splat %a_70 : i32 -> tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_79 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_80 = tt.broadcast %b_79 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc123)
      %b_81 = ttg.convert_layout %b_80 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc123)
      %b_82 = ttg.convert_layout %b_ptrs_68 : tensor<64x32x!tt.ptr<f16>, #blocked> -> tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc123)
      %b_83 = ttg.convert_layout %b_81 : tensor<64x32xi1, #blocked> -> tensor<64x32xi1, #blocked7> loc(#loc123)
      %b_84 = ttg.convert_layout %cst : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked7> loc(#loc123)
      %b_85 = tt.load %b_82, %b_83, %b_84 : tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc123)
      %b_86 = ttg.convert_layout %b_85 : tensor<64x32xf16, #blocked7> -> tensor<64x32xf16, #blocked> loc(#loc123)
      %a_87 = ttg.convert_layout %a_78 : tensor<64x64xf16, #blocked1> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked8}>> loc(#loc121)
      %b_88 = ttg.convert_layout %b_86 : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked8}>> loc(#loc123)
      %accumulator_89 = ttg.convert_layout %accumulator_69 : tensor<64x32xf32, #blocked> -> tensor<64x32xf32, #blocked8> loc(#loc142)
      %accumulator_90 = tt.dot %a_87, %b_88, %accumulator_89, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked8}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked8}>> -> tensor<64x32xf32, #blocked8> loc(#loc124)
      %10 = ttg.convert_layout %accumulator_90 : tensor<64x32xf32, #blocked8> -> tensor<64x32xf32, #blocked> loc(#loc60)
      %a_ptrs_91 = tt.addptr %a_ptrs_67, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc125)
      %b_ptrs_92 = tt.addptr %b_ptrs_68, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc116)
      scf.yield %a_ptrs_91, %b_ptrs_92, %10 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked> loc(#loc60)
    } loc(#loc143)
    %c = arith.truncf %accumulator_46#2 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = ttg.convert_layout %offs_am_10 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc127)
    %c_ptrs_47 = tt.expand_dims %c_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc127)
    %c_ptrs_48 = ttg.convert_layout %c_ptrs_47 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_49 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_50 = arith.muli %c_ptrs_49, %c_ptrs_48 : tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_51 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked4> loc(#loc129)
    %c_ptrs_52 = tt.addptr %c_ptrs_51, %c_ptrs_50 : tensor<64x1x!tt.ptr<f16>, #blocked4>, tensor<64x1xi32, #blocked4> loc(#loc129)
    %c_ptrs_53 = ttg.convert_layout %offs_bn_15 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc130)
    %c_ptrs_54 = tt.expand_dims %c_ptrs_53 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc130)
    %c_ptrs_55 = ttg.convert_layout %c_ptrs_54 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc131)
    %c_ptrs_56 = tt.broadcast %c_ptrs_52 : tensor<64x1x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked4> loc(#loc131)
    %c_ptrs_57 = ttg.convert_layout %c_ptrs_56 : tensor<64x32x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc131)
    %c_ptrs_58 = tt.broadcast %c_ptrs_55 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc131)
    %c_ptrs_59 = tt.addptr %c_ptrs_57, %c_ptrs_58 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_60 = arith.cmpi slt, %c_ptrs_48, %c_mask : tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_61 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_62 = arith.cmpi slt, %c_ptrs_55, %c_mask_61 : tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_63 = tt.broadcast %c_mask_60 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc134)
    %c_mask_64 = ttg.convert_layout %c_mask_63 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_65 = tt.broadcast %c_mask_62 : tensor<1x32xi1, #blocked> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_66 = arith.andi %c_mask_64, %c_mask_65 : tensor<64x32xi1, #blocked> loc(#loc134)
    %7 = ttg.convert_layout %c_ptrs_59 : tensor<64x32x!tt.ptr<f16>, #blocked> -> tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc71)
    %8 = ttg.convert_layout %c : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked7> loc(#loc71)
    %9 = ttg.convert_layout %c_mask_66 : tensor<64x32xi1, #blocked> -> tensor<64x32xi1, #blocked7> loc(#loc71)
    tt.store %7, %8, %9 : tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc61))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc82))
#loc143 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPURemoveLayoutConversions (tritongpu-remove-layout-conversions) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [2, 32], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1], threadsPerWarp = [64], warpsPerCTA = [8], order = [0]}>
#blocked3 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [0, 1]}>
#blocked4 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [64, 1], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked5 = #ttg.blocked<{sizePerThread = [1, 1], threadsPerWarp = [1, 64], warpsPerCTA = [1, 8], order = [0, 1]}>
#blocked6 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked7 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked8 = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked1> loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked1> loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #blocked2> loc(#loc96)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_10 = arith.addi %offs_am_9, %offs_am_8 : tensor<64xi32, #blocked2> loc(#loc97)
    %offs_am_11 = tt.splat %M : i32 -> tensor<64xi32, #blocked2> loc(#loc98)
    %offs_am_12 = arith.remsi %offs_am_10, %offs_am_11 : tensor<64xi32, #blocked2> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_13 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #blocked2> loc(#loc100)
    %offs_bn_14 = tt.splat %offs_bn : i32 -> tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_15 = arith.addi %offs_bn_14, %offs_bn_13 : tensor<32xi32, #blocked2> loc(#loc101)
    %offs_bn_16 = tt.splat %N : i32 -> tensor<32xi32, #blocked2> loc(#loc102)
    %offs_bn_17 = arith.remsi %offs_bn_15, %offs_bn_16 : tensor<32xi32, #blocked2> loc(#loc102)
    %a_ptrs = ttg.convert_layout %offs_am_12 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc103)
    %a_ptrs_18 = tt.expand_dims %a_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc103)
    %a_ptrs_19 = ttg.convert_layout %a_ptrs_18 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_20 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_21 = arith.muli %a_ptrs_19, %a_ptrs_20 : tensor<64x1xi32, #blocked4> loc(#loc104)
    %a_ptrs_22 = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc105)
    %a_ptrs_23 = tt.expand_dims %a_ptrs_22 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x64xi32, #blocked5> loc(#loc105)
    %a_ptrs_24 = ttg.convert_layout %a_ptrs_23 : tensor<1x64xi32, #blocked5> -> tensor<1x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_25 = tt.broadcast %a_ptrs_21 : tensor<64x1xi32, #blocked4> -> tensor<64x64xi32, #blocked4> loc(#loc106)
    %a_ptrs_26 = ttg.convert_layout %a_ptrs_25 : tensor<64x64xi32, #blocked4> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_27 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked1> -> tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked1> loc(#loc106)
    %a_ptrs_29 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked1> loc(#loc107)
    %a_ptrs_30 = tt.addptr %a_ptrs_29, %a_ptrs_28 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc107)
    %b_ptrs = ttg.convert_layout %offs_am_8 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc108)
    %b_ptrs_32 = ttg.convert_layout %b_ptrs_31 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_32, %b_ptrs_33 : tensor<64x1xi32, #blocked4> loc(#loc109)
    %b_ptrs_35 = ttg.convert_layout %offs_bn_17 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc110)
    %b_ptrs_36 = tt.expand_dims %b_ptrs_35 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc110)
    %b_ptrs_37 = ttg.convert_layout %b_ptrs_36 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc111)
    %b_ptrs_38 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked4> -> tensor<64x32xi32, #blocked4> loc(#loc111)
    %b_ptrs_39 = ttg.convert_layout %b_ptrs_38 : tensor<64x32xi32, #blocked4> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_40 = tt.broadcast %b_ptrs_37 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked> loc(#loc111)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc112)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked> loc(#loc116)
    %accumulator_46:3 = scf.for %k = %c0_i32 to %6 step %c1_i32 iter_args(%a_ptrs_67 = %a_ptrs_30, %b_ptrs_68 = %b_ptrs_43, %accumulator_69 = %accumulator) -> (tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked>)  : i32 {
      %a = arith.muli %k, %c64_i32 : i32 loc(#loc118)
      %a_70 = arith.subi %K, %a : i32 loc(#loc119)
      %a_71 = tt.splat %a_70 : i32 -> tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_72 = arith.cmpi slt, %a_ptrs_24, %a_71 : tensor<1x64xi32, #blocked1> loc(#loc120)
      %a_73 = tt.broadcast %a_72 : tensor<1x64xi1, #blocked1> -> tensor<64x64xi1, #blocked1> loc(#loc121)
      %a_74 = ttg.convert_layout %a_ptrs_67 : tensor<64x64x!tt.ptr<f16>, #blocked1> -> tensor<64x64x!tt.ptr<f16>, #blocked6> loc(#loc121)
      %a_75 = ttg.convert_layout %a_73 : tensor<64x64xi1, #blocked1> -> tensor<64x64xi1, #blocked6> loc(#loc121)
      %a_76 = ttg.convert_layout %cst_0 : tensor<64x64xf16, #blocked1> -> tensor<64x64xf16, #blocked6> loc(#loc121)
      %a_77 = tt.load %a_74, %a_75, %a_76 : tensor<64x64x!tt.ptr<f16>, #blocked6> loc(#loc121)
      %a_78 = ttg.convert_layout %a_77 : tensor<64x64xf16, #blocked6> -> tensor<64x64xf16, #blocked1> loc(#loc121)
      %b = tt.splat %a_70 : i32 -> tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_79 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked4> loc(#loc122)
      %b_80 = tt.broadcast %b_79 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc123)
      %b_81 = ttg.convert_layout %b_80 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc123)
      %b_82 = ttg.convert_layout %b_ptrs_68 : tensor<64x32x!tt.ptr<f16>, #blocked> -> tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc123)
      %b_83 = ttg.convert_layout %b_81 : tensor<64x32xi1, #blocked> -> tensor<64x32xi1, #blocked7> loc(#loc123)
      %b_84 = ttg.convert_layout %cst : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked7> loc(#loc123)
      %b_85 = tt.load %b_82, %b_83, %b_84 : tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc123)
      %b_86 = ttg.convert_layout %b_85 : tensor<64x32xf16, #blocked7> -> tensor<64x32xf16, #blocked> loc(#loc123)
      %a_87 = ttg.convert_layout %a_78 : tensor<64x64xf16, #blocked1> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked8}>> loc(#loc121)
      %b_88 = ttg.convert_layout %b_86 : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked8}>> loc(#loc123)
      %accumulator_89 = ttg.convert_layout %accumulator_69 : tensor<64x32xf32, #blocked> -> tensor<64x32xf32, #blocked8> loc(#loc142)
      %accumulator_90 = tt.dot %a_87, %b_88, %accumulator_89, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked8}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked8}>> -> tensor<64x32xf32, #blocked8> loc(#loc124)
      %10 = ttg.convert_layout %accumulator_90 : tensor<64x32xf32, #blocked8> -> tensor<64x32xf32, #blocked> loc(#loc60)
      %a_ptrs_91 = tt.addptr %a_ptrs_67, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x64xi32, #blocked1> loc(#loc125)
      %b_ptrs_92 = tt.addptr %b_ptrs_68, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc116)
      scf.yield %a_ptrs_91, %b_ptrs_92, %10 : tensor<64x64x!tt.ptr<f16>, #blocked1>, tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xf32, #blocked> loc(#loc60)
    } loc(#loc143)
    %c = arith.truncf %accumulator_46#2 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = ttg.convert_layout %offs_am_10 : tensor<64xi32, #blocked2> -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> loc(#loc127)
    %c_ptrs_47 = tt.expand_dims %c_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked3}>> -> tensor<64x1xi32, #blocked3> loc(#loc127)
    %c_ptrs_48 = ttg.convert_layout %c_ptrs_47 : tensor<64x1xi32, #blocked3> -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_49 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_50 = arith.muli %c_ptrs_49, %c_ptrs_48 : tensor<64x1xi32, #blocked4> loc(#loc128)
    %c_ptrs_51 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked4> loc(#loc129)
    %c_ptrs_52 = tt.addptr %c_ptrs_51, %c_ptrs_50 : tensor<64x1x!tt.ptr<f16>, #blocked4>, tensor<64x1xi32, #blocked4> loc(#loc129)
    %c_ptrs_53 = ttg.convert_layout %offs_bn_15 : tensor<32xi32, #blocked2> -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> loc(#loc130)
    %c_ptrs_54 = tt.expand_dims %c_ptrs_53 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked5}>> -> tensor<1x32xi32, #blocked5> loc(#loc130)
    %c_ptrs_55 = ttg.convert_layout %c_ptrs_54 : tensor<1x32xi32, #blocked5> -> tensor<1x32xi32, #blocked> loc(#loc131)
    %c_ptrs_56 = tt.broadcast %c_ptrs_52 : tensor<64x1x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked4> loc(#loc131)
    %c_ptrs_57 = ttg.convert_layout %c_ptrs_56 : tensor<64x32x!tt.ptr<f16>, #blocked4> -> tensor<64x32x!tt.ptr<f16>, #blocked> loc(#loc131)
    %c_ptrs_58 = tt.broadcast %c_ptrs_55 : tensor<1x32xi32, #blocked> -> tensor<64x32xi32, #blocked> loc(#loc131)
    %c_ptrs_59 = tt.addptr %c_ptrs_57, %c_ptrs_58 : tensor<64x32x!tt.ptr<f16>, #blocked>, tensor<64x32xi32, #blocked> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_60 = arith.cmpi slt, %c_ptrs_48, %c_mask : tensor<64x1xi32, #blocked4> loc(#loc132)
    %c_mask_61 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_62 = arith.cmpi slt, %c_ptrs_55, %c_mask_61 : tensor<1x32xi32, #blocked> loc(#loc133)
    %c_mask_63 = tt.broadcast %c_mask_60 : tensor<64x1xi1, #blocked4> -> tensor<64x32xi1, #blocked4> loc(#loc134)
    %c_mask_64 = ttg.convert_layout %c_mask_63 : tensor<64x32xi1, #blocked4> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_65 = tt.broadcast %c_mask_62 : tensor<1x32xi1, #blocked> -> tensor<64x32xi1, #blocked> loc(#loc134)
    %c_mask_66 = arith.andi %c_mask_64, %c_mask_65 : tensor<64x32xi1, #blocked> loc(#loc134)
    %7 = ttg.convert_layout %c_ptrs_59 : tensor<64x32x!tt.ptr<f16>, #blocked> -> tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc71)
    %8 = ttg.convert_layout %c : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked7> loc(#loc71)
    %9 = ttg.convert_layout %c_mask_66 : tensor<64x32xi1, #blocked> -> tensor<64x32xi1, #blocked7> loc(#loc71)
    tt.store %7, %8, %9 : tensor<64x32x!tt.ptr<f16>, #blocked7> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc61))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc82))
#loc143 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPUOptimizeThreadLocality (tritongpu-optimize-thread-locality) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked2> loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked2> loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_58 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_59 = %accumulator, %a_ptrs_60 = %a_ptrs_29, %b_ptrs_61 = %b_ptrs_40) -> (tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_58, %c64_i32 : i32 loc(#loc118)
      %a_62 = arith.subi %K, %a : i32 loc(#loc119)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_64 = arith.cmpi slt, %a_ptrs_24, %a_63 : tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc121)
      %a_66 = tt.load %a_ptrs_60, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc121)
      %b = tt.splat %a_62 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_67 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_68 = tt.broadcast %b_67 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_69 = tt.load %b_ptrs_61, %b_68, %cst : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_70 = ttg.convert_layout %a_66 : tensor<64x64xf16, #blocked2> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> loc(#loc121)
      %b_71 = ttg.convert_layout %b_69 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> loc(#loc123)
      %accumulator_72 = tt.dot %a_70, %b_71, %accumulator_59, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> -> tensor<64x32xf32, #blocked> loc(#loc124)
      %a_ptrs_73 = tt.addptr %a_ptrs_60, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc125)
      %b_ptrs_74 = tt.addptr %b_ptrs_61, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_72, %a_ptrs_73, %b_ptrs_74 : tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %7 = ttg.convert_layout %c : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked1> loc(#loc71)
    tt.store %c_ptrs_51, %7, %c_mask_57 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUAccelerateMatmul (tritonamdgpu-accelerate-matmul) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked2> loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked2> loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_58 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_59 = %accumulator, %a_ptrs_60 = %a_ptrs_29, %b_ptrs_61 = %b_ptrs_40) -> (tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_58, %c64_i32 : i32 loc(#loc118)
      %a_62 = arith.subi %K, %a : i32 loc(#loc119)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_64 = arith.cmpi slt, %a_ptrs_24, %a_63 : tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc121)
      %a_66 = tt.load %a_ptrs_60, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc121)
      %b = tt.splat %a_62 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_67 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_68 = tt.broadcast %b_67 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_69 = tt.load %b_ptrs_61, %b_68, %cst : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_70 = ttg.convert_layout %a_66 : tensor<64x64xf16, #blocked2> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> loc(#loc121)
      %b_71 = ttg.convert_layout %b_69 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> loc(#loc123)
      %accumulator_72 = tt.dot %a_70, %b_71, %accumulator_59, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> -> tensor<64x32xf32, #blocked> loc(#loc124)
      %a_ptrs_73 = tt.addptr %a_ptrs_60, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc125)
      %b_ptrs_74 = tt.addptr %b_ptrs_61, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_72, %a_ptrs_73, %b_ptrs_74 : tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %7 = ttg.convert_layout %c : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked1> loc(#loc71)
    tt.store %c_ptrs_51, %7, %c_mask_57 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPURemoveLayoutConversions (tritongpu-remove-layout-conversions) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [2, 2], threadsPerWarp = [4, 16], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked2 = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #blocked> loc(#loc135)
    %num_pid_n = arith.constant 31 : i32 loc(#loc136)
    %c63_i32 = arith.constant 63 : i32 loc(#loc3)
    %c1_i32 = arith.constant 1 : i32 loc(#loc5)
    %cst = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc3)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked2> loc(#loc3)
    %c4_i32 = arith.constant 4 : i32 loc(#loc3)
    %c0_i32 = arith.constant 0 : i32 loc(#loc3)
    %true = arith.constant true loc(#loc3)
    %c64_i32 = arith.constant 64 : i32 loc(#loc3)
    %c32_i32 = arith.constant 32 : i32 loc(#loc3)
    %cst_1 = arith.constant dense<64> : tensor<64x64xi32, #blocked2> loc(#loc3)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked2}>> -> tensor<64x1xi32, #blocked2> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked2> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked2}>> -> tensor<1x64xi32, #blocked2> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked2> -> tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked2> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_58 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_59 = %accumulator, %a_ptrs_60 = %a_ptrs_29, %b_ptrs_61 = %b_ptrs_40) -> (tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_58, %c64_i32 : i32 loc(#loc118)
      %a_62 = arith.subi %K, %a : i32 loc(#loc119)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_64 = arith.cmpi slt, %a_ptrs_24, %a_63 : tensor<1x64xi32, #blocked2> loc(#loc120)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1, #blocked2> -> tensor<64x64xi1, #blocked2> loc(#loc121)
      %a_66 = tt.load %a_ptrs_60, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked2> loc(#loc121)
      %b = tt.splat %a_62 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_67 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_68 = tt.broadcast %b_67 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_69 = tt.load %b_ptrs_61, %b_68, %cst : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_70 = ttg.convert_layout %a_66 : tensor<64x64xf16, #blocked2> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> loc(#loc121)
      %b_71 = ttg.convert_layout %b_69 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> loc(#loc123)
      %accumulator_72 = ttg.convert_layout %accumulator_59 : tensor<64x32xf32, #blocked> -> tensor<64x32xf32, #mma> loc(#loc135)
      %a_73 = ttg.convert_layout %a_70 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #blocked}>> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_74 = ttg.convert_layout %b_71 : tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #blocked}>> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_75 = tt.dot %a_73, %b_74, %accumulator_72, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_76 = ttg.convert_layout %accumulator_75 : tensor<64x32xf32, #mma> -> tensor<64x32xf32, #blocked> loc(#loc124)
      %a_ptrs_77 = tt.addptr %a_ptrs_60, %cst_1 : tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x64xi32, #blocked2> loc(#loc125)
      %b_ptrs_78 = tt.addptr %b_ptrs_61, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_76, %a_ptrs_77, %b_ptrs_78 : tensor<64x32xf32, #blocked>, tensor<64x64x!tt.ptr<f16>, #blocked2>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #blocked> to tensor<64x32xf16, #blocked> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %7 = ttg.convert_layout %c : tensor<64x32xf16, #blocked> -> tensor<64x32xf16, #blocked1> loc(#loc71)
    tt.store %c_ptrs_51, %7, %c_mask_57 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc3 = loc(unknown)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("accumulator"(#loc2))
#loc83 = loc("num_pid_n"(#loc4))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc5))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc3 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc83))
#loc140 = loc(callsite(#loc9 at #loc83))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUOptimizeEpilogue (tritonamdgpu-optimize-epilogue) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_58 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_59 = %accumulator, %a_ptrs_60 = %a_ptrs_29, %b_ptrs_61 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_58, %c64_i32 : i32 loc(#loc118)
      %a_62 = arith.subi %K, %a : i32 loc(#loc119)
      %a_63 = tt.splat %a_62 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_64 = arith.cmpi slt, %a_ptrs_24, %a_63 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_65 = tt.broadcast %a_64 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_66 = tt.load %a_ptrs_60, %a_65, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_62 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_67 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_68 = tt.broadcast %b_67 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_69 = tt.load %b_ptrs_61, %b_68, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_70 = ttg.convert_layout %a_66 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_71 = ttg.convert_layout %b_69 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_72 = tt.dot %a_70, %b_71, %accumulator_59, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_73 = tt.addptr %a_ptrs_60, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_74 = tt.addptr %b_ptrs_61, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_72, %a_ptrs_73, %b_ptrs_74 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %7 = ttg.convert_layout %c : tensor<64x32xf16, #mma> -> tensor<64x32xf16, #blocked1> loc(#loc71)
    tt.store %c_ptrs_51, %7, %c_mask_57 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUOptimizeDotOperands (tritonamdgpu-optimize-dot-operands) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUHoistLayoutConversions (tritonamdgpu-hoist-layout-conversions) ('tt.func' operation: @matmul_kernel) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUSinkLayoutConversions (tritonamdgpu-sink-layout-conversions) ('tt.func' operation: @matmul_kernel) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonGPUFuseNestedLoops (tritongpu-fuse-nested-loops) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonLoopInvariantCodeMotion (triton-licm) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUScheduleLoops (tritonamdgpu-schedule-loops) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before TritonAMDGPUPipeline (tritonamdgpu-pipeline) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#loc73 = loc("a_ptr"(#loc))
#loc74 = loc("b_ptr"(#loc))
#loc75 = loc("c_ptr"(#loc))
#loc76 = loc("M"(#loc))
#loc77 = loc("N"(#loc))
#loc78 = loc("K"(#loc))
#loc79 = loc("stride_am"(#loc))
#loc80 = loc("stride_bk"(#loc))
#loc81 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc2)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc135)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc136)
    %pid = tt.get_program_id x : i32 loc(#loc84)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc137)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc138)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc139)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc140)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc86)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc87)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc88)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc89)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc90)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc91)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc92)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc93)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc94)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc19)
    llvm.intr.assume %0 : i1 loc(#loc20)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc21)
    llvm.intr.assume %1 : i1 loc(#loc22)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc23)
    llvm.intr.assume %2 : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    llvm.intr.assume %true : i1 loc(#loc26)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc27)
    llvm.intr.assume %3 : i1 loc(#loc28)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc29)
    llvm.intr.assume %4 : i1 loc(#loc30)
    llvm.intr.assume %true : i1 loc(#loc31)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc95)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc98)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc99)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc102)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc104)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc105)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc105)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc106)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc107)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc107)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc108)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc109)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc111)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc112)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc112)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc113)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc115)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_43:3 = scf.for %accumulator_60 = %c0_i32 to %6 step %c1_i32 iter_args(%accumulator_61 = %accumulator, %a_ptrs_62 = %a_ptrs_29, %b_ptrs_63 = %b_ptrs_40) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>)  : i32 {
      %a = arith.muli %accumulator_60, %c64_i32 : i32 loc(#loc118)
      %a_64 = arith.subi %K, %a : i32 loc(#loc119)
      %a_65 = tt.splat %a_64 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_66 = arith.cmpi slt, %a_ptrs_24, %a_65 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_67 = tt.broadcast %a_66 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc121)
      %a_68 = tt.load %a_ptrs_62, %a_67, %cst_0 {loop.cluster = 0 : i32, loop.stage = 0 : i32} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc121)
      %b = tt.splat %a_64 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_69 = arith.cmpi slt, %b_ptrs_32, %b : tensor<64x1xi32, #blocked1> loc(#loc122)
      %b_70 = tt.broadcast %b_69 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc123)
      %b_71 = tt.load %b_ptrs_63, %b_70, %cst_1 {loop.cluster = 0 : i32, loop.stage = 0 : i32} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc123)
      %a_72 = ttg.convert_layout %a_68 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc121)
      %b_73 = ttg.convert_layout %b_71 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc123)
      %accumulator_74 = tt.dot %a_72, %b_73, %accumulator_61, inputPrecision = tf32 {loop.cluster = 1 : i32, loop.stage = 1 : i32} : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %a_ptrs_75 = tt.addptr %a_ptrs_62, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc125)
      %b_ptrs_76 = tt.addptr %b_ptrs_63, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
      scf.yield %accumulator_74, %a_ptrs_75, %b_ptrs_76 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc61)
    } {tt.scheduled_max_stage = 1 : i32} loc(#loc142)
    %c = arith.truncf %accumulator_43#0 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc126)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_44 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_45 = arith.muli %c_ptrs_44, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_46 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc129)
    %c_ptrs_47 = tt.addptr %c_ptrs_46, %c_ptrs_45 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc129)
    %c_ptrs_48 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_49 = tt.broadcast %c_ptrs_47 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc131)
    %c_ptrs_50 = tt.broadcast %c_ptrs_48 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_ptrs_51 = tt.addptr %c_ptrs_49, %c_ptrs_50 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc131)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_52 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc132)
    %c_mask_53 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_54 = arith.cmpi slt, %c_ptrs_48, %c_mask_53 : tensor<1x32xi32, #blocked1> loc(#loc133)
    %c_mask_55 = tt.broadcast %c_mask_52 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_56 = tt.broadcast %c_mask_54 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_mask_57 = arith.andi %c_mask_55, %c_mask_56 : tensor<64x32xi1, #blocked1> loc(#loc134)
    %c_ptrs_58 = ttg.convert_layout %c_ptrs_51 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc131)
    %c_mask_59 = ttg.convert_layout %c_mask_57 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc134)
    tt.store %c_ptrs_58, %c, %c_mask_59 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc71)
    tt.return loc(#loc72)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc7 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc9 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:8)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc72 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc82 = loc("num_pid_n"(#loc3))
#loc83 = loc("accumulator"(#loc5))
#loc84 = loc("pid"(#loc6))
#loc85 = loc("num_pid_m"(#loc8))
#loc86 = loc("num_pid_in_group"(#loc10))
#loc87 = loc("group_id"(#loc11))
#loc88 = loc("first_pid_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("group_size_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_m"(#loc17))
#loc94 = loc("pid_n"(#loc18))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_am"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("offs_bn"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("a_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc("b_ptrs"(#loc49))
#loc113 = loc(callsite(#loc7 at #loc50))
#loc114 = loc(callsite(#loc9 at #loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("a_ptrs"(#loc2))
#loc118 = loc("a"(#loc53))
#loc119 = loc("a"(#loc54))
#loc120 = loc("a"(#loc55))
#loc121 = loc("a"(#loc56))
#loc122 = loc("b"(#loc57))
#loc123 = loc("b"(#loc58))
#loc124 = loc("accumulator"(#loc59))
#loc125 = loc("a_ptrs"(#loc60))
#loc126 = loc("c"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_ptrs"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc("c_mask"(#loc70))
#loc135 = loc(callsite(#loc1 at #loc82))
#loc136 = loc(callsite(#loc4 at #loc83))
#loc137 = loc(callsite(#loc7 at #loc85))
#loc138 = loc(callsite(#loc9 at #loc85))
#loc139 = loc(callsite(#loc7 at #loc82))
#loc140 = loc(callsite(#loc9 at #loc82))
#loc141 = loc("b_ptrs"(#loc117))
#loc142 = loc("accumulator"(#loc141))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %c-1_i32 = arith.constant -1 : i32 loc(#loc1)
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_43 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_44 = arith.subi %K, %c0_i32 : i32 loc(#loc119)
    %a_45 = tt.splat %a_44 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
    %a_46 = arith.cmpi slt, %a_ptrs_24, %a_45 : tensor<1x64xi32, #blocked> loc(#loc120)
    %a_47 = tt.broadcast %a_46 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_48 = tt.splat %accumulator_43 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_49 = arith.andi %accumulator_48, %a_47 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_50 = tt.load %a_ptrs_29, %accumulator_49, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %accumulator_51 = tt.splat %accumulator_43 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_52 = arith.andi %accumulator_51, %a_47 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_53 = tt.load %a_ptrs_29, %accumulator_52, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_54 = tt.splat %a_44 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc121)
    %b_55 = arith.cmpi slt, %b_ptrs_32, %b_54 : tensor<64x1xi32, #blocked1> loc(#loc121)
    %b_56 = tt.broadcast %b_55 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_57 = tt.splat %accumulator_43 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_58 = arith.andi %accumulator_57, %b_56 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_59 = tt.load %b_ptrs_40, %accumulator_58, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %accumulator_60 = tt.splat %accumulator_43 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_61 = arith.andi %accumulator_60, %b_56 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_62 = tt.load %b_ptrs_40, %accumulator_61, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %accumulator_63 = arith.cmpi slt, %c0_i32, %c1_i32 : i32 loc(#loc141)
    %accumulator_64 = arith.select %accumulator_63, %c0_i32, %c0_i32 : i32 loc(#loc141)
    %a_65 = ttg.memdesc_index %a[%accumulator_64] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_50, %a_65 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_66 = ttg.memdesc_index %b[%accumulator_64] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_59, %b_66 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_67 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_68:6 = scf.for %accumulator_96 = %c0_i32 to %accumulator_67 step %c1_i32 iter_args(%accumulator_97 = %accumulator, %a_ptrs_98 = %a_ptrs_29, %b_ptrs_99 = %b_ptrs_40, %accumulator_100 = %accumulator_64, %a_101 = %a_65, %b_102 = %b_66) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_103 = tt.addptr %a_ptrs_98, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc122)
      %b_ptrs_104 = tt.addptr %b_ptrs_99, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_105 = arith.addi %accumulator_96, %c1_i32 : i32 loc(#loc141)
      %a_106 = arith.muli %accumulator_105, %c64_i32 : i32 loc(#loc123)
      %a_107 = arith.subi %K, %a_106 : i32 loc(#loc119)
      %a_108 = tt.splat %a_107 : i32 -> tensor<1x64xi32, #blocked> loc(#loc120)
      %a_109 = arith.cmpi slt, %a_ptrs_24, %a_108 : tensor<1x64xi32, #blocked> loc(#loc120)
      %a_110 = tt.broadcast %a_109 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_111 = tt.load %a_ptrs_103, %a_110, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_112 = ttg.local_load %a_101 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #blocked> loc(#loc116)
      %b_113 = tt.splat %a_107 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc121)
      %b_114 = arith.cmpi slt, %b_ptrs_32, %b_113 : tensor<64x1xi32, #blocked1> loc(#loc121)
      %b_115 = tt.broadcast %b_114 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_116 = tt.load %b_ptrs_104, %b_115, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_117 = ttg.local_load %b_102 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #blocked1> loc(#loc117)
      %a_118 = ttg.convert_layout %a_112 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_119 = ttg.convert_layout %b_117 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_120 = tt.dot %a_118, %b_119, %accumulator_97, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_121 = arith.addi %accumulator_100, %c1_i32 : i32 loc(#loc141)
      %accumulator_122 = arith.cmpi slt, %accumulator_121, %c1_i32 : i32 loc(#loc141)
      %accumulator_123 = arith.select %accumulator_122, %accumulator_121, %c0_i32 : i32 loc(#loc141)
      %a_124 = ttg.memdesc_index %a[%accumulator_123] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_111, %a_124 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_125 = ttg.memdesc_index %b[%accumulator_123] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_116, %b_125 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_120, %a_ptrs_103, %b_ptrs_104, %accumulator_123, %a_124, %b_125 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_69 = arith.addi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_70 = arith.addi %accumulator_69, %c-1_i32 : i32 loc(#loc141)
    %accumulator_71 = arith.cmpi sge, %accumulator_70, %c1_i32 : i32 loc(#loc141)
    %a_ptrs_72 = tt.addptr %accumulator_68#1, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc122)
    %b_ptrs_73 = tt.addptr %accumulator_68#2, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
    %a_74 = ttg.local_load %accumulator_68#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #blocked> loc(#loc116)
    %b_75 = ttg.local_load %accumulator_68#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #blocked1> loc(#loc117)
    %a_76 = ttg.convert_layout %a_74 : tensor<64x64xf16, #blocked> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_77 = ttg.convert_layout %b_75 : tensor<64x32xf16, #blocked1> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_78 = scf.if %accumulator_71 -> (tensor<64x32xf32, #mma>) {
      %accumulator_96 = tt.dot %a_76, %b_77, %accumulator_68#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_96 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_68#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_79 = arith.select %accumulator_71, %accumulator_78, %accumulator_68#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_79 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc126)
    %c_ptrs_80 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_81 = arith.muli %c_ptrs_80, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_82 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc128)
    %c_ptrs_83 = tt.addptr %c_ptrs_82, %c_ptrs_81 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_84 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc129)
    %c_ptrs_85 = tt.broadcast %c_ptrs_83 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc130)
    %c_ptrs_86 = tt.broadcast %c_ptrs_84 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_87 = tt.addptr %c_ptrs_85, %c_ptrs_86 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc131)
    %c_mask_88 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc131)
    %c_mask_89 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc132)
    %c_mask_90 = arith.cmpi slt, %c_ptrs_84, %c_mask_89 : tensor<1x32xi32, #blocked1> loc(#loc132)
    %c_mask_91 = tt.broadcast %c_mask_88 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_mask_92 = tt.broadcast %c_mask_90 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_mask_93 = arith.andi %c_mask_91, %c_mask_92 : tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_ptrs_94 = ttg.convert_layout %c_ptrs_87 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_mask_95 = ttg.convert_layout %c_mask_93 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_94, %c, %c_mask_95 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("a"(#loc56))
#loc121 = loc("b"(#loc57))
#loc122 = loc("a_ptrs"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonGPURemoveLayoutConversions (tritongpu-remove-layout-conversions) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_18 = arith.addi %offs_bn_17, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_19 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_20 = arith.remsi %offs_bn_18, %offs_bn_19 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_21 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_22 = arith.muli %a_ptrs, %a_ptrs_21 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_23 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_24 = tt.expand_dims %a_ptrs_23 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_25 = tt.broadcast %a_ptrs_22 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_26 = tt.broadcast %a_ptrs_24 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_27 = arith.addi %a_ptrs_25, %a_ptrs_26 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_28 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_29 = tt.addptr %a_ptrs_28, %a_ptrs_27 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_30 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_31 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_32 = tt.expand_dims %b_ptrs_30 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_33 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_34 = arith.muli %b_ptrs_31, %b_ptrs_33 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_35 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_36 = tt.broadcast %b_ptrs_34 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_37 = tt.broadcast %b_ptrs_35 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_38 = arith.addi %b_ptrs_36, %b_ptrs_37 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_39 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_40 = tt.addptr %b_ptrs_39, %b_ptrs_38 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_41 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_42 = tt.splat %b_ptrs_41 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_43 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_44 = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
    %a_45 = arith.cmpi slt, %a_ptrs_24, %a_44 : tensor<1x64xi32, #blocked> loc(#loc119)
    %a_46 = tt.broadcast %a_45 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_47 = tt.splat %accumulator_43 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_48 = arith.andi %accumulator_47, %a_46 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_49 = tt.load %a_ptrs_29, %accumulator_48, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_50 = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_51 = arith.cmpi slt, %b_ptrs_32, %b_50 : tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_52 = tt.broadcast %b_51 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_53 = tt.splat %accumulator_43 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_54 = arith.andi %accumulator_53, %b_52 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_55 = tt.load %b_ptrs_40, %accumulator_54, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %a_56 = ttg.memdesc_index %a[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_49, %a_56 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_57 = ttg.memdesc_index %b[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_55, %b_57 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_58 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_59:6 = scf.for %accumulator_81 = %c0_i32 to %accumulator_58 step %c1_i32 iter_args(%accumulator_82 = %accumulator, %a_ptrs_83 = %a_ptrs_29, %b_ptrs_84 = %b_ptrs_40, %accumulator_85 = %c0_i32, %a_86 = %a_56, %b_87 = %b_57) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_88 = tt.addptr %a_ptrs_83, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_89 = tt.addptr %b_ptrs_84, %b_ptrs_42 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_90 = arith.addi %accumulator_81, %c1_i32 : i32 loc(#loc141)
      %a_91 = arith.muli %accumulator_90, %c64_i32 : i32 loc(#loc122)
      %a_92 = arith.subi %K, %a_91 : i32 loc(#loc123)
      %a_93 = tt.splat %a_92 : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
      %a_94 = arith.cmpi slt, %a_ptrs_24, %a_93 : tensor<1x64xi32, #blocked> loc(#loc119)
      %a_95 = tt.broadcast %a_94 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_96 = tt.load %a_ptrs_88, %a_95, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_97 = ttg.local_load %a_86 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_98 = tt.splat %a_92 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_99 = arith.cmpi slt, %b_ptrs_32, %b_98 : tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_100 = tt.broadcast %b_99 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_101 = tt.load %b_ptrs_89, %b_100, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_102 = ttg.local_load %b_87 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_103 = tt.dot %a_97, %b_102, %accumulator_82, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_104 = arith.addi %accumulator_85, %c1_i32 : i32 loc(#loc141)
      %accumulator_105 = arith.cmpi slt, %accumulator_104, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.select %accumulator_105, %accumulator_104, %c0_i32 : i32 loc(#loc141)
      %a_107 = ttg.memdesc_index %a[%accumulator_106] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_96, %a_107 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_108 = ttg.memdesc_index %b[%accumulator_106] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_101, %b_108 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_103, %a_ptrs_88, %b_ptrs_89, %accumulator_106, %a_107, %b_108 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_60 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_61 = ttg.local_load %accumulator_59#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_62 = ttg.local_load %accumulator_59#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_63 = scf.if %accumulator_60 -> (tensor<64x32xf32, #mma>) {
      %accumulator_81 = tt.dot %a_61, %b_62, %accumulator_59#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_81 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_59#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_64 = arith.select %accumulator_60, %accumulator_63, %accumulator_59#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_64 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc126)
    %c_ptrs_65 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_66 = arith.muli %c_ptrs_65, %c_ptrs : tensor<64x1xi32, #blocked1> loc(#loc127)
    %c_ptrs_67 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #blocked1> loc(#loc128)
    %c_ptrs_68 = tt.addptr %c_ptrs_67, %c_ptrs_66 : tensor<64x1x!tt.ptr<f16>, #blocked1>, tensor<64x1xi32, #blocked1> loc(#loc128)
    %c_ptrs_69 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc129)
    %c_ptrs_70 = tt.broadcast %c_ptrs_68 : tensor<64x1x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc130)
    %c_ptrs_71 = tt.broadcast %c_ptrs_69 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc130)
    %c_ptrs_72 = tt.addptr %c_ptrs_70, %c_ptrs_71 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #blocked1> loc(#loc131)
    %c_mask_73 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #blocked1> loc(#loc131)
    %c_mask_74 = tt.splat %N : i32 -> tensor<1x32xi32, #blocked1> loc(#loc132)
    %c_mask_75 = arith.cmpi slt, %c_ptrs_69, %c_mask_74 : tensor<1x32xi32, #blocked1> loc(#loc132)
    %c_mask_76 = tt.broadcast %c_mask_73 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_mask_77 = tt.broadcast %c_mask_75 : tensor<1x32xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_mask_78 = arith.andi %c_mask_76, %c_mask_77 : tensor<64x32xi1, #blocked1> loc(#loc133)
    %c_ptrs_79 = ttg.convert_layout %c_ptrs_72 : tensor<64x32x!tt.ptr<f16>, #blocked1> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_mask_80 = ttg.convert_layout %c_mask_78 : tensor<64x32xi1, #blocked1> -> tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_79, %c, %c_mask_80 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("b"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonGPUReduceDataDuplication (tritongpu-reduce-data-duplication) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_33 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_34 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_35 = tt.expand_dims %b_ptrs_33 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_37 = arith.muli %b_ptrs_34, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_38 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_39 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_40 = tt.broadcast %b_ptrs_38 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_46 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_47 = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
    %a_48 = arith.cmpi slt, %a_ptrs_27, %a_47 : tensor<1x64xi32, #blocked> loc(#loc119)
    %a_49 = tt.broadcast %a_48 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_46 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_51 = arith.andi %accumulator_50, %a_49 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_52 = tt.load %a_ptrs_32, %accumulator_51, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_53 = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_54 = arith.cmpi slt, %b_ptrs_35, %b_53 : tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_55 = tt.broadcast %b_54 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_56 = tt.splat %accumulator_46 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_57 = arith.andi %accumulator_56, %b_55 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_58 = tt.load %b_ptrs_43, %accumulator_57, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %a_59 = ttg.memdesc_index %a[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_52, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_60 = ttg.memdesc_index %b[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_58, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_43, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc119)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_100 = arith.cmpi slt, %b_ptrs_35, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_109 = ttg.memdesc_index %b[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("b"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonAMDGPUInThreadTranspose (tritonamdgpu-in-thread-transpose) ('tt.func' operation: @matmul_kernel) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_33 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_34 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_35 = tt.expand_dims %b_ptrs_33 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_37 = arith.muli %b_ptrs_34, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_38 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_39 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_40 = tt.broadcast %b_ptrs_38 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_46 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_47 = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
    %a_48 = arith.cmpi slt, %a_ptrs_27, %a_47 : tensor<1x64xi32, #blocked> loc(#loc119)
    %a_49 = tt.broadcast %a_48 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_46 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_51 = arith.andi %accumulator_50, %a_49 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_52 = tt.load %a_ptrs_32, %accumulator_51, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_53 = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_54 = arith.cmpi slt, %b_ptrs_35, %b_53 : tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_55 = tt.broadcast %b_54 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_56 = tt.splat %accumulator_46 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_57 = arith.andi %accumulator_56, %b_55 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_58 = tt.load %b_ptrs_43, %accumulator_57, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %a_59 = ttg.memdesc_index %a[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_52, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_60 = ttg.memdesc_index %b[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_58, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_43, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc119)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_100 = arith.cmpi slt, %b_ptrs_35, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_109 = ttg.memdesc_index %b[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("b"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonGPURemoveLayoutConversions (tritongpu-remove-layout-conversions) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_33 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_34 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_35 = tt.expand_dims %b_ptrs_33 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_37 = arith.muli %b_ptrs_34, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_38 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_39 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_40 = tt.broadcast %b_ptrs_38 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_46 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_47 = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
    %a_48 = arith.cmpi slt, %a_ptrs_27, %a_47 : tensor<1x64xi32, #blocked> loc(#loc119)
    %a_49 = tt.broadcast %a_48 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_46 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_51 = arith.andi %accumulator_50, %a_49 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_52 = tt.load %a_ptrs_32, %accumulator_51, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_53 = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_54 = arith.cmpi slt, %b_ptrs_35, %b_53 : tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_55 = tt.broadcast %b_54 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_56 = tt.splat %accumulator_46 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_57 = arith.andi %accumulator_56, %b_55 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_58 = tt.load %b_ptrs_43, %accumulator_57, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %a_59 = ttg.memdesc_index %a[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_52, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_60 = ttg.memdesc_index %b[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_58, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_43, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc119)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_100 = arith.cmpi slt, %b_ptrs_35, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_109 = ttg.memdesc_index %b[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("b"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonAMDGPUReorderInstructions (tritonamdgpu-reorder-instructions) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_33 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc107)
    %b_ptrs_34 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_35 = tt.expand_dims %b_ptrs_33 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc107)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_37 = arith.muli %b_ptrs_34, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc108)
    %b_ptrs_38 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc109)
    %b_ptrs_39 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_40 = tt.broadcast %b_ptrs_38 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_41 = arith.addi %b_ptrs_39, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc110)
    %b_ptrs_42 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc111)
    %b_ptrs_43 = tt.addptr %b_ptrs_42, %b_ptrs_41 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc111)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc112)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc113)
    %b_ptrs_44 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc114)
    %b_ptrs_45 = tt.splat %b_ptrs_44 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %a = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_46 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %a_47 = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
    %a_48 = arith.cmpi slt, %a_ptrs_27, %a_47 : tensor<1x64xi32, #blocked> loc(#loc119)
    %a_49 = tt.broadcast %a_48 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_46 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %accumulator_51 = arith.andi %accumulator_50, %a_49 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_52 = tt.load %a_ptrs_32, %accumulator_51, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
    %b_53 = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_54 = arith.cmpi slt, %b_ptrs_35, %b_53 : tensor<64x1xi32, #blocked1> loc(#loc120)
    %b_55 = tt.broadcast %b_54 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
    %accumulator_56 = tt.splat %accumulator_46 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %accumulator_57 = arith.andi %accumulator_56, %b_55 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_58 = tt.load %b_ptrs_43, %accumulator_57, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
    %a_59 = ttg.memdesc_index %a[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    ttg.local_store %a_52, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
    %b_60 = ttg.memdesc_index %b[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    ttg.local_store %b_58, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_43, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_45 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc115)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc119)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc119)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc116)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc116)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_100 = arith.cmpi slt, %b_ptrs_35, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc120)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc117)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc117)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc116)
      %b_109 = ttg.memdesc_index %b[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc117)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc116)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc117)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc("b_ptrs"(#loc44))
#loc108 = loc("b_ptrs"(#loc45))
#loc109 = loc("b_ptrs"(#loc46))
#loc110 = loc("b_ptrs"(#loc47))
#loc111 = loc("b_ptrs"(#loc48))
#loc112 = loc(callsite(#loc6 at #loc49))
#loc113 = loc(callsite(#loc8 at #loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("a"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("a_ptrs"(#loc54))
#loc119 = loc("a"(#loc55))
#loc120 = loc("b"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc118))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonAMDGPUBlockPingpong (tritonamdgpu-block-pingpong) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc107)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc108)
    %accumulator_33 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %accumulator_34 = tt.splat %accumulator_33 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc110)
    %a_35 = arith.cmpi slt, %a_ptrs_27, %a : tensor<1x64xi32, #blocked> loc(#loc110)
    %a_36 = tt.broadcast %a_35 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc111)
    %accumulator_37 = arith.andi %accumulator_34, %a_36 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_38 = tt.load %a_ptrs_32, %accumulator_37, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc111)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc112)
    %b_ptrs_39 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc112)
    %b_ptrs_40 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc112)
    %b_ptrs_41 = tt.expand_dims %b_ptrs_39 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc112)
    %b_ptrs_42 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc113)
    %b_ptrs_43 = arith.muli %b_ptrs_40, %b_ptrs_42 : tensor<64x1xi32, #blocked1> loc(#loc113)
    %b_ptrs_44 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc114)
    %b_ptrs_45 = tt.broadcast %b_ptrs_43 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_46 = tt.broadcast %b_ptrs_44 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_47 = arith.addi %b_ptrs_45, %b_ptrs_46 : tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_48 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc116)
    %b_ptrs_49 = tt.addptr %b_ptrs_48, %b_ptrs_47 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_33 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc117)
    %b_51 = arith.cmpi slt, %b_ptrs_41, %b : tensor<64x1xi32, #blocked1> loc(#loc117)
    %b_52 = tt.broadcast %b_51 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc118)
    %accumulator_53 = arith.andi %accumulator_50, %b_52 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_54 = tt.load %b_ptrs_49, %accumulator_53, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc118)
    %b_ptrs_55 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc119)
    %b_ptrs_56 = tt.splat %b_ptrs_55 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc120)
    %a_57 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc111)
    %b_58 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    %a_59 = ttg.memdesc_index %a_57[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
    ttg.local_store %a_38, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
    %b_60 = ttg.memdesc_index %b_58[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    ttg.local_store %b_54, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_49, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_56 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc120)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc110)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc110)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc111)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc111)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc111)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc117)
      %b_100 = arith.cmpi slt, %b_ptrs_41, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc117)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc118)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc118)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc118)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a_57[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
      %b_109 = ttg.memdesc_index %b_58[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc111)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc118)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b_58 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a_57 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc(callsite(#loc6 at #loc44))
#loc108 = loc(callsite(#loc8 at #loc44))
#loc109 = loc("a_ptrs"(#loc45))
#loc110 = loc("a"(#loc46))
#loc111 = loc("a"(#loc47))
#loc112 = loc("b_ptrs"(#loc48))
#loc113 = loc("b_ptrs"(#loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("b"(#loc54))
#loc119 = loc("b_ptrs"(#loc55))
#loc120 = loc("b_ptrs"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc109))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before TritonAMDGPUCanonicalizePointers (tritonamdgpu-canonicalize-pointers) ('tt.func' operation: @matmul_kernel) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc72 = loc("a_ptr"(#loc))
#loc73 = loc("b_ptr"(#loc))
#loc74 = loc("c_ptr"(#loc))
#loc75 = loc("M"(#loc))
#loc76 = loc("N"(#loc))
#loc77 = loc("K"(#loc))
#loc78 = loc("stride_am"(#loc))
#loc79 = loc("stride_bk"(#loc))
#loc80 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc134)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc135)
    %pid = tt.get_program_id x : i32 loc(#loc83)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc136)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc137)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc138)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc139)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc85)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc86)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc87)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc88)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc89)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc90)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc91)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc92)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc93)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc94)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc95)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc95)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc96)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc96)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc97)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc98)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc99)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc99)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc100)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc100)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc101)
    %a_ptrs = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc102)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_25 = arith.muli %a_ptrs, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc103)
    %a_ptrs_26 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc104)
    %a_ptrs_27 = tt.expand_dims %a_ptrs_26 {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc104)
    %a_ptrs_28 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_29 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_30 = arith.addi %a_ptrs_28, %a_ptrs_29 : tensor<64x64xi32, #blocked> loc(#loc105)
    %a_ptrs_31 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc106)
    %a_ptrs_32 = tt.addptr %a_ptrs_31, %a_ptrs_30 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc106)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc107)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc108)
    %accumulator_33 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc141)
    %accumulator_34 = tt.splat %accumulator_33 : i1 -> tensor<64x64xi1, #blocked> loc(#loc141)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc110)
    %a_35 = arith.cmpi slt, %a_ptrs_27, %a : tensor<1x64xi32, #blocked> loc(#loc110)
    %a_36 = tt.broadcast %a_35 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc111)
    %accumulator_37 = arith.andi %accumulator_34, %a_36 : tensor<64x64xi1, #blocked> loc(#loc141)
    %a_38 = tt.load %a_ptrs_32, %accumulator_37, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc111)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc112)
    %b_ptrs_39 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc112)
    %b_ptrs_40 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc112)
    %b_ptrs_41 = tt.expand_dims %b_ptrs_39 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc112)
    %b_ptrs_42 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc113)
    %b_ptrs_43 = arith.muli %b_ptrs_40, %b_ptrs_42 : tensor<64x1xi32, #blocked1> loc(#loc113)
    %b_ptrs_44 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc114)
    %b_ptrs_45 = tt.broadcast %b_ptrs_43 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_46 = tt.broadcast %b_ptrs_44 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_47 = arith.addi %b_ptrs_45, %b_ptrs_46 : tensor<64x32xi32, #blocked1> loc(#loc115)
    %b_ptrs_48 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc116)
    %b_ptrs_49 = tt.addptr %b_ptrs_48, %b_ptrs_47 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc116)
    %accumulator_50 = tt.splat %accumulator_33 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc141)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc117)
    %b_51 = arith.cmpi slt, %b_ptrs_41, %b : tensor<64x1xi32, #blocked1> loc(#loc117)
    %b_52 = tt.broadcast %b_51 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc118)
    %accumulator_53 = arith.andi %accumulator_50, %b_52 : tensor<64x32xi1, #blocked1> loc(#loc141)
    %b_54 = tt.load %b_ptrs_49, %accumulator_53, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc118)
    %b_ptrs_55 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc119)
    %b_ptrs_56 = tt.splat %b_ptrs_55 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc120)
    %a_57 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc111)
    %b_58 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    %a_59 = ttg.memdesc_index %a_57[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
    ttg.local_store %a_38, %a_59 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
    %b_60 = ttg.memdesc_index %b_58[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    ttg.local_store %b_54, %b_60 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
    %accumulator_61 = arith.subi %6, %c1_i32 : i32 loc(#loc141)
    %accumulator_62:6 = scf.for %accumulator_82 = %c0_i32 to %accumulator_61 step %c1_i32 iter_args(%accumulator_83 = %accumulator, %a_ptrs_84 = %a_ptrs_32, %b_ptrs_85 = %b_ptrs_49, %accumulator_86 = %c0_i32, %a_87 = %a_59, %b_88 = %b_60) -> (tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_89 = tt.addptr %a_ptrs_84, %cst : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc121)
      %b_ptrs_90 = tt.addptr %b_ptrs_85, %b_ptrs_56 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc120)
      %accumulator_91 = arith.addi %accumulator_82, %c1_i32 : i32 loc(#loc141)
      %a_92 = arith.muli %accumulator_91, %c64_i32 : i32 loc(#loc122)
      %a_93 = arith.subi %K, %a_92 : i32 loc(#loc123)
      %a_94 = tt.splat %a_93 : i32 -> tensor<1x64xi32, #blocked> loc(#loc110)
      %a_95 = arith.cmpi slt, %a_ptrs_27, %a_94 : tensor<1x64xi32, #blocked> loc(#loc110)
      %a_96 = tt.broadcast %a_95 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc111)
      %a_97 = tt.load %a_ptrs_89, %a_96, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc111)
      %a_98 = ttg.local_load %a_87 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc111)
      %b_99 = tt.splat %a_93 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc117)
      %b_100 = arith.cmpi slt, %b_ptrs_41, %b_99 : tensor<64x1xi32, #blocked1> loc(#loc117)
      %b_101 = tt.broadcast %b_100 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc118)
      %b_102 = tt.load %b_ptrs_90, %b_101, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc118)
      %b_103 = ttg.local_load %b_88 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc118)
      %accumulator_104 = tt.dot %a_98, %b_103, %accumulator_83, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      %accumulator_105 = arith.addi %accumulator_86, %c1_i32 : i32 loc(#loc141)
      %accumulator_106 = arith.cmpi slt, %accumulator_105, %c1_i32 : i32 loc(#loc141)
      %accumulator_107 = arith.select %accumulator_106, %accumulator_105, %c0_i32 : i32 loc(#loc141)
      %a_108 = ttg.memdesc_index %a_57[%accumulator_107] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
      ttg.local_store %a_97, %a_108 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc111)
      %b_109 = ttg.memdesc_index %b_58[%accumulator_107] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
      ttg.local_store %b_102, %b_109 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc118)
      scf.yield %accumulator_104, %a_ptrs_89, %b_ptrs_90, %accumulator_107, %a_108, %b_109 : tensor<64x32xf32, #mma>, tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x32x!tt.ptr<f16>, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    } loc(#loc141)
    %accumulator_63 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc141)
    %a_64 = ttg.local_load %accumulator_62#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc111)
    %b_65 = ttg.local_load %accumulator_62#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc118)
    %accumulator_66 = scf.if %accumulator_63 -> (tensor<64x32xf32, #mma>) {
      %accumulator_82 = tt.dot %a_64, %b_65, %accumulator_62#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc124)
      scf.yield %accumulator_82 : tensor<64x32xf32, #mma> loc(#loc124)
    } else {
      scf.yield %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc124)
    } loc(#loc124)
    %accumulator_67 = arith.select %accumulator_63, %accumulator_66, %accumulator_62#0 : tensor<64x32xf32, #mma> loc(#loc141)
    ttg.local_dealloc %b_58 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc141)
    ttg.local_dealloc %a_57 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc141)
    %c = arith.truncf %accumulator_67 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc125)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc126)
    %c_ptrs_68 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_69 = arith.muli %c_ptrs_68, %c_ptrs : tensor<64x1xi32, #mma> loc(#loc127)
    %c_ptrs_70 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x1x!tt.ptr<f16>, #mma> loc(#loc128)
    %c_ptrs_71 = tt.addptr %c_ptrs_70, %c_ptrs_69 : tensor<64x1x!tt.ptr<f16>, #mma>, tensor<64x1xi32, #mma> loc(#loc128)
    %c_ptrs_72 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc129)
    %c_ptrs_73 = tt.broadcast %c_ptrs_71 : tensor<64x1x!tt.ptr<f16>, #mma> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc130)
    %c_ptrs_74 = tt.broadcast %c_ptrs_72 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc130)
    %c_ptrs_75 = tt.addptr %c_ptrs_73, %c_ptrs_74 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc130)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_76 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc131)
    %c_mask_77 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_78 = arith.cmpi slt, %c_ptrs_72, %c_mask_77 : tensor<1x32xi32, #mma> loc(#loc132)
    %c_mask_79 = tt.broadcast %c_mask_76 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_80 = tt.broadcast %c_mask_78 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc133)
    %c_mask_81 = arith.andi %c_mask_79, %c_mask_80 : tensor<64x32xi1, #mma> loc(#loc133)
    tt.store %c_ptrs_75, %c, %c_mask_81 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc70)
    tt.return loc(#loc71)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:30)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:41)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:53)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:40)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:60)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:52)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:33)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc65 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc66 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc67 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc68 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc69 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc70 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc71 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc81 = loc("num_pid_n"(#loc2))
#loc82 = loc("accumulator"(#loc4))
#loc83 = loc("pid"(#loc5))
#loc84 = loc("num_pid_m"(#loc7))
#loc85 = loc("num_pid_in_group"(#loc9))
#loc86 = loc("group_id"(#loc10))
#loc87 = loc("first_pid_m"(#loc11))
#loc88 = loc("group_size_m"(#loc12))
#loc89 = loc("group_size_m"(#loc13))
#loc90 = loc("pid_m"(#loc14))
#loc91 = loc("pid_m"(#loc15))
#loc92 = loc("pid_m"(#loc16))
#loc93 = loc("pid_n"(#loc17))
#loc94 = loc("offs_am"(#loc31))
#loc95 = loc("offs_am"(#loc32))
#loc96 = loc("offs_am"(#loc33))
#loc97 = loc("offs_am"(#loc34))
#loc98 = loc("offs_bn"(#loc35))
#loc99 = loc("offs_bn"(#loc36))
#loc100 = loc("offs_bn"(#loc37))
#loc101 = loc("offs_bn"(#loc38))
#loc102 = loc("a_ptrs"(#loc39))
#loc103 = loc("a_ptrs"(#loc40))
#loc104 = loc("a_ptrs"(#loc41))
#loc105 = loc("a_ptrs"(#loc42))
#loc106 = loc("a_ptrs"(#loc43))
#loc107 = loc(callsite(#loc6 at #loc44))
#loc108 = loc(callsite(#loc8 at #loc44))
#loc109 = loc("a_ptrs"(#loc45))
#loc110 = loc("a"(#loc46))
#loc111 = loc("a"(#loc47))
#loc112 = loc("b_ptrs"(#loc48))
#loc113 = loc("b_ptrs"(#loc49))
#loc114 = loc("b_ptrs"(#loc50))
#loc115 = loc("b_ptrs"(#loc51))
#loc116 = loc("b_ptrs"(#loc52))
#loc117 = loc("b"(#loc53))
#loc118 = loc("b"(#loc54))
#loc119 = loc("b_ptrs"(#loc55))
#loc120 = loc("b_ptrs"(#loc56))
#loc121 = loc("a_ptrs"(#loc57))
#loc122 = loc("a"(#loc58))
#loc123 = loc("a"(#loc59))
#loc124 = loc("accumulator"(#loc60))
#loc125 = loc("c"(#loc61))
#loc126 = loc("c_ptrs"(#loc62))
#loc127 = loc("c_ptrs"(#loc63))
#loc128 = loc("c_ptrs"(#loc64))
#loc129 = loc("c_ptrs"(#loc65))
#loc130 = loc("c_ptrs"(#loc66))
#loc131 = loc("c_mask"(#loc67))
#loc132 = loc("c_mask"(#loc68))
#loc133 = loc("c_mask"(#loc69))
#loc134 = loc(callsite(#loc1 at #loc81))
#loc135 = loc(callsite(#loc3 at #loc82))
#loc136 = loc(callsite(#loc6 at #loc84))
#loc137 = loc(callsite(#loc8 at #loc84))
#loc138 = loc(callsite(#loc6 at #loc81))
#loc139 = loc(callsite(#loc8 at #loc81))
#loc140 = loc("b_ptrs"(#loc109))
#loc141 = loc("accumulator"(#loc140))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc65 = loc("a_ptr"(#loc))
#loc66 = loc("b_ptr"(#loc))
#loc67 = loc("c_ptr"(#loc))
#loc68 = loc("M"(#loc))
#loc69 = loc("N"(#loc))
#loc70 = loc("K"(#loc))
#loc71 = loc("stride_am"(#loc))
#loc72 = loc("stride_bk"(#loc))
#loc73 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc120)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc121)
    %pid = tt.get_program_id x : i32 loc(#loc76)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc122)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc123)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc124)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc125)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc78)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc79)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc80)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc81)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc82)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc83)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc84)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc85)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc86)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc87)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc88)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc88)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc91)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc92)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc92)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc95)
    %a_ptrs_24 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_ptrs_25 = arith.constant 0 : i32 loc(#loc96)
    %a_ptrs_26 = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_27 = arith.constant dense<0> : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_28 = arith.muli %a_ptrs_25, %stride_am : i32 loc(#loc96)
    %a_ptrs_29 = tt.splat %a_ptrs_25 : i32 -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_30 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_31 = arith.muli %a_ptrs_26, %a_ptrs_27 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_32 = arith.muli %a_ptrs_29, %a_ptrs_27 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_33 = arith.muli %a_ptrs_26, %a_ptrs_30 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_34 = arith.addi %a_ptrs_31, %a_ptrs_32 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_35 = arith.addi %a_ptrs_34, %a_ptrs_33 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_36 = tt.broadcast %a_ptrs_35 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_37 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc96)
    %a_ptrs_38 = tt.broadcast %a_ptrs_37 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_39 = arith.addi %a_ptrs_36, %a_ptrs_38 : tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_40 = tt.splat %a_ptrs_28 : i32 -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_41 = arith.addi %a_ptrs_40, %a_ptrs_39 : tensor<64x64xi32, #blocked> loc(#loc96)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc97)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc98)
    %accumulator_42 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc127)
    %accumulator_43 = tt.splat %accumulator_42 : i1 -> tensor<64x64xi1, #blocked> loc(#loc127)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
    %a_44 = arith.cmpi slt, %a_ptrs_24, %a : tensor<1x64xi32, #blocked> loc(#loc100)
    %a_45 = tt.broadcast %a_44 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
    %accumulator_46 = arith.andi %accumulator_43, %a_45 : tensor<64x64xi1, #blocked> loc(#loc127)
    %a_47 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
    %a_48 = tt.addptr %a_47, %a_ptrs_41 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc101)
    %a_49 = tt.load %a_48, %accumulator_46, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_50 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_51 = tt.expand_dims %b_ptrs_50 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc102)
    %b_ptrs_52 = arith.constant 0 : i32 loc(#loc103)
    %b_ptrs_53 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_54 = arith.constant dense<0> : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_55 = arith.muli %b_ptrs_52, %stride_bk : i32 loc(#loc103)
    %b_ptrs_56 = tt.splat %b_ptrs_52 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_57 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_58 = arith.muli %b_ptrs_53, %b_ptrs_54 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_59 = arith.muli %b_ptrs_56, %b_ptrs_54 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_60 = arith.muli %b_ptrs_53, %b_ptrs_57 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_61 = arith.addi %b_ptrs_58, %b_ptrs_59 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_62 = arith.addi %b_ptrs_61, %b_ptrs_60 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_63 = tt.broadcast %b_ptrs_62 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_64 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_65 = tt.broadcast %b_ptrs_64 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_66 = arith.addi %b_ptrs_63, %b_ptrs_65 : tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_67 = tt.splat %b_ptrs_55 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_68 = arith.addi %b_ptrs_67, %b_ptrs_66 : tensor<64x32xi32, #blocked1> loc(#loc103)
    %accumulator_69 = tt.splat %accumulator_42 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc127)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_70 = arith.cmpi slt, %b_ptrs_51, %b : tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_71 = tt.broadcast %b_70 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
    %accumulator_72 = arith.andi %accumulator_69, %b_71 : tensor<64x32xi1, #blocked1> loc(#loc127)
    %b_73 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
    %b_74 = tt.addptr %b_73, %b_ptrs_68 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc105)
    %b_75 = tt.load %b_74, %accumulator_72, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
    %b_ptrs_76 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc106)
    %b_ptrs_77 = tt.splat %b_ptrs_76 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc107)
    %a_78 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_79 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %a_80 = ttg.memdesc_index %a_78[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    ttg.local_store %a_49, %a_80 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_81 = ttg.memdesc_index %b_79[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    ttg.local_store %b_75, %b_81 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %accumulator_82 = arith.subi %6, %c1_i32 : i32 loc(#loc127)
    %accumulator_83:8 = scf.for %accumulator_143 = %c0_i32 to %accumulator_82 step %c1_i32 iter_args(%accumulator_144 = %accumulator, %a_ptrs_145 = %a_ptr, %a_ptrs_146 = %a_ptrs_41, %b_ptrs_147 = %b_ptr, %b_ptrs_148 = %b_ptrs_68, %accumulator_149 = %c0_i32, %a_150 = %a_80, %b_151 = %b_81) -> (tensor<64x32xf32, #mma>, !tt.ptr<f16>, tensor<64x64xi32, #blocked>, !tt.ptr<f16>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_152 = arith.addi %a_ptrs_146, %cst : tensor<64x64xi32, #blocked> loc(#loc108)
      %b_ptrs_153 = arith.addi %b_ptrs_148, %b_ptrs_77 : tensor<64x32xi32, #blocked1> loc(#loc107)
      %accumulator_154 = arith.addi %accumulator_143, %c1_i32 : i32 loc(#loc127)
      %a_155 = arith.muli %accumulator_154, %c64_i32 : i32 loc(#loc109)
      %a_156 = arith.subi %K, %a_155 : i32 loc(#loc110)
      %a_157 = tt.splat %a_156 : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
      %a_158 = arith.cmpi slt, %a_ptrs_24, %a_157 : tensor<1x64xi32, #blocked> loc(#loc100)
      %a_159 = tt.broadcast %a_158 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
      %a_160 = tt.splat %a_ptrs_145 : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
      %a_161 = tt.addptr %a_160, %a_ptrs_152 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc101)
      %a_162 = tt.load %a_161, %a_159, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
      %a_163 = ttg.local_load %a_150 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
      %b_164 = tt.splat %a_156 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_165 = arith.cmpi slt, %b_ptrs_51, %b_164 : tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_166 = tt.broadcast %b_165 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
      %b_167 = tt.splat %b_ptrs_147 : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
      %b_168 = tt.addptr %b_167, %b_ptrs_153 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc105)
      %b_169 = tt.load %b_168, %b_166, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
      %b_170 = ttg.local_load %b_151 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
      %accumulator_171 = tt.dot %a_163, %b_170, %accumulator_144, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      %accumulator_172 = arith.addi %accumulator_149, %c1_i32 : i32 loc(#loc127)
      %accumulator_173 = arith.cmpi slt, %accumulator_172, %c1_i32 : i32 loc(#loc127)
      %accumulator_174 = arith.select %accumulator_173, %accumulator_172, %c0_i32 : i32 loc(#loc127)
      %a_175 = ttg.memdesc_index %a_78[%accumulator_174] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      ttg.local_store %a_162, %a_175 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      %b_176 = ttg.memdesc_index %b_79[%accumulator_174] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      ttg.local_store %b_169, %b_176 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      scf.yield %accumulator_171, %a_ptrs_145, %a_ptrs_152, %b_ptrs_147, %b_ptrs_153, %accumulator_174, %a_175, %b_176 : tensor<64x32xf32, #mma>, !tt.ptr<f16>, tensor<64x64xi32, #blocked>, !tt.ptr<f16>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    } loc(#loc127)
    %accumulator_84 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc127)
    %a_85 = ttg.local_load %accumulator_83#6 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
    %b_86 = ttg.local_load %accumulator_83#7 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
    %accumulator_87 = scf.if %accumulator_84 -> (tensor<64x32xf32, #mma>) {
      %accumulator_143 = tt.dot %a_85, %b_86, %accumulator_83#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      scf.yield %accumulator_143 : tensor<64x32xf32, #mma> loc(#loc111)
    } else {
      scf.yield %accumulator_83#0 : tensor<64x32xf32, #mma> loc(#loc111)
    } loc(#loc111)
    %accumulator_88 = arith.select %accumulator_84, %accumulator_87, %accumulator_83#0 : tensor<64x32xf32, #mma> loc(#loc127)
    ttg.local_dealloc %b_79 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    ttg.local_dealloc %a_78 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc127)
    %c = arith.truncf %accumulator_88 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc112)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc113)
    %c_ptrs_89 = arith.muli %stride_cm, %offs_am : i32 loc(#loc114)
    %c_ptrs_90 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc115)
    %c_ptrs_91 = arith.constant 0 : i32 loc(#loc116)
    %c_ptrs_92 = arith.constant dense<0> : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_93 = arith.constant 0 : i32 loc(#loc116)
    %c_ptrs_94 = tt.expand_dims %offs_am_9 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_95 = arith.muli %c_ptrs_91, %c_ptrs_93 : i32 loc(#loc116)
    %c_ptrs_96 = tt.splat %c_ptrs_91 : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_97 = tt.splat %c_ptrs_93 : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_98 = arith.muli %c_ptrs_92, %c_ptrs_94 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_99 = arith.muli %c_ptrs_96, %c_ptrs_94 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_100 = arith.muli %c_ptrs_92, %c_ptrs_97 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_101 = arith.addi %c_ptrs_98, %c_ptrs_99 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_102 = arith.addi %c_ptrs_101, %c_ptrs_100 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_103 = arith.constant dense<0> : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_104 = arith.constant 0 : i32 loc(#loc116)
    %c_ptrs_105 = tt.expand_dims %offs_am_9 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_106 = arith.muli %stride_cm, %c_ptrs_104 : i32 loc(#loc116)
    %c_ptrs_107 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_108 = tt.splat %c_ptrs_104 : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_109 = arith.muli %c_ptrs_103, %c_ptrs_105 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_110 = arith.muli %c_ptrs_107, %c_ptrs_105 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_111 = arith.muli %c_ptrs_103, %c_ptrs_108 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_112 = arith.addi %c_ptrs_109, %c_ptrs_110 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_113 = arith.addi %c_ptrs_112, %c_ptrs_111 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_114 = arith.addi %c_ptrs_95, %c_ptrs_106 : i32 loc(#loc116)
    %c_ptrs_115 = arith.addi %c_ptrs_102, %c_ptrs_113 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_116 = arith.constant 0 : i32 loc(#loc116)
    %c_ptrs_117 = arith.constant dense<0> : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_118 = arith.constant dense<0> : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_119 = arith.muli %c_ptrs_116, %offs_am : i32 loc(#loc116)
    %c_ptrs_120 = tt.splat %c_ptrs_116 : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_121 = tt.splat %offs_am : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_122 = arith.muli %c_ptrs_117, %c_ptrs_118 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_123 = arith.muli %c_ptrs_120, %c_ptrs_118 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_124 = arith.muli %c_ptrs_117, %c_ptrs_121 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_125 = arith.addi %c_ptrs_122, %c_ptrs_123 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_126 = arith.addi %c_ptrs_125, %c_ptrs_124 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_127 = arith.addi %c_ptrs_114, %c_ptrs_119 : i32 loc(#loc116)
    %c_ptrs_128 = arith.addi %c_ptrs_115, %c_ptrs_126 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_129 = arith.addi %c_ptrs_89, %c_ptrs_127 : i32 loc(#loc116)
    %c_ptrs_130 = tt.broadcast %c_ptrs_128 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_131 = tt.expand_dims %offs_bn_16 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc116)
    %c_ptrs_132 = tt.broadcast %c_ptrs_131 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_133 = arith.addi %c_ptrs_129, %offs_bn : i32 loc(#loc116)
    %c_ptrs_134 = arith.addi %c_ptrs_130, %c_ptrs_132 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_135 = tt.splat %c_ptrs_133 : i32 -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_136 = arith.addi %c_ptrs_135, %c_ptrs_134 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_137 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_138 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_139 = arith.cmpi slt, %c_ptrs_90, %c_mask_138 : tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_140 = tt.broadcast %c_mask_137 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_141 = tt.broadcast %c_mask_139 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_142 = arith.andi %c_mask_140, %c_mask_141 : tensor<64x32xi1, #mma> loc(#loc119)
    %7 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc63)
    %8 = tt.addptr %7, %c_ptrs_136 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc63)
    tt.store %8, %c, %c_mask_142 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc63)
    tt.return loc(#loc64)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc74 = loc("num_pid_n"(#loc2))
#loc75 = loc("accumulator"(#loc4))
#loc76 = loc("pid"(#loc5))
#loc77 = loc("num_pid_m"(#loc7))
#loc78 = loc("num_pid_in_group"(#loc9))
#loc79 = loc("group_id"(#loc10))
#loc80 = loc("first_pid_m"(#loc11))
#loc81 = loc("group_size_m"(#loc12))
#loc82 = loc("group_size_m"(#loc13))
#loc83 = loc("pid_m"(#loc14))
#loc84 = loc("pid_m"(#loc15))
#loc85 = loc("pid_m"(#loc16))
#loc86 = loc("pid_n"(#loc17))
#loc87 = loc("offs_am"(#loc31))
#loc88 = loc("offs_am"(#loc32))
#loc89 = loc("offs_am"(#loc33))
#loc90 = loc("offs_am"(#loc34))
#loc91 = loc("offs_bn"(#loc35))
#loc92 = loc("offs_bn"(#loc36))
#loc93 = loc("offs_bn"(#loc37))
#loc94 = loc("offs_bn"(#loc38))
#loc95 = loc("a_ptrs"(#loc39))
#loc96 = loc("a_ptrs"(#loc40))
#loc97 = loc(callsite(#loc6 at #loc41))
#loc98 = loc(callsite(#loc8 at #loc41))
#loc99 = loc("a_ptrs"(#loc42))
#loc100 = loc("a"(#loc43))
#loc101 = loc("a"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("b_ptrs"(#loc46))
#loc104 = loc("b"(#loc47))
#loc105 = loc("b"(#loc48))
#loc106 = loc("b_ptrs"(#loc49))
#loc107 = loc("b_ptrs"(#loc50))
#loc108 = loc("a_ptrs"(#loc51))
#loc109 = loc("a"(#loc52))
#loc110 = loc("a"(#loc53))
#loc111 = loc("accumulator"(#loc54))
#loc112 = loc("c"(#loc55))
#loc113 = loc("c_ptrs"(#loc56))
#loc114 = loc("c_ptrs"(#loc57))
#loc115 = loc("c_ptrs"(#loc58))
#loc116 = loc("c_ptrs"(#loc59))
#loc117 = loc("c_mask"(#loc60))
#loc118 = loc("c_mask"(#loc61))
#loc119 = loc("c_mask"(#loc62))
#loc120 = loc(callsite(#loc1 at #loc74))
#loc121 = loc(callsite(#loc3 at #loc75))
#loc122 = loc(callsite(#loc6 at #loc77))
#loc123 = loc(callsite(#loc8 at #loc77))
#loc124 = loc(callsite(#loc6 at #loc74))
#loc125 = loc(callsite(#loc8 at #loc74))
#loc126 = loc("b_ptrs"(#loc99))
#loc127 = loc("accumulator"(#loc126))


// -----// IR Dump Before TritonAMDGPUConvertToBufferOps (tritonamdgpu-convert-buffer-ops) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc65 = loc("a_ptr"(#loc))
#loc66 = loc("b_ptr"(#loc))
#loc67 = loc("c_ptr"(#loc))
#loc68 = loc("M"(#loc))
#loc69 = loc("N"(#loc))
#loc70 = loc("K"(#loc))
#loc71 = loc("stride_am"(#loc))
#loc72 = loc("stride_bk"(#loc))
#loc73 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %cst_0 = arith.constant dense<0.000000e+00> : tensor<64x64xf16, #blocked> loc(#loc1)
    %cst_1 = arith.constant dense<0.000000e+00> : tensor<64x32xf16, #blocked1> loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc120)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc121)
    %pid = tt.get_program_id x : i32 loc(#loc76)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc122)
    %num_pid_m_2 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc123)
    %num_pid_n_3 = arith.addi %N, %num_pid_n : i32 loc(#loc124)
    %num_pid_n_4 = arith.divsi %num_pid_n_3, %c32_i32 : i32 loc(#loc125)
    %num_pid_in_group = arith.muli %num_pid_n_4, %c4_i32 : i32 loc(#loc78)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc79)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc80)
    %group_size_m = arith.subi %num_pid_m_2, %first_pid_m : i32 loc(#loc81)
    %group_size_m_5 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc82)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc83)
    %pid_m_6 = arith.remsi %pid_m, %group_size_m_5 : i32 loc(#loc84)
    %pid_m_7 = arith.addi %first_pid_m, %pid_m_6 : i32 loc(#loc85)
    %pid_n = arith.divsi %pid_m, %group_size_m_5 : i32 loc(#loc86)
    %0 = arith.cmpi sge, %pid_m_7, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_7, %c64_i32 : i32 loc(#loc87)
    %offs_am_8 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc88)
    %offs_am_9 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc88)
    %offs_am_10 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_11 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_12 = arith.addi %offs_am_10, %offs_am_8 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_13 = arith.addi %offs_am_11, %offs_am_9 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_14 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_am_15 = arith.remsi %offs_am_12, %offs_am_14 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc91)
    %offs_bn_16 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc92)
    %offs_bn_17 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc92)
    %offs_bn_18 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_19 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_20 = arith.addi %offs_bn_18, %offs_bn_16 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_21 = arith.addi %offs_bn_19, %offs_bn_17 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_22 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %offs_bn_23 = arith.remsi %offs_bn_21, %offs_bn_22 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc95)
    %a_ptrs_24 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_ptrs_25 = tt.expand_dims %offs_am_15 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_26 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_27 = arith.muli %a_ptrs_25, %a_ptrs_26 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_28 = tt.broadcast %a_ptrs_27 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_29 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc96)
    %a_ptrs_30 = tt.broadcast %a_ptrs_29 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_31 = arith.addi %a_ptrs_28, %a_ptrs_30 : tensor<64x64xi32, #blocked> loc(#loc96)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc97)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc98)
    %accumulator_32 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc127)
    %accumulator_33 = tt.splat %accumulator_32 : i1 -> tensor<64x64xi1, #blocked> loc(#loc127)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
    %a_34 = arith.cmpi slt, %a_ptrs_24, %a : tensor<1x64xi32, #blocked> loc(#loc100)
    %a_35 = tt.broadcast %a_34 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
    %accumulator_36 = arith.andi %accumulator_33, %a_35 : tensor<64x64xi1, #blocked> loc(#loc127)
    %a_37 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
    %a_38 = tt.addptr %a_37, %a_ptrs_31 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc101)
    %a_39 = tt.load %a_38, %accumulator_36, %cst_0 {amd.pipeliner_part = "prologue"} : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_40 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_41 = tt.expand_dims %b_ptrs_40 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc102)
    %b_ptrs_42 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_43 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_44 = arith.muli %b_ptrs_42, %b_ptrs_43 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_45 = tt.broadcast %b_ptrs_44 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_46 = tt.expand_dims %offs_bn_23 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_47 = tt.broadcast %b_ptrs_46 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_48 = arith.addi %b_ptrs_45, %b_ptrs_47 : tensor<64x32xi32, #blocked1> loc(#loc103)
    %accumulator_49 = tt.splat %accumulator_32 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc127)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_50 = arith.cmpi slt, %b_ptrs_41, %b : tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_51 = tt.broadcast %b_50 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
    %accumulator_52 = arith.andi %accumulator_49, %b_51 : tensor<64x32xi1, #blocked1> loc(#loc127)
    %b_53 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
    %b_54 = tt.addptr %b_53, %b_ptrs_48 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc105)
    %b_55 = tt.load %b_54, %accumulator_52, %cst_1 {amd.pipeliner_part = "prologue"} : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
    %b_ptrs_56 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc106)
    %b_ptrs_57 = tt.splat %b_ptrs_56 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc107)
    %a_58 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_59 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %a_60 = ttg.memdesc_index %a_58[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    ttg.local_store %a_39, %a_60 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_61 = ttg.memdesc_index %b_59[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    ttg.local_store %b_55, %b_61 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %accumulator_62 = arith.subi %6, %c1_i32 : i32 loc(#loc127)
    %accumulator_63:6 = scf.for %accumulator_87 = %c0_i32 to %accumulator_62 step %c1_i32 iter_args(%accumulator_88 = %accumulator, %a_ptrs_89 = %a_ptrs_31, %b_ptrs_90 = %b_ptrs_48, %arg13 = %c0_i32, %a_91 = %a_60, %b_92 = %b_61) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_93 = arith.addi %a_ptrs_89, %cst : tensor<64x64xi32, #blocked> loc(#loc108)
      %b_ptrs_94 = arith.addi %b_ptrs_90, %b_ptrs_57 : tensor<64x32xi32, #blocked1> loc(#loc107)
      %accumulator_95 = arith.addi %accumulator_87, %c1_i32 : i32 loc(#loc127)
      %a_96 = arith.muli %accumulator_95, %c64_i32 : i32 loc(#loc109)
      %a_97 = arith.subi %K, %a_96 : i32 loc(#loc110)
      %a_98 = tt.splat %a_97 : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
      %a_99 = arith.cmpi slt, %a_ptrs_24, %a_98 : tensor<1x64xi32, #blocked> loc(#loc100)
      %a_100 = tt.broadcast %a_99 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
      %a_101 = tt.splat %a_ptr : !tt.ptr<f16> -> tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
      %a_102 = tt.addptr %a_101, %a_ptrs_93 : tensor<64x64x!tt.ptr<f16>, #blocked>, tensor<64x64xi32, #blocked> loc(#loc101)
      %a_103 = tt.load %a_102, %a_100, %cst_0 : tensor<64x64x!tt.ptr<f16>, #blocked> loc(#loc101)
      %a_104 = ttg.local_load %a_91 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
      %b_105 = tt.splat %a_97 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_106 = arith.cmpi slt, %b_ptrs_41, %b_105 : tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_107 = tt.broadcast %b_106 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
      %b_108 = tt.splat %b_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
      %b_109 = tt.addptr %b_108, %b_ptrs_94 : tensor<64x32x!tt.ptr<f16>, #blocked1>, tensor<64x32xi32, #blocked1> loc(#loc105)
      %b_110 = tt.load %b_109, %b_107, %cst_1 : tensor<64x32x!tt.ptr<f16>, #blocked1> loc(#loc105)
      %b_111 = ttg.local_load %b_92 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
      %accumulator_112 = tt.dot %a_104, %b_111, %accumulator_88, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      %accumulator_113 = arith.addi %arg13, %c1_i32 : i32 loc(#loc127)
      %accumulator_114 = arith.cmpi slt, %accumulator_113, %c1_i32 : i32 loc(#loc127)
      %accumulator_115 = arith.select %accumulator_114, %accumulator_113, %c0_i32 : i32 loc(#loc127)
      %a_116 = ttg.memdesc_index %a_58[%accumulator_115] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      ttg.local_store %a_103, %a_116 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      %b_117 = ttg.memdesc_index %b_59[%accumulator_115] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      ttg.local_store %b_110, %b_117 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      scf.yield %accumulator_112, %a_ptrs_93, %b_ptrs_94, %accumulator_115, %a_116, %b_117 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    } loc(#loc127)
    %accumulator_64 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc127)
    %a_65 = ttg.local_load %accumulator_63#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
    %b_66 = ttg.local_load %accumulator_63#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
    %accumulator_67 = scf.if %accumulator_64 -> (tensor<64x32xf32, #mma>) {
      %accumulator_87 = tt.dot %a_65, %b_66, %accumulator_63#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      scf.yield %accumulator_87 : tensor<64x32xf32, #mma> loc(#loc111)
    } else {
      scf.yield %accumulator_63#0 : tensor<64x32xf32, #mma> loc(#loc111)
    } loc(#loc111)
    %accumulator_68 = arith.select %accumulator_64, %accumulator_67, %accumulator_63#0 : tensor<64x32xf32, #mma> loc(#loc127)
    ttg.local_dealloc %b_59 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    ttg.local_dealloc %a_58 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc127)
    %c = arith.truncf %accumulator_68 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc112)
    %c_ptrs = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc113)
    %c_ptrs_69 = arith.muli %stride_cm, %offs_am : i32 loc(#loc114)
    %c_ptrs_70 = tt.expand_dims %offs_bn_20 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc115)
    %c_ptrs_71 = tt.expand_dims %offs_am_9 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_72 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_73 = arith.muli %c_ptrs_72, %c_ptrs_71 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_74 = tt.broadcast %c_ptrs_73 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_75 = tt.expand_dims %offs_bn_16 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc116)
    %c_ptrs_76 = tt.broadcast %c_ptrs_75 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_77 = arith.addi %c_ptrs_69, %offs_bn : i32 loc(#loc116)
    %c_ptrs_78 = arith.addi %c_ptrs_74, %c_ptrs_76 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_79 = tt.splat %c_ptrs_77 : i32 -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_80 = arith.addi %c_ptrs_79, %c_ptrs_78 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_81 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_82 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_83 = arith.cmpi slt, %c_ptrs_70, %c_mask_82 : tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_84 = tt.broadcast %c_mask_81 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_85 = tt.broadcast %c_mask_83 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_86 = arith.andi %c_mask_84, %c_mask_85 : tensor<64x32xi1, #mma> loc(#loc119)
    %7 = tt.splat %c_ptr : !tt.ptr<f16> -> tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc63)
    %8 = tt.addptr %7, %c_ptrs_80 : tensor<64x32x!tt.ptr<f16>, #mma>, tensor<64x32xi32, #mma> loc(#loc63)
    tt.store %8, %c, %c_mask_86 : tensor<64x32x!tt.ptr<f16>, #mma> loc(#loc63)
    tt.return loc(#loc64)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc74 = loc("num_pid_n"(#loc2))
#loc75 = loc("accumulator"(#loc4))
#loc76 = loc("pid"(#loc5))
#loc77 = loc("num_pid_m"(#loc7))
#loc78 = loc("num_pid_in_group"(#loc9))
#loc79 = loc("group_id"(#loc10))
#loc80 = loc("first_pid_m"(#loc11))
#loc81 = loc("group_size_m"(#loc12))
#loc82 = loc("group_size_m"(#loc13))
#loc83 = loc("pid_m"(#loc14))
#loc84 = loc("pid_m"(#loc15))
#loc85 = loc("pid_m"(#loc16))
#loc86 = loc("pid_n"(#loc17))
#loc87 = loc("offs_am"(#loc31))
#loc88 = loc("offs_am"(#loc32))
#loc89 = loc("offs_am"(#loc33))
#loc90 = loc("offs_am"(#loc34))
#loc91 = loc("offs_bn"(#loc35))
#loc92 = loc("offs_bn"(#loc36))
#loc93 = loc("offs_bn"(#loc37))
#loc94 = loc("offs_bn"(#loc38))
#loc95 = loc("a_ptrs"(#loc39))
#loc96 = loc("a_ptrs"(#loc40))
#loc97 = loc(callsite(#loc6 at #loc41))
#loc98 = loc(callsite(#loc8 at #loc41))
#loc99 = loc("a_ptrs"(#loc42))
#loc100 = loc("a"(#loc43))
#loc101 = loc("a"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("b_ptrs"(#loc46))
#loc104 = loc("b"(#loc47))
#loc105 = loc("b"(#loc48))
#loc106 = loc("b_ptrs"(#loc49))
#loc107 = loc("b_ptrs"(#loc50))
#loc108 = loc("a_ptrs"(#loc51))
#loc109 = loc("a"(#loc52))
#loc110 = loc("a"(#loc53))
#loc111 = loc("accumulator"(#loc54))
#loc112 = loc("c"(#loc55))
#loc113 = loc("c_ptrs"(#loc56))
#loc114 = loc("c_ptrs"(#loc57))
#loc115 = loc("c_ptrs"(#loc58))
#loc116 = loc("c_ptrs"(#loc59))
#loc117 = loc("c_mask"(#loc60))
#loc118 = loc("c_mask"(#loc61))
#loc119 = loc("c_mask"(#loc62))
#loc120 = loc(callsite(#loc1 at #loc74))
#loc121 = loc(callsite(#loc3 at #loc75))
#loc122 = loc(callsite(#loc6 at #loc77))
#loc123 = loc(callsite(#loc8 at #loc77))
#loc124 = loc(callsite(#loc6 at #loc74))
#loc125 = loc(callsite(#loc8 at #loc74))
#loc126 = loc("b_ptrs"(#loc99))
#loc127 = loc("accumulator"(#loc126))


// -----// IR Dump Before TritonAMDFoldTrueCmpI (tritonamdgpu-fold-true-cmpi) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc65 = loc("a_ptr"(#loc))
#loc66 = loc("b_ptr"(#loc))
#loc67 = loc("c_ptr"(#loc))
#loc68 = loc("M"(#loc))
#loc69 = loc("N"(#loc))
#loc70 = loc("K"(#loc))
#loc71 = loc("stride_am"(#loc))
#loc72 = loc("stride_bk"(#loc))
#loc73 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc120)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc121)
    %pid = tt.get_program_id x : i32 loc(#loc76)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc122)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc123)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc124)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc125)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc78)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc79)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc80)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc81)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc82)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc83)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc84)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc85)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc86)
    %0 = arith.cmpi sge, %pid_m_5, %c0_i32 : i32 loc(#loc18)
    llvm.intr.assume %0 : i1 loc(#loc19)
    %1 = arith.cmpi sge, %pid_n, %c0_i32 : i32 loc(#loc20)
    llvm.intr.assume %1 : i1 loc(#loc21)
    %2 = arith.cmpi sgt, %stride_am, %c0_i32 : i32 loc(#loc22)
    llvm.intr.assume %2 : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %3 = arith.cmpi sgt, %stride_bk, %c0_i32 : i32 loc(#loc26)
    llvm.intr.assume %3 : i1 loc(#loc27)
    %4 = arith.cmpi sgt, %stride_cm, %c0_i32 : i32 loc(#loc28)
    llvm.intr.assume %4 : i1 loc(#loc29)
    llvm.intr.assume %true : i1 loc(#loc30)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc87)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc88)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc88)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc89)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc89)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc90)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc91)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc92)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc92)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc93)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc93)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc94)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc95)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc96)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_27 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc96)
    %a_ptrs_28 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc96)
    %a_ptrs_29 = arith.addi %a_ptrs_26, %a_ptrs_28 : tensor<64x64xi32, #blocked> loc(#loc96)
    %5 = arith.addi %K, %c63_i32 : i32 loc(#loc97)
    %6 = arith.divsi %5, %c64_i32 : i32 loc(#loc98)
    %accumulator_30 = arith.cmpi sgt, %6, %c0_i32 : i32 loc(#loc127)
    %accumulator_31 = tt.splat %accumulator_30 : i1 -> tensor<64x64xi1, #blocked> loc(#loc127)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
    %a_32 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc100)
    %a_33 = tt.broadcast %a_32 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
    %accumulator_34 = arith.andi %accumulator_31, %a_33 : tensor<64x64xi1, #blocked> loc(#loc127)
    %a_35 = amdg.buffer_load %a_ptr[%a_ptrs_29], %accumulator_34 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc101)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc102)
    %b_ptrs_37 = tt.expand_dims %b_ptrs_36 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc102)
    %b_ptrs_38 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_39 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_40 = arith.muli %b_ptrs_38, %b_ptrs_39 : tensor<64x1xi32, #blocked1> loc(#loc103)
    %b_ptrs_41 = tt.broadcast %b_ptrs_40 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_42 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_43 = tt.broadcast %b_ptrs_42 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc103)
    %b_ptrs_44 = arith.addi %b_ptrs_41, %b_ptrs_43 : tensor<64x32xi32, #blocked1> loc(#loc103)
    %accumulator_45 = tt.splat %accumulator_30 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc127)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_46 = arith.cmpi slt, %b_ptrs_37, %b : tensor<64x1xi32, #blocked1> loc(#loc104)
    %b_47 = tt.broadcast %b_46 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
    %accumulator_48 = arith.andi %accumulator_45, %b_47 : tensor<64x32xi1, #blocked1> loc(#loc127)
    %b_49 = amdg.buffer_load %b_ptr[%b_ptrs_44], %accumulator_48 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc105)
    %b_ptrs_50 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc106)
    %b_ptrs_51 = tt.splat %b_ptrs_50 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc107)
    %a_52 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_53 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %a_54 = ttg.memdesc_index %a_52[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    ttg.local_store %a_35, %a_54 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
    %b_55 = ttg.memdesc_index %b_53[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    ttg.local_store %b_49, %b_55 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
    %accumulator_56 = arith.subi %6, %c1_i32 : i32 loc(#loc127)
    %accumulator_57:6 = scf.for %accumulator_81 = %c0_i32 to %accumulator_56 step %c1_i32 iter_args(%accumulator_82 = %accumulator, %a_ptrs_83 = %a_ptrs_29, %b_ptrs_84 = %b_ptrs_44, %arg13 = %c0_i32, %a_85 = %a_54, %b_86 = %b_55) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_87 = arith.addi %a_ptrs_83, %cst : tensor<64x64xi32, #blocked> loc(#loc108)
      %b_ptrs_88 = arith.addi %b_ptrs_84, %b_ptrs_51 : tensor<64x32xi32, #blocked1> loc(#loc107)
      %accumulator_89 = arith.addi %accumulator_81, %c1_i32 : i32 loc(#loc127)
      %a_90 = arith.muli %accumulator_89, %c64_i32 : i32 loc(#loc109)
      %a_91 = arith.subi %K, %a_90 : i32 loc(#loc110)
      %a_92 = tt.splat %a_91 : i32 -> tensor<1x64xi32, #blocked> loc(#loc100)
      %a_93 = arith.cmpi slt, %a_ptrs_22, %a_92 : tensor<1x64xi32, #blocked> loc(#loc100)
      %a_94 = tt.broadcast %a_93 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc101)
      %a_95 = amdg.buffer_load %a_ptr[%a_ptrs_87], %a_94 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc101)
      %a_96 = ttg.local_load %a_85 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
      %b_97 = tt.splat %a_91 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_98 = arith.cmpi slt, %b_ptrs_37, %b_97 : tensor<64x1xi32, #blocked1> loc(#loc104)
      %b_99 = tt.broadcast %b_98 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc105)
      %b_100 = amdg.buffer_load %b_ptr[%b_ptrs_88], %b_99 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc105)
      %b_101 = ttg.local_load %b_86 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
      %accumulator_102 = tt.dot %a_96, %b_101, %accumulator_82, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      %accumulator_103 = arith.addi %arg13, %c1_i32 : i32 loc(#loc127)
      %accumulator_104 = arith.cmpi slt, %accumulator_103, %c1_i32 : i32 loc(#loc127)
      %accumulator_105 = arith.select %accumulator_104, %accumulator_103, %c0_i32 : i32 loc(#loc127)
      %a_106 = ttg.memdesc_index %a_52[%accumulator_105] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      ttg.local_store %a_95, %a_106 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc101)
      %b_107 = ttg.memdesc_index %b_53[%accumulator_105] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      ttg.local_store %b_100, %b_107 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc105)
      scf.yield %accumulator_102, %a_ptrs_87, %b_ptrs_88, %accumulator_105, %a_106, %b_107 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    } loc(#loc127)
    %accumulator_58 = arith.cmpi sge, %6, %c1_i32 : i32 loc(#loc127)
    %a_59 = ttg.local_load %accumulator_57#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc101)
    %b_60 = ttg.local_load %accumulator_57#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc105)
    %accumulator_61 = scf.if %accumulator_58 -> (tensor<64x32xf32, #mma>) {
      %accumulator_81 = tt.dot %a_59, %b_60, %accumulator_57#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc111)
      scf.yield %accumulator_81 : tensor<64x32xf32, #mma> loc(#loc111)
    } else {
      scf.yield %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc111)
    } loc(#loc111)
    %accumulator_62 = arith.select %accumulator_58, %accumulator_61, %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc127)
    ttg.local_dealloc %b_53 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc127)
    ttg.local_dealloc %a_52 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc127)
    %c = arith.truncf %accumulator_62 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc112)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc113)
    %c_ptrs_63 = arith.muli %stride_cm, %offs_am : i32 loc(#loc114)
    %c_ptrs_64 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc115)
    %c_ptrs_65 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_66 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_67 = arith.muli %c_ptrs_66, %c_ptrs_65 : tensor<64x1xi32, #mma> loc(#loc116)
    %c_ptrs_68 = tt.broadcast %c_ptrs_67 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_69 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc116)
    %c_ptrs_70 = tt.broadcast %c_ptrs_69 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_71 = arith.addi %c_ptrs_63, %offs_bn : i32 loc(#loc116)
    %c_ptrs_72 = arith.addi %c_ptrs_68, %c_ptrs_70 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_73 = tt.splat %c_ptrs_71 : i32 -> tensor<64x32xi32, #mma> loc(#loc116)
    %c_ptrs_74 = arith.addi %c_ptrs_73, %c_ptrs_72 : tensor<64x32xi32, #mma> loc(#loc116)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_75 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc117)
    %c_mask_76 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_77 = arith.cmpi slt, %c_ptrs_64, %c_mask_76 : tensor<1x32xi32, #mma> loc(#loc118)
    %c_mask_78 = tt.broadcast %c_mask_75 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_79 = tt.broadcast %c_mask_77 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc119)
    %c_mask_80 = arith.andi %c_mask_78, %c_mask_79 : tensor<64x32xi1, #mma> loc(#loc119)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_74], %c_mask_80 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc63)
    tt.return loc(#loc64)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:23)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:23)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:26)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:26)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:26)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc60 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc61 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc62 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc63 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc64 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc74 = loc("num_pid_n"(#loc2))
#loc75 = loc("accumulator"(#loc4))
#loc76 = loc("pid"(#loc5))
#loc77 = loc("num_pid_m"(#loc7))
#loc78 = loc("num_pid_in_group"(#loc9))
#loc79 = loc("group_id"(#loc10))
#loc80 = loc("first_pid_m"(#loc11))
#loc81 = loc("group_size_m"(#loc12))
#loc82 = loc("group_size_m"(#loc13))
#loc83 = loc("pid_m"(#loc14))
#loc84 = loc("pid_m"(#loc15))
#loc85 = loc("pid_m"(#loc16))
#loc86 = loc("pid_n"(#loc17))
#loc87 = loc("offs_am"(#loc31))
#loc88 = loc("offs_am"(#loc32))
#loc89 = loc("offs_am"(#loc33))
#loc90 = loc("offs_am"(#loc34))
#loc91 = loc("offs_bn"(#loc35))
#loc92 = loc("offs_bn"(#loc36))
#loc93 = loc("offs_bn"(#loc37))
#loc94 = loc("offs_bn"(#loc38))
#loc95 = loc("a_ptrs"(#loc39))
#loc96 = loc("a_ptrs"(#loc40))
#loc97 = loc(callsite(#loc6 at #loc41))
#loc98 = loc(callsite(#loc8 at #loc41))
#loc99 = loc("a_ptrs"(#loc42))
#loc100 = loc("a"(#loc43))
#loc101 = loc("a"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("b_ptrs"(#loc46))
#loc104 = loc("b"(#loc47))
#loc105 = loc("b"(#loc48))
#loc106 = loc("b_ptrs"(#loc49))
#loc107 = loc("b_ptrs"(#loc50))
#loc108 = loc("a_ptrs"(#loc51))
#loc109 = loc("a"(#loc52))
#loc110 = loc("a"(#loc53))
#loc111 = loc("accumulator"(#loc54))
#loc112 = loc("c"(#loc55))
#loc113 = loc("c_ptrs"(#loc56))
#loc114 = loc("c_ptrs"(#loc57))
#loc115 = loc("c_ptrs"(#loc58))
#loc116 = loc("c_ptrs"(#loc59))
#loc117 = loc("c_mask"(#loc60))
#loc118 = loc("c_mask"(#loc61))
#loc119 = loc("c_mask"(#loc62))
#loc120 = loc(callsite(#loc1 at #loc74))
#loc121 = loc(callsite(#loc3 at #loc75))
#loc122 = loc(callsite(#loc6 at #loc77))
#loc123 = loc(callsite(#loc8 at #loc77))
#loc124 = loc(callsite(#loc6 at #loc74))
#loc125 = loc(callsite(#loc8 at #loc74))
#loc126 = loc("b_ptrs"(#loc99))
#loc127 = loc("accumulator"(#loc126))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_29 = arith.addi %a_ptrs_26, %a_ptrs_28 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_30 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_31 = tt.splat %accumulator_30 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_33 = tt.broadcast %a_32 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_34 = arith.andi %accumulator_31, %a_33 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_35 = amdg.buffer_load %a_ptr[%a_ptrs_29], %accumulator_34 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_37 = tt.expand_dims %b_ptrs_36 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_38 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = arith.muli %b_ptrs_38, %b_ptrs_39 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = tt.broadcast %b_ptrs_40 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_42 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_43 = tt.broadcast %b_ptrs_42 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_44 = arith.addi %b_ptrs_41, %b_ptrs_43 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_45 = tt.splat %accumulator_30 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_46 = arith.cmpi slt, %b_ptrs_37, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_47 = tt.broadcast %b_46 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_48 = arith.andi %accumulator_45, %b_47 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_49 = amdg.buffer_load %b_ptr[%b_ptrs_44], %accumulator_48 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_50 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_51 = tt.splat %b_ptrs_50 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_52 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_53 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_54 = ttg.memdesc_index %a_52[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_35, %a_54 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_55 = ttg.memdesc_index %b_53[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_49, %b_55 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_56 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_57:6 = scf.for %accumulator_81 = %c0_i32 to %accumulator_56 step %c1_i32 iter_args(%accumulator_82 = %accumulator, %a_ptrs_83 = %a_ptrs_29, %b_ptrs_84 = %b_ptrs_44, %arg13 = %c0_i32, %a_85 = %a_54, %b_86 = %b_55) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_87 = arith.addi %a_ptrs_83, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_88 = arith.addi %b_ptrs_84, %b_ptrs_51 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_89 = arith.addi %accumulator_81, %c1_i32 : i32 loc(#loc122)
      %a_90 = arith.muli %accumulator_89, %c64_i32 : i32 loc(#loc104)
      %a_91 = arith.subi %K, %a_90 : i32 loc(#loc105)
      %a_92 = tt.splat %a_91 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_93 = arith.cmpi slt, %a_ptrs_22, %a_92 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_94 = tt.broadcast %a_93 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_95 = amdg.buffer_load %a_ptr[%a_ptrs_87], %a_94 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_96 = ttg.local_load %a_85 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_97 = tt.splat %a_91 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_98 = arith.cmpi slt, %b_ptrs_37, %b_97 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_99 = tt.broadcast %b_98 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_100 = amdg.buffer_load %b_ptr[%b_ptrs_88], %b_99 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_101 = ttg.local_load %b_86 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_102 = tt.dot %a_96, %b_101, %accumulator_82, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_103 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_104 = arith.cmpi slt, %accumulator_103, %c1_i32 : i32 loc(#loc122)
      %accumulator_105 = arith.select %accumulator_104, %accumulator_103, %c0_i32 : i32 loc(#loc122)
      %a_106 = ttg.memdesc_index %a_52[%accumulator_105] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_95, %a_106 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_107 = ttg.memdesc_index %b_53[%accumulator_105] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_100, %b_107 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_102, %a_ptrs_87, %b_ptrs_88, %accumulator_105, %a_106, %b_107 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_58 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_59 = ttg.local_load %accumulator_57#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_60 = ttg.local_load %accumulator_57#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_61 = scf.if %accumulator_58 -> (tensor<64x32xf32, #mma>) {
      %accumulator_81 = tt.dot %a_59, %b_60, %accumulator_57#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_81 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_62 = arith.select %accumulator_58, %accumulator_61, %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_53 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_52 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_62 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_63 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_64 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_65 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_67 = arith.muli %c_ptrs_66, %c_ptrs_65 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_68 = tt.broadcast %c_ptrs_67 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_69 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.broadcast %c_ptrs_69 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_63, %offs_bn : i32 loc(#loc111)
    %c_ptrs_72 = arith.addi %c_ptrs_68, %c_ptrs_70 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_73 = tt.splat %c_ptrs_71 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_74 = arith.addi %c_ptrs_73, %c_ptrs_72 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_75 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_76 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_77 = arith.cmpi slt, %c_ptrs_64, %c_mask_76 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_78 = tt.broadcast %c_mask_75 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_79 = tt.broadcast %c_mask_77 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_80 = arith.andi %c_mask_78, %c_mask_79 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_74], %c_mask_80 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before CSE (cse) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = tt.broadcast %a_ptrs_27 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_29 = arith.addi %a_ptrs_26, %a_ptrs_28 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_30 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_31 = tt.splat %accumulator_30 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_33 = tt.broadcast %a_32 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_34 = arith.andi %accumulator_31, %a_33 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_35 = amdg.buffer_load %a_ptr[%a_ptrs_29], %accumulator_34 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_36 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_37 = tt.expand_dims %b_ptrs_36 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_38 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = arith.muli %b_ptrs_38, %b_ptrs_39 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = tt.broadcast %b_ptrs_40 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_42 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_43 = tt.broadcast %b_ptrs_42 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_44 = arith.addi %b_ptrs_41, %b_ptrs_43 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_45 = tt.splat %accumulator_30 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_46 = arith.cmpi slt, %b_ptrs_37, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_47 = tt.broadcast %b_46 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_48 = arith.andi %accumulator_45, %b_47 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_49 = amdg.buffer_load %b_ptr[%b_ptrs_44], %accumulator_48 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_50 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_51 = tt.splat %b_ptrs_50 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_52 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_53 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_54 = ttg.memdesc_index %a_52[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_35, %a_54 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_55 = ttg.memdesc_index %b_53[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_49, %b_55 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_56 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_57:6 = scf.for %accumulator_81 = %c0_i32 to %accumulator_56 step %c1_i32 iter_args(%accumulator_82 = %accumulator, %a_ptrs_83 = %a_ptrs_29, %b_ptrs_84 = %b_ptrs_44, %arg13 = %c0_i32, %a_85 = %a_54, %b_86 = %b_55) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_87 = arith.addi %a_ptrs_83, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_88 = arith.addi %b_ptrs_84, %b_ptrs_51 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_89 = arith.addi %accumulator_81, %c1_i32 : i32 loc(#loc122)
      %a_90 = arith.muli %accumulator_89, %c64_i32 : i32 loc(#loc104)
      %a_91 = arith.subi %K, %a_90 : i32 loc(#loc105)
      %a_92 = tt.splat %a_91 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_93 = arith.cmpi slt, %a_ptrs_22, %a_92 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_94 = tt.broadcast %a_93 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_95 = amdg.buffer_load %a_ptr[%a_ptrs_87], %a_94 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_96 = ttg.local_load %a_85 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_97 = tt.splat %a_91 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_98 = arith.cmpi slt, %b_ptrs_37, %b_97 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_99 = tt.broadcast %b_98 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_100 = amdg.buffer_load %b_ptr[%b_ptrs_88], %b_99 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_101 = ttg.local_load %b_86 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_102 = tt.dot %a_96, %b_101, %accumulator_82, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_103 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_104 = arith.cmpi slt, %accumulator_103, %c1_i32 : i32 loc(#loc122)
      %accumulator_105 = arith.select %accumulator_104, %accumulator_103, %c0_i32 : i32 loc(#loc122)
      %a_106 = ttg.memdesc_index %a_52[%accumulator_105] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_95, %a_106 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_107 = ttg.memdesc_index %b_53[%accumulator_105] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_100, %b_107 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_102, %a_ptrs_87, %b_ptrs_88, %accumulator_105, %a_106, %b_107 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_58 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_59 = ttg.local_load %accumulator_57#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_60 = ttg.local_load %accumulator_57#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_61 = scf.if %accumulator_58 -> (tensor<64x32xf32, #mma>) {
      %accumulator_81 = tt.dot %a_59, %b_60, %accumulator_57#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_81 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_62 = arith.select %accumulator_58, %accumulator_61, %accumulator_57#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_53 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_52 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_62 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_63 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_64 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_65 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_67 = arith.muli %c_ptrs_66, %c_ptrs_65 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_68 = tt.broadcast %c_ptrs_67 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_69 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.broadcast %c_ptrs_69 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_63, %offs_bn : i32 loc(#loc111)
    %c_ptrs_72 = arith.addi %c_ptrs_68, %c_ptrs_70 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_73 = tt.splat %c_ptrs_71 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_74 = arith.addi %c_ptrs_73, %c_ptrs_72 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_75 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_76 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_77 = arith.cmpi slt, %c_ptrs_64, %c_mask_76 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_78 = tt.broadcast %c_mask_75 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_79 = tt.broadcast %c_mask_77 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_80 = arith.andi %c_mask_78, %c_mask_79 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_74], %c_mask_80 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before SymbolDCE (symbol-dce) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_54:6 = scf.for %accumulator_78 = %c0_i32 to %accumulator_53 step %c1_i32 iter_args(%accumulator_79 = %accumulator, %a_ptrs_80 = %a_ptrs_28, %b_ptrs_81 = %b_ptrs_41, %arg13 = %c0_i32, %a_82 = %a_51, %b_83 = %b_52) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_84 = arith.addi %a_ptrs_80, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_85 = arith.addi %b_ptrs_81, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_86 = arith.addi %accumulator_78, %c1_i32 : i32 loc(#loc122)
      %a_87 = arith.muli %accumulator_86, %c64_i32 : i32 loc(#loc104)
      %a_88 = arith.subi %K, %a_87 : i32 loc(#loc105)
      %a_89 = tt.splat %a_88 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_90 = arith.cmpi slt, %a_ptrs_22, %a_89 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_91 = tt.broadcast %a_90 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_92 = amdg.buffer_load %a_ptr[%a_ptrs_84], %a_91 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_93 = ttg.local_load %a_82 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_94 = tt.splat %a_88 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_95 = arith.cmpi slt, %b_ptrs_35, %b_94 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_96 = tt.broadcast %b_95 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_97 = amdg.buffer_load %b_ptr[%b_ptrs_85], %b_96 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_98 = ttg.local_load %b_83 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_99 = tt.dot %a_93, %b_98, %accumulator_79, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_100 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_101 = arith.cmpi slt, %accumulator_100, %c1_i32 : i32 loc(#loc122)
      %accumulator_102 = arith.select %accumulator_101, %accumulator_100, %c0_i32 : i32 loc(#loc122)
      %a_103 = ttg.memdesc_index %a_49[%accumulator_102] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_92, %a_103 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_104 = ttg.memdesc_index %b_50[%accumulator_102] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_97, %b_104 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_99, %a_ptrs_84, %b_ptrs_85, %accumulator_102, %a_103, %b_104 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_55 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_56 = ttg.local_load %accumulator_54#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_57 = ttg.local_load %accumulator_54#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_58 = scf.if %accumulator_55 -> (tensor<64x32xf32, #mma>) {
      %accumulator_78 = tt.dot %a_56, %b_57, %accumulator_54#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_78 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_59 = arith.select %accumulator_55, %accumulator_58, %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_59 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_60 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_61 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_62 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_63 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_64 = arith.muli %c_ptrs_63, %c_ptrs_62 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_65 = tt.broadcast %c_ptrs_64 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_67 = tt.broadcast %c_ptrs_66 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_68 = arith.addi %c_ptrs_60, %offs_bn : i32 loc(#loc111)
    %c_ptrs_69 = arith.addi %c_ptrs_65, %c_ptrs_67 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.splat %c_ptrs_68 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_70, %c_ptrs_69 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_72 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_73 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_74 = arith.cmpi slt, %c_ptrs_61, %c_mask_73 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_75 = tt.broadcast %c_mask_72 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_76 = tt.broadcast %c_mask_74 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_77 = arith.andi %c_mask_75, %c_mask_76 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_71], %c_mask_77 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before TritonAMDGPUUpdateAsyncWaitCount (tritonamdgpu-update-async-wait-count) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_54:6 = scf.for %accumulator_78 = %c0_i32 to %accumulator_53 step %c1_i32 iter_args(%accumulator_79 = %accumulator, %a_ptrs_80 = %a_ptrs_28, %b_ptrs_81 = %b_ptrs_41, %arg13 = %c0_i32, %a_82 = %a_51, %b_83 = %b_52) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_84 = arith.addi %a_ptrs_80, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_85 = arith.addi %b_ptrs_81, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_86 = arith.addi %accumulator_78, %c1_i32 : i32 loc(#loc122)
      %a_87 = arith.muli %accumulator_86, %c64_i32 : i32 loc(#loc104)
      %a_88 = arith.subi %K, %a_87 : i32 loc(#loc105)
      %a_89 = tt.splat %a_88 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_90 = arith.cmpi slt, %a_ptrs_22, %a_89 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_91 = tt.broadcast %a_90 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_92 = amdg.buffer_load %a_ptr[%a_ptrs_84], %a_91 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_93 = ttg.local_load %a_82 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_94 = tt.splat %a_88 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_95 = arith.cmpi slt, %b_ptrs_35, %b_94 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_96 = tt.broadcast %b_95 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_97 = amdg.buffer_load %b_ptr[%b_ptrs_85], %b_96 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_98 = ttg.local_load %b_83 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_99 = tt.dot %a_93, %b_98, %accumulator_79, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_100 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_101 = arith.cmpi slt, %accumulator_100, %c1_i32 : i32 loc(#loc122)
      %accumulator_102 = arith.select %accumulator_101, %accumulator_100, %c0_i32 : i32 loc(#loc122)
      %a_103 = ttg.memdesc_index %a_49[%accumulator_102] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_92, %a_103 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_104 = ttg.memdesc_index %b_50[%accumulator_102] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_97, %b_104 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_99, %a_ptrs_84, %b_ptrs_85, %accumulator_102, %a_103, %b_104 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_55 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_56 = ttg.local_load %accumulator_54#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_57 = ttg.local_load %accumulator_54#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_58 = scf.if %accumulator_55 -> (tensor<64x32xf32, #mma>) {
      %accumulator_78 = tt.dot %a_56, %b_57, %accumulator_54#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_78 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_59 = arith.select %accumulator_55, %accumulator_58, %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_59 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_60 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_61 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_62 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_63 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_64 = arith.muli %c_ptrs_63, %c_ptrs_62 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_65 = tt.broadcast %c_ptrs_64 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_67 = tt.broadcast %c_ptrs_66 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_68 = arith.addi %c_ptrs_60, %offs_bn : i32 loc(#loc111)
    %c_ptrs_69 = arith.addi %c_ptrs_65, %c_ptrs_67 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.splat %c_ptrs_68 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_70, %c_ptrs_69 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_72 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_73 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_74 = arith.cmpi slt, %c_ptrs_61, %c_mask_73 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_75 = tt.broadcast %c_mask_72 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_76 = tt.broadcast %c_mask_74 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_77 = arith.andi %c_mask_75, %c_mask_76 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_71], %c_mask_77 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before ConvertWarpPipeline (convert-warp-pipeline) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_54:6 = scf.for %accumulator_78 = %c0_i32 to %accumulator_53 step %c1_i32 iter_args(%accumulator_79 = %accumulator, %a_ptrs_80 = %a_ptrs_28, %b_ptrs_81 = %b_ptrs_41, %arg13 = %c0_i32, %a_82 = %a_51, %b_83 = %b_52) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_84 = arith.addi %a_ptrs_80, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_85 = arith.addi %b_ptrs_81, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_86 = arith.addi %accumulator_78, %c1_i32 : i32 loc(#loc122)
      %a_87 = arith.muli %accumulator_86, %c64_i32 : i32 loc(#loc104)
      %a_88 = arith.subi %K, %a_87 : i32 loc(#loc105)
      %a_89 = tt.splat %a_88 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_90 = arith.cmpi slt, %a_ptrs_22, %a_89 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_91 = tt.broadcast %a_90 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_92 = amdg.buffer_load %a_ptr[%a_ptrs_84], %a_91 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_93 = ttg.local_load %a_82 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_94 = tt.splat %a_88 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_95 = arith.cmpi slt, %b_ptrs_35, %b_94 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_96 = tt.broadcast %b_95 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_97 = amdg.buffer_load %b_ptr[%b_ptrs_85], %b_96 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_98 = ttg.local_load %b_83 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_99 = tt.dot %a_93, %b_98, %accumulator_79, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_100 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_101 = arith.cmpi slt, %accumulator_100, %c1_i32 : i32 loc(#loc122)
      %accumulator_102 = arith.select %accumulator_101, %accumulator_100, %c0_i32 : i32 loc(#loc122)
      %a_103 = ttg.memdesc_index %a_49[%accumulator_102] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_92, %a_103 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_104 = ttg.memdesc_index %b_50[%accumulator_102] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_97, %b_104 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_99, %a_ptrs_84, %b_ptrs_85, %accumulator_102, %a_103, %b_104 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_55 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_56 = ttg.local_load %accumulator_54#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_57 = ttg.local_load %accumulator_54#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_58 = scf.if %accumulator_55 -> (tensor<64x32xf32, #mma>) {
      %accumulator_78 = tt.dot %a_56, %b_57, %accumulator_54#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_78 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_59 = arith.select %accumulator_55, %accumulator_58, %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_59 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_60 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_61 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_62 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_63 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_64 = arith.muli %c_ptrs_63, %c_ptrs_62 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_65 = tt.broadcast %c_ptrs_64 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_67 = tt.broadcast %c_ptrs_66 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_68 = arith.addi %c_ptrs_60, %offs_bn : i32 loc(#loc111)
    %c_ptrs_69 = arith.addi %c_ptrs_65, %c_ptrs_67 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.splat %c_ptrs_68 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_70, %c_ptrs_69 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_72 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_73 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_74 = arith.cmpi slt, %c_ptrs_61, %c_mask_73 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_75 = tt.broadcast %c_mask_72 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_76 = tt.broadcast %c_mask_74 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_77 = arith.andi %c_mask_75, %c_mask_76 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_71], %c_mask_77 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before SCFToControlFlowPass (convert-scf-to-cf) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    %accumulator_54:6 = scf.for %accumulator_78 = %c0_i32 to %accumulator_53 step %c1_i32 iter_args(%accumulator_79 = %accumulator, %a_ptrs_80 = %a_ptrs_28, %b_ptrs_81 = %b_ptrs_41, %arg13 = %c0_i32, %a_82 = %a_51, %b_83 = %b_52) -> (tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>)  : i32 {
      %a_ptrs_84 = arith.addi %a_ptrs_80, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
      %b_ptrs_85 = arith.addi %b_ptrs_81, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
      %accumulator_86 = arith.addi %accumulator_78, %c1_i32 : i32 loc(#loc122)
      %a_87 = arith.muli %accumulator_86, %c64_i32 : i32 loc(#loc104)
      %a_88 = arith.subi %K, %a_87 : i32 loc(#loc105)
      %a_89 = tt.splat %a_88 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
      %a_90 = arith.cmpi slt, %a_ptrs_22, %a_89 : tensor<1x64xi32, #blocked> loc(#loc95)
      %a_91 = tt.broadcast %a_90 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
      %a_92 = amdg.buffer_load %a_ptr[%a_ptrs_84], %a_91 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
      %a_93 = ttg.local_load %a_82 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
      %b_94 = tt.splat %a_88 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_95 = arith.cmpi slt, %b_ptrs_35, %b_94 : tensor<64x1xi32, #blocked1> loc(#loc99)
      %b_96 = tt.broadcast %b_95 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
      %b_97 = amdg.buffer_load %b_ptr[%b_ptrs_85], %b_96 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
      %b_98 = ttg.local_load %b_83 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
      %accumulator_99 = tt.dot %a_93, %b_98, %accumulator_79, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      %accumulator_100 = arith.addi %arg13, %c1_i32 : i32 loc(#loc122)
      %accumulator_101 = arith.cmpi slt, %accumulator_100, %c1_i32 : i32 loc(#loc122)
      %accumulator_102 = arith.select %accumulator_101, %accumulator_100, %c0_i32 : i32 loc(#loc122)
      %a_103 = ttg.memdesc_index %a_49[%accumulator_102] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      ttg.local_store %a_92, %a_103 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
      %b_104 = ttg.memdesc_index %b_50[%accumulator_102] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      ttg.local_store %b_97, %b_104 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
      scf.yield %accumulator_99, %a_ptrs_84, %b_ptrs_85, %accumulator_102, %a_103, %b_104 : tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    } loc(#loc122)
    %accumulator_55 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_56 = ttg.local_load %accumulator_54#4 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_57 = ttg.local_load %accumulator_54#5 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_58 = scf.if %accumulator_55 -> (tensor<64x32xf32, #mma>) {
      %accumulator_78 = tt.dot %a_56, %b_57, %accumulator_54#0, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
      scf.yield %accumulator_78 : tensor<64x32xf32, #mma> loc(#loc106)
    } else {
      scf.yield %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc106)
    } loc(#loc106)
    %accumulator_59 = arith.select %accumulator_55, %accumulator_58, %accumulator_54#0 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_59 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_60 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_61 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_62 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_63 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_64 = arith.muli %c_ptrs_63, %c_ptrs_62 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_65 = tt.broadcast %c_ptrs_64 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_66 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_67 = tt.broadcast %c_ptrs_66 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_68 = arith.addi %c_ptrs_60, %offs_bn : i32 loc(#loc111)
    %c_ptrs_69 = arith.addi %c_ptrs_65, %c_ptrs_67 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_70 = tt.splat %c_ptrs_68 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_71 = arith.addi %c_ptrs_70, %c_ptrs_69 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_72 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_73 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_74 = arith.cmpi slt, %c_ptrs_61, %c_mask_73 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_75 = tt.broadcast %c_mask_72 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_76 = tt.broadcast %c_mask_74 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_77 = arith.andi %c_mask_75, %c_mask_76 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_71], %c_mask_77 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc(unknown)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc70 = loc("accumulator"(#loc4))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc91 = loc("a_ptrs"(#loc35))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc94 = loc("a_ptrs"(#loc37))
#loc95 = loc("a"(#loc38))
#loc96 = loc("a"(#loc39))
#loc97 = loc("b_ptrs"(#loc40))
#loc98 = loc("b_ptrs"(#loc41))
#loc99 = loc("b"(#loc42))
#loc100 = loc("b"(#loc43))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc106 = loc("accumulator"(#loc49))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))


// -----// IR Dump Before GluonInline (gluon-inline) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc70 = loc("accumulator"(#loc4))
#loc91 = loc("a_ptrs"(#loc35))
#loc94 = loc("a_ptrs"(#loc37))
#loc96 = loc("a"(#loc39))
#loc98 = loc("b_ptrs"(#loc41))
#loc100 = loc("b"(#loc43))
#loc106 = loc("accumulator"(#loc49))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%c0_i32, %accumulator, %a_ptrs_28, %b_ptrs_41, %c0_i32, %a_51, %b_52 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb1(%accumulator_54: i32 loc("accumulator"(#loc121)), %accumulator_55: tensor<64x32xf32, #mma> loc(callsite(#loc3 at #loc70)), %a_ptrs_56: tensor<64x64xi32, #blocked> loc("a_ptrs"(#loc35)), %b_ptrs_57: tensor<64x32xi32, #blocked1> loc("b_ptrs"(#loc41)), %2: i32 loc(unknown), %a_58: !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc("a"(#loc39)), %b_59: !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc("b"(#loc43))):  // 2 preds: ^bb0, ^bb2
    %accumulator_60 = arith.cmpi slt, %accumulator_54, %accumulator_53 : i32 loc(#loc122)
    cf.cond_br %accumulator_60, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_61 = arith.addi %a_ptrs_56, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
    %b_ptrs_62 = arith.addi %b_ptrs_57, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_63 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    %a_64 = arith.muli %accumulator_63, %c64_i32 : i32 loc(#loc104)
    %a_65 = arith.subi %K, %a_64 : i32 loc(#loc105)
    %a_66 = tt.splat %a_65 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_67 = arith.cmpi slt, %a_ptrs_22, %a_66 : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_68 = tt.broadcast %a_67 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %a_69 = amdg.buffer_load %a_ptr[%a_ptrs_61], %a_68 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %a_70 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_71 = tt.splat %a_65 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_72 = arith.cmpi slt, %b_ptrs_35, %b_71 : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_73 = tt.broadcast %b_72 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %b_74 = amdg.buffer_load %b_ptr[%b_ptrs_62], %b_73 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_75 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_76 = tt.dot %a_70, %b_75, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_77 = arith.addi %2, %c1_i32 : i32 loc(#loc122)
    %accumulator_78 = arith.cmpi slt, %accumulator_77, %c1_i32 : i32 loc(#loc122)
    %accumulator_79 = arith.select %accumulator_78, %accumulator_77, %c0_i32 : i32 loc(#loc122)
    %a_80 = ttg.memdesc_index %a_49[%accumulator_79] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_69, %a_80 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_81 = ttg.memdesc_index %b_50[%accumulator_79] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_74, %b_81 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_82 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%accumulator_82, %accumulator_76, %a_ptrs_61, %b_ptrs_62, %accumulator_79, %a_80, %b_81 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_83 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_84 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_85 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    cf.cond_br %accumulator_83, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_86 = tt.dot %a_84, %b_85, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    cf.br ^bb6(%accumulator_86 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    cf.br ^bb6(%accumulator_55 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb6(%accumulator_87: tensor<64x32xf32, #mma> loc("accumulator"(#loc49))):  // 2 preds: ^bb4, ^bb5
    cf.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_88 = arith.select %accumulator_83, %accumulator_87, %accumulator_55 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_88 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_89 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_90 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_91 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_92 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_93 = arith.muli %c_ptrs_92, %c_ptrs_91 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_94 = tt.broadcast %c_ptrs_93 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_95 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_96 = tt.broadcast %c_ptrs_95 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_97 = arith.addi %c_ptrs_89, %offs_bn : i32 loc(#loc111)
    %c_ptrs_98 = arith.addi %c_ptrs_94, %c_ptrs_96 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_99 = tt.splat %c_ptrs_97 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_100 = arith.addi %c_ptrs_99, %c_ptrs_98 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_101 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_102 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_103 = arith.cmpi slt, %c_ptrs_90, %c_mask_102 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_104 = tt.broadcast %c_mask_101 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_105 = tt.broadcast %c_mask_103 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_106 = arith.andi %c_mask_104, %c_mask_105 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_100], %c_mask_106 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc95 = loc("a"(#loc38))
#loc97 = loc("b_ptrs"(#loc40))
#loc99 = loc("b"(#loc42))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))


// -----// IR Dump Before ConvertIndexToLLVMPass (convert-index-to-llvm) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc70 = loc("accumulator"(#loc4))
#loc91 = loc("a_ptrs"(#loc35))
#loc94 = loc("a_ptrs"(#loc37))
#loc96 = loc("a"(#loc39))
#loc98 = loc("b_ptrs"(#loc41))
#loc100 = loc("b"(#loc43))
#loc106 = loc("accumulator"(#loc49))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%c0_i32, %accumulator, %a_ptrs_28, %b_ptrs_41, %c0_i32, %a_51, %b_52 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb1(%accumulator_54: i32 loc("accumulator"(#loc121)), %accumulator_55: tensor<64x32xf32, #mma> loc(callsite(#loc3 at #loc70)), %a_ptrs_56: tensor<64x64xi32, #blocked> loc("a_ptrs"(#loc35)), %b_ptrs_57: tensor<64x32xi32, #blocked1> loc("b_ptrs"(#loc41)), %2: i32 loc(unknown), %a_58: !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc("a"(#loc39)), %b_59: !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc("b"(#loc43))):  // 2 preds: ^bb0, ^bb2
    %accumulator_60 = arith.cmpi slt, %accumulator_54, %accumulator_53 : i32 loc(#loc122)
    cf.cond_br %accumulator_60, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_61 = arith.addi %a_ptrs_56, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
    %b_ptrs_62 = arith.addi %b_ptrs_57, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_63 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    %a_64 = arith.muli %accumulator_63, %c64_i32 : i32 loc(#loc104)
    %a_65 = arith.subi %K, %a_64 : i32 loc(#loc105)
    %a_66 = tt.splat %a_65 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_67 = arith.cmpi slt, %a_ptrs_22, %a_66 : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_68 = tt.broadcast %a_67 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %a_69 = amdg.buffer_load %a_ptr[%a_ptrs_61], %a_68 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %a_70 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_71 = tt.splat %a_65 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_72 = arith.cmpi slt, %b_ptrs_35, %b_71 : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_73 = tt.broadcast %b_72 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %b_74 = amdg.buffer_load %b_ptr[%b_ptrs_62], %b_73 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_75 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_76 = tt.dot %a_70, %b_75, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_77 = arith.addi %2, %c1_i32 : i32 loc(#loc122)
    %accumulator_78 = arith.cmpi slt, %accumulator_77, %c1_i32 : i32 loc(#loc122)
    %accumulator_79 = arith.select %accumulator_78, %accumulator_77, %c0_i32 : i32 loc(#loc122)
    %a_80 = ttg.memdesc_index %a_49[%accumulator_79] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_69, %a_80 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_81 = ttg.memdesc_index %b_50[%accumulator_79] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_74, %b_81 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_82 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%accumulator_82, %accumulator_76, %a_ptrs_61, %b_ptrs_62, %accumulator_79, %a_80, %b_81 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_83 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_84 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_85 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    cf.cond_br %accumulator_83, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_86 = tt.dot %a_84, %b_85, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    cf.br ^bb6(%accumulator_86 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    cf.br ^bb6(%accumulator_55 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb6(%accumulator_87: tensor<64x32xf32, #mma> loc("accumulator"(#loc49))):  // 2 preds: ^bb4, ^bb5
    cf.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_88 = arith.select %accumulator_83, %accumulator_87, %accumulator_55 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_88 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_89 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_90 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_91 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_92 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_93 = arith.muli %c_ptrs_92, %c_ptrs_91 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_94 = tt.broadcast %c_ptrs_93 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_95 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_96 = tt.broadcast %c_ptrs_95 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_97 = arith.addi %c_ptrs_89, %offs_bn : i32 loc(#loc111)
    %c_ptrs_98 = arith.addi %c_ptrs_94, %c_ptrs_96 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_99 = tt.splat %c_ptrs_97 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_100 = arith.addi %c_ptrs_99, %c_ptrs_98 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_101 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_102 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_103 = arith.cmpi slt, %c_ptrs_90, %c_mask_102 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_104 = tt.broadcast %c_mask_101 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_105 = tt.broadcast %c_mask_103 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_106 = arith.andi %c_mask_104, %c_mask_105 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_100], %c_mask_106 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc95 = loc("a"(#loc38))
#loc97 = loc("b_ptrs"(#loc40))
#loc99 = loc("b"(#loc42))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))


// -----// IR Dump Before AllocateAMDGPUSharedMemory (allocate-amdgpu-shared-memory) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc70 = loc("accumulator"(#loc4))
#loc91 = loc("a_ptrs"(#loc35))
#loc94 = loc("a_ptrs"(#loc37))
#loc96 = loc("a"(#loc39))
#loc98 = loc("b_ptrs"(#loc41))
#loc100 = loc("b"(#loc43))
#loc106 = loc("accumulator"(#loc49))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%c0_i32, %accumulator, %a_ptrs_28, %b_ptrs_41, %c0_i32, %a_51, %b_52 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb1(%accumulator_54: i32 loc("accumulator"(#loc121)), %accumulator_55: tensor<64x32xf32, #mma> loc(callsite(#loc3 at #loc70)), %a_ptrs_56: tensor<64x64xi32, #blocked> loc("a_ptrs"(#loc35)), %b_ptrs_57: tensor<64x32xi32, #blocked1> loc("b_ptrs"(#loc41)), %2: i32 loc(unknown), %a_58: !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc("a"(#loc39)), %b_59: !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc("b"(#loc43))):  // 2 preds: ^bb0, ^bb2
    %accumulator_60 = arith.cmpi slt, %accumulator_54, %accumulator_53 : i32 loc(#loc122)
    cf.cond_br %accumulator_60, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_61 = arith.addi %a_ptrs_56, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
    %b_ptrs_62 = arith.addi %b_ptrs_57, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_63 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    %a_64 = arith.muli %accumulator_63, %c64_i32 : i32 loc(#loc104)
    %a_65 = arith.subi %K, %a_64 : i32 loc(#loc105)
    %a_66 = tt.splat %a_65 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_67 = arith.cmpi slt, %a_ptrs_22, %a_66 : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_68 = tt.broadcast %a_67 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %a_69 = amdg.buffer_load %a_ptr[%a_ptrs_61], %a_68 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %a_70 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_71 = tt.splat %a_65 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_72 = arith.cmpi slt, %b_ptrs_35, %b_71 : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_73 = tt.broadcast %b_72 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %b_74 = amdg.buffer_load %b_ptr[%b_ptrs_62], %b_73 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_75 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_76 = tt.dot %a_70, %b_75, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_77 = arith.addi %2, %c1_i32 : i32 loc(#loc122)
    %accumulator_78 = arith.cmpi slt, %accumulator_77, %c1_i32 : i32 loc(#loc122)
    %accumulator_79 = arith.select %accumulator_78, %accumulator_77, %c0_i32 : i32 loc(#loc122)
    %a_80 = ttg.memdesc_index %a_49[%accumulator_79] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_69, %a_80 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_81 = ttg.memdesc_index %b_50[%accumulator_79] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_74, %b_81 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_82 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%accumulator_82, %accumulator_76, %a_ptrs_61, %b_ptrs_62, %accumulator_79, %a_80, %b_81 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_83 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_84 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_85 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    cf.cond_br %accumulator_83, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_86 = tt.dot %a_84, %b_85, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    cf.br ^bb6(%accumulator_86 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    cf.br ^bb6(%accumulator_55 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb6(%accumulator_87: tensor<64x32xf32, #mma> loc("accumulator"(#loc49))):  // 2 preds: ^bb4, ^bb5
    cf.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_88 = arith.select %accumulator_83, %accumulator_87, %accumulator_55 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_88 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_89 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_90 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_91 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_92 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_93 = arith.muli %c_ptrs_92, %c_ptrs_91 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_94 = tt.broadcast %c_ptrs_93 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_95 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_96 = tt.broadcast %c_ptrs_95 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_97 = arith.addi %c_ptrs_89, %offs_bn : i32 loc(#loc111)
    %c_ptrs_98 = arith.addi %c_ptrs_94, %c_ptrs_96 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_99 = tt.splat %c_ptrs_97 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_100 = arith.addi %c_ptrs_99, %c_ptrs_98 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_101 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_102 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_103 = arith.cmpi slt, %c_ptrs_90, %c_mask_102 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_104 = tt.broadcast %c_mask_101 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_105 = tt.broadcast %c_mask_103 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_106 = arith.andi %c_mask_104, %c_mask_105 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_100], %c_mask_106 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc95 = loc("a"(#loc38))
#loc97 = loc("b_ptrs"(#loc40))
#loc99 = loc("b"(#loc42))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))


// -----// IR Dump Before ConvertTritonAMDGPUToLLVM (convert-triton-amdgpu-to-llvm) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc3 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc70 = loc("accumulator"(#loc4))
#loc91 = loc("a_ptrs"(#loc35))
#loc94 = loc("a_ptrs"(#loc37))
#loc96 = loc("a"(#loc39))
#loc98 = loc("b_ptrs"(#loc41))
#loc100 = loc("b"(#loc43))
#loc106 = loc("accumulator"(#loc49))
#loc116 = loc(callsite(#loc3 at #loc70))
#loc121 = loc("b_ptrs"(#loc94))
#loc122 = loc("accumulator"(#loc121))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  tt.func public @matmul_kernel(%a_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !tt.ptr<f16> {tt.divisibility = 16 : i32, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc))) attributes {noinline = false} {
    %cst = arith.constant dense<64> : tensor<64x64xi32, #blocked> loc(#loc1)
    %c32_i32 = arith.constant 32 : i32 loc(#loc1)
    %c64_i32 = arith.constant 64 : i32 loc(#loc1)
    %true = arith.constant true loc(#loc1)
    %c0_i32 = arith.constant 0 : i32 loc(#loc1)
    %c4_i32 = arith.constant 4 : i32 loc(#loc1)
    %c1_i32 = arith.constant 1 : i32 loc(#loc1)
    %c63_i32 = arith.constant 63 : i32 loc(#loc1)
    %num_pid_n = arith.constant 31 : i32 loc(#loc115)
    %accumulator = arith.constant dense<0.000000e+00> : tensor<64x32xf32, #mma> loc(#loc116)
    %pid = tt.get_program_id x : i32 loc(#loc71)
    %num_pid_m = arith.addi %M, %c63_i32 : i32 loc(#loc117)
    %num_pid_m_0 = arith.divsi %num_pid_m, %c64_i32 : i32 loc(#loc118)
    %num_pid_n_1 = arith.addi %N, %num_pid_n : i32 loc(#loc119)
    %num_pid_n_2 = arith.divsi %num_pid_n_1, %c32_i32 : i32 loc(#loc120)
    %num_pid_in_group = arith.muli %num_pid_n_2, %c4_i32 : i32 loc(#loc73)
    %group_id = arith.divsi %pid, %num_pid_in_group : i32 loc(#loc74)
    %first_pid_m = arith.muli %group_id, %c4_i32 : i32 loc(#loc75)
    %group_size_m = arith.subi %num_pid_m_0, %first_pid_m : i32 loc(#loc76)
    %group_size_m_3 = arith.minsi %group_size_m, %c4_i32 : i32 loc(#loc77)
    %pid_m = arith.remsi %pid, %num_pid_in_group : i32 loc(#loc78)
    %pid_m_4 = arith.remsi %pid_m, %group_size_m_3 : i32 loc(#loc79)
    %pid_m_5 = arith.addi %first_pid_m, %pid_m_4 : i32 loc(#loc80)
    %pid_n = arith.divsi %pid_m, %group_size_m_3 : i32 loc(#loc81)
    llvm.intr.assume %true : i1 loc(#loc18)
    llvm.intr.assume %true : i1 loc(#loc19)
    llvm.intr.assume %true : i1 loc(#loc20)
    llvm.intr.assume %true : i1 loc(#loc21)
    llvm.intr.assume %true : i1 loc(#loc22)
    llvm.intr.assume %true : i1 loc(#loc23)
    llvm.intr.assume %true : i1 loc(#loc24)
    llvm.intr.assume %true : i1 loc(#loc25)
    %offs_am = arith.muli %pid_m_5, %c64_i32 : i32 loc(#loc82)
    %offs_am_6 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc83)
    %offs_am_7 = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc83)
    %offs_am_8 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_9 = tt.splat %offs_am : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_10 = arith.addi %offs_am_8, %offs_am_6 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc84)
    %offs_am_11 = arith.addi %offs_am_9, %offs_am_7 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> loc(#loc84)
    %offs_am_12 = tt.splat %M : i32 -> tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_am_13 = arith.remsi %offs_am_10, %offs_am_12 : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> loc(#loc85)
    %offs_bn = arith.muli %pid_n, %c32_i32 : i32 loc(#loc86)
    %offs_bn_14 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc87)
    %offs_bn_15 = tt.make_range {end = 32 : i32, start = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc87)
    %offs_bn_16 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_17 = tt.splat %offs_bn : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_18 = arith.addi %offs_bn_16, %offs_bn_14 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> loc(#loc88)
    %offs_bn_19 = arith.addi %offs_bn_17, %offs_bn_15 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc88)
    %offs_bn_20 = tt.splat %N : i32 -> tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %offs_bn_21 = arith.remsi %offs_bn_19, %offs_bn_20 : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> loc(#loc89)
    %a_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> loc(#loc90)
    %a_ptrs_22 = tt.expand_dims %a_ptrs {axis = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 0, parent = #blocked}>> -> tensor<1x64xi32, #blocked> loc(#loc90)
    %a_ptrs_23 = tt.expand_dims %offs_am_13 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked}>> -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_24 = tt.splat %stride_am : i32 -> tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_25 = arith.muli %a_ptrs_23, %a_ptrs_24 : tensor<64x1xi32, #blocked> loc(#loc91)
    %a_ptrs_26 = tt.broadcast %a_ptrs_25 : tensor<64x1xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_27 = tt.broadcast %a_ptrs_22 : tensor<1x64xi32, #blocked> -> tensor<64x64xi32, #blocked> loc(#loc91)
    %a_ptrs_28 = arith.addi %a_ptrs_26, %a_ptrs_27 : tensor<64x64xi32, #blocked> loc(#loc91)
    %0 = arith.addi %K, %c63_i32 : i32 loc(#loc92)
    %1 = arith.divsi %0, %c64_i32 : i32 loc(#loc93)
    %accumulator_29 = arith.cmpi sgt, %1, %c0_i32 : i32 loc(#loc122)
    %accumulator_30 = tt.splat %accumulator_29 : i1 -> tensor<64x64xi1, #blocked> loc(#loc122)
    %a = tt.splat %K : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_31 = arith.cmpi slt, %a_ptrs_22, %a : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_32 = tt.broadcast %a_31 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %accumulator_33 = arith.andi %accumulator_30, %a_32 : tensor<64x64xi1, #blocked> loc(#loc122)
    %a_34 = amdg.buffer_load %a_ptr[%a_ptrs_28], %accumulator_33 stride = %stride_am {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %b_ptrs = tt.make_range {end = 64 : i32, start = 0 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> loc(#loc97)
    %b_ptrs_35 = tt.expand_dims %b_ptrs {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #blocked1}>> -> tensor<64x1xi32, #blocked1> loc(#loc97)
    %b_ptrs_36 = tt.splat %stride_bk : i32 -> tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_37 = arith.muli %b_ptrs_35, %b_ptrs_36 : tensor<64x1xi32, #blocked1> loc(#loc98)
    %b_ptrs_38 = tt.broadcast %b_ptrs_37 : tensor<64x1xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_39 = tt.expand_dims %offs_bn_21 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #blocked1}>> -> tensor<1x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_40 = tt.broadcast %b_ptrs_39 : tensor<1x32xi32, #blocked1> -> tensor<64x32xi32, #blocked1> loc(#loc98)
    %b_ptrs_41 = arith.addi %b_ptrs_38, %b_ptrs_40 : tensor<64x32xi32, #blocked1> loc(#loc98)
    %accumulator_42 = tt.splat %accumulator_29 : i1 -> tensor<64x32xi1, #blocked1> loc(#loc122)
    %b = tt.splat %K : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_43 = arith.cmpi slt, %b_ptrs_35, %b : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_44 = tt.broadcast %b_43 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %accumulator_45 = arith.andi %accumulator_42, %b_44 : tensor<64x32xi1, #blocked1> loc(#loc122)
    %b_46 = amdg.buffer_load %b_ptr[%b_ptrs_41], %accumulator_45 stride = %stride_bk {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_ptrs_47 = arith.muli %stride_bk, %c64_i32 : i32 loc(#loc101)
    %b_ptrs_48 = tt.splat %b_ptrs_47 : i32 -> tensor<64x32xi32, #blocked1> loc(#loc102)
    %a_49 = ttg.local_alloc {allocation.offset = 0 : i32} : () -> !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_50 = ttg.local_alloc {allocation.offset = 8192 : i32} : () -> !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %a_51 = ttg.memdesc_index %a_49[%c0_i32] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_34, %a_51 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_52 = ttg.memdesc_index %b_50[%c0_i32] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_46, %b_52 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_53 = arith.subi %1, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%c0_i32, %accumulator, %a_ptrs_28, %b_ptrs_41, %c0_i32, %a_51, %b_52 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb1(%accumulator_54: i32 loc("accumulator"(#loc121)), %accumulator_55: tensor<64x32xf32, #mma> loc(callsite(#loc3 at #loc70)), %a_ptrs_56: tensor<64x64xi32, #blocked> loc("a_ptrs"(#loc35)), %b_ptrs_57: tensor<64x32xi32, #blocked1> loc("b_ptrs"(#loc41)), %2: i32 loc(unknown), %a_58: !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc("a"(#loc39)), %b_59: !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc("b"(#loc43))):  // 2 preds: ^bb0, ^bb2
    %accumulator_60 = arith.cmpi slt, %accumulator_54, %accumulator_53 : i32 loc(#loc122)
    cf.cond_br %accumulator_60, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_61 = arith.addi %a_ptrs_56, %cst : tensor<64x64xi32, #blocked> loc(#loc103)
    %b_ptrs_62 = arith.addi %b_ptrs_57, %b_ptrs_48 : tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_63 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    %a_64 = arith.muli %accumulator_63, %c64_i32 : i32 loc(#loc104)
    %a_65 = arith.subi %K, %a_64 : i32 loc(#loc105)
    %a_66 = tt.splat %a_65 : i32 -> tensor<1x64xi32, #blocked> loc(#loc95)
    %a_67 = arith.cmpi slt, %a_ptrs_22, %a_66 : tensor<1x64xi32, #blocked> loc(#loc95)
    %a_68 = tt.broadcast %a_67 : tensor<1x64xi1, #blocked> -> tensor<64x64xi1, #blocked> loc(#loc96)
    %a_69 = amdg.buffer_load %a_ptr[%a_ptrs_61], %a_68 {contiguity = 8 : i32} : tensor<64x64xf16, #blocked> loc(#loc96)
    %a_70 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_71 = tt.splat %a_65 : i32 -> tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_72 = arith.cmpi slt, %b_ptrs_35, %b_71 : tensor<64x1xi32, #blocked1> loc(#loc99)
    %b_73 = tt.broadcast %b_72 : tensor<64x1xi1, #blocked1> -> tensor<64x32xi1, #blocked1> loc(#loc100)
    %b_74 = amdg.buffer_load %b_ptr[%b_ptrs_62], %b_73 {contiguity = 4 : i32} : tensor<64x32xf16, #blocked1> loc(#loc100)
    %b_75 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    %accumulator_76 = tt.dot %a_70, %b_75, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_77 = arith.addi %2, %c1_i32 : i32 loc(#loc122)
    %accumulator_78 = arith.cmpi slt, %accumulator_77, %c1_i32 : i32 loc(#loc122)
    %accumulator_79 = arith.select %accumulator_78, %accumulator_77, %c0_i32 : i32 loc(#loc122)
    %a_80 = ttg.memdesc_index %a_49[%accumulator_79] : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    ttg.local_store %a_69, %a_80 : tensor<64x64xf16, #blocked> -> !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc96)
    %b_81 = ttg.memdesc_index %b_50[%accumulator_79] : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    ttg.local_store %b_74, %b_81 : tensor<64x32xf16, #blocked1> -> !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc100)
    %accumulator_82 = arith.addi %accumulator_54, %c1_i32 : i32 loc(#loc122)
    cf.br ^bb1(%accumulator_82, %accumulator_76, %a_ptrs_61, %b_ptrs_62, %accumulator_79, %a_80, %b_81 : i32, tensor<64x32xf32, #mma>, tensor<64x64xi32, #blocked>, tensor<64x32xi32, #blocked1>, i32, !ttg.memdesc<64x64xf16, #shared, #smem, mutable>, !ttg.memdesc<64x32xf16, #shared1, #smem, mutable>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_83 = arith.cmpi sge, %1, %c1_i32 : i32 loc(#loc122)
    %a_84 = ttg.local_load %a_58 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> -> tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> loc(#loc96)
    %b_85 = ttg.local_load %b_59 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> -> tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> loc(#loc100)
    cf.cond_br %accumulator_83, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_86 = tt.dot %a_84, %b_85, %accumulator_55, inputPrecision = tf32 : tensor<64x64xf16, #ttg.dot_op<{opIdx = 0, parent = #mma, kWidth = 4}>> * tensor<64x32xf16, #ttg.dot_op<{opIdx = 1, parent = #mma, kWidth = 4}>> -> tensor<64x32xf32, #mma> loc(#loc106)
    cf.br ^bb6(%accumulator_86 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    cf.br ^bb6(%accumulator_55 : tensor<64x32xf32, #mma>) loc(#loc106)
  ^bb6(%accumulator_87: tensor<64x32xf32, #mma> loc("accumulator"(#loc49))):  // 2 preds: ^bb4, ^bb5
    cf.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_88 = arith.select %accumulator_83, %accumulator_87, %accumulator_55 : tensor<64x32xf32, #mma> loc(#loc122)
    ttg.local_dealloc %b_50 : !ttg.memdesc<1x64x32xf16, #shared1, #smem, mutable> loc(#loc122)
    ttg.local_dealloc %a_49 : !ttg.memdesc<1x64x64xf16, #shared, #smem, mutable> loc(#loc122)
    %c = arith.truncf %accumulator_88 : tensor<64x32xf32, #mma> to tensor<64x32xf16, #mma> loc(#loc107)
    %c_ptrs = tt.expand_dims %offs_am_11 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc108)
    %c_ptrs_89 = arith.muli %stride_cm, %offs_am : i32 loc(#loc109)
    %c_ptrs_90 = tt.expand_dims %offs_bn_18 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc110)
    %c_ptrs_91 = tt.expand_dims %offs_am_7 {axis = 1 : i32} : tensor<64xi32, #ttg.slice<{dim = 1, parent = #mma}>> -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_92 = tt.splat %stride_cm : i32 -> tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_93 = arith.muli %c_ptrs_92, %c_ptrs_91 : tensor<64x1xi32, #mma> loc(#loc111)
    %c_ptrs_94 = tt.broadcast %c_ptrs_93 : tensor<64x1xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_95 = tt.expand_dims %offs_bn_14 {axis = 0 : i32} : tensor<32xi32, #ttg.slice<{dim = 0, parent = #mma}>> -> tensor<1x32xi32, #mma> loc(#loc111)
    %c_ptrs_96 = tt.broadcast %c_ptrs_95 : tensor<1x32xi32, #mma> -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_97 = arith.addi %c_ptrs_89, %offs_bn : i32 loc(#loc111)
    %c_ptrs_98 = arith.addi %c_ptrs_94, %c_ptrs_96 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_99 = tt.splat %c_ptrs_97 : i32 -> tensor<64x32xi32, #mma> loc(#loc111)
    %c_ptrs_100 = arith.addi %c_ptrs_99, %c_ptrs_98 : tensor<64x32xi32, #mma> loc(#loc111)
    %c_mask = tt.splat %M : i32 -> tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_101 = arith.cmpi slt, %c_ptrs, %c_mask : tensor<64x1xi32, #mma> loc(#loc112)
    %c_mask_102 = tt.splat %N : i32 -> tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_103 = arith.cmpi slt, %c_ptrs_90, %c_mask_102 : tensor<1x32xi32, #mma> loc(#loc113)
    %c_mask_104 = tt.broadcast %c_mask_101 : tensor<64x1xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_105 = tt.broadcast %c_mask_103 : tensor<1x32xi1, #mma> -> tensor<64x32xi1, #mma> loc(#loc114)
    %c_mask_106 = arith.andi %c_mask_104, %c_mask_105 : tensor<64x32xi1, #mma> loc(#loc114)
    amdg.buffer_store %c, %c_ptr[%c_ptrs_100], %c_mask_106 {contiguity = 4 : i32} : tensor<64x32xf16, #mma> loc(#loc58)
    tt.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc6 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc8 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc69 = loc("num_pid_n"(#loc2))
#loc71 = loc("pid"(#loc5))
#loc72 = loc("num_pid_m"(#loc7))
#loc73 = loc("num_pid_in_group"(#loc9))
#loc74 = loc("group_id"(#loc10))
#loc75 = loc("first_pid_m"(#loc11))
#loc76 = loc("group_size_m"(#loc12))
#loc77 = loc("group_size_m"(#loc13))
#loc78 = loc("pid_m"(#loc14))
#loc79 = loc("pid_m"(#loc15))
#loc80 = loc("pid_m"(#loc16))
#loc81 = loc("pid_n"(#loc17))
#loc82 = loc("offs_am"(#loc26))
#loc83 = loc("offs_am"(#loc27))
#loc84 = loc("offs_am"(#loc28))
#loc85 = loc("offs_am"(#loc29))
#loc86 = loc("offs_bn"(#loc30))
#loc87 = loc("offs_bn"(#loc31))
#loc88 = loc("offs_bn"(#loc32))
#loc89 = loc("offs_bn"(#loc33))
#loc90 = loc("a_ptrs"(#loc34))
#loc92 = loc(callsite(#loc6 at #loc36))
#loc93 = loc(callsite(#loc8 at #loc36))
#loc95 = loc("a"(#loc38))
#loc97 = loc("b_ptrs"(#loc40))
#loc99 = loc("b"(#loc42))
#loc101 = loc("b_ptrs"(#loc44))
#loc102 = loc("b_ptrs"(#loc45))
#loc103 = loc("a_ptrs"(#loc46))
#loc104 = loc("a"(#loc47))
#loc105 = loc("a"(#loc48))
#loc107 = loc("c"(#loc50))
#loc108 = loc("c_ptrs"(#loc51))
#loc109 = loc("c_ptrs"(#loc52))
#loc110 = loc("c_ptrs"(#loc53))
#loc111 = loc("c_ptrs"(#loc54))
#loc112 = loc("c_mask"(#loc55))
#loc113 = loc("c_mask"(#loc56))
#loc114 = loc("c_mask"(#loc57))
#loc115 = loc(callsite(#loc1 at #loc69))
#loc117 = loc(callsite(#loc6 at #loc72))
#loc118 = loc(callsite(#loc8 at #loc72))
#loc119 = loc(callsite(#loc6 at #loc69))
#loc120 = loc(callsite(#loc8 at #loc69))


// -----// IR Dump Before TritonAMDGPUConvertWarpSpecializeToLLVM (triton-amdgpu-convert-warp-specialize-to-llvm) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc8 = loc(unknown)
#loc10 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc69 = loc("b"(#loc2))
#loc70 = loc("a"(#loc3))
#loc76 = loc("accumulator"(#loc11))
#loc77 = loc("a_ptrs"(#loc12))
#loc95 = loc("a_ptrs"(#loc40))
#loc99 = loc("b_ptrs"(#loc43))
#loc106 = loc("accumulator"(#loc50))
#loc116 = loc(callsite(#loc10 at #loc76))
#loc117 = loc("b_ptrs"(#loc77))
#loc122 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %1 = rocdl.workitem.id.x : i32 loc(#loc1)
    %2 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %3 = llvm.and %1, %2 : i32 loc(#loc1)
    %4 = llvm.udiv %3, %0 : i32 loc(#loc1)
    %5 = rocdl.readfirstlane %4 : i32 loc(#loc1)
    %b = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_0 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2 = llvm.and %b_0, %b_1 : i32 loc(#loc69)
    %b_3 = llvm.udiv %b_2, %b : i32 loc(#loc69)
    %b_4 = rocdl.readfirstlane %b_3 : i32 loc(#loc69)
    %a = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_5 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_6 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_7 = llvm.and %a_5, %a_6 : i32 loc(#loc70)
    %a_8 = llvm.udiv %a_7, %a : i32 loc(#loc70)
    %a_9 = rocdl.readfirstlane %a_8 : i32 loc(#loc70)
    %b_10 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_11 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_12 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_13 = llvm.and %b_11, %b_12 : i32 loc(#loc69)
    %b_14 = llvm.udiv %b_13, %b_10 : i32 loc(#loc69)
    %b_15 = rocdl.readfirstlane %b_14 : i32 loc(#loc69)
    %a_16 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_17 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_18 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_19 = llvm.and %a_17, %a_18 : i32 loc(#loc70)
    %a_20 = llvm.udiv %a_19, %a_16 : i32 loc(#loc70)
    %a_21 = rocdl.readfirstlane %a_20 : i32 loc(#loc70)
    %b_22 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_23 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_24 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_25 = llvm.and %b_23, %b_24 : i32 loc(#loc69)
    %b_26 = llvm.udiv %b_25, %b_22 : i32 loc(#loc69)
    %b_27 = rocdl.readfirstlane %b_26 : i32 loc(#loc69)
    %a_28 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_29 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_30 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_31 = llvm.and %a_29, %a_30 : i32 loc(#loc70)
    %a_32 = llvm.udiv %a_31, %a_28 : i32 loc(#loc70)
    %a_33 = rocdl.readfirstlane %a_32 : i32 loc(#loc70)
    %b_34 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_35 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_36 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_37 = llvm.and %b_35, %b_36 : i32 loc(#loc69)
    %b_38 = llvm.udiv %b_37, %b_34 : i32 loc(#loc69)
    %b_39 = rocdl.readfirstlane %b_38 : i32 loc(#loc69)
    %a_40 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_41 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_42 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_43 = llvm.and %a_41, %a_42 : i32 loc(#loc70)
    %a_44 = llvm.udiv %a_43, %a_40 : i32 loc(#loc70)
    %a_45 = rocdl.readfirstlane %a_44 : i32 loc(#loc70)
    %b_ptrs = llvm.mlir.constant(64 : i32) : i32 loc(#loc71)
    %b_ptrs_46 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_ptrs_47 = llvm.mlir.constant(511 : i32) : i32 loc(#loc71)
    %b_ptrs_48 = llvm.and %b_ptrs_46, %b_ptrs_47 : i32 loc(#loc71)
    %b_ptrs_49 = llvm.udiv %b_ptrs_48, %b_ptrs : i32 loc(#loc71)
    %b_ptrs_50 = rocdl.readfirstlane %b_ptrs_49 : i32 loc(#loc71)
    %a_ptrs = llvm.mlir.constant(64 : i32) : i32 loc(#loc72)
    %a_ptrs_51 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_ptrs_52 = llvm.mlir.constant(511 : i32) : i32 loc(#loc72)
    %a_ptrs_53 = llvm.and %a_ptrs_51, %a_ptrs_52 : i32 loc(#loc72)
    %a_ptrs_54 = llvm.udiv %a_ptrs_53, %a_ptrs : i32 loc(#loc72)
    %a_ptrs_55 = rocdl.readfirstlane %a_ptrs_54 : i32 loc(#loc72)
    %offs_bn = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_56 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_57 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_58 = llvm.and %offs_bn_56, %offs_bn_57 : i32 loc(#loc73)
    %offs_bn_59 = llvm.udiv %offs_bn_58, %offs_bn : i32 loc(#loc73)
    %offs_bn_60 = rocdl.readfirstlane %offs_bn_59 : i32 loc(#loc73)
    %offs_bn_61 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_62 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_63 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_64 = llvm.and %offs_bn_62, %offs_bn_63 : i32 loc(#loc73)
    %offs_bn_65 = llvm.udiv %offs_bn_64, %offs_bn_61 : i32 loc(#loc73)
    %offs_bn_66 = rocdl.readfirstlane %offs_bn_65 : i32 loc(#loc73)
    %offs_am = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_67 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_68 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_69 = llvm.and %offs_am_67, %offs_am_68 : i32 loc(#loc74)
    %offs_am_70 = llvm.udiv %offs_am_69, %offs_am : i32 loc(#loc74)
    %offs_am_71 = rocdl.readfirstlane %offs_am_70 : i32 loc(#loc74)
    %offs_am_72 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_73 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_74 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_75 = llvm.and %offs_am_73, %offs_am_74 : i32 loc(#loc74)
    %offs_am_76 = llvm.udiv %offs_am_75, %offs_am_72 : i32 loc(#loc74)
    %offs_am_77 = rocdl.readfirstlane %offs_am_76 : i32 loc(#loc74)
    %c_ptr_78 = builtin.unrealized_conversion_cast %c_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc62)
    %b_ptr_79 = builtin.unrealized_conversion_cast %b_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc61)
    %a_ptr_80 = builtin.unrealized_conversion_cast %a_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc60)
    %6 = llvm.mlir.constant(64 : i32) : i32 loc(#loc8)
    %7 = llvm.bitcast %6 : i32 to i32 loc(#loc8)
    %8 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc8)
    %9 = llvm.insertvalue %7, %8[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %10 = llvm.insertvalue %7, %9[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %11 = llvm.insertvalue %7, %10[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %12 = llvm.insertvalue %7, %11[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %13 = llvm.insertvalue %7, %12[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %14 = llvm.insertvalue %7, %13[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %15 = llvm.insertvalue %7, %14[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %16 = llvm.insertvalue %7, %15[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %17 = llvm.mlir.constant(32 : i32) : i32 loc(#loc8)
    %18 = llvm.mlir.constant(64 : i32) : i32 loc(#loc8)
    %19 = llvm.mlir.constant(true) : i1 loc(#loc8)
    %20 = llvm.mlir.constant(0 : i32) : i32 loc(#loc8)
    %21 = llvm.mlir.constant(4 : i32) : i32 loc(#loc8)
    %22 = llvm.mlir.constant(1 : i32) : i32 loc(#loc8)
    %23 = llvm.mlir.constant(63 : i32) : i32 loc(#loc8)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc115)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc116)
    %accumulator_81 = llvm.bitcast %accumulator : f32 to f32 loc(#loc116)
    %accumulator_82 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc116)
    %accumulator_83 = llvm.insertvalue %accumulator_81, %accumulator_82[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_84 = llvm.insertvalue %accumulator_81, %accumulator_83[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_85 = llvm.insertvalue %accumulator_81, %accumulator_84[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_86 = llvm.insertvalue %accumulator_81, %accumulator_85[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_87 = builtin.unrealized_conversion_cast %accumulator_86 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc116)
    %accumulator_88 = builtin.unrealized_conversion_cast %accumulator_87 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc78)
    %num_pid_m = llvm.add %M, %23 : i32 loc(#loc118)
    %num_pid_m_89 = llvm.sdiv %num_pid_m, %18 : i32 loc(#loc119)
    %num_pid_n_90 = llvm.add %N, %num_pid_n : i32 loc(#loc120)
    %num_pid_n_91 = llvm.sdiv %num_pid_n_90, %17 : i32 loc(#loc121)
    %num_pid_in_group = llvm.mul %num_pid_n_91, %21 : i32 loc(#loc80)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc81)
    %first_pid_m = llvm.mul %group_id, %21 : i32 loc(#loc82)
    %group_size_m = llvm.sub %num_pid_m_89, %first_pid_m : i32 loc(#loc83)
    %group_size_m_92 = llvm.intr.smin(%group_size_m, %21) : (i32, i32) -> i32 loc(#loc84)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc85)
    %pid_m_93 = llvm.srem %pid_m, %group_size_m_92 : i32 loc(#loc86)
    %pid_m_94 = llvm.add %first_pid_m, %pid_m_93 : i32 loc(#loc87)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_92 : i32 loc(#loc88)
    llvm.intr.assume %19 : i1 loc(#loc26)
    llvm.intr.assume %19 : i1 loc(#loc27)
    llvm.intr.assume %19 : i1 loc(#loc28)
    llvm.intr.assume %19 : i1 loc(#loc29)
    llvm.intr.assume %19 : i1 loc(#loc30)
    llvm.intr.assume %19 : i1 loc(#loc31)
    llvm.intr.assume %19 : i1 loc(#loc32)
    llvm.intr.assume %19 : i1 loc(#loc33)
    %offs_am_95 = llvm.mul %pid_m_94, %18 : i32 loc(#loc89)
    %offs_am_96 = llvm.mlir.constant(0 : index) : i32 loc(#loc74)
    %offs_am_97 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_98 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_99 = llvm.and %offs_am_97, %offs_am_98 : i32 loc(#loc74)
    %offs_am_100 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_101 = llvm.urem %offs_am_99, %offs_am_100 : i32 loc(#loc74)
    %offs_am_102 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_103 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_104 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_105 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_106 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_107 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_108 = llvm.shl %offs_am_101, %offs_am_107 : i32 loc(#loc74)
    %offs_am_109 = llvm.or %offs_am_106, %offs_am_108 : i32 loc(#loc74)
    %offs_am_110 = llvm.mlir.constant(6 : i32) : i32 loc(#loc74)
    %offs_am_111 = llvm.shl %offs_am_77, %offs_am_110 : i32 loc(#loc74)
    %offs_am_112 = llvm.or %offs_am_109, %offs_am_111 : i32 loc(#loc74)
    %offs_am_113 = llvm.mlir.constant(504 : i32) : i32 loc(#loc74)
    %offs_am_114 = llvm.and %offs_am_112, %offs_am_113 : i32 loc(#loc74)
    %offs_am_115 = llvm.mlir.constant(3 : i32) : i32 loc(#loc74)
    %offs_am_116 = llvm.lshr %offs_am_114, %offs_am_115 : i32 loc(#loc74)
    %offs_am_117 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_118 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_119 = llvm.or disjoint %offs_am_116, %offs_am_118 : i32 loc(#loc74)
    %offs_am_120 = llvm.xor %offs_am_105, %offs_am_119 : i32 loc(#loc74)
    %offs_am_121 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_122 = llvm.xor %offs_am_120, %offs_am_121 : i32 loc(#loc74)
    %offs_am_123 = llvm.add %offs_am_122, %offs_am_96 : i32 loc(#loc74)
    %offs_am_124 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc74)
    %offs_am_125 = llvm.insertvalue %offs_am_123, %offs_am_124[0] : !llvm.struct<(i32)>  loc(#loc74)
    %offs_am_126 = llvm.mlir.constant(0 : index) : i32 loc(#loc74)
    %offs_am_127 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_128 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_129 = llvm.and %offs_am_127, %offs_am_128 : i32 loc(#loc74)
    %offs_am_130 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_131 = llvm.urem %offs_am_129, %offs_am_130 : i32 loc(#loc74)
    %offs_am_132 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_133 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_134 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_135 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_136 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_137 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_138 = llvm.shl %offs_am_131, %offs_am_137 : i32 loc(#loc74)
    %offs_am_139 = llvm.or %offs_am_136, %offs_am_138 : i32 loc(#loc74)
    %offs_am_140 = llvm.mlir.constant(6 : i32) : i32 loc(#loc74)
    %offs_am_141 = llvm.shl %offs_am_71, %offs_am_140 : i32 loc(#loc74)
    %offs_am_142 = llvm.or %offs_am_139, %offs_am_141 : i32 loc(#loc74)
    %offs_am_143 = llvm.mlir.constant(15 : i32) : i32 loc(#loc74)
    %offs_am_144 = llvm.and %offs_am_142, %offs_am_143 : i32 loc(#loc74)
    %offs_am_145 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_146 = llvm.lshr %offs_am_144, %offs_am_145 : i32 loc(#loc74)
    %offs_am_147 = llvm.mlir.constant(384 : i32) : i32 loc(#loc74)
    %offs_am_148 = llvm.and %offs_am_142, %offs_am_147 : i32 loc(#loc74)
    %offs_am_149 = llvm.mlir.constant(3 : i32) : i32 loc(#loc74)
    %offs_am_150 = llvm.lshr %offs_am_148, %offs_am_149 : i32 loc(#loc74)
    %offs_am_151 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_152 = llvm.or disjoint %offs_am_146, %offs_am_150 : i32 loc(#loc74)
    %offs_am_153 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_154 = llvm.or disjoint %offs_am_152, %offs_am_153 : i32 loc(#loc74)
    %offs_am_155 = llvm.xor %offs_am_135, %offs_am_154 : i32 loc(#loc74)
    %offs_am_156 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_157 = llvm.xor %offs_am_155, %offs_am_156 : i32 loc(#loc74)
    %offs_am_158 = llvm.add %offs_am_157, %offs_am_126 : i32 loc(#loc74)
    %offs_am_159 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc74)
    %offs_am_160 = llvm.insertvalue %offs_am_158, %offs_am_159[0] : !llvm.struct<(i32)>  loc(#loc74)
    %offs_am_161 = llvm.bitcast %offs_am_95 : i32 to i32 loc(#loc90)
    %offs_am_162 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_163 = llvm.insertvalue %offs_am_161, %offs_am_162[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_164 = llvm.bitcast %offs_am_95 : i32 to i32 loc(#loc90)
    %offs_am_165 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_166 = llvm.insertvalue %offs_am_164, %offs_am_165[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_167 = llvm.extractvalue %offs_am_163[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_168 = llvm.extractvalue %offs_am_125[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_169 = llvm.add %offs_am_167, %offs_am_168 : i32 loc(#loc90)
    %offs_am_170 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_171 = llvm.insertvalue %offs_am_169, %offs_am_170[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_172 = llvm.extractvalue %offs_am_166[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_173 = llvm.extractvalue %offs_am_160[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_174 = llvm.add %offs_am_172, %offs_am_173 : i32 loc(#loc90)
    %offs_am_175 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_176 = llvm.insertvalue %offs_am_174, %offs_am_175[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_177 = llvm.bitcast %M : i32 to i32 loc(#loc91)
    %offs_am_178 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc91)
    %offs_am_179 = llvm.insertvalue %offs_am_177, %offs_am_178[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_180 = llvm.extractvalue %offs_am_171[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_181 = llvm.extractvalue %offs_am_179[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_182 = llvm.srem %offs_am_180, %offs_am_181 : i32 loc(#loc91)
    %offs_am_183 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc91)
    %offs_am_184 = llvm.insertvalue %offs_am_182, %offs_am_183[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_bn_185 = llvm.mul %pid_n, %17 : i32 loc(#loc92)
    %offs_bn_186 = llvm.mlir.constant(0 : index) : i32 loc(#loc73)
    %offs_bn_187 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_188 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_189 = llvm.and %offs_bn_187, %offs_bn_188 : i32 loc(#loc73)
    %offs_bn_190 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_191 = llvm.urem %offs_bn_189, %offs_bn_190 : i32 loc(#loc73)
    %offs_bn_192 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_193 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_194 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_195 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_196 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_197 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_198 = llvm.shl %offs_bn_191, %offs_bn_197 : i32 loc(#loc73)
    %offs_bn_199 = llvm.or %offs_bn_196, %offs_bn_198 : i32 loc(#loc73)
    %offs_bn_200 = llvm.mlir.constant(6 : i32) : i32 loc(#loc73)
    %offs_bn_201 = llvm.shl %offs_bn_66, %offs_bn_200 : i32 loc(#loc73)
    %offs_bn_202 = llvm.or %offs_bn_199, %offs_bn_201 : i32 loc(#loc73)
    %offs_bn_203 = llvm.mlir.constant(112 : i32) : i32 loc(#loc73)
    %offs_bn_204 = llvm.and %offs_bn_202, %offs_bn_203 : i32 loc(#loc73)
    %offs_bn_205 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_206 = llvm.lshr %offs_bn_204, %offs_bn_205 : i32 loc(#loc73)
    %offs_bn_207 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_208 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_209 = llvm.or disjoint %offs_bn_208, %offs_bn_206 : i32 loc(#loc73)
    %offs_bn_210 = llvm.xor %offs_bn_195, %offs_bn_209 : i32 loc(#loc73)
    %offs_bn_211 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_212 = llvm.xor %offs_bn_210, %offs_bn_211 : i32 loc(#loc73)
    %offs_bn_213 = llvm.mlir.constant(1 : i32) : i32 loc(#loc73)
    %offs_bn_214 = llvm.xor %offs_bn_210, %offs_bn_213 : i32 loc(#loc73)
    %offs_bn_215 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_216 = llvm.xor %offs_bn_210, %offs_bn_215 : i32 loc(#loc73)
    %offs_bn_217 = llvm.mlir.constant(3 : i32) : i32 loc(#loc73)
    %offs_bn_218 = llvm.xor %offs_bn_210, %offs_bn_217 : i32 loc(#loc73)
    %offs_bn_219 = llvm.add %offs_bn_212, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_220 = llvm.add %offs_bn_214, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_221 = llvm.add %offs_bn_216, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_222 = llvm.add %offs_bn_218, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_223 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc73)
    %offs_bn_224 = llvm.insertvalue %offs_bn_219, %offs_bn_223[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_225 = llvm.insertvalue %offs_bn_220, %offs_bn_224[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_226 = llvm.insertvalue %offs_bn_221, %offs_bn_225[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_227 = llvm.insertvalue %offs_bn_222, %offs_bn_226[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_228 = llvm.mlir.constant(0 : index) : i32 loc(#loc73)
    %offs_bn_229 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_230 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_231 = llvm.and %offs_bn_229, %offs_bn_230 : i32 loc(#loc73)
    %offs_bn_232 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_233 = llvm.urem %offs_bn_231, %offs_bn_232 : i32 loc(#loc73)
    %offs_bn_234 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_235 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_236 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_237 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_238 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_239 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_240 = llvm.shl %offs_bn_233, %offs_bn_239 : i32 loc(#loc73)
    %offs_bn_241 = llvm.or %offs_bn_238, %offs_bn_240 : i32 loc(#loc73)
    %offs_bn_242 = llvm.mlir.constant(6 : i32) : i32 loc(#loc73)
    %offs_bn_243 = llvm.shl %offs_bn_60, %offs_bn_242 : i32 loc(#loc73)
    %offs_bn_244 = llvm.or %offs_bn_241, %offs_bn_243 : i32 loc(#loc73)
    %offs_bn_245 = llvm.mlir.constant(7 : i32) : i32 loc(#loc73)
    %offs_bn_246 = llvm.and %offs_bn_244, %offs_bn_245 : i32 loc(#loc73)
    %offs_bn_247 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_248 = llvm.shl %offs_bn_246, %offs_bn_247 : i32 loc(#loc73)
    %offs_bn_249 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_250 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_251 = llvm.or disjoint %offs_bn_248, %offs_bn_250 : i32 loc(#loc73)
    %offs_bn_252 = llvm.xor %offs_bn_237, %offs_bn_251 : i32 loc(#loc73)
    %offs_bn_253 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_254 = llvm.xor %offs_bn_252, %offs_bn_253 : i32 loc(#loc73)
    %offs_bn_255 = llvm.mlir.constant(1 : i32) : i32 loc(#loc73)
    %offs_bn_256 = llvm.xor %offs_bn_252, %offs_bn_255 : i32 loc(#loc73)
    %offs_bn_257 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_258 = llvm.xor %offs_bn_252, %offs_bn_257 : i32 loc(#loc73)
    %offs_bn_259 = llvm.mlir.constant(3 : i32) : i32 loc(#loc73)
    %offs_bn_260 = llvm.xor %offs_bn_252, %offs_bn_259 : i32 loc(#loc73)
    %offs_bn_261 = llvm.add %offs_bn_254, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_262 = llvm.add %offs_bn_256, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_263 = llvm.add %offs_bn_258, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_264 = llvm.add %offs_bn_260, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_265 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc73)
    %offs_bn_266 = llvm.insertvalue %offs_bn_261, %offs_bn_265[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_267 = llvm.insertvalue %offs_bn_262, %offs_bn_266[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_268 = llvm.insertvalue %offs_bn_263, %offs_bn_267[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_269 = llvm.insertvalue %offs_bn_264, %offs_bn_268[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_270 = llvm.bitcast %offs_bn_185 : i32 to i32 loc(#loc93)
    %offs_bn_271 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_272 = llvm.insertvalue %offs_bn_270, %offs_bn_271[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_273 = llvm.insertvalue %offs_bn_270, %offs_bn_272[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_274 = llvm.insertvalue %offs_bn_270, %offs_bn_273[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_275 = llvm.insertvalue %offs_bn_270, %offs_bn_274[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_276 = llvm.bitcast %offs_bn_185 : i32 to i32 loc(#loc93)
    %offs_bn_277 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_278 = llvm.insertvalue %offs_bn_276, %offs_bn_277[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_279 = llvm.insertvalue %offs_bn_276, %offs_bn_278[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_280 = llvm.insertvalue %offs_bn_276, %offs_bn_279[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_281 = llvm.insertvalue %offs_bn_276, %offs_bn_280[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_282 = llvm.extractvalue %offs_bn_275[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_283 = llvm.extractvalue %offs_bn_275[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_284 = llvm.extractvalue %offs_bn_275[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_285 = llvm.extractvalue %offs_bn_275[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_286 = llvm.extractvalue %offs_bn_227[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_287 = llvm.extractvalue %offs_bn_227[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_288 = llvm.extractvalue %offs_bn_227[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_289 = llvm.extractvalue %offs_bn_227[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_290 = llvm.add %offs_bn_282, %offs_bn_286 : i32 loc(#loc93)
    %offs_bn_291 = llvm.add %offs_bn_283, %offs_bn_287 : i32 loc(#loc93)
    %offs_bn_292 = llvm.add %offs_bn_284, %offs_bn_288 : i32 loc(#loc93)
    %offs_bn_293 = llvm.add %offs_bn_285, %offs_bn_289 : i32 loc(#loc93)
    %offs_bn_294 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_295 = llvm.insertvalue %offs_bn_290, %offs_bn_294[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_296 = llvm.insertvalue %offs_bn_291, %offs_bn_295[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_297 = llvm.insertvalue %offs_bn_292, %offs_bn_296[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_298 = llvm.insertvalue %offs_bn_293, %offs_bn_297[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_299 = llvm.extractvalue %offs_bn_281[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_300 = llvm.extractvalue %offs_bn_281[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_301 = llvm.extractvalue %offs_bn_281[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_302 = llvm.extractvalue %offs_bn_281[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_303 = llvm.extractvalue %offs_bn_269[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_304 = llvm.extractvalue %offs_bn_269[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_305 = llvm.extractvalue %offs_bn_269[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_306 = llvm.extractvalue %offs_bn_269[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_307 = llvm.add %offs_bn_299, %offs_bn_303 : i32 loc(#loc93)
    %offs_bn_308 = llvm.add %offs_bn_300, %offs_bn_304 : i32 loc(#loc93)
    %offs_bn_309 = llvm.add %offs_bn_301, %offs_bn_305 : i32 loc(#loc93)
    %offs_bn_310 = llvm.add %offs_bn_302, %offs_bn_306 : i32 loc(#loc93)
    %offs_bn_311 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_312 = llvm.insertvalue %offs_bn_307, %offs_bn_311[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_313 = llvm.insertvalue %offs_bn_308, %offs_bn_312[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_314 = llvm.insertvalue %offs_bn_309, %offs_bn_313[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_315 = llvm.insertvalue %offs_bn_310, %offs_bn_314[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_316 = llvm.bitcast %N : i32 to i32 loc(#loc94)
    %offs_bn_317 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc94)
    %offs_bn_318 = llvm.insertvalue %offs_bn_316, %offs_bn_317[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_319 = llvm.insertvalue %offs_bn_316, %offs_bn_318[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_320 = llvm.insertvalue %offs_bn_316, %offs_bn_319[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_321 = llvm.insertvalue %offs_bn_316, %offs_bn_320[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_322 = llvm.extractvalue %offs_bn_315[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_323 = llvm.extractvalue %offs_bn_315[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_324 = llvm.extractvalue %offs_bn_315[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_325 = llvm.extractvalue %offs_bn_315[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_326 = llvm.extractvalue %offs_bn_321[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_327 = llvm.extractvalue %offs_bn_321[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_328 = llvm.extractvalue %offs_bn_321[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_329 = llvm.extractvalue %offs_bn_321[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_330 = llvm.srem %offs_bn_322, %offs_bn_326 : i32 loc(#loc94)
    %offs_bn_331 = llvm.srem %offs_bn_323, %offs_bn_327 : i32 loc(#loc94)
    %offs_bn_332 = llvm.srem %offs_bn_324, %offs_bn_328 : i32 loc(#loc94)
    %offs_bn_333 = llvm.srem %offs_bn_325, %offs_bn_329 : i32 loc(#loc94)
    %offs_bn_334 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc94)
    %offs_bn_335 = llvm.insertvalue %offs_bn_330, %offs_bn_334[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_336 = llvm.insertvalue %offs_bn_331, %offs_bn_335[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_337 = llvm.insertvalue %offs_bn_332, %offs_bn_336[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_338 = llvm.insertvalue %offs_bn_333, %offs_bn_337[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %a_ptrs_339 = llvm.mlir.constant(0 : index) : i32 loc(#loc72)
    %a_ptrs_340 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_ptrs_341 = llvm.mlir.constant(511 : i32) : i32 loc(#loc72)
    %a_ptrs_342 = llvm.and %a_ptrs_340, %a_ptrs_341 : i32 loc(#loc72)
    %a_ptrs_343 = llvm.mlir.constant(64 : i32) : i32 loc(#loc72)
    %a_ptrs_344 = llvm.urem %a_ptrs_342, %a_ptrs_343 : i32 loc(#loc72)
    %a_ptrs_345 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_346 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_347 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_348 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_349 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_350 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_351 = llvm.shl %a_ptrs_344, %a_ptrs_350 : i32 loc(#loc72)
    %a_ptrs_352 = llvm.or %a_ptrs_349, %a_ptrs_351 : i32 loc(#loc72)
    %a_ptrs_353 = llvm.mlir.constant(6 : i32) : i32 loc(#loc72)
    %a_ptrs_354 = llvm.shl %a_ptrs_55, %a_ptrs_353 : i32 loc(#loc72)
    %a_ptrs_355 = llvm.or %a_ptrs_352, %a_ptrs_354 : i32 loc(#loc72)
    %a_ptrs_356 = llvm.mlir.constant(7 : i32) : i32 loc(#loc72)
    %a_ptrs_357 = llvm.and %a_ptrs_355, %a_ptrs_356 : i32 loc(#loc72)
    %a_ptrs_358 = llvm.mlir.constant(3 : i32) : i32 loc(#loc72)
    %a_ptrs_359 = llvm.shl %a_ptrs_357, %a_ptrs_358 : i32 loc(#loc72)
    %a_ptrs_360 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_361 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_362 = llvm.or disjoint %a_ptrs_359, %a_ptrs_361 : i32 loc(#loc72)
    %a_ptrs_363 = llvm.xor %a_ptrs_348, %a_ptrs_362 : i32 loc(#loc72)
    %a_ptrs_364 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_365 = llvm.xor %a_ptrs_363, %a_ptrs_364 : i32 loc(#loc72)
    %a_ptrs_366 = llvm.mlir.constant(1 : i32) : i32 loc(#loc72)
    %a_ptrs_367 = llvm.xor %a_ptrs_363, %a_ptrs_366 : i32 loc(#loc72)
    %a_ptrs_368 = llvm.mlir.constant(2 : i32) : i32 loc(#loc72)
    %a_ptrs_369 = llvm.xor %a_ptrs_363, %a_ptrs_368 : i32 loc(#loc72)
    %a_ptrs_370 = llvm.mlir.constant(3 : i32) : i32 loc(#loc72)
    %a_ptrs_371 = llvm.xor %a_ptrs_363, %a_ptrs_370 : i32 loc(#loc72)
    %a_ptrs_372 = llvm.mlir.constant(4 : i32) : i32 loc(#loc72)
    %a_ptrs_373 = llvm.xor %a_ptrs_363, %a_ptrs_372 : i32 loc(#loc72)
    %a_ptrs_374 = llvm.mlir.constant(5 : i32) : i32 loc(#loc72)
    %a_ptrs_375 = llvm.xor %a_ptrs_363, %a_ptrs_374 : i32 loc(#loc72)
    %a_ptrs_376 = llvm.mlir.constant(6 : i32) : i32 loc(#loc72)
    %a_ptrs_377 = llvm.xor %a_ptrs_363, %a_ptrs_376 : i32 loc(#loc72)
    %a_ptrs_378 = llvm.mlir.constant(7 : i32) : i32 loc(#loc72)
    %a_ptrs_379 = llvm.xor %a_ptrs_363, %a_ptrs_378 : i32 loc(#loc72)
    %a_ptrs_380 = llvm.add %a_ptrs_365, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_381 = llvm.add %a_ptrs_367, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_382 = llvm.add %a_ptrs_369, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_383 = llvm.add %a_ptrs_371, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_384 = llvm.add %a_ptrs_373, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_385 = llvm.add %a_ptrs_375, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_386 = llvm.add %a_ptrs_377, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_387 = llvm.add %a_ptrs_379, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_388 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc72)
    %a_ptrs_389 = llvm.insertvalue %a_ptrs_380, %a_ptrs_388[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_390 = llvm.insertvalue %a_ptrs_381, %a_ptrs_389[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_391 = llvm.insertvalue %a_ptrs_382, %a_ptrs_390[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_392 = llvm.insertvalue %a_ptrs_383, %a_ptrs_391[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_393 = llvm.insertvalue %a_ptrs_384, %a_ptrs_392[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_394 = llvm.insertvalue %a_ptrs_385, %a_ptrs_393[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_395 = llvm.insertvalue %a_ptrs_386, %a_ptrs_394[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_396 = llvm.insertvalue %a_ptrs_387, %a_ptrs_395[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_397 = llvm.extractvalue %a_ptrs_396[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_398 = llvm.extractvalue %a_ptrs_396[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_399 = llvm.extractvalue %a_ptrs_396[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_400 = llvm.extractvalue %a_ptrs_396[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_401 = llvm.extractvalue %a_ptrs_396[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_402 = llvm.extractvalue %a_ptrs_396[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_403 = llvm.extractvalue %a_ptrs_396[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_404 = llvm.extractvalue %a_ptrs_396[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_405 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc72)
    %a_ptrs_406 = llvm.insertvalue %a_ptrs_397, %a_ptrs_405[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_407 = llvm.insertvalue %a_ptrs_398, %a_ptrs_406[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_408 = llvm.insertvalue %a_ptrs_399, %a_ptrs_407[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_409 = llvm.insertvalue %a_ptrs_400, %a_ptrs_408[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_410 = llvm.insertvalue %a_ptrs_401, %a_ptrs_409[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_411 = llvm.insertvalue %a_ptrs_402, %a_ptrs_410[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_412 = llvm.insertvalue %a_ptrs_403, %a_ptrs_411[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_413 = llvm.insertvalue %a_ptrs_404, %a_ptrs_412[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_414 = llvm.extractvalue %offs_am_184[0] : !llvm.struct<(i32)>  loc(#loc95)
    %a_ptrs_415 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_416 = llvm.insertvalue %a_ptrs_414, %a_ptrs_415[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_417 = llvm.insertvalue %a_ptrs_414, %a_ptrs_416[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_418 = llvm.insertvalue %a_ptrs_414, %a_ptrs_417[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_419 = llvm.insertvalue %a_ptrs_414, %a_ptrs_418[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_420 = llvm.insertvalue %a_ptrs_414, %a_ptrs_419[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_421 = llvm.insertvalue %a_ptrs_414, %a_ptrs_420[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_422 = llvm.insertvalue %a_ptrs_414, %a_ptrs_421[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_423 = llvm.insertvalue %a_ptrs_414, %a_ptrs_422[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_424 = llvm.bitcast %stride_am : i32 to i32 loc(#loc95)
    %a_ptrs_425 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_426 = llvm.insertvalue %a_ptrs_424, %a_ptrs_425[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_427 = llvm.insertvalue %a_ptrs_424, %a_ptrs_426[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_428 = llvm.insertvalue %a_ptrs_424, %a_ptrs_427[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_429 = llvm.insertvalue %a_ptrs_424, %a_ptrs_428[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_430 = llvm.insertvalue %a_ptrs_424, %a_ptrs_429[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_431 = llvm.insertvalue %a_ptrs_424, %a_ptrs_430[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_432 = llvm.insertvalue %a_ptrs_424, %a_ptrs_431[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_433 = llvm.insertvalue %a_ptrs_424, %a_ptrs_432[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_434 = llvm.extractvalue %a_ptrs_423[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_435 = llvm.extractvalue %a_ptrs_423[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_436 = llvm.extractvalue %a_ptrs_423[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_437 = llvm.extractvalue %a_ptrs_423[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_438 = llvm.extractvalue %a_ptrs_423[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_439 = llvm.extractvalue %a_ptrs_423[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_440 = llvm.extractvalue %a_ptrs_423[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_441 = llvm.extractvalue %a_ptrs_423[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_442 = llvm.extractvalue %a_ptrs_433[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_443 = llvm.extractvalue %a_ptrs_433[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_444 = llvm.extractvalue %a_ptrs_433[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_445 = llvm.extractvalue %a_ptrs_433[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_446 = llvm.extractvalue %a_ptrs_433[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_447 = llvm.extractvalue %a_ptrs_433[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_448 = llvm.extractvalue %a_ptrs_433[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_449 = llvm.extractvalue %a_ptrs_433[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_450 = llvm.mul %a_ptrs_434, %a_ptrs_442 : i32 loc(#loc95)
    %a_ptrs_451 = llvm.mul %a_ptrs_435, %a_ptrs_443 : i32 loc(#loc95)
    %a_ptrs_452 = llvm.mul %a_ptrs_436, %a_ptrs_444 : i32 loc(#loc95)
    %a_ptrs_453 = llvm.mul %a_ptrs_437, %a_ptrs_445 : i32 loc(#loc95)
    %a_ptrs_454 = llvm.mul %a_ptrs_438, %a_ptrs_446 : i32 loc(#loc95)
    %a_ptrs_455 = llvm.mul %a_ptrs_439, %a_ptrs_447 : i32 loc(#loc95)
    %a_ptrs_456 = llvm.mul %a_ptrs_440, %a_ptrs_448 : i32 loc(#loc95)
    %a_ptrs_457 = llvm.mul %a_ptrs_441, %a_ptrs_449 : i32 loc(#loc95)
    %a_ptrs_458 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_459 = llvm.insertvalue %a_ptrs_450, %a_ptrs_458[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_460 = llvm.insertvalue %a_ptrs_451, %a_ptrs_459[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_461 = llvm.insertvalue %a_ptrs_452, %a_ptrs_460[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_462 = llvm.insertvalue %a_ptrs_453, %a_ptrs_461[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_463 = llvm.insertvalue %a_ptrs_454, %a_ptrs_462[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_464 = llvm.insertvalue %a_ptrs_455, %a_ptrs_463[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_465 = llvm.insertvalue %a_ptrs_456, %a_ptrs_464[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_466 = llvm.insertvalue %a_ptrs_457, %a_ptrs_465[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_467 = llvm.extractvalue %a_ptrs_466[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_468 = llvm.extractvalue %a_ptrs_466[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_469 = llvm.extractvalue %a_ptrs_466[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_470 = llvm.extractvalue %a_ptrs_466[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_471 = llvm.extractvalue %a_ptrs_466[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_472 = llvm.extractvalue %a_ptrs_466[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_473 = llvm.extractvalue %a_ptrs_466[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_474 = llvm.extractvalue %a_ptrs_466[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_475 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_476 = llvm.insertvalue %a_ptrs_474, %a_ptrs_475[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_477 = llvm.insertvalue %a_ptrs_474, %a_ptrs_476[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_478 = llvm.insertvalue %a_ptrs_474, %a_ptrs_477[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_479 = llvm.insertvalue %a_ptrs_474, %a_ptrs_478[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_480 = llvm.insertvalue %a_ptrs_474, %a_ptrs_479[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_481 = llvm.insertvalue %a_ptrs_474, %a_ptrs_480[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_482 = llvm.insertvalue %a_ptrs_474, %a_ptrs_481[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_483 = llvm.insertvalue %a_ptrs_474, %a_ptrs_482[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_484 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_485 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_486 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_487 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_488 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_489 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_490 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_491 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_492 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_493 = llvm.insertvalue %a_ptrs_484, %a_ptrs_492[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_494 = llvm.insertvalue %a_ptrs_485, %a_ptrs_493[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_495 = llvm.insertvalue %a_ptrs_486, %a_ptrs_494[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_496 = llvm.insertvalue %a_ptrs_487, %a_ptrs_495[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_497 = llvm.insertvalue %a_ptrs_488, %a_ptrs_496[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_498 = llvm.insertvalue %a_ptrs_489, %a_ptrs_497[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_499 = llvm.insertvalue %a_ptrs_490, %a_ptrs_498[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_500 = llvm.insertvalue %a_ptrs_491, %a_ptrs_499[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_501 = llvm.extractvalue %a_ptrs_483[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_502 = llvm.extractvalue %a_ptrs_483[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_503 = llvm.extractvalue %a_ptrs_483[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_504 = llvm.extractvalue %a_ptrs_483[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_505 = llvm.extractvalue %a_ptrs_483[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_506 = llvm.extractvalue %a_ptrs_483[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_507 = llvm.extractvalue %a_ptrs_483[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_508 = llvm.extractvalue %a_ptrs_483[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_509 = llvm.extractvalue %a_ptrs_500[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_510 = llvm.extractvalue %a_ptrs_500[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_511 = llvm.extractvalue %a_ptrs_500[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_512 = llvm.extractvalue %a_ptrs_500[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_513 = llvm.extractvalue %a_ptrs_500[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_514 = llvm.extractvalue %a_ptrs_500[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_515 = llvm.extractvalue %a_ptrs_500[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_516 = llvm.extractvalue %a_ptrs_500[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_517 = llvm.add %a_ptrs_501, %a_ptrs_509 : i32 loc(#loc95)
    %a_ptrs_518 = llvm.add %a_ptrs_502, %a_ptrs_510 : i32 loc(#loc95)
    %a_ptrs_519 = llvm.add %a_ptrs_503, %a_ptrs_511 : i32 loc(#loc95)
    %a_ptrs_520 = llvm.add %a_ptrs_504, %a_ptrs_512 : i32 loc(#loc95)
    %a_ptrs_521 = llvm.add %a_ptrs_505, %a_ptrs_513 : i32 loc(#loc95)
    %a_ptrs_522 = llvm.add %a_ptrs_506, %a_ptrs_514 : i32 loc(#loc95)
    %a_ptrs_523 = llvm.add %a_ptrs_507, %a_ptrs_515 : i32 loc(#loc95)
    %a_ptrs_524 = llvm.add %a_ptrs_508, %a_ptrs_516 : i32 loc(#loc95)
    %a_ptrs_525 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_526 = llvm.insertvalue %a_ptrs_517, %a_ptrs_525[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_527 = llvm.insertvalue %a_ptrs_518, %a_ptrs_526[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_528 = llvm.insertvalue %a_ptrs_519, %a_ptrs_527[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_529 = llvm.insertvalue %a_ptrs_520, %a_ptrs_528[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_530 = llvm.insertvalue %a_ptrs_521, %a_ptrs_529[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_531 = llvm.insertvalue %a_ptrs_522, %a_ptrs_530[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_532 = llvm.insertvalue %a_ptrs_523, %a_ptrs_531[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_533 = llvm.insertvalue %a_ptrs_524, %a_ptrs_532[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_534 = builtin.unrealized_conversion_cast %a_ptrs_533 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc95)
    %accumulator_535 = builtin.unrealized_conversion_cast %a_ptrs_534 : tensor<64x64xi32, #blocked> to !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc122)
    %24 = llvm.add %K, %23 : i32 loc(#loc96)
    %25 = llvm.sdiv %24, %18 : i32 loc(#loc97)
    %accumulator_536 = llvm.icmp "sgt" %25, %20 : i32 loc(#loc122)
    %accumulator_537 = llvm.bitcast %accumulator_536 : i1 to i1 loc(#loc122)
    %accumulator_538 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc122)
    %accumulator_539 = llvm.insertvalue %accumulator_537, %accumulator_538[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_540 = llvm.insertvalue %accumulator_537, %accumulator_539[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_541 = llvm.insertvalue %accumulator_537, %accumulator_540[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_542 = llvm.insertvalue %accumulator_537, %accumulator_541[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_543 = llvm.insertvalue %accumulator_537, %accumulator_542[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_544 = llvm.insertvalue %accumulator_537, %accumulator_543[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_545 = llvm.insertvalue %accumulator_537, %accumulator_544[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_546 = llvm.insertvalue %accumulator_537, %accumulator_545[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %a_547 = llvm.bitcast %K : i32 to i32 loc(#loc98)
    %a_548 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc98)
    %a_549 = llvm.insertvalue %a_547, %a_548[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_550 = llvm.insertvalue %a_547, %a_549[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_551 = llvm.insertvalue %a_547, %a_550[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_552 = llvm.insertvalue %a_547, %a_551[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_553 = llvm.insertvalue %a_547, %a_552[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_554 = llvm.insertvalue %a_547, %a_553[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_555 = llvm.insertvalue %a_547, %a_554[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_556 = llvm.insertvalue %a_547, %a_555[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_557 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_558 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_559 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_560 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_561 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_562 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_563 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_564 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_565 = llvm.extractvalue %a_556[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_566 = llvm.extractvalue %a_556[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_567 = llvm.extractvalue %a_556[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_568 = llvm.extractvalue %a_556[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_569 = llvm.extractvalue %a_556[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_570 = llvm.extractvalue %a_556[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_571 = llvm.extractvalue %a_556[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_572 = llvm.extractvalue %a_556[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_573 = llvm.icmp "slt" %a_557, %a_565 : i32 loc(#loc98)
    %a_574 = llvm.icmp "slt" %a_558, %a_566 : i32 loc(#loc98)
    %a_575 = llvm.icmp "slt" %a_559, %a_567 : i32 loc(#loc98)
    %a_576 = llvm.icmp "slt" %a_560, %a_568 : i32 loc(#loc98)
    %a_577 = llvm.icmp "slt" %a_561, %a_569 : i32 loc(#loc98)
    %a_578 = llvm.icmp "slt" %a_562, %a_570 : i32 loc(#loc98)
    %a_579 = llvm.icmp "slt" %a_563, %a_571 : i32 loc(#loc98)
    %a_580 = llvm.icmp "slt" %a_564, %a_572 : i32 loc(#loc98)
    %a_581 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc98)
    %a_582 = llvm.insertvalue %a_573, %a_581[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_583 = llvm.insertvalue %a_573, %a_582[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_584 = llvm.insertvalue %a_573, %a_583[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_585 = llvm.insertvalue %a_573, %a_584[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_586 = llvm.insertvalue %a_573, %a_585[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_587 = llvm.insertvalue %a_573, %a_586[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_588 = llvm.insertvalue %a_573, %a_587[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_589 = llvm.insertvalue %a_573, %a_588[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_590 = llvm.extractvalue %a_589[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_591 = llvm.extractvalue %a_589[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_592 = llvm.extractvalue %a_589[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_593 = llvm.extractvalue %a_589[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_594 = llvm.extractvalue %a_589[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_595 = llvm.extractvalue %a_589[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_596 = llvm.extractvalue %a_589[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_597 = llvm.extractvalue %a_589[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_598 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc70)
    %a_599 = llvm.insertvalue %a_590, %a_598[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_600 = llvm.insertvalue %a_591, %a_599[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_601 = llvm.insertvalue %a_592, %a_600[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_602 = llvm.insertvalue %a_593, %a_601[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_603 = llvm.insertvalue %a_594, %a_602[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_604 = llvm.insertvalue %a_595, %a_603[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_605 = llvm.insertvalue %a_596, %a_604[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_606 = llvm.insertvalue %a_597, %a_605[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %accumulator_607 = llvm.extractvalue %accumulator_546[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_608 = llvm.extractvalue %accumulator_546[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_609 = llvm.extractvalue %accumulator_546[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_610 = llvm.extractvalue %accumulator_546[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_611 = llvm.extractvalue %accumulator_546[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_612 = llvm.extractvalue %accumulator_546[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_613 = llvm.extractvalue %accumulator_546[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_614 = llvm.extractvalue %accumulator_546[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_615 = llvm.extractvalue %a_606[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_616 = llvm.extractvalue %a_606[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_617 = llvm.extractvalue %a_606[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_618 = llvm.extractvalue %a_606[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_619 = llvm.extractvalue %a_606[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_620 = llvm.extractvalue %a_606[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_621 = llvm.extractvalue %a_606[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_622 = llvm.extractvalue %a_606[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_623 = llvm.and %accumulator_607, %accumulator_615 : i1 loc(#loc122)
    %accumulator_624 = llvm.and %accumulator_608, %accumulator_616 : i1 loc(#loc122)
    %accumulator_625 = llvm.and %accumulator_609, %accumulator_617 : i1 loc(#loc122)
    %accumulator_626 = llvm.and %accumulator_610, %accumulator_618 : i1 loc(#loc122)
    %accumulator_627 = llvm.and %accumulator_611, %accumulator_619 : i1 loc(#loc122)
    %accumulator_628 = llvm.and %accumulator_612, %accumulator_620 : i1 loc(#loc122)
    %accumulator_629 = llvm.and %accumulator_613, %accumulator_621 : i1 loc(#loc122)
    %accumulator_630 = llvm.and %accumulator_614, %accumulator_622 : i1 loc(#loc122)
    %accumulator_631 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc122)
    %accumulator_632 = llvm.insertvalue %accumulator_623, %accumulator_631[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_633 = llvm.insertvalue %accumulator_623, %accumulator_632[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_634 = llvm.insertvalue %accumulator_623, %accumulator_633[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_635 = llvm.insertvalue %accumulator_623, %accumulator_634[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_636 = llvm.insertvalue %accumulator_623, %accumulator_635[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_637 = llvm.insertvalue %accumulator_623, %accumulator_636[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_638 = llvm.insertvalue %accumulator_623, %accumulator_637[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_639 = llvm.insertvalue %accumulator_623, %accumulator_638[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %a_640 = llvm.extractvalue %a_ptrs_533[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_641 = llvm.extractvalue %a_ptrs_533[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_642 = llvm.extractvalue %a_ptrs_533[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_643 = llvm.extractvalue %a_ptrs_533[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_644 = llvm.extractvalue %a_ptrs_533[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_645 = llvm.extractvalue %a_ptrs_533[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_646 = llvm.extractvalue %a_ptrs_533[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_647 = llvm.extractvalue %a_ptrs_533[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_648 = llvm.extractvalue %accumulator_639[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_649 = llvm.extractvalue %accumulator_639[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_650 = llvm.extractvalue %accumulator_639[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_651 = llvm.extractvalue %accumulator_639[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_652 = llvm.extractvalue %accumulator_639[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_653 = llvm.extractvalue %accumulator_639[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_654 = llvm.extractvalue %accumulator_639[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_655 = llvm.extractvalue %accumulator_639[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_656 = llvm.mlir.constant(0 : i16) : i16 loc(#loc70)
    %a_657 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc70)
    %a_658 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc70)
    %a_659 = rocdl.make.buffer.rsrc %a_ptr, %a_656, %a_658, %a_657 : <1> to <8> loc(#loc70)
    %a_660 = llvm.mlir.constant(dense<0.000000e+00> : vector<8xf16>) : vector<8xf16> loc(#loc70)
    %a_661 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc70)
    %a_662 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_663 = llvm.mul %a_662, %a_640 : i32 loc(#loc70)
    %a_664 = llvm.select %a_648, %a_663, %a_661 : i1, i32 loc(#loc70)
    %a_665 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_666 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_667 = rocdl.raw.ptr.buffer.load %a_659, %a_664, %a_665, %a_666 : vector<4xi32> loc(#loc70)
    %a_668 = llvm.bitcast %a_667 : vector<4xi32> to vector<8xf16> loc(#loc70)
    %a_669 = llvm.mlir.constant(0 : index) : i32 loc(#loc70)
    %a_670 = llvm.extractelement %a_668[%a_669 : i32] : vector<8xf16> loc(#loc70)
    %a_671 = llvm.mlir.constant(1 : index) : i32 loc(#loc70)
    %a_672 = llvm.extractelement %a_668[%a_671 : i32] : vector<8xf16> loc(#loc70)
    %a_673 = llvm.mlir.constant(2 : index) : i32 loc(#loc70)
    %a_674 = llvm.extractelement %a_668[%a_673 : i32] : vector<8xf16> loc(#loc70)
    %a_675 = llvm.mlir.constant(3 : index) : i32 loc(#loc70)
    %a_676 = llvm.extractelement %a_668[%a_675 : i32] : vector<8xf16> loc(#loc70)
    %a_677 = llvm.mlir.constant(4 : index) : i32 loc(#loc70)
    %a_678 = llvm.extractelement %a_668[%a_677 : i32] : vector<8xf16> loc(#loc70)
    %a_679 = llvm.mlir.constant(5 : index) : i32 loc(#loc70)
    %a_680 = llvm.extractelement %a_668[%a_679 : i32] : vector<8xf16> loc(#loc70)
    %a_681 = llvm.mlir.constant(6 : index) : i32 loc(#loc70)
    %a_682 = llvm.extractelement %a_668[%a_681 : i32] : vector<8xf16> loc(#loc70)
    %a_683 = llvm.mlir.constant(7 : index) : i32 loc(#loc70)
    %a_684 = llvm.extractelement %a_668[%a_683 : i32] : vector<8xf16> loc(#loc70)
    %a_685 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_686 = llvm.insertvalue %a_670, %a_685[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_687 = llvm.insertvalue %a_672, %a_686[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_688 = llvm.insertvalue %a_674, %a_687[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_689 = llvm.insertvalue %a_676, %a_688[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_690 = llvm.insertvalue %a_678, %a_689[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_691 = llvm.insertvalue %a_680, %a_690[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_692 = llvm.insertvalue %a_682, %a_691[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_693 = llvm.insertvalue %a_684, %a_692[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_ptrs_694 = llvm.mlir.constant(0 : index) : i32 loc(#loc71)
    %b_ptrs_695 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_ptrs_696 = llvm.mlir.constant(511 : i32) : i32 loc(#loc71)
    %b_ptrs_697 = llvm.and %b_ptrs_695, %b_ptrs_696 : i32 loc(#loc71)
    %b_ptrs_698 = llvm.mlir.constant(64 : i32) : i32 loc(#loc71)
    %b_ptrs_699 = llvm.urem %b_ptrs_697, %b_ptrs_698 : i32 loc(#loc71)
    %b_ptrs_700 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_701 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_702 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_703 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_704 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_705 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_706 = llvm.shl %b_ptrs_699, %b_ptrs_705 : i32 loc(#loc71)
    %b_ptrs_707 = llvm.or %b_ptrs_704, %b_ptrs_706 : i32 loc(#loc71)
    %b_ptrs_708 = llvm.mlir.constant(6 : i32) : i32 loc(#loc71)
    %b_ptrs_709 = llvm.shl %b_ptrs_50, %b_ptrs_708 : i32 loc(#loc71)
    %b_ptrs_710 = llvm.or %b_ptrs_707, %b_ptrs_709 : i32 loc(#loc71)
    %b_ptrs_711 = llvm.mlir.constant(504 : i32) : i32 loc(#loc71)
    %b_ptrs_712 = llvm.and %b_ptrs_710, %b_ptrs_711 : i32 loc(#loc71)
    %b_ptrs_713 = llvm.mlir.constant(3 : i32) : i32 loc(#loc71)
    %b_ptrs_714 = llvm.lshr %b_ptrs_712, %b_ptrs_713 : i32 loc(#loc71)
    %b_ptrs_715 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_716 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_717 = llvm.or disjoint %b_ptrs_714, %b_ptrs_716 : i32 loc(#loc71)
    %b_ptrs_718 = llvm.xor %b_ptrs_703, %b_ptrs_717 : i32 loc(#loc71)
    %b_ptrs_719 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_720 = llvm.xor %b_ptrs_718, %b_ptrs_719 : i32 loc(#loc71)
    %b_ptrs_721 = llvm.add %b_ptrs_720, %b_ptrs_694 : i32 loc(#loc71)
    %b_ptrs_722 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc71)
    %b_ptrs_723 = llvm.insertvalue %b_ptrs_721, %b_ptrs_722[0] : !llvm.struct<(i32)>  loc(#loc71)
    %b_ptrs_724 = llvm.extractvalue %b_ptrs_723[0] : !llvm.struct<(i32)>  loc(#loc71)
    %b_ptrs_725 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc71)
    %b_ptrs_726 = llvm.insertvalue %b_ptrs_724, %b_ptrs_725[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_727 = llvm.insertvalue %b_ptrs_724, %b_ptrs_726[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_728 = llvm.insertvalue %b_ptrs_724, %b_ptrs_727[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_729 = llvm.insertvalue %b_ptrs_724, %b_ptrs_728[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_730 = llvm.bitcast %stride_bk : i32 to i32 loc(#loc99)
    %b_ptrs_731 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_732 = llvm.insertvalue %b_ptrs_730, %b_ptrs_731[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_733 = llvm.insertvalue %b_ptrs_730, %b_ptrs_732[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_734 = llvm.insertvalue %b_ptrs_730, %b_ptrs_733[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_735 = llvm.insertvalue %b_ptrs_730, %b_ptrs_734[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_736 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_737 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_738 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_739 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_740 = llvm.extractvalue %b_ptrs_735[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_741 = llvm.extractvalue %b_ptrs_735[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_742 = llvm.extractvalue %b_ptrs_735[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_743 = llvm.extractvalue %b_ptrs_735[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_744 = llvm.mul %b_ptrs_736, %b_ptrs_740 : i32 loc(#loc99)
    %b_ptrs_745 = llvm.mul %b_ptrs_737, %b_ptrs_741 : i32 loc(#loc99)
    %b_ptrs_746 = llvm.mul %b_ptrs_738, %b_ptrs_742 : i32 loc(#loc99)
    %b_ptrs_747 = llvm.mul %b_ptrs_739, %b_ptrs_743 : i32 loc(#loc99)
    %b_ptrs_748 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_749 = llvm.insertvalue %b_ptrs_744, %b_ptrs_748[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_750 = llvm.insertvalue %b_ptrs_745, %b_ptrs_749[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_751 = llvm.insertvalue %b_ptrs_746, %b_ptrs_750[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_752 = llvm.insertvalue %b_ptrs_747, %b_ptrs_751[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_753 = llvm.extractvalue %b_ptrs_752[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_754 = llvm.extractvalue %b_ptrs_752[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_755 = llvm.extractvalue %b_ptrs_752[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_756 = llvm.extractvalue %b_ptrs_752[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_757 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_758 = llvm.insertvalue %b_ptrs_756, %b_ptrs_757[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_759 = llvm.insertvalue %b_ptrs_756, %b_ptrs_758[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_760 = llvm.insertvalue %b_ptrs_756, %b_ptrs_759[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_761 = llvm.insertvalue %b_ptrs_756, %b_ptrs_760[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_762 = llvm.extractvalue %offs_bn_338[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_763 = llvm.extractvalue %offs_bn_338[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_764 = llvm.extractvalue %offs_bn_338[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_765 = llvm.extractvalue %offs_bn_338[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_766 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_767 = llvm.insertvalue %b_ptrs_762, %b_ptrs_766[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_768 = llvm.insertvalue %b_ptrs_763, %b_ptrs_767[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_769 = llvm.insertvalue %b_ptrs_764, %b_ptrs_768[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_770 = llvm.insertvalue %b_ptrs_765, %b_ptrs_769[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_771 = llvm.extractvalue %b_ptrs_770[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_772 = llvm.extractvalue %b_ptrs_770[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_773 = llvm.extractvalue %b_ptrs_770[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_774 = llvm.extractvalue %b_ptrs_770[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_775 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_776 = llvm.insertvalue %b_ptrs_771, %b_ptrs_775[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_777 = llvm.insertvalue %b_ptrs_772, %b_ptrs_776[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_778 = llvm.insertvalue %b_ptrs_773, %b_ptrs_777[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_779 = llvm.insertvalue %b_ptrs_774, %b_ptrs_778[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_780 = llvm.extractvalue %b_ptrs_761[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_781 = llvm.extractvalue %b_ptrs_761[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_782 = llvm.extractvalue %b_ptrs_761[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_783 = llvm.extractvalue %b_ptrs_761[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_784 = llvm.extractvalue %b_ptrs_779[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_785 = llvm.extractvalue %b_ptrs_779[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_786 = llvm.extractvalue %b_ptrs_779[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_787 = llvm.extractvalue %b_ptrs_779[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_788 = llvm.add %b_ptrs_780, %b_ptrs_784 : i32 loc(#loc99)
    %b_ptrs_789 = llvm.add %b_ptrs_781, %b_ptrs_785 : i32 loc(#loc99)
    %b_ptrs_790 = llvm.add %b_ptrs_782, %b_ptrs_786 : i32 loc(#loc99)
    %b_ptrs_791 = llvm.add %b_ptrs_783, %b_ptrs_787 : i32 loc(#loc99)
    %b_ptrs_792 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_793 = llvm.insertvalue %b_ptrs_788, %b_ptrs_792[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_794 = llvm.insertvalue %b_ptrs_789, %b_ptrs_793[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_795 = llvm.insertvalue %b_ptrs_790, %b_ptrs_794[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_796 = llvm.insertvalue %b_ptrs_791, %b_ptrs_795[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_797 = builtin.unrealized_conversion_cast %b_ptrs_796 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc99)
    %accumulator_798 = builtin.unrealized_conversion_cast %b_ptrs_797 : tensor<64x32xi32, #blocked1> to !llvm.struct<(i32, i32, i32, i32)> loc(#loc122)
    %accumulator_799 = llvm.bitcast %accumulator_536 : i1 to i1 loc(#loc122)
    %accumulator_800 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc122)
    %accumulator_801 = llvm.insertvalue %accumulator_799, %accumulator_800[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_802 = llvm.insertvalue %accumulator_799, %accumulator_801[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_803 = llvm.insertvalue %accumulator_799, %accumulator_802[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_804 = llvm.insertvalue %accumulator_799, %accumulator_803[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %b_805 = llvm.bitcast %K : i32 to i32 loc(#loc100)
    %b_806 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc100)
    %b_807 = llvm.insertvalue %b_805, %b_806[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_808 = llvm.insertvalue %b_805, %b_807[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_809 = llvm.insertvalue %b_805, %b_808[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_810 = llvm.insertvalue %b_805, %b_809[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_811 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_812 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_813 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_814 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_815 = llvm.extractvalue %b_810[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_816 = llvm.extractvalue %b_810[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_817 = llvm.extractvalue %b_810[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_818 = llvm.extractvalue %b_810[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_819 = llvm.icmp "slt" %b_811, %b_815 : i32 loc(#loc100)
    %b_820 = llvm.icmp "slt" %b_812, %b_816 : i32 loc(#loc100)
    %b_821 = llvm.icmp "slt" %b_813, %b_817 : i32 loc(#loc100)
    %b_822 = llvm.icmp "slt" %b_814, %b_818 : i32 loc(#loc100)
    %b_823 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc100)
    %b_824 = llvm.insertvalue %b_819, %b_823[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_825 = llvm.insertvalue %b_819, %b_824[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_826 = llvm.insertvalue %b_819, %b_825[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_827 = llvm.insertvalue %b_819, %b_826[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_828 = llvm.extractvalue %b_827[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_829 = llvm.extractvalue %b_827[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_830 = llvm.extractvalue %b_827[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_831 = llvm.extractvalue %b_827[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_832 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc69)
    %b_833 = llvm.insertvalue %b_831, %b_832[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_834 = llvm.insertvalue %b_831, %b_833[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_835 = llvm.insertvalue %b_831, %b_834[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_836 = llvm.insertvalue %b_831, %b_835[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %accumulator_837 = llvm.extractvalue %accumulator_804[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_838 = llvm.extractvalue %accumulator_804[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_839 = llvm.extractvalue %accumulator_804[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_840 = llvm.extractvalue %accumulator_804[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_841 = llvm.extractvalue %b_836[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_842 = llvm.extractvalue %b_836[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_843 = llvm.extractvalue %b_836[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_844 = llvm.extractvalue %b_836[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_845 = llvm.and %accumulator_837, %accumulator_841 : i1 loc(#loc122)
    %accumulator_846 = llvm.and %accumulator_838, %accumulator_842 : i1 loc(#loc122)
    %accumulator_847 = llvm.and %accumulator_839, %accumulator_843 : i1 loc(#loc122)
    %accumulator_848 = llvm.and %accumulator_840, %accumulator_844 : i1 loc(#loc122)
    %accumulator_849 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc122)
    %accumulator_850 = llvm.insertvalue %accumulator_845, %accumulator_849[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_851 = llvm.insertvalue %accumulator_845, %accumulator_850[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_852 = llvm.insertvalue %accumulator_845, %accumulator_851[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_853 = llvm.insertvalue %accumulator_845, %accumulator_852[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %b_854 = llvm.extractvalue %b_ptrs_796[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_855 = llvm.extractvalue %b_ptrs_796[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_856 = llvm.extractvalue %b_ptrs_796[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_857 = llvm.extractvalue %b_ptrs_796[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_858 = llvm.extractvalue %accumulator_853[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_859 = llvm.extractvalue %accumulator_853[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_860 = llvm.extractvalue %accumulator_853[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_861 = llvm.extractvalue %accumulator_853[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_862 = llvm.mlir.constant(0 : i16) : i16 loc(#loc69)
    %b_863 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc69)
    %b_864 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc69)
    %b_865 = rocdl.make.buffer.rsrc %b_ptr, %b_862, %b_864, %b_863 : <1> to <8> loc(#loc69)
    %b_866 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc69)
    %b_867 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc69)
    %b_868 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_869 = llvm.mul %b_868, %b_854 : i32 loc(#loc69)
    %b_870 = llvm.select %b_858, %b_869, %b_867 : i1, i32 loc(#loc69)
    %b_871 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_872 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_873 = rocdl.raw.ptr.buffer.load %b_865, %b_870, %b_871, %b_872 : vector<2xi32> loc(#loc69)
    %b_874 = llvm.bitcast %b_873 : vector<2xi32> to vector<4xf16> loc(#loc69)
    %b_875 = llvm.mlir.constant(0 : index) : i32 loc(#loc69)
    %b_876 = llvm.extractelement %b_874[%b_875 : i32] : vector<4xf16> loc(#loc69)
    %b_877 = llvm.mlir.constant(1 : index) : i32 loc(#loc69)
    %b_878 = llvm.extractelement %b_874[%b_877 : i32] : vector<4xf16> loc(#loc69)
    %b_879 = llvm.mlir.constant(2 : index) : i32 loc(#loc69)
    %b_880 = llvm.extractelement %b_874[%b_879 : i32] : vector<4xf16> loc(#loc69)
    %b_881 = llvm.mlir.constant(3 : index) : i32 loc(#loc69)
    %b_882 = llvm.extractelement %b_874[%b_881 : i32] : vector<4xf16> loc(#loc69)
    %b_883 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc69)
    %b_884 = llvm.insertvalue %b_876, %b_883[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_885 = llvm.insertvalue %b_878, %b_884[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_886 = llvm.insertvalue %b_880, %b_885[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_887 = llvm.insertvalue %b_882, %b_886[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_ptrs_888 = llvm.mul %stride_bk, %18 : i32 loc(#loc101)
    %b_ptrs_889 = llvm.bitcast %b_ptrs_888 : i32 to i32 loc(#loc102)
    %b_ptrs_890 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc102)
    %b_ptrs_891 = llvm.insertvalue %b_ptrs_889, %b_ptrs_890[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_892 = llvm.insertvalue %b_ptrs_889, %b_ptrs_891[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_893 = llvm.insertvalue %b_ptrs_889, %b_ptrs_892[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_894 = llvm.insertvalue %b_ptrs_889, %b_ptrs_893[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %a_895 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %26 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc)
    %a_896 = llvm.getelementptr %26[%a_895] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_897 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_898 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32, i32)> loc(#loc70)
    %a_899 = llvm.insertvalue %a_896, %a_898[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_900 = llvm.insertvalue %a_897, %a_899[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_901 = llvm.insertvalue %a_897, %a_900[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_902 = llvm.insertvalue %a_897, %a_901[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %b_903 = llvm.mlir.constant(8192 : i32) : i32 loc(#loc69)
    %27 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc)
    %b_904 = llvm.getelementptr %27[%b_903] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_905 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_906 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32, i32)> loc(#loc69)
    %b_907 = llvm.insertvalue %b_904, %b_906[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_908 = llvm.insertvalue %b_905, %b_907[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_909 = llvm.insertvalue %b_905, %b_908[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_910 = llvm.insertvalue %b_905, %b_909[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %a_911 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc70)
    %a_912 = llvm.mul %20, %a_911 : i32 loc(#loc70)
    %a_913 = llvm.extractvalue %a_902[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_914 = llvm.extractvalue %a_902[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_915 = llvm.extractvalue %a_902[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_916 = llvm.extractvalue %a_902[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_917 = llvm.getelementptr %a_913[%a_912] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc70)
    %a_918 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc70)
    %a_919 = llvm.insertvalue %a_917, %a_918[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_920 = llvm.insertvalue %a_915, %a_919[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_921 = llvm.insertvalue %a_916, %a_920[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_922 = builtin.unrealized_conversion_cast %a_921 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %accumulator_923 = builtin.unrealized_conversion_cast %a_922 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %a_924 = llvm.extractvalue %a_921[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_925 = llvm.extractvalue %a_921[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_926 = llvm.extractvalue %a_921[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_927 = llvm.extractvalue %a_693[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_928 = llvm.extractvalue %a_693[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_929 = llvm.extractvalue %a_693[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_930 = llvm.extractvalue %a_693[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_931 = llvm.extractvalue %a_693[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_932 = llvm.extractvalue %a_693[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_933 = llvm.extractvalue %a_693[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_934 = llvm.extractvalue %a_693[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_935 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_936 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_937 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_938 = llvm.and %a_936, %a_937 : i32 loc(#loc70)
    %a_939 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_940 = llvm.urem %a_938, %a_939 : i32 loc(#loc70)
    %a_941 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_942 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_943 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_944 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_945 = llvm.shl %a_940, %a_944 : i32 loc(#loc70)
    %a_946 = llvm.or %a_943, %a_945 : i32 loc(#loc70)
    %a_947 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_948 = llvm.shl %a_45, %a_947 : i32 loc(#loc70)
    %a_949 = llvm.or %a_946, %a_948 : i32 loc(#loc70)
    %a_950 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_951 = llvm.and %a_949, %a_950 : i32 loc(#loc70)
    %a_952 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_953 = llvm.shl %a_951, %a_952 : i32 loc(#loc70)
    %a_954 = llvm.mlir.constant(120 : i32) : i32 loc(#loc70)
    %a_955 = llvm.and %a_949, %a_954 : i32 loc(#loc70)
    %a_956 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_957 = llvm.lshr %a_955, %a_956 : i32 loc(#loc70)
    %a_958 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_959 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_960 = llvm.xor %a_953, %a_957 : i32 loc(#loc70)
    %a_961 = llvm.or disjoint %a_959, %a_960 : i32 loc(#loc70)
    %a_962 = llvm.xor %a_942, %a_961 : i32 loc(#loc70)
    %a_963 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_964 = llvm.mul %a_935, %a_963 : i32 loc(#loc70)
    %a_965 = llvm.xor %a_962, %a_964 : i32 loc(#loc70)
    %a_966 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_967 = llvm.xor %a_965, %a_966 : i32 loc(#loc70)
    %a_968 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_969 = llvm.add %a_967, %a_968 : i32 loc(#loc70)
    %a_970 = llvm.getelementptr inbounds %a_924[%a_969] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_971 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_972 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_973 = llvm.insertelement %a_927, %a_971[%a_972 : i32] : vector<4xf16> loc(#loc70)
    %a_974 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_975 = llvm.insertelement %a_928, %a_973[%a_974 : i32] : vector<4xf16> loc(#loc70)
    %a_976 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_977 = llvm.insertelement %a_929, %a_975[%a_976 : i32] : vector<4xf16> loc(#loc70)
    %a_978 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_979 = llvm.insertelement %a_930, %a_977[%a_978 : i32] : vector<4xf16> loc(#loc70)
    %a_980 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_979, %a_970 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %a_981 = llvm.mlir.constant(8 : i32) : i32 loc(#loc70)
    %a_982 = llvm.xor %a_965, %a_981 : i32 loc(#loc70)
    %a_983 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_984 = llvm.add %a_982, %a_983 : i32 loc(#loc70)
    %a_985 = llvm.getelementptr inbounds %a_924[%a_984] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_986 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_987 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_988 = llvm.insertelement %a_931, %a_986[%a_987 : i32] : vector<4xf16> loc(#loc70)
    %a_989 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_990 = llvm.insertelement %a_932, %a_988[%a_989 : i32] : vector<4xf16> loc(#loc70)
    %a_991 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_992 = llvm.insertelement %a_933, %a_990[%a_991 : i32] : vector<4xf16> loc(#loc70)
    %a_993 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_994 = llvm.insertelement %a_934, %a_992[%a_993 : i32] : vector<4xf16> loc(#loc70)
    %a_995 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_994, %a_985 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %b_996 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_997 = llvm.mul %20, %b_996 : i32 loc(#loc69)
    %b_998 = llvm.extractvalue %b_910[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_999 = llvm.extractvalue %b_910[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1000 = llvm.extractvalue %b_910[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1001 = llvm.extractvalue %b_910[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1002 = llvm.getelementptr %b_998[%b_997] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc69)
    %b_1003 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc69)
    %b_1004 = llvm.insertvalue %b_1002, %b_1003[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1005 = llvm.insertvalue %b_1000, %b_1004[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1006 = llvm.insertvalue %b_1001, %b_1005[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1007 = builtin.unrealized_conversion_cast %b_1006 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %accumulator_1008 = builtin.unrealized_conversion_cast %b_1007 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %b_1009 = llvm.extractvalue %b_1006[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1010 = llvm.extractvalue %b_1006[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1011 = llvm.extractvalue %b_1006[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1012 = llvm.extractvalue %b_887[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1013 = llvm.extractvalue %b_887[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1014 = llvm.extractvalue %b_887[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1015 = llvm.extractvalue %b_887[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1016 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1017 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1018 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1019 = llvm.and %b_1017, %b_1018 : i32 loc(#loc69)
    %b_1020 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1021 = llvm.urem %b_1019, %b_1020 : i32 loc(#loc69)
    %b_1022 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1023 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1024 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1025 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1026 = llvm.shl %b_1021, %b_1025 : i32 loc(#loc69)
    %b_1027 = llvm.or %b_1024, %b_1026 : i32 loc(#loc69)
    %b_1028 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_1029 = llvm.shl %b_39, %b_1028 : i32 loc(#loc69)
    %b_1030 = llvm.or %b_1027, %b_1029 : i32 loc(#loc69)
    %b_1031 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1032 = llvm.and %b_1030, %b_1031 : i32 loc(#loc69)
    %b_1033 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_1034 = llvm.shl %b_1032, %b_1033 : i32 loc(#loc69)
    %b_1035 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1036 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1037 = llvm.or disjoint %b_1034, %b_1036 : i32 loc(#loc69)
    %b_1038 = llvm.xor %b_1023, %b_1037 : i32 loc(#loc69)
    %b_1039 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1040 = llvm.mul %b_1016, %b_1039 : i32 loc(#loc69)
    %b_1041 = llvm.xor %b_1038, %b_1040 : i32 loc(#loc69)
    %b_1042 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1043 = llvm.xor %b_1041, %b_1042 : i32 loc(#loc69)
    %b_1044 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1045 = llvm.add %b_1043, %b_1044 : i32 loc(#loc69)
    %b_1046 = llvm.getelementptr inbounds %b_1009[%b_1045] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1047 = llvm.mlir.undef : vector<4xf16> loc(#loc69)
    %b_1048 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1049 = llvm.insertelement %b_1012, %b_1047[%b_1048 : i32] : vector<4xf16> loc(#loc69)
    %b_1050 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_1051 = llvm.insertelement %b_1013, %b_1049[%b_1050 : i32] : vector<4xf16> loc(#loc69)
    %b_1052 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1053 = llvm.insertelement %b_1014, %b_1051[%b_1052 : i32] : vector<4xf16> loc(#loc69)
    %b_1054 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_1055 = llvm.insertelement %b_1015, %b_1053[%b_1054 : i32] : vector<4xf16> loc(#loc69)
    %b_1056 = llvm.mlir.constant(true) : i1 loc(#loc69)
    llvm.store %b_1055, %b_1046 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc69)
    %accumulator_1057 = llvm.sub %25, %22 : i32 loc(#loc122)
    llvm.br ^bb1(%20, %accumulator_88, %accumulator_535, %accumulator_798, %20, %accumulator_923, %accumulator_1008 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc122)
  ^bb1(%accumulator_1058: i32 loc("accumulator"(#loc117)), %accumulator_1059: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc10 at #loc76)), %a_ptrs_1060: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc40)), %b_ptrs_1061: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %28: i32 loc(unknown), %a_1062: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc3)), %b_1063: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc2))):  // 2 preds: ^bb0, ^bb2
    %b_1064 = builtin.unrealized_conversion_cast %b_1063 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %a_1065 = builtin.unrealized_conversion_cast %a_1062 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %b_ptrs_1066 = builtin.unrealized_conversion_cast %b_ptrs_1061 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc99)
    %a_ptrs_1067 = builtin.unrealized_conversion_cast %a_ptrs_1060 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc95)
    %accumulator_1068 = builtin.unrealized_conversion_cast %accumulator_1059 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc116)
    %accumulator_1069 = llvm.icmp "slt" %accumulator_1058, %accumulator_1057 : i32 loc(#loc122)
    llvm.cond_br %accumulator_1069, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_1070 = llvm.extractvalue %a_ptrs_1060[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1071 = llvm.extractvalue %a_ptrs_1060[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1072 = llvm.extractvalue %a_ptrs_1060[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1073 = llvm.extractvalue %a_ptrs_1060[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1074 = llvm.extractvalue %a_ptrs_1060[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1075 = llvm.extractvalue %a_ptrs_1060[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1076 = llvm.extractvalue %a_ptrs_1060[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1077 = llvm.extractvalue %a_ptrs_1060[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1078 = llvm.extractvalue %16[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1079 = llvm.extractvalue %16[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1080 = llvm.extractvalue %16[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1081 = llvm.extractvalue %16[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1082 = llvm.extractvalue %16[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1083 = llvm.extractvalue %16[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1084 = llvm.extractvalue %16[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1085 = llvm.extractvalue %16[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1086 = llvm.add %a_ptrs_1070, %a_ptrs_1078 : i32 loc(#loc103)
    %a_ptrs_1087 = llvm.add %a_ptrs_1071, %a_ptrs_1079 : i32 loc(#loc103)
    %a_ptrs_1088 = llvm.add %a_ptrs_1072, %a_ptrs_1080 : i32 loc(#loc103)
    %a_ptrs_1089 = llvm.add %a_ptrs_1073, %a_ptrs_1081 : i32 loc(#loc103)
    %a_ptrs_1090 = llvm.add %a_ptrs_1074, %a_ptrs_1082 : i32 loc(#loc103)
    %a_ptrs_1091 = llvm.add %a_ptrs_1075, %a_ptrs_1083 : i32 loc(#loc103)
    %a_ptrs_1092 = llvm.add %a_ptrs_1076, %a_ptrs_1084 : i32 loc(#loc103)
    %a_ptrs_1093 = llvm.add %a_ptrs_1077, %a_ptrs_1085 : i32 loc(#loc103)
    %a_ptrs_1094 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc103)
    %a_ptrs_1095 = llvm.insertvalue %a_ptrs_1086, %a_ptrs_1094[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1096 = llvm.insertvalue %a_ptrs_1087, %a_ptrs_1095[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1097 = llvm.insertvalue %a_ptrs_1088, %a_ptrs_1096[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1098 = llvm.insertvalue %a_ptrs_1089, %a_ptrs_1097[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1099 = llvm.insertvalue %a_ptrs_1090, %a_ptrs_1098[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1100 = llvm.insertvalue %a_ptrs_1091, %a_ptrs_1099[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1101 = llvm.insertvalue %a_ptrs_1092, %a_ptrs_1100[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1102 = llvm.insertvalue %a_ptrs_1093, %a_ptrs_1101[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1103 = builtin.unrealized_conversion_cast %a_ptrs_1102 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc103)
    %accumulator_1104 = builtin.unrealized_conversion_cast %a_ptrs_1103 : tensor<64x64xi32, #blocked> to !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc122)
    %b_ptrs_1105 = llvm.extractvalue %b_ptrs_1061[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1106 = llvm.extractvalue %b_ptrs_1061[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1107 = llvm.extractvalue %b_ptrs_1061[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1108 = llvm.extractvalue %b_ptrs_1061[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1109 = llvm.extractvalue %b_ptrs_894[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1110 = llvm.extractvalue %b_ptrs_894[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1111 = llvm.extractvalue %b_ptrs_894[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1112 = llvm.extractvalue %b_ptrs_894[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1113 = llvm.add %b_ptrs_1105, %b_ptrs_1109 : i32 loc(#loc102)
    %b_ptrs_1114 = llvm.add %b_ptrs_1106, %b_ptrs_1110 : i32 loc(#loc102)
    %b_ptrs_1115 = llvm.add %b_ptrs_1107, %b_ptrs_1111 : i32 loc(#loc102)
    %b_ptrs_1116 = llvm.add %b_ptrs_1108, %b_ptrs_1112 : i32 loc(#loc102)
    %b_ptrs_1117 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc102)
    %b_ptrs_1118 = llvm.insertvalue %b_ptrs_1113, %b_ptrs_1117[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1119 = llvm.insertvalue %b_ptrs_1114, %b_ptrs_1118[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1120 = llvm.insertvalue %b_ptrs_1115, %b_ptrs_1119[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1121 = llvm.insertvalue %b_ptrs_1116, %b_ptrs_1120[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1122 = builtin.unrealized_conversion_cast %b_ptrs_1121 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_1123 = builtin.unrealized_conversion_cast %b_ptrs_1122 : tensor<64x32xi32, #blocked1> to !llvm.struct<(i32, i32, i32, i32)> loc(#loc122)
    %accumulator_1124 = llvm.add %accumulator_1058, %22 : i32 loc(#loc122)
    %a_1125 = llvm.mul %accumulator_1124, %18 : i32 loc(#loc104)
    %a_1126 = llvm.sub %K, %a_1125 : i32 loc(#loc105)
    %a_1127 = llvm.bitcast %a_1126 : i32 to i32 loc(#loc98)
    %a_1128 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc98)
    %a_1129 = llvm.insertvalue %a_1127, %a_1128[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1130 = llvm.insertvalue %a_1127, %a_1129[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1131 = llvm.insertvalue %a_1127, %a_1130[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1132 = llvm.insertvalue %a_1127, %a_1131[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1133 = llvm.insertvalue %a_1127, %a_1132[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1134 = llvm.insertvalue %a_1127, %a_1133[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1135 = llvm.insertvalue %a_1127, %a_1134[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1136 = llvm.insertvalue %a_1127, %a_1135[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1137 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1138 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1139 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1140 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1141 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1142 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1143 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1144 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1145 = llvm.extractvalue %a_1136[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1146 = llvm.extractvalue %a_1136[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1147 = llvm.extractvalue %a_1136[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1148 = llvm.extractvalue %a_1136[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1149 = llvm.extractvalue %a_1136[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1150 = llvm.extractvalue %a_1136[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1151 = llvm.extractvalue %a_1136[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1152 = llvm.extractvalue %a_1136[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1153 = llvm.icmp "slt" %a_1137, %a_1145 : i32 loc(#loc98)
    %a_1154 = llvm.icmp "slt" %a_1138, %a_1146 : i32 loc(#loc98)
    %a_1155 = llvm.icmp "slt" %a_1139, %a_1147 : i32 loc(#loc98)
    %a_1156 = llvm.icmp "slt" %a_1140, %a_1148 : i32 loc(#loc98)
    %a_1157 = llvm.icmp "slt" %a_1141, %a_1149 : i32 loc(#loc98)
    %a_1158 = llvm.icmp "slt" %a_1142, %a_1150 : i32 loc(#loc98)
    %a_1159 = llvm.icmp "slt" %a_1143, %a_1151 : i32 loc(#loc98)
    %a_1160 = llvm.icmp "slt" %a_1144, %a_1152 : i32 loc(#loc98)
    %a_1161 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc98)
    %a_1162 = llvm.insertvalue %a_1153, %a_1161[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1163 = llvm.insertvalue %a_1153, %a_1162[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1164 = llvm.insertvalue %a_1153, %a_1163[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1165 = llvm.insertvalue %a_1153, %a_1164[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1166 = llvm.insertvalue %a_1153, %a_1165[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1167 = llvm.insertvalue %a_1153, %a_1166[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1168 = llvm.insertvalue %a_1153, %a_1167[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1169 = llvm.insertvalue %a_1153, %a_1168[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1170 = llvm.extractvalue %a_1169[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1171 = llvm.extractvalue %a_1169[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1172 = llvm.extractvalue %a_1169[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1173 = llvm.extractvalue %a_1169[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1174 = llvm.extractvalue %a_1169[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1175 = llvm.extractvalue %a_1169[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1176 = llvm.extractvalue %a_1169[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1177 = llvm.extractvalue %a_1169[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1178 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc70)
    %a_1179 = llvm.insertvalue %a_1170, %a_1178[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1180 = llvm.insertvalue %a_1171, %a_1179[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1181 = llvm.insertvalue %a_1172, %a_1180[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1182 = llvm.insertvalue %a_1173, %a_1181[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1183 = llvm.insertvalue %a_1174, %a_1182[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1184 = llvm.insertvalue %a_1175, %a_1183[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1185 = llvm.insertvalue %a_1176, %a_1184[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1186 = llvm.insertvalue %a_1177, %a_1185[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1187 = llvm.extractvalue %a_ptrs_1102[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1188 = llvm.extractvalue %a_ptrs_1102[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1189 = llvm.extractvalue %a_ptrs_1102[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1190 = llvm.extractvalue %a_ptrs_1102[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1191 = llvm.extractvalue %a_ptrs_1102[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1192 = llvm.extractvalue %a_ptrs_1102[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1193 = llvm.extractvalue %a_ptrs_1102[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1194 = llvm.extractvalue %a_ptrs_1102[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1195 = llvm.extractvalue %a_1186[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1196 = llvm.extractvalue %a_1186[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1197 = llvm.extractvalue %a_1186[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1198 = llvm.extractvalue %a_1186[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1199 = llvm.extractvalue %a_1186[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1200 = llvm.extractvalue %a_1186[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1201 = llvm.extractvalue %a_1186[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1202 = llvm.extractvalue %a_1186[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1203 = llvm.mlir.constant(0 : i16) : i16 loc(#loc70)
    %a_1204 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc70)
    %a_1205 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc70)
    %a_1206 = rocdl.make.buffer.rsrc %a_ptr, %a_1203, %a_1205, %a_1204 : <1> to <8> loc(#loc70)
    %a_1207 = llvm.mlir.constant(dense<0.000000e+00> : vector<8xf16>) : vector<8xf16> loc(#loc70)
    %a_1208 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc70)
    %a_1209 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1210 = llvm.mul %a_1209, %a_1187 : i32 loc(#loc70)
    %a_1211 = llvm.select %a_1195, %a_1210, %a_1208 : i1, i32 loc(#loc70)
    %a_1212 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1213 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1214 = rocdl.raw.ptr.buffer.load %a_1206, %a_1211, %a_1212, %a_1213 : vector<4xi32> loc(#loc70)
    %a_1215 = llvm.bitcast %a_1214 : vector<4xi32> to vector<8xf16> loc(#loc70)
    %a_1216 = llvm.mlir.constant(0 : index) : i32 loc(#loc70)
    %a_1217 = llvm.extractelement %a_1215[%a_1216 : i32] : vector<8xf16> loc(#loc70)
    %a_1218 = llvm.mlir.constant(1 : index) : i32 loc(#loc70)
    %a_1219 = llvm.extractelement %a_1215[%a_1218 : i32] : vector<8xf16> loc(#loc70)
    %a_1220 = llvm.mlir.constant(2 : index) : i32 loc(#loc70)
    %a_1221 = llvm.extractelement %a_1215[%a_1220 : i32] : vector<8xf16> loc(#loc70)
    %a_1222 = llvm.mlir.constant(3 : index) : i32 loc(#loc70)
    %a_1223 = llvm.extractelement %a_1215[%a_1222 : i32] : vector<8xf16> loc(#loc70)
    %a_1224 = llvm.mlir.constant(4 : index) : i32 loc(#loc70)
    %a_1225 = llvm.extractelement %a_1215[%a_1224 : i32] : vector<8xf16> loc(#loc70)
    %a_1226 = llvm.mlir.constant(5 : index) : i32 loc(#loc70)
    %a_1227 = llvm.extractelement %a_1215[%a_1226 : i32] : vector<8xf16> loc(#loc70)
    %a_1228 = llvm.mlir.constant(6 : index) : i32 loc(#loc70)
    %a_1229 = llvm.extractelement %a_1215[%a_1228 : i32] : vector<8xf16> loc(#loc70)
    %a_1230 = llvm.mlir.constant(7 : index) : i32 loc(#loc70)
    %a_1231 = llvm.extractelement %a_1215[%a_1230 : i32] : vector<8xf16> loc(#loc70)
    %a_1232 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_1233 = llvm.insertvalue %a_1217, %a_1232[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1234 = llvm.insertvalue %a_1219, %a_1233[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1235 = llvm.insertvalue %a_1221, %a_1234[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1236 = llvm.insertvalue %a_1223, %a_1235[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1237 = llvm.insertvalue %a_1225, %a_1236[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1238 = llvm.insertvalue %a_1227, %a_1237[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1239 = llvm.insertvalue %a_1229, %a_1238[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1240 = llvm.insertvalue %a_1231, %a_1239[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_1241 = llvm.extractvalue %a_1062[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1242 = llvm.extractvalue %a_1062[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1243 = llvm.extractvalue %a_1062[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1244 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1245 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_1246 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1247 = llvm.and %a_1245, %a_1246 : i32 loc(#loc70)
    %a_1248 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1249 = llvm.urem %a_1247, %a_1248 : i32 loc(#loc70)
    %a_1250 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1251 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1252 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1253 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1254 = llvm.shl %a_1249, %a_1253 : i32 loc(#loc70)
    %a_1255 = llvm.or %a_1252, %a_1254 : i32 loc(#loc70)
    %a_1256 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_1257 = llvm.shl %a_33, %a_1256 : i32 loc(#loc70)
    %a_1258 = llvm.or %a_1255, %a_1257 : i32 loc(#loc70)
    %a_1259 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_1260 = llvm.and %a_1258, %a_1259 : i32 loc(#loc70)
    %a_1261 = llvm.mlir.constant(7 : i32) : i32 loc(#loc70)
    %a_1262 = llvm.shl %a_1260, %a_1261 : i32 loc(#loc70)
    %a_1263 = llvm.mlir.constant(384 : i32) : i32 loc(#loc70)
    %a_1264 = llvm.and %a_1258, %a_1263 : i32 loc(#loc70)
    %a_1265 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_1266 = llvm.shl %a_1264, %a_1265 : i32 loc(#loc70)
    %a_1267 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_1268 = llvm.and %a_1258, %a_1267 : i32 loc(#loc70)
    %a_1269 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1270 = llvm.shl %a_1268, %a_1269 : i32 loc(#loc70)
    %a_1271 = llvm.mlir.constant(48 : i32) : i32 loc(#loc70)
    %a_1272 = llvm.and %a_1258, %a_1271 : i32 loc(#loc70)
    %a_1273 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1274 = llvm.lshr %a_1272, %a_1273 : i32 loc(#loc70)
    %a_1275 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1276 = llvm.xor %a_1266, %a_1270 : i32 loc(#loc70)
    %a_1277 = llvm.xor %a_1276, %a_1274 : i32 loc(#loc70)
    %a_1278 = llvm.or disjoint %a_1262, %a_1277 : i32 loc(#loc70)
    %a_1279 = llvm.xor %a_1251, %a_1278 : i32 loc(#loc70)
    %a_1280 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1281 = llvm.mul %a_1244, %a_1280 : i32 loc(#loc70)
    %a_1282 = llvm.xor %a_1279, %a_1281 : i32 loc(#loc70)
    %a_1283 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1284 = llvm.xor %a_1282, %a_1283 : i32 loc(#loc70)
    %a_1285 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1286 = llvm.add %a_1284, %a_1285 : i32 loc(#loc70)
    %a_1287 = llvm.getelementptr inbounds %a_1241[%a_1286] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1288 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1289 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1290 = llvm.load %a_1287 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1291 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1292 = llvm.extractelement %a_1290[%a_1291 : i32] : vector<4xf16> loc(#loc70)
    %a_1293 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1294 = llvm.extractelement %a_1290[%a_1293 : i32] : vector<4xf16> loc(#loc70)
    %a_1295 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1296 = llvm.extractelement %a_1290[%a_1295 : i32] : vector<4xf16> loc(#loc70)
    %a_1297 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1298 = llvm.extractelement %a_1290[%a_1297 : i32] : vector<4xf16> loc(#loc70)
    %a_1299 = llvm.mlir.constant(32 : i32) : i32 loc(#loc70)
    %a_1300 = llvm.xor %a_1282, %a_1299 : i32 loc(#loc70)
    %a_1301 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1302 = llvm.add %a_1300, %a_1301 : i32 loc(#loc70)
    %a_1303 = llvm.getelementptr inbounds %a_1241[%a_1302] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1304 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1305 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1306 = llvm.load %a_1303 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1307 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1308 = llvm.extractelement %a_1306[%a_1307 : i32] : vector<4xf16> loc(#loc70)
    %a_1309 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1310 = llvm.extractelement %a_1306[%a_1309 : i32] : vector<4xf16> loc(#loc70)
    %a_1311 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1312 = llvm.extractelement %a_1306[%a_1311 : i32] : vector<4xf16> loc(#loc70)
    %a_1313 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1314 = llvm.extractelement %a_1306[%a_1313 : i32] : vector<4xf16> loc(#loc70)
    %a_1315 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1316 = llvm.xor %a_1282, %a_1315 : i32 loc(#loc70)
    %a_1317 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1318 = llvm.add %a_1316, %a_1317 : i32 loc(#loc70)
    %a_1319 = llvm.getelementptr inbounds %a_1241[%a_1318] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1320 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1321 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1322 = llvm.load %a_1319 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1323 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1324 = llvm.extractelement %a_1322[%a_1323 : i32] : vector<4xf16> loc(#loc70)
    %a_1325 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1326 = llvm.extractelement %a_1322[%a_1325 : i32] : vector<4xf16> loc(#loc70)
    %a_1327 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1328 = llvm.extractelement %a_1322[%a_1327 : i32] : vector<4xf16> loc(#loc70)
    %a_1329 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1330 = llvm.extractelement %a_1322[%a_1329 : i32] : vector<4xf16> loc(#loc70)
    %a_1331 = llvm.mlir.constant(96 : i32) : i32 loc(#loc70)
    %a_1332 = llvm.xor %a_1282, %a_1331 : i32 loc(#loc70)
    %a_1333 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1334 = llvm.add %a_1332, %a_1333 : i32 loc(#loc70)
    %a_1335 = llvm.getelementptr inbounds %a_1241[%a_1334] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1336 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1337 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1338 = llvm.load %a_1335 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1339 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1340 = llvm.extractelement %a_1338[%a_1339 : i32] : vector<4xf16> loc(#loc70)
    %a_1341 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1342 = llvm.extractelement %a_1338[%a_1341 : i32] : vector<4xf16> loc(#loc70)
    %a_1343 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1344 = llvm.extractelement %a_1338[%a_1343 : i32] : vector<4xf16> loc(#loc70)
    %a_1345 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1346 = llvm.extractelement %a_1338[%a_1345 : i32] : vector<4xf16> loc(#loc70)
    %a_1347 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_1348 = llvm.insertvalue %a_1292, %a_1347[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1349 = llvm.insertvalue %a_1294, %a_1348[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1350 = llvm.insertvalue %a_1296, %a_1349[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1351 = llvm.insertvalue %a_1298, %a_1350[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1352 = llvm.insertvalue %a_1308, %a_1351[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1353 = llvm.insertvalue %a_1310, %a_1352[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1354 = llvm.insertvalue %a_1312, %a_1353[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1355 = llvm.insertvalue %a_1314, %a_1354[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1356 = llvm.insertvalue %a_1324, %a_1355[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1357 = llvm.insertvalue %a_1326, %a_1356[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1358 = llvm.insertvalue %a_1328, %a_1357[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1359 = llvm.insertvalue %a_1330, %a_1358[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1360 = llvm.insertvalue %a_1340, %a_1359[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1361 = llvm.insertvalue %a_1342, %a_1360[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1362 = llvm.insertvalue %a_1344, %a_1361[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1363 = llvm.insertvalue %a_1346, %a_1362[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_1364 = llvm.bitcast %a_1126 : i32 to i32 loc(#loc100)
    %b_1365 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc100)
    %b_1366 = llvm.insertvalue %b_1364, %b_1365[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1367 = llvm.insertvalue %b_1364, %b_1366[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1368 = llvm.insertvalue %b_1364, %b_1367[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1369 = llvm.insertvalue %b_1364, %b_1368[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1370 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1371 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1372 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1373 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1374 = llvm.extractvalue %b_1369[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1375 = llvm.extractvalue %b_1369[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1376 = llvm.extractvalue %b_1369[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1377 = llvm.extractvalue %b_1369[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1378 = llvm.icmp "slt" %b_1370, %b_1374 : i32 loc(#loc100)
    %b_1379 = llvm.icmp "slt" %b_1371, %b_1375 : i32 loc(#loc100)
    %b_1380 = llvm.icmp "slt" %b_1372, %b_1376 : i32 loc(#loc100)
    %b_1381 = llvm.icmp "slt" %b_1373, %b_1377 : i32 loc(#loc100)
    %b_1382 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc100)
    %b_1383 = llvm.insertvalue %b_1378, %b_1382[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1384 = llvm.insertvalue %b_1378, %b_1383[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1385 = llvm.insertvalue %b_1378, %b_1384[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1386 = llvm.insertvalue %b_1378, %b_1385[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1387 = llvm.extractvalue %b_1386[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1388 = llvm.extractvalue %b_1386[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1389 = llvm.extractvalue %b_1386[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1390 = llvm.extractvalue %b_1386[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1391 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc69)
    %b_1392 = llvm.insertvalue %b_1390, %b_1391[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1393 = llvm.insertvalue %b_1390, %b_1392[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1394 = llvm.insertvalue %b_1390, %b_1393[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1395 = llvm.insertvalue %b_1390, %b_1394[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1396 = llvm.extractvalue %b_ptrs_1121[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1397 = llvm.extractvalue %b_ptrs_1121[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1398 = llvm.extractvalue %b_ptrs_1121[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1399 = llvm.extractvalue %b_ptrs_1121[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1400 = llvm.extractvalue %b_1395[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1401 = llvm.extractvalue %b_1395[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1402 = llvm.extractvalue %b_1395[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1403 = llvm.extractvalue %b_1395[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1404 = llvm.mlir.constant(0 : i16) : i16 loc(#loc69)
    %b_1405 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc69)
    %b_1406 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc69)
    %b_1407 = rocdl.make.buffer.rsrc %b_ptr, %b_1404, %b_1406, %b_1405 : <1> to <8> loc(#loc69)
    %b_1408 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc69)
    %b_1409 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc69)
    %b_1410 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1411 = llvm.mul %b_1410, %b_1396 : i32 loc(#loc69)
    %b_1412 = llvm.select %b_1400, %b_1411, %b_1409 : i1, i32 loc(#loc69)
    %b_1413 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1414 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1415 = rocdl.raw.ptr.buffer.load %b_1407, %b_1412, %b_1413, %b_1414 : vector<2xi32> loc(#loc69)
    %b_1416 = llvm.bitcast %b_1415 : vector<2xi32> to vector<4xf16> loc(#loc69)
    %b_1417 = llvm.mlir.constant(0 : index) : i32 loc(#loc69)
    %b_1418 = llvm.extractelement %b_1416[%b_1417 : i32] : vector<4xf16> loc(#loc69)
    %b_1419 = llvm.mlir.constant(1 : index) : i32 loc(#loc69)
    %b_1420 = llvm.extractelement %b_1416[%b_1419 : i32] : vector<4xf16> loc(#loc69)
    %b_1421 = llvm.mlir.constant(2 : index) : i32 loc(#loc69)
    %b_1422 = llvm.extractelement %b_1416[%b_1421 : i32] : vector<4xf16> loc(#loc69)
    %b_1423 = llvm.mlir.constant(3 : index) : i32 loc(#loc69)
    %b_1424 = llvm.extractelement %b_1416[%b_1423 : i32] : vector<4xf16> loc(#loc69)
    %b_1425 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc69)
    %b_1426 = llvm.insertvalue %b_1418, %b_1425[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1427 = llvm.insertvalue %b_1420, %b_1426[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1428 = llvm.insertvalue %b_1422, %b_1427[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1429 = llvm.insertvalue %b_1424, %b_1428[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1430 = llvm.extractvalue %b_1063[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1431 = llvm.extractvalue %b_1063[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1432 = llvm.extractvalue %b_1063[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1433 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1434 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1435 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1436 = llvm.and %b_1434, %b_1435 : i32 loc(#loc69)
    %b_1437 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1438 = llvm.urem %b_1436, %b_1437 : i32 loc(#loc69)
    %b_1439 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1440 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1441 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1442 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1443 = llvm.shl %b_1438, %b_1442 : i32 loc(#loc69)
    %b_1444 = llvm.or %b_1441, %b_1443 : i32 loc(#loc69)
    %b_1445 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_1446 = llvm.shl %b_27, %b_1445 : i32 loc(#loc69)
    %b_1447 = llvm.or %b_1444, %b_1446 : i32 loc(#loc69)
    %b_1448 = llvm.mlir.constant(48 : i32) : i32 loc(#loc69)
    %b_1449 = llvm.and %b_1447, %b_1448 : i32 loc(#loc69)
    %b_1450 = llvm.mlir.constant(4 : i32) : i32 loc(#loc69)
    %b_1451 = llvm.shl %b_1449, %b_1450 : i32 loc(#loc69)
    %b_1452 = llvm.mlir.constant(15 : i32) : i32 loc(#loc69)
    %b_1453 = llvm.and %b_1447, %b_1452 : i32 loc(#loc69)
    %b_1454 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_1455 = llvm.shl %b_1453, %b_1454 : i32 loc(#loc69)
    %b_1456 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1457 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1458 = llvm.and %b_1447, %b_1457 : i32 loc(#loc69)
    %b_1459 = llvm.icmp "eq" %b_1458, %b_1456 : i32 loc(#loc69)
    %b_1460 = llvm.mlir.constant(32 : i32) : i32 loc(#loc69)
    %b_1461 = llvm.select %b_1459, %b_1456, %b_1460 : i1, i32 loc(#loc69)
    %b_1462 = llvm.xor %b_1451, %b_1455 : i32 loc(#loc69)
    %b_1463 = llvm.or disjoint %b_1461, %b_1462 : i32 loc(#loc69)
    %b_1464 = llvm.xor %b_1440, %b_1463 : i32 loc(#loc69)
    %b_1465 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1466 = llvm.mul %b_1433, %b_1465 : i32 loc(#loc69)
    %b_1467 = llvm.xor %b_1464, %b_1466 : i32 loc(#loc69)
    %b_1468 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1469 = llvm.xor %b_1467, %b_1468 : i32 loc(#loc69)
    %b_1470 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1471 = llvm.add %b_1469, %b_1470 : i32 loc(#loc69)
    %b_1472 = llvm.getelementptr inbounds %b_1430[%b_1471] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1473 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1474 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1475 = llvm.load %b_1472 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1476 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1477 = llvm.extractelement %b_1475[%b_1476 : i32] : vector<1xf16> loc(#loc69)
    %b_1478 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1479 = llvm.add %b_1469, %b_1478 : i32 loc(#loc69)
    %b_1480 = llvm.getelementptr inbounds %b_1430[%b_1479] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1481 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1482 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1483 = llvm.load %b_1480 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1484 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1485 = llvm.extractelement %b_1483[%b_1484 : i32] : vector<1xf16> loc(#loc69)
    %b_1486 = llvm.mlir.constant(128 : i32) : i32 loc(#loc69)
    %b_1487 = llvm.add %b_1469, %b_1486 : i32 loc(#loc69)
    %b_1488 = llvm.getelementptr inbounds %b_1430[%b_1487] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1489 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1490 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1491 = llvm.load %b_1488 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1492 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1493 = llvm.extractelement %b_1491[%b_1492 : i32] : vector<1xf16> loc(#loc69)
    %b_1494 = llvm.mlir.constant(192 : i32) : i32 loc(#loc69)
    %b_1495 = llvm.add %b_1469, %b_1494 : i32 loc(#loc69)
    %b_1496 = llvm.getelementptr inbounds %b_1430[%b_1495] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1497 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1498 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1499 = llvm.load %b_1496 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1500 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1501 = llvm.extractelement %b_1499[%b_1500 : i32] : vector<1xf16> loc(#loc69)
    %b_1502 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc69)
    %b_1503 = llvm.add %b_1469, %b_1502 : i32 loc(#loc69)
    %b_1504 = llvm.getelementptr inbounds %b_1430[%b_1503] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1505 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1506 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1507 = llvm.load %b_1504 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1508 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1509 = llvm.extractelement %b_1507[%b_1508 : i32] : vector<1xf16> loc(#loc69)
    %b_1510 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc69)
    %b_1511 = llvm.add %b_1469, %b_1510 : i32 loc(#loc69)
    %b_1512 = llvm.getelementptr inbounds %b_1430[%b_1511] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1513 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1514 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1515 = llvm.load %b_1512 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1516 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1517 = llvm.extractelement %b_1515[%b_1516 : i32] : vector<1xf16> loc(#loc69)
    %b_1518 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc69)
    %b_1519 = llvm.add %b_1469, %b_1518 : i32 loc(#loc69)
    %b_1520 = llvm.getelementptr inbounds %b_1430[%b_1519] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1521 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1522 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1523 = llvm.load %b_1520 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1524 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1525 = llvm.extractelement %b_1523[%b_1524 : i32] : vector<1xf16> loc(#loc69)
    %b_1526 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc69)
    %b_1527 = llvm.add %b_1469, %b_1526 : i32 loc(#loc69)
    %b_1528 = llvm.getelementptr inbounds %b_1430[%b_1527] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1529 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1530 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1531 = llvm.load %b_1528 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1532 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1533 = llvm.extractelement %b_1531[%b_1532 : i32] : vector<1xf16> loc(#loc69)
    %b_1534 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_1535 = llvm.add %b_1469, %b_1534 : i32 loc(#loc69)
    %b_1536 = llvm.getelementptr inbounds %b_1430[%b_1535] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1537 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1538 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1539 = llvm.load %b_1536 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1540 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1541 = llvm.extractelement %b_1539[%b_1540 : i32] : vector<1xf16> loc(#loc69)
    %b_1542 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc69)
    %b_1543 = llvm.add %b_1469, %b_1542 : i32 loc(#loc69)
    %b_1544 = llvm.getelementptr inbounds %b_1430[%b_1543] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1545 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1546 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1547 = llvm.load %b_1544 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1548 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1549 = llvm.extractelement %b_1547[%b_1548 : i32] : vector<1xf16> loc(#loc69)
    %b_1550 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc69)
    %b_1551 = llvm.add %b_1469, %b_1550 : i32 loc(#loc69)
    %b_1552 = llvm.getelementptr inbounds %b_1430[%b_1551] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1553 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1554 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1555 = llvm.load %b_1552 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1556 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1557 = llvm.extractelement %b_1555[%b_1556 : i32] : vector<1xf16> loc(#loc69)
    %b_1558 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc69)
    %b_1559 = llvm.add %b_1469, %b_1558 : i32 loc(#loc69)
    %b_1560 = llvm.getelementptr inbounds %b_1430[%b_1559] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1561 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1562 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1563 = llvm.load %b_1560 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1564 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1565 = llvm.extractelement %b_1563[%b_1564 : i32] : vector<1xf16> loc(#loc69)
    %b_1566 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc69)
    %b_1567 = llvm.add %b_1469, %b_1566 : i32 loc(#loc69)
    %b_1568 = llvm.getelementptr inbounds %b_1430[%b_1567] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1569 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1570 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1571 = llvm.load %b_1568 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1572 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1573 = llvm.extractelement %b_1571[%b_1572 : i32] : vector<1xf16> loc(#loc69)
    %b_1574 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc69)
    %b_1575 = llvm.add %b_1469, %b_1574 : i32 loc(#loc69)
    %b_1576 = llvm.getelementptr inbounds %b_1430[%b_1575] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1577 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1578 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1579 = llvm.load %b_1576 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1580 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1581 = llvm.extractelement %b_1579[%b_1580 : i32] : vector<1xf16> loc(#loc69)
    %b_1582 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc69)
    %b_1583 = llvm.add %b_1469, %b_1582 : i32 loc(#loc69)
    %b_1584 = llvm.getelementptr inbounds %b_1430[%b_1583] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1585 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1586 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1587 = llvm.load %b_1584 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1588 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1589 = llvm.extractelement %b_1587[%b_1588 : i32] : vector<1xf16> loc(#loc69)
    %b_1590 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc69)
    %b_1591 = llvm.add %b_1469, %b_1590 : i32 loc(#loc69)
    %b_1592 = llvm.getelementptr inbounds %b_1430[%b_1591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1593 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1594 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1595 = llvm.load %b_1592 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1596 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1597 = llvm.extractelement %b_1595[%b_1596 : i32] : vector<1xf16> loc(#loc69)
    %b_1598 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc69)
    %b_1599 = llvm.insertvalue %b_1477, %b_1598[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1600 = llvm.insertvalue %b_1485, %b_1599[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1601 = llvm.insertvalue %b_1493, %b_1600[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1602 = llvm.insertvalue %b_1501, %b_1601[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1603 = llvm.insertvalue %b_1509, %b_1602[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1604 = llvm.insertvalue %b_1517, %b_1603[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1605 = llvm.insertvalue %b_1525, %b_1604[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1606 = llvm.insertvalue %b_1533, %b_1605[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1607 = llvm.insertvalue %b_1541, %b_1606[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1608 = llvm.insertvalue %b_1549, %b_1607[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1609 = llvm.insertvalue %b_1557, %b_1608[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1610 = llvm.insertvalue %b_1565, %b_1609[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1611 = llvm.insertvalue %b_1573, %b_1610[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1612 = llvm.insertvalue %b_1581, %b_1611[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1613 = llvm.insertvalue %b_1589, %b_1612[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1614 = llvm.insertvalue %b_1597, %b_1613[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %accumulator_1615 = llvm.extractvalue %a_1363[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1616 = llvm.extractvalue %a_1363[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1617 = llvm.extractvalue %a_1363[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1618 = llvm.extractvalue %a_1363[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1619 = llvm.extractvalue %a_1363[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1620 = llvm.extractvalue %a_1363[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1621 = llvm.extractvalue %a_1363[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1622 = llvm.extractvalue %a_1363[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1623 = llvm.extractvalue %a_1363[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1624 = llvm.extractvalue %a_1363[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1625 = llvm.extractvalue %a_1363[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1626 = llvm.extractvalue %a_1363[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1627 = llvm.extractvalue %a_1363[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1628 = llvm.extractvalue %a_1363[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1629 = llvm.extractvalue %a_1363[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1630 = llvm.extractvalue %a_1363[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1631 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1632 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1633 = llvm.insertelement %accumulator_1615, %accumulator_1631[%accumulator_1632 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1634 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1635 = llvm.insertelement %accumulator_1616, %accumulator_1633[%accumulator_1634 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1636 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1637 = llvm.insertelement %accumulator_1617, %accumulator_1635[%accumulator_1636 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1638 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1639 = llvm.insertelement %accumulator_1618, %accumulator_1637[%accumulator_1638 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1640 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1641 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1642 = llvm.extractelement %accumulator_1639[%accumulator_1641 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1643 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1644 = llvm.insertelement %accumulator_1642, %accumulator_1640[%accumulator_1643 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1645 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1646 = llvm.extractelement %accumulator_1639[%accumulator_1645 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1647 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1648 = llvm.insertelement %accumulator_1646, %accumulator_1644[%accumulator_1647 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1649 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1650 = llvm.extractelement %accumulator_1639[%accumulator_1649 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1651 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1652 = llvm.insertelement %accumulator_1650, %accumulator_1648[%accumulator_1651 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1653 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1654 = llvm.extractelement %accumulator_1639[%accumulator_1653 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1655 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1656 = llvm.insertelement %accumulator_1654, %accumulator_1652[%accumulator_1655 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1657 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1658 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1659 = llvm.insertelement %accumulator_1619, %accumulator_1657[%accumulator_1658 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1660 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1661 = llvm.insertelement %accumulator_1620, %accumulator_1659[%accumulator_1660 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1662 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1663 = llvm.insertelement %accumulator_1621, %accumulator_1661[%accumulator_1662 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1664 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1665 = llvm.insertelement %accumulator_1622, %accumulator_1663[%accumulator_1664 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1666 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1667 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1668 = llvm.extractelement %accumulator_1665[%accumulator_1667 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1669 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1670 = llvm.insertelement %accumulator_1668, %accumulator_1666[%accumulator_1669 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1671 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1672 = llvm.extractelement %accumulator_1665[%accumulator_1671 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1673 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1674 = llvm.insertelement %accumulator_1672, %accumulator_1670[%accumulator_1673 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1675 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1676 = llvm.extractelement %accumulator_1665[%accumulator_1675 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1677 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1678 = llvm.insertelement %accumulator_1676, %accumulator_1674[%accumulator_1677 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1679 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1680 = llvm.extractelement %accumulator_1665[%accumulator_1679 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1681 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1682 = llvm.insertelement %accumulator_1680, %accumulator_1678[%accumulator_1681 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1683 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1684 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1685 = llvm.insertelement %accumulator_1623, %accumulator_1683[%accumulator_1684 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1686 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1687 = llvm.insertelement %accumulator_1624, %accumulator_1685[%accumulator_1686 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1688 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1689 = llvm.insertelement %accumulator_1625, %accumulator_1687[%accumulator_1688 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1690 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1691 = llvm.insertelement %accumulator_1626, %accumulator_1689[%accumulator_1690 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1692 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1693 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1694 = llvm.extractelement %accumulator_1691[%accumulator_1693 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1695 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1696 = llvm.insertelement %accumulator_1694, %accumulator_1692[%accumulator_1695 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1697 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1698 = llvm.extractelement %accumulator_1691[%accumulator_1697 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1699 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1700 = llvm.insertelement %accumulator_1698, %accumulator_1696[%accumulator_1699 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1701 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1702 = llvm.extractelement %accumulator_1691[%accumulator_1701 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1703 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1704 = llvm.insertelement %accumulator_1702, %accumulator_1700[%accumulator_1703 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1705 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1706 = llvm.extractelement %accumulator_1691[%accumulator_1705 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1707 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1708 = llvm.insertelement %accumulator_1706, %accumulator_1704[%accumulator_1707 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1709 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1710 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1711 = llvm.insertelement %accumulator_1627, %accumulator_1709[%accumulator_1710 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1712 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1713 = llvm.insertelement %accumulator_1628, %accumulator_1711[%accumulator_1712 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1714 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1715 = llvm.insertelement %accumulator_1629, %accumulator_1713[%accumulator_1714 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1716 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1717 = llvm.insertelement %accumulator_1630, %accumulator_1715[%accumulator_1716 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1718 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1719 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1720 = llvm.extractelement %accumulator_1717[%accumulator_1719 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1721 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1722 = llvm.insertelement %accumulator_1720, %accumulator_1718[%accumulator_1721 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1723 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1724 = llvm.extractelement %accumulator_1717[%accumulator_1723 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1725 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1726 = llvm.insertelement %accumulator_1724, %accumulator_1722[%accumulator_1725 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1727 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1728 = llvm.extractelement %accumulator_1717[%accumulator_1727 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1729 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1730 = llvm.insertelement %accumulator_1728, %accumulator_1726[%accumulator_1729 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1731 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1732 = llvm.extractelement %accumulator_1717[%accumulator_1731 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1733 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1734 = llvm.insertelement %accumulator_1732, %accumulator_1730[%accumulator_1733 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1735 = llvm.extractvalue %b_1614[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1736 = llvm.extractvalue %b_1614[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1737 = llvm.extractvalue %b_1614[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1738 = llvm.extractvalue %b_1614[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1739 = llvm.extractvalue %b_1614[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1740 = llvm.extractvalue %b_1614[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1741 = llvm.extractvalue %b_1614[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1742 = llvm.extractvalue %b_1614[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1743 = llvm.extractvalue %b_1614[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1744 = llvm.extractvalue %b_1614[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1745 = llvm.extractvalue %b_1614[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1746 = llvm.extractvalue %b_1614[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1747 = llvm.extractvalue %b_1614[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1748 = llvm.extractvalue %b_1614[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1749 = llvm.extractvalue %b_1614[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1750 = llvm.extractvalue %b_1614[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1751 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1752 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1753 = llvm.insertelement %accumulator_1735, %accumulator_1751[%accumulator_1752 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1754 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1755 = llvm.insertelement %accumulator_1736, %accumulator_1753[%accumulator_1754 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1756 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1757 = llvm.insertelement %accumulator_1737, %accumulator_1755[%accumulator_1756 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1758 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1759 = llvm.insertelement %accumulator_1738, %accumulator_1757[%accumulator_1758 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1760 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1761 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1762 = llvm.extractelement %accumulator_1759[%accumulator_1761 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1763 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1764 = llvm.insertelement %accumulator_1762, %accumulator_1760[%accumulator_1763 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1765 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1766 = llvm.extractelement %accumulator_1759[%accumulator_1765 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1767 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1768 = llvm.insertelement %accumulator_1766, %accumulator_1764[%accumulator_1767 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1769 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1770 = llvm.extractelement %accumulator_1759[%accumulator_1769 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1771 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1772 = llvm.insertelement %accumulator_1770, %accumulator_1768[%accumulator_1771 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1773 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1774 = llvm.extractelement %accumulator_1759[%accumulator_1773 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1775 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1776 = llvm.insertelement %accumulator_1774, %accumulator_1772[%accumulator_1775 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1777 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1778 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1779 = llvm.insertelement %accumulator_1739, %accumulator_1777[%accumulator_1778 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1780 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1781 = llvm.insertelement %accumulator_1740, %accumulator_1779[%accumulator_1780 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1782 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1783 = llvm.insertelement %accumulator_1741, %accumulator_1781[%accumulator_1782 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1784 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1785 = llvm.insertelement %accumulator_1742, %accumulator_1783[%accumulator_1784 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1786 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1787 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1788 = llvm.extractelement %accumulator_1785[%accumulator_1787 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1789 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1790 = llvm.insertelement %accumulator_1788, %accumulator_1786[%accumulator_1789 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1791 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1792 = llvm.extractelement %accumulator_1785[%accumulator_1791 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1793 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1794 = llvm.insertelement %accumulator_1792, %accumulator_1790[%accumulator_1793 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1795 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1796 = llvm.extractelement %accumulator_1785[%accumulator_1795 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1797 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1798 = llvm.insertelement %accumulator_1796, %accumulator_1794[%accumulator_1797 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1799 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1800 = llvm.extractelement %accumulator_1785[%accumulator_1799 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1801 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1802 = llvm.insertelement %accumulator_1800, %accumulator_1798[%accumulator_1801 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1803 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1804 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1805 = llvm.insertelement %accumulator_1743, %accumulator_1803[%accumulator_1804 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1806 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1807 = llvm.insertelement %accumulator_1744, %accumulator_1805[%accumulator_1806 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1808 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1809 = llvm.insertelement %accumulator_1745, %accumulator_1807[%accumulator_1808 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1810 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1811 = llvm.insertelement %accumulator_1746, %accumulator_1809[%accumulator_1810 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1812 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1813 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1814 = llvm.extractelement %accumulator_1811[%accumulator_1813 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1815 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1816 = llvm.insertelement %accumulator_1814, %accumulator_1812[%accumulator_1815 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1817 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1818 = llvm.extractelement %accumulator_1811[%accumulator_1817 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1819 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1820 = llvm.insertelement %accumulator_1818, %accumulator_1816[%accumulator_1819 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1821 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1822 = llvm.extractelement %accumulator_1811[%accumulator_1821 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1823 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1824 = llvm.insertelement %accumulator_1822, %accumulator_1820[%accumulator_1823 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1825 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1826 = llvm.extractelement %accumulator_1811[%accumulator_1825 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1827 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1828 = llvm.insertelement %accumulator_1826, %accumulator_1824[%accumulator_1827 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1829 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1830 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1831 = llvm.insertelement %accumulator_1747, %accumulator_1829[%accumulator_1830 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1832 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1833 = llvm.insertelement %accumulator_1748, %accumulator_1831[%accumulator_1832 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1834 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1835 = llvm.insertelement %accumulator_1749, %accumulator_1833[%accumulator_1834 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1836 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1837 = llvm.insertelement %accumulator_1750, %accumulator_1835[%accumulator_1836 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1838 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1839 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1840 = llvm.extractelement %accumulator_1837[%accumulator_1839 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1841 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1842 = llvm.insertelement %accumulator_1840, %accumulator_1838[%accumulator_1841 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1843 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1844 = llvm.extractelement %accumulator_1837[%accumulator_1843 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1845 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1846 = llvm.insertelement %accumulator_1844, %accumulator_1842[%accumulator_1845 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1847 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1848 = llvm.extractelement %accumulator_1837[%accumulator_1847 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1849 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1850 = llvm.insertelement %accumulator_1848, %accumulator_1846[%accumulator_1849 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1851 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1852 = llvm.extractelement %accumulator_1837[%accumulator_1851 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1853 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1854 = llvm.insertelement %accumulator_1852, %accumulator_1850[%accumulator_1853 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1855 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1856 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1857 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1858 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1859 = llvm.mlir.undef : vector<4xf32> loc(#loc106)
    %accumulator_1860 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1861 = llvm.insertelement %accumulator_1855, %accumulator_1859[%accumulator_1860 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1862 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1863 = llvm.insertelement %accumulator_1856, %accumulator_1861[%accumulator_1862 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1864 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1865 = llvm.insertelement %accumulator_1857, %accumulator_1863[%accumulator_1864 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1866 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1867 = llvm.insertelement %accumulator_1858, %accumulator_1865[%accumulator_1866 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1868 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1869 = rocdl.mfma.f32.16x16x16f16 %accumulator_1776, %accumulator_1656, %accumulator_1867, %accumulator_1868, %accumulator_1868, %accumulator_1868 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1870 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1871 = rocdl.mfma.f32.16x16x16f16 %accumulator_1802, %accumulator_1682, %accumulator_1869, %accumulator_1870, %accumulator_1870, %accumulator_1870 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1872 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1873 = rocdl.mfma.f32.16x16x16f16 %accumulator_1828, %accumulator_1708, %accumulator_1871, %accumulator_1872, %accumulator_1872, %accumulator_1872 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1874 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1875 = rocdl.mfma.f32.16x16x16f16 %accumulator_1854, %accumulator_1734, %accumulator_1873, %accumulator_1874, %accumulator_1874, %accumulator_1874 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1876 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1877 = llvm.extractelement %accumulator_1875[%accumulator_1876 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1878 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1879 = llvm.extractelement %accumulator_1875[%accumulator_1878 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1880 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1881 = llvm.extractelement %accumulator_1875[%accumulator_1880 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1882 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1883 = llvm.extractelement %accumulator_1875[%accumulator_1882 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1884 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    %accumulator_1885 = llvm.insertvalue %accumulator_1877, %accumulator_1884[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1886 = llvm.insertvalue %accumulator_1879, %accumulator_1885[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1887 = llvm.insertvalue %accumulator_1881, %accumulator_1886[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1888 = llvm.insertvalue %accumulator_1883, %accumulator_1887[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1889 = builtin.unrealized_conversion_cast %accumulator_1888 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_1890 = builtin.unrealized_conversion_cast %accumulator_1889 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %accumulator_1891 = llvm.add %28, %22 : i32 loc(#loc122)
    %accumulator_1892 = llvm.icmp "slt" %accumulator_1891, %22 : i32 loc(#loc122)
    %accumulator_1893 = llvm.select %accumulator_1892, %accumulator_1891, %20 : i1, i32 loc(#loc122)
    %a_1894 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc70)
    %a_1895 = llvm.mul %accumulator_1893, %a_1894 : i32 loc(#loc70)
    %a_1896 = llvm.extractvalue %a_902[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1897 = llvm.extractvalue %a_902[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1898 = llvm.extractvalue %a_902[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1899 = llvm.extractvalue %a_902[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1900 = llvm.getelementptr %a_1896[%a_1895] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc70)
    %a_1901 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc70)
    %a_1902 = llvm.insertvalue %a_1900, %a_1901[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1903 = llvm.insertvalue %a_1898, %a_1902[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1904 = llvm.insertvalue %a_1899, %a_1903[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1905 = builtin.unrealized_conversion_cast %a_1904 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %accumulator_1906 = builtin.unrealized_conversion_cast %a_1905 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_1907 = llvm.extractvalue %a_1904[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1908 = llvm.extractvalue %a_1904[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1909 = llvm.extractvalue %a_1904[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1910 = llvm.extractvalue %a_1240[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1911 = llvm.extractvalue %a_1240[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1912 = llvm.extractvalue %a_1240[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1913 = llvm.extractvalue %a_1240[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1914 = llvm.extractvalue %a_1240[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1915 = llvm.extractvalue %a_1240[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1916 = llvm.extractvalue %a_1240[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1917 = llvm.extractvalue %a_1240[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1918 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1919 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_1920 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1921 = llvm.and %a_1919, %a_1920 : i32 loc(#loc70)
    %a_1922 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1923 = llvm.urem %a_1921, %a_1922 : i32 loc(#loc70)
    %a_1924 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1925 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1926 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1927 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1928 = llvm.shl %a_1923, %a_1927 : i32 loc(#loc70)
    %a_1929 = llvm.or %a_1926, %a_1928 : i32 loc(#loc70)
    %a_1930 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_1931 = llvm.shl %a_21, %a_1930 : i32 loc(#loc70)
    %a_1932 = llvm.or %a_1929, %a_1931 : i32 loc(#loc70)
    %a_1933 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1934 = llvm.and %a_1932, %a_1933 : i32 loc(#loc70)
    %a_1935 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_1936 = llvm.shl %a_1934, %a_1935 : i32 loc(#loc70)
    %a_1937 = llvm.mlir.constant(120 : i32) : i32 loc(#loc70)
    %a_1938 = llvm.and %a_1932, %a_1937 : i32 loc(#loc70)
    %a_1939 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1940 = llvm.lshr %a_1938, %a_1939 : i32 loc(#loc70)
    %a_1941 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1942 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1943 = llvm.xor %a_1936, %a_1940 : i32 loc(#loc70)
    %a_1944 = llvm.or disjoint %a_1942, %a_1943 : i32 loc(#loc70)
    %a_1945 = llvm.xor %a_1925, %a_1944 : i32 loc(#loc70)
    %a_1946 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1947 = llvm.mul %a_1918, %a_1946 : i32 loc(#loc70)
    %a_1948 = llvm.xor %a_1945, %a_1947 : i32 loc(#loc70)
    %a_1949 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1950 = llvm.xor %a_1948, %a_1949 : i32 loc(#loc70)
    %a_1951 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1952 = llvm.add %a_1950, %a_1951 : i32 loc(#loc70)
    %a_1953 = llvm.getelementptr inbounds %a_1907[%a_1952] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1954 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_1955 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1956 = llvm.insertelement %a_1910, %a_1954[%a_1955 : i32] : vector<4xf16> loc(#loc70)
    %a_1957 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1958 = llvm.insertelement %a_1911, %a_1956[%a_1957 : i32] : vector<4xf16> loc(#loc70)
    %a_1959 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1960 = llvm.insertelement %a_1912, %a_1958[%a_1959 : i32] : vector<4xf16> loc(#loc70)
    %a_1961 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1962 = llvm.insertelement %a_1913, %a_1960[%a_1961 : i32] : vector<4xf16> loc(#loc70)
    %a_1963 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_1962, %a_1953 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %a_1964 = llvm.mlir.constant(8 : i32) : i32 loc(#loc70)
    %a_1965 = llvm.xor %a_1948, %a_1964 : i32 loc(#loc70)
    %a_1966 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1967 = llvm.add %a_1965, %a_1966 : i32 loc(#loc70)
    %a_1968 = llvm.getelementptr inbounds %a_1907[%a_1967] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1969 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_1970 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1971 = llvm.insertelement %a_1914, %a_1969[%a_1970 : i32] : vector<4xf16> loc(#loc70)
    %a_1972 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1973 = llvm.insertelement %a_1915, %a_1971[%a_1972 : i32] : vector<4xf16> loc(#loc70)
    %a_1974 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1975 = llvm.insertelement %a_1916, %a_1973[%a_1974 : i32] : vector<4xf16> loc(#loc70)
    %a_1976 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1977 = llvm.insertelement %a_1917, %a_1975[%a_1976 : i32] : vector<4xf16> loc(#loc70)
    %a_1978 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_1977, %a_1968 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %b_1979 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_1980 = llvm.mul %accumulator_1893, %b_1979 : i32 loc(#loc69)
    %b_1981 = llvm.extractvalue %b_910[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1982 = llvm.extractvalue %b_910[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1983 = llvm.extractvalue %b_910[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1984 = llvm.extractvalue %b_910[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1985 = llvm.getelementptr %b_1981[%b_1980] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc69)
    %b_1986 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc69)
    %b_1987 = llvm.insertvalue %b_1985, %b_1986[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1988 = llvm.insertvalue %b_1983, %b_1987[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1989 = llvm.insertvalue %b_1984, %b_1988[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1990 = builtin.unrealized_conversion_cast %b_1989 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %accumulator_1991 = builtin.unrealized_conversion_cast %b_1990 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %b_1992 = llvm.extractvalue %b_1989[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1993 = llvm.extractvalue %b_1989[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1994 = llvm.extractvalue %b_1989[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1995 = llvm.extractvalue %b_1429[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1996 = llvm.extractvalue %b_1429[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1997 = llvm.extractvalue %b_1429[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1998 = llvm.extractvalue %b_1429[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1999 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2000 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_2001 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2002 = llvm.and %b_2000, %b_2001 : i32 loc(#loc69)
    %b_2003 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2004 = llvm.urem %b_2002, %b_2003 : i32 loc(#loc69)
    %b_2005 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2006 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2007 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2008 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2009 = llvm.shl %b_2004, %b_2008 : i32 loc(#loc69)
    %b_2010 = llvm.or %b_2007, %b_2009 : i32 loc(#loc69)
    %b_2011 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_2012 = llvm.shl %b_15, %b_2011 : i32 loc(#loc69)
    %b_2013 = llvm.or %b_2010, %b_2012 : i32 loc(#loc69)
    %b_2014 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2015 = llvm.and %b_2013, %b_2014 : i32 loc(#loc69)
    %b_2016 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_2017 = llvm.shl %b_2015, %b_2016 : i32 loc(#loc69)
    %b_2018 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2019 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2020 = llvm.or disjoint %b_2017, %b_2019 : i32 loc(#loc69)
    %b_2021 = llvm.xor %b_2006, %b_2020 : i32 loc(#loc69)
    %b_2022 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2023 = llvm.mul %b_1999, %b_2022 : i32 loc(#loc69)
    %b_2024 = llvm.xor %b_2021, %b_2023 : i32 loc(#loc69)
    %b_2025 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2026 = llvm.xor %b_2024, %b_2025 : i32 loc(#loc69)
    %b_2027 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2028 = llvm.add %b_2026, %b_2027 : i32 loc(#loc69)
    %b_2029 = llvm.getelementptr inbounds %b_1992[%b_2028] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2030 = llvm.mlir.undef : vector<4xf16> loc(#loc69)
    %b_2031 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2032 = llvm.insertelement %b_1995, %b_2030[%b_2031 : i32] : vector<4xf16> loc(#loc69)
    %b_2033 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_2034 = llvm.insertelement %b_1996, %b_2032[%b_2033 : i32] : vector<4xf16> loc(#loc69)
    %b_2035 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2036 = llvm.insertelement %b_1997, %b_2034[%b_2035 : i32] : vector<4xf16> loc(#loc69)
    %b_2037 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_2038 = llvm.insertelement %b_1998, %b_2036[%b_2037 : i32] : vector<4xf16> loc(#loc69)
    %b_2039 = llvm.mlir.constant(true) : i1 loc(#loc69)
    llvm.store %b_2038, %b_2029 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc69)
    %accumulator_2040 = llvm.add %accumulator_1058, %22 : i32 loc(#loc122)
    llvm.br ^bb1(%accumulator_2040, %accumulator_1890, %accumulator_1104, %accumulator_1123, %accumulator_1893, %accumulator_1906, %accumulator_1991 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_2041 = llvm.icmp "sge" %25, %22 : i32 loc(#loc122)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_2042 = llvm.extractvalue %a_1062[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2043 = llvm.extractvalue %a_1062[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2044 = llvm.extractvalue %a_1062[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2045 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2046 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_2047 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_2048 = llvm.and %a_2046, %a_2047 : i32 loc(#loc70)
    %a_2049 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_2050 = llvm.urem %a_2048, %a_2049 : i32 loc(#loc70)
    %a_2051 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2052 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2053 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2054 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2055 = llvm.shl %a_2050, %a_2054 : i32 loc(#loc70)
    %a_2056 = llvm.or %a_2053, %a_2055 : i32 loc(#loc70)
    %a_2057 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_2058 = llvm.shl %a_9, %a_2057 : i32 loc(#loc70)
    %a_2059 = llvm.or %a_2056, %a_2058 : i32 loc(#loc70)
    %a_2060 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_2061 = llvm.and %a_2059, %a_2060 : i32 loc(#loc70)
    %a_2062 = llvm.mlir.constant(7 : i32) : i32 loc(#loc70)
    %a_2063 = llvm.shl %a_2061, %a_2062 : i32 loc(#loc70)
    %a_2064 = llvm.mlir.constant(384 : i32) : i32 loc(#loc70)
    %a_2065 = llvm.and %a_2059, %a_2064 : i32 loc(#loc70)
    %a_2066 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_2067 = llvm.shl %a_2065, %a_2066 : i32 loc(#loc70)
    %a_2068 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_2069 = llvm.and %a_2059, %a_2068 : i32 loc(#loc70)
    %a_2070 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2071 = llvm.shl %a_2069, %a_2070 : i32 loc(#loc70)
    %a_2072 = llvm.mlir.constant(48 : i32) : i32 loc(#loc70)
    %a_2073 = llvm.and %a_2059, %a_2072 : i32 loc(#loc70)
    %a_2074 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2075 = llvm.lshr %a_2073, %a_2074 : i32 loc(#loc70)
    %a_2076 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2077 = llvm.xor %a_2067, %a_2071 : i32 loc(#loc70)
    %a_2078 = llvm.xor %a_2077, %a_2075 : i32 loc(#loc70)
    %a_2079 = llvm.or disjoint %a_2063, %a_2078 : i32 loc(#loc70)
    %a_2080 = llvm.xor %a_2052, %a_2079 : i32 loc(#loc70)
    %a_2081 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2082 = llvm.mul %a_2045, %a_2081 : i32 loc(#loc70)
    %a_2083 = llvm.xor %a_2080, %a_2082 : i32 loc(#loc70)
    %a_2084 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2085 = llvm.xor %a_2083, %a_2084 : i32 loc(#loc70)
    %a_2086 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2087 = llvm.add %a_2085, %a_2086 : i32 loc(#loc70)
    %a_2088 = llvm.getelementptr inbounds %a_2042[%a_2087] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2089 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2090 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2091 = llvm.load %a_2088 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2092 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2093 = llvm.extractelement %a_2091[%a_2092 : i32] : vector<4xf16> loc(#loc70)
    %a_2094 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2095 = llvm.extractelement %a_2091[%a_2094 : i32] : vector<4xf16> loc(#loc70)
    %a_2096 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2097 = llvm.extractelement %a_2091[%a_2096 : i32] : vector<4xf16> loc(#loc70)
    %a_2098 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2099 = llvm.extractelement %a_2091[%a_2098 : i32] : vector<4xf16> loc(#loc70)
    %a_2100 = llvm.mlir.constant(32 : i32) : i32 loc(#loc70)
    %a_2101 = llvm.xor %a_2083, %a_2100 : i32 loc(#loc70)
    %a_2102 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2103 = llvm.add %a_2101, %a_2102 : i32 loc(#loc70)
    %a_2104 = llvm.getelementptr inbounds %a_2042[%a_2103] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2105 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2106 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2107 = llvm.load %a_2104 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2108 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2109 = llvm.extractelement %a_2107[%a_2108 : i32] : vector<4xf16> loc(#loc70)
    %a_2110 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2111 = llvm.extractelement %a_2107[%a_2110 : i32] : vector<4xf16> loc(#loc70)
    %a_2112 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2113 = llvm.extractelement %a_2107[%a_2112 : i32] : vector<4xf16> loc(#loc70)
    %a_2114 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2115 = llvm.extractelement %a_2107[%a_2114 : i32] : vector<4xf16> loc(#loc70)
    %a_2116 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_2117 = llvm.xor %a_2083, %a_2116 : i32 loc(#loc70)
    %a_2118 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2119 = llvm.add %a_2117, %a_2118 : i32 loc(#loc70)
    %a_2120 = llvm.getelementptr inbounds %a_2042[%a_2119] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2121 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2122 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2123 = llvm.load %a_2120 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2124 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2125 = llvm.extractelement %a_2123[%a_2124 : i32] : vector<4xf16> loc(#loc70)
    %a_2126 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2127 = llvm.extractelement %a_2123[%a_2126 : i32] : vector<4xf16> loc(#loc70)
    %a_2128 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2129 = llvm.extractelement %a_2123[%a_2128 : i32] : vector<4xf16> loc(#loc70)
    %a_2130 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2131 = llvm.extractelement %a_2123[%a_2130 : i32] : vector<4xf16> loc(#loc70)
    %a_2132 = llvm.mlir.constant(96 : i32) : i32 loc(#loc70)
    %a_2133 = llvm.xor %a_2083, %a_2132 : i32 loc(#loc70)
    %a_2134 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2135 = llvm.add %a_2133, %a_2134 : i32 loc(#loc70)
    %a_2136 = llvm.getelementptr inbounds %a_2042[%a_2135] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2137 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2138 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2139 = llvm.load %a_2136 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2140 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2141 = llvm.extractelement %a_2139[%a_2140 : i32] : vector<4xf16> loc(#loc70)
    %a_2142 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2143 = llvm.extractelement %a_2139[%a_2142 : i32] : vector<4xf16> loc(#loc70)
    %a_2144 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2145 = llvm.extractelement %a_2139[%a_2144 : i32] : vector<4xf16> loc(#loc70)
    %a_2146 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2147 = llvm.extractelement %a_2139[%a_2146 : i32] : vector<4xf16> loc(#loc70)
    %a_2148 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_2149 = llvm.insertvalue %a_2093, %a_2148[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2150 = llvm.insertvalue %a_2095, %a_2149[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2151 = llvm.insertvalue %a_2097, %a_2150[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2152 = llvm.insertvalue %a_2099, %a_2151[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2153 = llvm.insertvalue %a_2109, %a_2152[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2154 = llvm.insertvalue %a_2111, %a_2153[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2155 = llvm.insertvalue %a_2113, %a_2154[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2156 = llvm.insertvalue %a_2115, %a_2155[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2157 = llvm.insertvalue %a_2125, %a_2156[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2158 = llvm.insertvalue %a_2127, %a_2157[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2159 = llvm.insertvalue %a_2129, %a_2158[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2160 = llvm.insertvalue %a_2131, %a_2159[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2161 = llvm.insertvalue %a_2141, %a_2160[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2162 = llvm.insertvalue %a_2143, %a_2161[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2163 = llvm.insertvalue %a_2145, %a_2162[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2164 = llvm.insertvalue %a_2147, %a_2163[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_2165 = llvm.extractvalue %b_1063[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2166 = llvm.extractvalue %b_1063[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2167 = llvm.extractvalue %b_1063[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2168 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2169 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_2170 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2171 = llvm.and %b_2169, %b_2170 : i32 loc(#loc69)
    %b_2172 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2173 = llvm.urem %b_2171, %b_2172 : i32 loc(#loc69)
    %b_2174 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2175 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2176 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2177 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2178 = llvm.shl %b_2173, %b_2177 : i32 loc(#loc69)
    %b_2179 = llvm.or %b_2176, %b_2178 : i32 loc(#loc69)
    %b_2180 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_2181 = llvm.shl %b_4, %b_2180 : i32 loc(#loc69)
    %b_2182 = llvm.or %b_2179, %b_2181 : i32 loc(#loc69)
    %b_2183 = llvm.mlir.constant(48 : i32) : i32 loc(#loc69)
    %b_2184 = llvm.and %b_2182, %b_2183 : i32 loc(#loc69)
    %b_2185 = llvm.mlir.constant(4 : i32) : i32 loc(#loc69)
    %b_2186 = llvm.shl %b_2184, %b_2185 : i32 loc(#loc69)
    %b_2187 = llvm.mlir.constant(15 : i32) : i32 loc(#loc69)
    %b_2188 = llvm.and %b_2182, %b_2187 : i32 loc(#loc69)
    %b_2189 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_2190 = llvm.shl %b_2188, %b_2189 : i32 loc(#loc69)
    %b_2191 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2192 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2193 = llvm.and %b_2182, %b_2192 : i32 loc(#loc69)
    %b_2194 = llvm.icmp "eq" %b_2193, %b_2191 : i32 loc(#loc69)
    %b_2195 = llvm.mlir.constant(32 : i32) : i32 loc(#loc69)
    %b_2196 = llvm.select %b_2194, %b_2191, %b_2195 : i1, i32 loc(#loc69)
    %b_2197 = llvm.xor %b_2186, %b_2190 : i32 loc(#loc69)
    %b_2198 = llvm.or disjoint %b_2196, %b_2197 : i32 loc(#loc69)
    %b_2199 = llvm.xor %b_2175, %b_2198 : i32 loc(#loc69)
    %b_2200 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2201 = llvm.mul %b_2168, %b_2200 : i32 loc(#loc69)
    %b_2202 = llvm.xor %b_2199, %b_2201 : i32 loc(#loc69)
    %b_2203 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2204 = llvm.xor %b_2202, %b_2203 : i32 loc(#loc69)
    %b_2205 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2206 = llvm.add %b_2204, %b_2205 : i32 loc(#loc69)
    %b_2207 = llvm.getelementptr inbounds %b_2165[%b_2206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2208 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2209 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2210 = llvm.load %b_2207 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2211 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2212 = llvm.extractelement %b_2210[%b_2211 : i32] : vector<1xf16> loc(#loc69)
    %b_2213 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2214 = llvm.add %b_2204, %b_2213 : i32 loc(#loc69)
    %b_2215 = llvm.getelementptr inbounds %b_2165[%b_2214] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2216 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2217 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2218 = llvm.load %b_2215 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2219 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2220 = llvm.extractelement %b_2218[%b_2219 : i32] : vector<1xf16> loc(#loc69)
    %b_2221 = llvm.mlir.constant(128 : i32) : i32 loc(#loc69)
    %b_2222 = llvm.add %b_2204, %b_2221 : i32 loc(#loc69)
    %b_2223 = llvm.getelementptr inbounds %b_2165[%b_2222] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2224 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2225 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2226 = llvm.load %b_2223 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2227 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2228 = llvm.extractelement %b_2226[%b_2227 : i32] : vector<1xf16> loc(#loc69)
    %b_2229 = llvm.mlir.constant(192 : i32) : i32 loc(#loc69)
    %b_2230 = llvm.add %b_2204, %b_2229 : i32 loc(#loc69)
    %b_2231 = llvm.getelementptr inbounds %b_2165[%b_2230] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2232 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2233 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2234 = llvm.load %b_2231 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2235 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2236 = llvm.extractelement %b_2234[%b_2235 : i32] : vector<1xf16> loc(#loc69)
    %b_2237 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc69)
    %b_2238 = llvm.add %b_2204, %b_2237 : i32 loc(#loc69)
    %b_2239 = llvm.getelementptr inbounds %b_2165[%b_2238] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2240 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2241 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2242 = llvm.load %b_2239 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2243 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2244 = llvm.extractelement %b_2242[%b_2243 : i32] : vector<1xf16> loc(#loc69)
    %b_2245 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc69)
    %b_2246 = llvm.add %b_2204, %b_2245 : i32 loc(#loc69)
    %b_2247 = llvm.getelementptr inbounds %b_2165[%b_2246] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2248 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2249 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2250 = llvm.load %b_2247 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2251 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2252 = llvm.extractelement %b_2250[%b_2251 : i32] : vector<1xf16> loc(#loc69)
    %b_2253 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc69)
    %b_2254 = llvm.add %b_2204, %b_2253 : i32 loc(#loc69)
    %b_2255 = llvm.getelementptr inbounds %b_2165[%b_2254] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2256 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2257 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2258 = llvm.load %b_2255 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2259 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2260 = llvm.extractelement %b_2258[%b_2259 : i32] : vector<1xf16> loc(#loc69)
    %b_2261 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc69)
    %b_2262 = llvm.add %b_2204, %b_2261 : i32 loc(#loc69)
    %b_2263 = llvm.getelementptr inbounds %b_2165[%b_2262] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2264 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2265 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2266 = llvm.load %b_2263 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2267 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2268 = llvm.extractelement %b_2266[%b_2267 : i32] : vector<1xf16> loc(#loc69)
    %b_2269 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_2270 = llvm.add %b_2204, %b_2269 : i32 loc(#loc69)
    %b_2271 = llvm.getelementptr inbounds %b_2165[%b_2270] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2272 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2273 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2274 = llvm.load %b_2271 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2275 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2276 = llvm.extractelement %b_2274[%b_2275 : i32] : vector<1xf16> loc(#loc69)
    %b_2277 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc69)
    %b_2278 = llvm.add %b_2204, %b_2277 : i32 loc(#loc69)
    %b_2279 = llvm.getelementptr inbounds %b_2165[%b_2278] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2280 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2281 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2282 = llvm.load %b_2279 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2283 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2284 = llvm.extractelement %b_2282[%b_2283 : i32] : vector<1xf16> loc(#loc69)
    %b_2285 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc69)
    %b_2286 = llvm.add %b_2204, %b_2285 : i32 loc(#loc69)
    %b_2287 = llvm.getelementptr inbounds %b_2165[%b_2286] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2288 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2289 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2290 = llvm.load %b_2287 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2291 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2292 = llvm.extractelement %b_2290[%b_2291 : i32] : vector<1xf16> loc(#loc69)
    %b_2293 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc69)
    %b_2294 = llvm.add %b_2204, %b_2293 : i32 loc(#loc69)
    %b_2295 = llvm.getelementptr inbounds %b_2165[%b_2294] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2296 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2297 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2298 = llvm.load %b_2295 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2299 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2300 = llvm.extractelement %b_2298[%b_2299 : i32] : vector<1xf16> loc(#loc69)
    %b_2301 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc69)
    %b_2302 = llvm.add %b_2204, %b_2301 : i32 loc(#loc69)
    %b_2303 = llvm.getelementptr inbounds %b_2165[%b_2302] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2304 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2305 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2306 = llvm.load %b_2303 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2307 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2308 = llvm.extractelement %b_2306[%b_2307 : i32] : vector<1xf16> loc(#loc69)
    %b_2309 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc69)
    %b_2310 = llvm.add %b_2204, %b_2309 : i32 loc(#loc69)
    %b_2311 = llvm.getelementptr inbounds %b_2165[%b_2310] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2312 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2313 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2314 = llvm.load %b_2311 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2315 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2316 = llvm.extractelement %b_2314[%b_2315 : i32] : vector<1xf16> loc(#loc69)
    %b_2317 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc69)
    %b_2318 = llvm.add %b_2204, %b_2317 : i32 loc(#loc69)
    %b_2319 = llvm.getelementptr inbounds %b_2165[%b_2318] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2320 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2321 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2322 = llvm.load %b_2319 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2323 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2324 = llvm.extractelement %b_2322[%b_2323 : i32] : vector<1xf16> loc(#loc69)
    %b_2325 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc69)
    %b_2326 = llvm.add %b_2204, %b_2325 : i32 loc(#loc69)
    %b_2327 = llvm.getelementptr inbounds %b_2165[%b_2326] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2328 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2329 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2330 = llvm.load %b_2327 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2331 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2332 = llvm.extractelement %b_2330[%b_2331 : i32] : vector<1xf16> loc(#loc69)
    %b_2333 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc69)
    %b_2334 = llvm.insertvalue %b_2212, %b_2333[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2335 = llvm.insertvalue %b_2220, %b_2334[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2336 = llvm.insertvalue %b_2228, %b_2335[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2337 = llvm.insertvalue %b_2236, %b_2336[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2338 = llvm.insertvalue %b_2244, %b_2337[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2339 = llvm.insertvalue %b_2252, %b_2338[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2340 = llvm.insertvalue %b_2260, %b_2339[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2341 = llvm.insertvalue %b_2268, %b_2340[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2342 = llvm.insertvalue %b_2276, %b_2341[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2343 = llvm.insertvalue %b_2284, %b_2342[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2344 = llvm.insertvalue %b_2292, %b_2343[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2345 = llvm.insertvalue %b_2300, %b_2344[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2346 = llvm.insertvalue %b_2308, %b_2345[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2347 = llvm.insertvalue %b_2316, %b_2346[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2348 = llvm.insertvalue %b_2324, %b_2347[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2349 = llvm.insertvalue %b_2332, %b_2348[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    llvm.cond_br %accumulator_2041, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_2350 = llvm.extractvalue %a_2164[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2351 = llvm.extractvalue %a_2164[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2352 = llvm.extractvalue %a_2164[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2353 = llvm.extractvalue %a_2164[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2354 = llvm.extractvalue %a_2164[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2355 = llvm.extractvalue %a_2164[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2356 = llvm.extractvalue %a_2164[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2357 = llvm.extractvalue %a_2164[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2358 = llvm.extractvalue %a_2164[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2359 = llvm.extractvalue %a_2164[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2360 = llvm.extractvalue %a_2164[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2361 = llvm.extractvalue %a_2164[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2362 = llvm.extractvalue %a_2164[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2363 = llvm.extractvalue %a_2164[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2364 = llvm.extractvalue %a_2164[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2365 = llvm.extractvalue %a_2164[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2366 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2367 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2368 = llvm.insertelement %accumulator_2350, %accumulator_2366[%accumulator_2367 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2369 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2370 = llvm.insertelement %accumulator_2351, %accumulator_2368[%accumulator_2369 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2371 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2372 = llvm.insertelement %accumulator_2352, %accumulator_2370[%accumulator_2371 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2373 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2374 = llvm.insertelement %accumulator_2353, %accumulator_2372[%accumulator_2373 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2375 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2376 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2377 = llvm.extractelement %accumulator_2374[%accumulator_2376 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2378 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2379 = llvm.insertelement %accumulator_2377, %accumulator_2375[%accumulator_2378 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2380 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2381 = llvm.extractelement %accumulator_2374[%accumulator_2380 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2382 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2383 = llvm.insertelement %accumulator_2381, %accumulator_2379[%accumulator_2382 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2384 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2385 = llvm.extractelement %accumulator_2374[%accumulator_2384 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2386 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2387 = llvm.insertelement %accumulator_2385, %accumulator_2383[%accumulator_2386 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2388 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2389 = llvm.extractelement %accumulator_2374[%accumulator_2388 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2390 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2391 = llvm.insertelement %accumulator_2389, %accumulator_2387[%accumulator_2390 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2392 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2393 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2394 = llvm.insertelement %accumulator_2354, %accumulator_2392[%accumulator_2393 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2395 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2396 = llvm.insertelement %accumulator_2355, %accumulator_2394[%accumulator_2395 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2397 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2398 = llvm.insertelement %accumulator_2356, %accumulator_2396[%accumulator_2397 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2399 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2400 = llvm.insertelement %accumulator_2357, %accumulator_2398[%accumulator_2399 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2401 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2402 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2403 = llvm.extractelement %accumulator_2400[%accumulator_2402 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2404 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2405 = llvm.insertelement %accumulator_2403, %accumulator_2401[%accumulator_2404 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2406 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2407 = llvm.extractelement %accumulator_2400[%accumulator_2406 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2408 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2409 = llvm.insertelement %accumulator_2407, %accumulator_2405[%accumulator_2408 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2410 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2411 = llvm.extractelement %accumulator_2400[%accumulator_2410 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2412 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2413 = llvm.insertelement %accumulator_2411, %accumulator_2409[%accumulator_2412 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2414 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2415 = llvm.extractelement %accumulator_2400[%accumulator_2414 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2416 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2417 = llvm.insertelement %accumulator_2415, %accumulator_2413[%accumulator_2416 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2418 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2419 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2420 = llvm.insertelement %accumulator_2358, %accumulator_2418[%accumulator_2419 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2421 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2422 = llvm.insertelement %accumulator_2359, %accumulator_2420[%accumulator_2421 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2423 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2424 = llvm.insertelement %accumulator_2360, %accumulator_2422[%accumulator_2423 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2425 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2426 = llvm.insertelement %accumulator_2361, %accumulator_2424[%accumulator_2425 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2427 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2428 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2429 = llvm.extractelement %accumulator_2426[%accumulator_2428 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2430 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2431 = llvm.insertelement %accumulator_2429, %accumulator_2427[%accumulator_2430 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2432 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2433 = llvm.extractelement %accumulator_2426[%accumulator_2432 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2434 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2435 = llvm.insertelement %accumulator_2433, %accumulator_2431[%accumulator_2434 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2436 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2437 = llvm.extractelement %accumulator_2426[%accumulator_2436 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2438 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2439 = llvm.insertelement %accumulator_2437, %accumulator_2435[%accumulator_2438 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2440 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2441 = llvm.extractelement %accumulator_2426[%accumulator_2440 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2442 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2443 = llvm.insertelement %accumulator_2441, %accumulator_2439[%accumulator_2442 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2444 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2445 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2446 = llvm.insertelement %accumulator_2362, %accumulator_2444[%accumulator_2445 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2447 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2448 = llvm.insertelement %accumulator_2363, %accumulator_2446[%accumulator_2447 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2449 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2450 = llvm.insertelement %accumulator_2364, %accumulator_2448[%accumulator_2449 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2451 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2452 = llvm.insertelement %accumulator_2365, %accumulator_2450[%accumulator_2451 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2453 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2454 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2455 = llvm.extractelement %accumulator_2452[%accumulator_2454 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2456 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2457 = llvm.insertelement %accumulator_2455, %accumulator_2453[%accumulator_2456 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2458 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2459 = llvm.extractelement %accumulator_2452[%accumulator_2458 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2460 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2461 = llvm.insertelement %accumulator_2459, %accumulator_2457[%accumulator_2460 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2462 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2463 = llvm.extractelement %accumulator_2452[%accumulator_2462 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2464 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2465 = llvm.insertelement %accumulator_2463, %accumulator_2461[%accumulator_2464 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2466 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2467 = llvm.extractelement %accumulator_2452[%accumulator_2466 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2468 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2469 = llvm.insertelement %accumulator_2467, %accumulator_2465[%accumulator_2468 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2470 = llvm.extractvalue %b_2349[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2471 = llvm.extractvalue %b_2349[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2472 = llvm.extractvalue %b_2349[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2473 = llvm.extractvalue %b_2349[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2474 = llvm.extractvalue %b_2349[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2475 = llvm.extractvalue %b_2349[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2476 = llvm.extractvalue %b_2349[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2477 = llvm.extractvalue %b_2349[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2478 = llvm.extractvalue %b_2349[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2479 = llvm.extractvalue %b_2349[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2480 = llvm.extractvalue %b_2349[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2481 = llvm.extractvalue %b_2349[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2482 = llvm.extractvalue %b_2349[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2483 = llvm.extractvalue %b_2349[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2484 = llvm.extractvalue %b_2349[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2485 = llvm.extractvalue %b_2349[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2486 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2487 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2488 = llvm.insertelement %accumulator_2470, %accumulator_2486[%accumulator_2487 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2489 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2490 = llvm.insertelement %accumulator_2471, %accumulator_2488[%accumulator_2489 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2491 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2492 = llvm.insertelement %accumulator_2472, %accumulator_2490[%accumulator_2491 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2493 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2494 = llvm.insertelement %accumulator_2473, %accumulator_2492[%accumulator_2493 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2495 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2496 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2497 = llvm.extractelement %accumulator_2494[%accumulator_2496 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2498 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2499 = llvm.insertelement %accumulator_2497, %accumulator_2495[%accumulator_2498 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2500 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2501 = llvm.extractelement %accumulator_2494[%accumulator_2500 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2502 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2503 = llvm.insertelement %accumulator_2501, %accumulator_2499[%accumulator_2502 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2504 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2505 = llvm.extractelement %accumulator_2494[%accumulator_2504 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2506 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2507 = llvm.insertelement %accumulator_2505, %accumulator_2503[%accumulator_2506 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2508 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2509 = llvm.extractelement %accumulator_2494[%accumulator_2508 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2510 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2511 = llvm.insertelement %accumulator_2509, %accumulator_2507[%accumulator_2510 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2512 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2513 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2514 = llvm.insertelement %accumulator_2474, %accumulator_2512[%accumulator_2513 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2515 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2516 = llvm.insertelement %accumulator_2475, %accumulator_2514[%accumulator_2515 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2517 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2518 = llvm.insertelement %accumulator_2476, %accumulator_2516[%accumulator_2517 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2519 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2520 = llvm.insertelement %accumulator_2477, %accumulator_2518[%accumulator_2519 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2521 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2522 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2523 = llvm.extractelement %accumulator_2520[%accumulator_2522 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2524 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2525 = llvm.insertelement %accumulator_2523, %accumulator_2521[%accumulator_2524 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2526 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2527 = llvm.extractelement %accumulator_2520[%accumulator_2526 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2528 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2529 = llvm.insertelement %accumulator_2527, %accumulator_2525[%accumulator_2528 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2530 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2531 = llvm.extractelement %accumulator_2520[%accumulator_2530 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2532 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2533 = llvm.insertelement %accumulator_2531, %accumulator_2529[%accumulator_2532 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2534 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2535 = llvm.extractelement %accumulator_2520[%accumulator_2534 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2536 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2537 = llvm.insertelement %accumulator_2535, %accumulator_2533[%accumulator_2536 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2538 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2539 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2540 = llvm.insertelement %accumulator_2478, %accumulator_2538[%accumulator_2539 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2541 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2542 = llvm.insertelement %accumulator_2479, %accumulator_2540[%accumulator_2541 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2543 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2544 = llvm.insertelement %accumulator_2480, %accumulator_2542[%accumulator_2543 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2545 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2546 = llvm.insertelement %accumulator_2481, %accumulator_2544[%accumulator_2545 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2547 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2548 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2549 = llvm.extractelement %accumulator_2546[%accumulator_2548 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2550 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2551 = llvm.insertelement %accumulator_2549, %accumulator_2547[%accumulator_2550 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2552 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2553 = llvm.extractelement %accumulator_2546[%accumulator_2552 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2554 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2555 = llvm.insertelement %accumulator_2553, %accumulator_2551[%accumulator_2554 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2556 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2557 = llvm.extractelement %accumulator_2546[%accumulator_2556 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2558 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2559 = llvm.insertelement %accumulator_2557, %accumulator_2555[%accumulator_2558 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2560 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2561 = llvm.extractelement %accumulator_2546[%accumulator_2560 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2562 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2563 = llvm.insertelement %accumulator_2561, %accumulator_2559[%accumulator_2562 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2564 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2565 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2566 = llvm.insertelement %accumulator_2482, %accumulator_2564[%accumulator_2565 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2567 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2568 = llvm.insertelement %accumulator_2483, %accumulator_2566[%accumulator_2567 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2569 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2570 = llvm.insertelement %accumulator_2484, %accumulator_2568[%accumulator_2569 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2571 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2572 = llvm.insertelement %accumulator_2485, %accumulator_2570[%accumulator_2571 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2573 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2574 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2575 = llvm.extractelement %accumulator_2572[%accumulator_2574 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2576 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2577 = llvm.insertelement %accumulator_2575, %accumulator_2573[%accumulator_2576 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2578 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2579 = llvm.extractelement %accumulator_2572[%accumulator_2578 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2580 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2581 = llvm.insertelement %accumulator_2579, %accumulator_2577[%accumulator_2580 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2582 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2583 = llvm.extractelement %accumulator_2572[%accumulator_2582 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2584 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2585 = llvm.insertelement %accumulator_2583, %accumulator_2581[%accumulator_2584 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2586 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2587 = llvm.extractelement %accumulator_2572[%accumulator_2586 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2588 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2589 = llvm.insertelement %accumulator_2587, %accumulator_2585[%accumulator_2588 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2590 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2591 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2592 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2593 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2594 = llvm.mlir.undef : vector<4xf32> loc(#loc106)
    %accumulator_2595 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2596 = llvm.insertelement %accumulator_2590, %accumulator_2594[%accumulator_2595 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2597 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2598 = llvm.insertelement %accumulator_2591, %accumulator_2596[%accumulator_2597 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2599 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2600 = llvm.insertelement %accumulator_2592, %accumulator_2598[%accumulator_2599 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2601 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2602 = llvm.insertelement %accumulator_2593, %accumulator_2600[%accumulator_2601 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2603 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2604 = rocdl.mfma.f32.16x16x16f16 %accumulator_2511, %accumulator_2391, %accumulator_2602, %accumulator_2603, %accumulator_2603, %accumulator_2603 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2605 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2606 = rocdl.mfma.f32.16x16x16f16 %accumulator_2537, %accumulator_2417, %accumulator_2604, %accumulator_2605, %accumulator_2605, %accumulator_2605 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2607 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2608 = rocdl.mfma.f32.16x16x16f16 %accumulator_2563, %accumulator_2443, %accumulator_2606, %accumulator_2607, %accumulator_2607, %accumulator_2607 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2609 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2610 = rocdl.mfma.f32.16x16x16f16 %accumulator_2589, %accumulator_2469, %accumulator_2608, %accumulator_2609, %accumulator_2609, %accumulator_2609 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2611 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2612 = llvm.extractelement %accumulator_2610[%accumulator_2611 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2613 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2614 = llvm.extractelement %accumulator_2610[%accumulator_2613 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2615 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2616 = llvm.extractelement %accumulator_2610[%accumulator_2615 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2617 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2618 = llvm.extractelement %accumulator_2610[%accumulator_2617 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2619 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    %accumulator_2620 = llvm.insertvalue %accumulator_2612, %accumulator_2619[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2621 = llvm.insertvalue %accumulator_2614, %accumulator_2620[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2622 = llvm.insertvalue %accumulator_2616, %accumulator_2621[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2623 = llvm.insertvalue %accumulator_2618, %accumulator_2622[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2624 = builtin.unrealized_conversion_cast %accumulator_2623 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_2625 = builtin.unrealized_conversion_cast %accumulator_2624 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    llvm.br ^bb6(%accumulator_2625 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_1059 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc106)
  ^bb6(%accumulator_2626: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    %accumulator_2627 = builtin.unrealized_conversion_cast %accumulator_2626 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    llvm.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_2628 = llvm.extractvalue %accumulator_2626[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2629 = llvm.extractvalue %accumulator_2626[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2630 = llvm.extractvalue %accumulator_2626[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2631 = llvm.extractvalue %accumulator_2626[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2632 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2633 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2634 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2635 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2636 = llvm.select %accumulator_2041, %accumulator_2628, %accumulator_2632 : i1, f32 loc(#loc122)
    %accumulator_2637 = llvm.select %accumulator_2041, %accumulator_2629, %accumulator_2633 : i1, f32 loc(#loc122)
    %accumulator_2638 = llvm.select %accumulator_2041, %accumulator_2630, %accumulator_2634 : i1, f32 loc(#loc122)
    %accumulator_2639 = llvm.select %accumulator_2041, %accumulator_2631, %accumulator_2635 : i1, f32 loc(#loc122)
    %accumulator_2640 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %accumulator_2641 = llvm.insertvalue %accumulator_2636, %accumulator_2640[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2642 = llvm.insertvalue %accumulator_2637, %accumulator_2641[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2643 = llvm.insertvalue %accumulator_2638, %accumulator_2642[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2644 = llvm.insertvalue %accumulator_2639, %accumulator_2643[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %c = llvm.extractvalue %accumulator_2644[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2645 = llvm.extractvalue %accumulator_2644[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2646 = llvm.extractvalue %accumulator_2644[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2647 = llvm.extractvalue %accumulator_2644[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2648 = llvm.fptrunc %c : f32 to f16 loc(#loc107)
    %c_2649 = llvm.fptrunc %c_2645 : f32 to f16 loc(#loc107)
    %c_2650 = llvm.fptrunc %c_2646 : f32 to f16 loc(#loc107)
    %c_2651 = llvm.fptrunc %c_2647 : f32 to f16 loc(#loc107)
    %c_2652 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc107)
    %c_2653 = llvm.insertvalue %c_2648, %c_2652[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2654 = llvm.insertvalue %c_2649, %c_2653[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2655 = llvm.insertvalue %c_2650, %c_2654[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2656 = llvm.insertvalue %c_2651, %c_2655[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_ptrs = llvm.extractvalue %offs_am_176[0] : !llvm.struct<(i32)>  loc(#loc108)
    %c_ptrs_2657 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc108)
    %c_ptrs_2658 = llvm.insertvalue %c_ptrs, %c_ptrs_2657[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2659 = llvm.insertvalue %c_ptrs, %c_ptrs_2658[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2660 = llvm.insertvalue %c_ptrs, %c_ptrs_2659[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2661 = llvm.insertvalue %c_ptrs, %c_ptrs_2660[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2662 = llvm.mul %stride_cm, %offs_am_95 : i32 loc(#loc109)
    %c_ptrs_2663 = llvm.extractvalue %offs_bn_298[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2664 = llvm.extractvalue %offs_bn_298[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2665 = llvm.extractvalue %offs_bn_298[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2666 = llvm.extractvalue %offs_bn_298[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2667 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc110)
    %c_ptrs_2668 = llvm.insertvalue %c_ptrs_2663, %c_ptrs_2667[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2669 = llvm.insertvalue %c_ptrs_2664, %c_ptrs_2668[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2670 = llvm.insertvalue %c_ptrs_2665, %c_ptrs_2669[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2671 = llvm.insertvalue %c_ptrs_2666, %c_ptrs_2670[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2672 = llvm.extractvalue %offs_am_160[0] : !llvm.struct<(i32)>  loc(#loc111)
    %c_ptrs_2673 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2674 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2673[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2675 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2674[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2676 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2675[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2677 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2676[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2678 = llvm.bitcast %stride_cm : i32 to i32 loc(#loc111)
    %c_ptrs_2679 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2680 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2679[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2681 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2680[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2682 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2681[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2683 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2682[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2684 = llvm.extractvalue %c_ptrs_2683[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2685 = llvm.extractvalue %c_ptrs_2683[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2686 = llvm.extractvalue %c_ptrs_2683[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2687 = llvm.extractvalue %c_ptrs_2683[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2688 = llvm.extractvalue %c_ptrs_2677[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2689 = llvm.extractvalue %c_ptrs_2677[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2690 = llvm.extractvalue %c_ptrs_2677[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2691 = llvm.extractvalue %c_ptrs_2677[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2692 = llvm.mul %c_ptrs_2684, %c_ptrs_2688 : i32 loc(#loc111)
    %c_ptrs_2693 = llvm.mul %c_ptrs_2685, %c_ptrs_2689 : i32 loc(#loc111)
    %c_ptrs_2694 = llvm.mul %c_ptrs_2686, %c_ptrs_2690 : i32 loc(#loc111)
    %c_ptrs_2695 = llvm.mul %c_ptrs_2687, %c_ptrs_2691 : i32 loc(#loc111)
    %c_ptrs_2696 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2697 = llvm.insertvalue %c_ptrs_2692, %c_ptrs_2696[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2698 = llvm.insertvalue %c_ptrs_2693, %c_ptrs_2697[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2699 = llvm.insertvalue %c_ptrs_2694, %c_ptrs_2698[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2700 = llvm.insertvalue %c_ptrs_2695, %c_ptrs_2699[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2701 = llvm.extractvalue %c_ptrs_2700[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2702 = llvm.extractvalue %c_ptrs_2700[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2703 = llvm.extractvalue %c_ptrs_2700[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2704 = llvm.extractvalue %c_ptrs_2700[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2705 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2706 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2705[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2707 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2706[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2708 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2707[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2709 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2708[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2710 = llvm.extractvalue %offs_bn_227[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2711 = llvm.extractvalue %offs_bn_227[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2712 = llvm.extractvalue %offs_bn_227[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2713 = llvm.extractvalue %offs_bn_227[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2714 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2715 = llvm.insertvalue %c_ptrs_2710, %c_ptrs_2714[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2716 = llvm.insertvalue %c_ptrs_2711, %c_ptrs_2715[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2717 = llvm.insertvalue %c_ptrs_2712, %c_ptrs_2716[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2718 = llvm.insertvalue %c_ptrs_2713, %c_ptrs_2717[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2719 = llvm.extractvalue %c_ptrs_2718[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2720 = llvm.extractvalue %c_ptrs_2718[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2721 = llvm.extractvalue %c_ptrs_2718[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2722 = llvm.extractvalue %c_ptrs_2718[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2723 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2724 = llvm.insertvalue %c_ptrs_2719, %c_ptrs_2723[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2725 = llvm.insertvalue %c_ptrs_2720, %c_ptrs_2724[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2726 = llvm.insertvalue %c_ptrs_2721, %c_ptrs_2725[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2727 = llvm.insertvalue %c_ptrs_2722, %c_ptrs_2726[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2728 = llvm.add %c_ptrs_2662, %offs_bn_185 : i32 loc(#loc111)
    %c_ptrs_2729 = llvm.extractvalue %c_ptrs_2709[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2730 = llvm.extractvalue %c_ptrs_2709[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2731 = llvm.extractvalue %c_ptrs_2709[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2732 = llvm.extractvalue %c_ptrs_2709[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2733 = llvm.extractvalue %c_ptrs_2727[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2734 = llvm.extractvalue %c_ptrs_2727[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2735 = llvm.extractvalue %c_ptrs_2727[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2736 = llvm.extractvalue %c_ptrs_2727[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2737 = llvm.add %c_ptrs_2729, %c_ptrs_2733 : i32 loc(#loc111)
    %c_ptrs_2738 = llvm.add %c_ptrs_2730, %c_ptrs_2734 : i32 loc(#loc111)
    %c_ptrs_2739 = llvm.add %c_ptrs_2731, %c_ptrs_2735 : i32 loc(#loc111)
    %c_ptrs_2740 = llvm.add %c_ptrs_2732, %c_ptrs_2736 : i32 loc(#loc111)
    %c_ptrs_2741 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2742 = llvm.insertvalue %c_ptrs_2737, %c_ptrs_2741[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2743 = llvm.insertvalue %c_ptrs_2738, %c_ptrs_2742[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2744 = llvm.insertvalue %c_ptrs_2739, %c_ptrs_2743[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2745 = llvm.insertvalue %c_ptrs_2740, %c_ptrs_2744[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2746 = llvm.bitcast %c_ptrs_2728 : i32 to i32 loc(#loc111)
    %c_ptrs_2747 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2748 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2747[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2749 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2748[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2750 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2749[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2751 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2750[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2752 = llvm.extractvalue %c_ptrs_2751[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2753 = llvm.extractvalue %c_ptrs_2751[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2754 = llvm.extractvalue %c_ptrs_2751[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2755 = llvm.extractvalue %c_ptrs_2751[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2756 = llvm.extractvalue %c_ptrs_2745[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2757 = llvm.extractvalue %c_ptrs_2745[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2758 = llvm.extractvalue %c_ptrs_2745[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2759 = llvm.extractvalue %c_ptrs_2745[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2760 = llvm.add %c_ptrs_2752, %c_ptrs_2756 : i32 loc(#loc111)
    %c_ptrs_2761 = llvm.add %c_ptrs_2753, %c_ptrs_2757 : i32 loc(#loc111)
    %c_ptrs_2762 = llvm.add %c_ptrs_2754, %c_ptrs_2758 : i32 loc(#loc111)
    %c_ptrs_2763 = llvm.add %c_ptrs_2755, %c_ptrs_2759 : i32 loc(#loc111)
    %c_ptrs_2764 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2765 = llvm.insertvalue %c_ptrs_2760, %c_ptrs_2764[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2766 = llvm.insertvalue %c_ptrs_2761, %c_ptrs_2765[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2767 = llvm.insertvalue %c_ptrs_2762, %c_ptrs_2766[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2768 = llvm.insertvalue %c_ptrs_2763, %c_ptrs_2767[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_mask = llvm.bitcast %M : i32 to i32 loc(#loc112)
    %c_mask_2769 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc112)
    %c_mask_2770 = llvm.insertvalue %c_mask, %c_mask_2769[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2771 = llvm.insertvalue %c_mask, %c_mask_2770[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2772 = llvm.insertvalue %c_mask, %c_mask_2771[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2773 = llvm.insertvalue %c_mask, %c_mask_2772[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2774 = llvm.extractvalue %c_ptrs_2661[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2775 = llvm.extractvalue %c_ptrs_2661[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2776 = llvm.extractvalue %c_ptrs_2661[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2777 = llvm.extractvalue %c_ptrs_2661[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2778 = llvm.extractvalue %c_mask_2773[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2779 = llvm.extractvalue %c_mask_2773[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2780 = llvm.extractvalue %c_mask_2773[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2781 = llvm.extractvalue %c_mask_2773[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2782 = llvm.icmp "slt" %c_mask_2774, %c_mask_2778 : i32 loc(#loc112)
    %c_mask_2783 = llvm.icmp "slt" %c_mask_2775, %c_mask_2779 : i32 loc(#loc112)
    %c_mask_2784 = llvm.icmp "slt" %c_mask_2776, %c_mask_2780 : i32 loc(#loc112)
    %c_mask_2785 = llvm.icmp "slt" %c_mask_2777, %c_mask_2781 : i32 loc(#loc112)
    %c_mask_2786 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc112)
    %c_mask_2787 = llvm.insertvalue %c_mask_2782, %c_mask_2786[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2788 = llvm.insertvalue %c_mask_2782, %c_mask_2787[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2789 = llvm.insertvalue %c_mask_2782, %c_mask_2788[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2790 = llvm.insertvalue %c_mask_2782, %c_mask_2789[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2791 = llvm.bitcast %N : i32 to i32 loc(#loc113)
    %c_mask_2792 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc113)
    %c_mask_2793 = llvm.insertvalue %c_mask_2791, %c_mask_2792[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2794 = llvm.insertvalue %c_mask_2791, %c_mask_2793[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2795 = llvm.insertvalue %c_mask_2791, %c_mask_2794[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2796 = llvm.insertvalue %c_mask_2791, %c_mask_2795[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2797 = llvm.extractvalue %c_ptrs_2671[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2798 = llvm.extractvalue %c_ptrs_2671[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2799 = llvm.extractvalue %c_ptrs_2671[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2800 = llvm.extractvalue %c_ptrs_2671[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2801 = llvm.extractvalue %c_mask_2796[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2802 = llvm.extractvalue %c_mask_2796[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2803 = llvm.extractvalue %c_mask_2796[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2804 = llvm.extractvalue %c_mask_2796[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2805 = llvm.icmp "slt" %c_mask_2797, %c_mask_2801 : i32 loc(#loc113)
    %c_mask_2806 = llvm.icmp "slt" %c_mask_2798, %c_mask_2802 : i32 loc(#loc113)
    %c_mask_2807 = llvm.icmp "slt" %c_mask_2799, %c_mask_2803 : i32 loc(#loc113)
    %c_mask_2808 = llvm.icmp "slt" %c_mask_2800, %c_mask_2804 : i32 loc(#loc113)
    %c_mask_2809 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc113)
    %c_mask_2810 = llvm.insertvalue %c_mask_2805, %c_mask_2809[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2811 = llvm.insertvalue %c_mask_2805, %c_mask_2810[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2812 = llvm.insertvalue %c_mask_2805, %c_mask_2811[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2813 = llvm.insertvalue %c_mask_2805, %c_mask_2812[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2814 = llvm.extractvalue %c_mask_2790[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2815 = llvm.extractvalue %c_mask_2790[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2816 = llvm.extractvalue %c_mask_2790[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2817 = llvm.extractvalue %c_mask_2790[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2818 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2819 = llvm.insertvalue %c_mask_2817, %c_mask_2818[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2820 = llvm.insertvalue %c_mask_2817, %c_mask_2819[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2821 = llvm.insertvalue %c_mask_2817, %c_mask_2820[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2822 = llvm.insertvalue %c_mask_2817, %c_mask_2821[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2823 = llvm.extractvalue %c_mask_2813[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2824 = llvm.extractvalue %c_mask_2813[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2825 = llvm.extractvalue %c_mask_2813[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2826 = llvm.extractvalue %c_mask_2813[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2827 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2828 = llvm.insertvalue %c_mask_2823, %c_mask_2827[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2829 = llvm.insertvalue %c_mask_2824, %c_mask_2828[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2830 = llvm.insertvalue %c_mask_2825, %c_mask_2829[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2831 = llvm.insertvalue %c_mask_2826, %c_mask_2830[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2832 = llvm.extractvalue %c_mask_2822[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2833 = llvm.extractvalue %c_mask_2822[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2834 = llvm.extractvalue %c_mask_2822[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2835 = llvm.extractvalue %c_mask_2822[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2836 = llvm.extractvalue %c_mask_2831[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2837 = llvm.extractvalue %c_mask_2831[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2838 = llvm.extractvalue %c_mask_2831[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2839 = llvm.extractvalue %c_mask_2831[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2840 = llvm.and %c_mask_2832, %c_mask_2836 : i1 loc(#loc114)
    %c_mask_2841 = llvm.and %c_mask_2833, %c_mask_2837 : i1 loc(#loc114)
    %c_mask_2842 = llvm.and %c_mask_2834, %c_mask_2838 : i1 loc(#loc114)
    %c_mask_2843 = llvm.and %c_mask_2835, %c_mask_2839 : i1 loc(#loc114)
    %c_mask_2844 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2845 = llvm.insertvalue %c_mask_2840, %c_mask_2844[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2846 = llvm.insertvalue %c_mask_2840, %c_mask_2845[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2847 = llvm.insertvalue %c_mask_2840, %c_mask_2846[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2848 = llvm.insertvalue %c_mask_2840, %c_mask_2847[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %29 = llvm.extractvalue %c_ptrs_2768[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %30 = llvm.extractvalue %c_ptrs_2768[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %31 = llvm.extractvalue %c_ptrs_2768[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %32 = llvm.extractvalue %c_ptrs_2768[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %33 = llvm.extractvalue %c_2656[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %34 = llvm.extractvalue %c_2656[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %35 = llvm.extractvalue %c_2656[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %36 = llvm.extractvalue %c_2656[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %37 = llvm.extractvalue %c_mask_2848[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %38 = llvm.extractvalue %c_mask_2848[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %39 = llvm.extractvalue %c_mask_2848[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %40 = llvm.extractvalue %c_mask_2848[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %41 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %42 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %43 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %44 = rocdl.make.buffer.rsrc %c_ptr, %41, %43, %42 : <1> to <8> loc(#loc1)
    %45 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %46 = rocdl.workitem.id.x : i32 loc(#loc1)
    %47 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %48 = llvm.and %46, %47 : i32 loc(#loc1)
    %49 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %50 = llvm.urem %48, %49 : i32 loc(#loc1)
    %51 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %52 = llvm.and %51, %37 : i1 loc(#loc1)
    %53 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %54 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %55 = llvm.insertelement %33, %53[%54 : i32] : vector<4xf16> loc(#loc1)
    %56 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %57 = llvm.insertelement %34, %55[%56 : i32] : vector<4xf16> loc(#loc1)
    %58 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %59 = llvm.insertelement %35, %57[%58 : i32] : vector<4xf16> loc(#loc1)
    %60 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %61 = llvm.insertelement %36, %59[%60 : i32] : vector<4xf16> loc(#loc1)
    %62 = llvm.bitcast %61 : vector<4xf16> to vector<2xi32> loc(#loc1)
    %63 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %64 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %65 = llvm.mul %64, %29 : i32 loc(#loc1)
    %66 = llvm.select %52, %65, %63 : i1, i32 loc(#loc1)
    %67 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %68 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    rocdl.raw.ptr.buffer.store %62, %44, %66, %67, %68 : vector<2xi32> loc(#loc1)
    llvm.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc14 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc16 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc71 = loc("b_ptrs"(#loc4))
#loc72 = loc("a_ptrs"(#loc5))
#loc73 = loc("offs_bn"(#loc6))
#loc74 = loc("offs_am"(#loc7))
#loc75 = loc("num_pid_n"(#loc9))
#loc78 = loc("pid"(#loc13))
#loc79 = loc("num_pid_m"(#loc15))
#loc80 = loc("num_pid_in_group"(#loc17))
#loc81 = loc("group_id"(#loc18))
#loc82 = loc("first_pid_m"(#loc19))
#loc83 = loc("group_size_m"(#loc20))
#loc84 = loc("group_size_m"(#loc21))
#loc85 = loc("pid_m"(#loc22))
#loc86 = loc("pid_m"(#loc23))
#loc87 = loc("pid_m"(#loc24))
#loc88 = loc("pid_n"(#loc25))
#loc89 = loc("offs_am"(#loc34))
#loc90 = loc("offs_am"(#loc35))
#loc91 = loc("offs_am"(#loc36))
#loc92 = loc("offs_bn"(#loc37))
#loc93 = loc("offs_bn"(#loc38))
#loc94 = loc("offs_bn"(#loc39))
#loc96 = loc(callsite(#loc14 at #loc41))
#loc97 = loc(callsite(#loc16 at #loc41))
#loc98 = loc("a"(#loc42))
#loc100 = loc("b"(#loc44))
#loc101 = loc("b_ptrs"(#loc45))
#loc102 = loc("b_ptrs"(#loc46))
#loc103 = loc("a_ptrs"(#loc47))
#loc104 = loc("a"(#loc48))
#loc105 = loc("a"(#loc49))
#loc107 = loc("c"(#loc51))
#loc108 = loc("c_ptrs"(#loc52))
#loc109 = loc("c_ptrs"(#loc53))
#loc110 = loc("c_ptrs"(#loc54))
#loc111 = loc("c_ptrs"(#loc55))
#loc112 = loc("c_mask"(#loc56))
#loc113 = loc("c_mask"(#loc57))
#loc114 = loc("c_mask"(#loc58))
#loc115 = loc(callsite(#loc8 at #loc75))
#loc118 = loc(callsite(#loc14 at #loc79))
#loc119 = loc(callsite(#loc16 at #loc79))
#loc120 = loc(callsite(#loc14 at #loc75))
#loc121 = loc(callsite(#loc16 at #loc75))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#blocked = #ttg.blocked<{sizePerThread = [1, 8], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#blocked1 = #ttg.blocked<{sizePerThread = [1, 4], threadsPerWarp = [8, 8], warpsPerCTA = [8, 1], order = [1, 0]}>
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc8 = loc(unknown)
#loc10 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#mma = #ttg.amd_mfma<{version = 3, warpsPerCTA = [4, 2], instrShape = [16, 16, 16], isTransposed = true}>
#shared = #ttg.swizzled_shared<{vec = 4, perPhase = 1, maxPhase = 16, order = [1, 0]}>
#shared1 = #ttg.swizzled_shared<{vec = 1, perPhase = 1, maxPhase = 1, order = [1, 0]}>
#smem = #ttg.shared_memory
#loc60 = loc("a_ptr"(#loc))
#loc61 = loc("b_ptr"(#loc))
#loc62 = loc("c_ptr"(#loc))
#loc63 = loc("M"(#loc))
#loc64 = loc("N"(#loc))
#loc65 = loc("K"(#loc))
#loc66 = loc("stride_am"(#loc))
#loc67 = loc("stride_bk"(#loc))
#loc68 = loc("stride_cm"(#loc))
#loc69 = loc("b"(#loc2))
#loc70 = loc("a"(#loc3))
#loc76 = loc("accumulator"(#loc11))
#loc77 = loc("a_ptrs"(#loc12))
#loc95 = loc("a_ptrs"(#loc40))
#loc99 = loc("b_ptrs"(#loc43))
#loc106 = loc("accumulator"(#loc50))
#loc116 = loc(callsite(#loc10 at #loc76))
#loc117 = loc("b_ptrs"(#loc77))
#loc122 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %1 = rocdl.workitem.id.x : i32 loc(#loc1)
    %2 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %3 = llvm.and %1, %2 : i32 loc(#loc1)
    %4 = llvm.udiv %3, %0 : i32 loc(#loc1)
    %5 = rocdl.readfirstlane %4 : i32 loc(#loc1)
    %b = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_0 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2 = llvm.and %b_0, %b_1 : i32 loc(#loc69)
    %b_3 = llvm.udiv %b_2, %b : i32 loc(#loc69)
    %b_4 = rocdl.readfirstlane %b_3 : i32 loc(#loc69)
    %a = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_5 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_6 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_7 = llvm.and %a_5, %a_6 : i32 loc(#loc70)
    %a_8 = llvm.udiv %a_7, %a : i32 loc(#loc70)
    %a_9 = rocdl.readfirstlane %a_8 : i32 loc(#loc70)
    %b_10 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_11 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_12 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_13 = llvm.and %b_11, %b_12 : i32 loc(#loc69)
    %b_14 = llvm.udiv %b_13, %b_10 : i32 loc(#loc69)
    %b_15 = rocdl.readfirstlane %b_14 : i32 loc(#loc69)
    %a_16 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_17 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_18 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_19 = llvm.and %a_17, %a_18 : i32 loc(#loc70)
    %a_20 = llvm.udiv %a_19, %a_16 : i32 loc(#loc70)
    %a_21 = rocdl.readfirstlane %a_20 : i32 loc(#loc70)
    %b_22 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_23 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_24 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_25 = llvm.and %b_23, %b_24 : i32 loc(#loc69)
    %b_26 = llvm.udiv %b_25, %b_22 : i32 loc(#loc69)
    %b_27 = rocdl.readfirstlane %b_26 : i32 loc(#loc69)
    %a_28 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_29 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_30 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_31 = llvm.and %a_29, %a_30 : i32 loc(#loc70)
    %a_32 = llvm.udiv %a_31, %a_28 : i32 loc(#loc70)
    %a_33 = rocdl.readfirstlane %a_32 : i32 loc(#loc70)
    %b_34 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_35 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_36 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_37 = llvm.and %b_35, %b_36 : i32 loc(#loc69)
    %b_38 = llvm.udiv %b_37, %b_34 : i32 loc(#loc69)
    %b_39 = rocdl.readfirstlane %b_38 : i32 loc(#loc69)
    %a_40 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_41 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_42 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_43 = llvm.and %a_41, %a_42 : i32 loc(#loc70)
    %a_44 = llvm.udiv %a_43, %a_40 : i32 loc(#loc70)
    %a_45 = rocdl.readfirstlane %a_44 : i32 loc(#loc70)
    %b_ptrs = llvm.mlir.constant(64 : i32) : i32 loc(#loc71)
    %b_ptrs_46 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_ptrs_47 = llvm.mlir.constant(511 : i32) : i32 loc(#loc71)
    %b_ptrs_48 = llvm.and %b_ptrs_46, %b_ptrs_47 : i32 loc(#loc71)
    %b_ptrs_49 = llvm.udiv %b_ptrs_48, %b_ptrs : i32 loc(#loc71)
    %b_ptrs_50 = rocdl.readfirstlane %b_ptrs_49 : i32 loc(#loc71)
    %a_ptrs = llvm.mlir.constant(64 : i32) : i32 loc(#loc72)
    %a_ptrs_51 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_ptrs_52 = llvm.mlir.constant(511 : i32) : i32 loc(#loc72)
    %a_ptrs_53 = llvm.and %a_ptrs_51, %a_ptrs_52 : i32 loc(#loc72)
    %a_ptrs_54 = llvm.udiv %a_ptrs_53, %a_ptrs : i32 loc(#loc72)
    %a_ptrs_55 = rocdl.readfirstlane %a_ptrs_54 : i32 loc(#loc72)
    %offs_bn = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_56 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_57 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_58 = llvm.and %offs_bn_56, %offs_bn_57 : i32 loc(#loc73)
    %offs_bn_59 = llvm.udiv %offs_bn_58, %offs_bn : i32 loc(#loc73)
    %offs_bn_60 = rocdl.readfirstlane %offs_bn_59 : i32 loc(#loc73)
    %offs_bn_61 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_62 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_63 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_64 = llvm.and %offs_bn_62, %offs_bn_63 : i32 loc(#loc73)
    %offs_bn_65 = llvm.udiv %offs_bn_64, %offs_bn_61 : i32 loc(#loc73)
    %offs_bn_66 = rocdl.readfirstlane %offs_bn_65 : i32 loc(#loc73)
    %offs_am = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_67 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_68 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_69 = llvm.and %offs_am_67, %offs_am_68 : i32 loc(#loc74)
    %offs_am_70 = llvm.udiv %offs_am_69, %offs_am : i32 loc(#loc74)
    %offs_am_71 = rocdl.readfirstlane %offs_am_70 : i32 loc(#loc74)
    %offs_am_72 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_73 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_74 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_75 = llvm.and %offs_am_73, %offs_am_74 : i32 loc(#loc74)
    %offs_am_76 = llvm.udiv %offs_am_75, %offs_am_72 : i32 loc(#loc74)
    %offs_am_77 = rocdl.readfirstlane %offs_am_76 : i32 loc(#loc74)
    %c_ptr_78 = builtin.unrealized_conversion_cast %c_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc62)
    %b_ptr_79 = builtin.unrealized_conversion_cast %b_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc61)
    %a_ptr_80 = builtin.unrealized_conversion_cast %a_ptr : !llvm.ptr<1> to !tt.ptr<f16> loc(#loc60)
    %6 = llvm.mlir.constant(64 : i32) : i32 loc(#loc8)
    %7 = llvm.bitcast %6 : i32 to i32 loc(#loc8)
    %8 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc8)
    %9 = llvm.insertvalue %7, %8[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %10 = llvm.insertvalue %7, %9[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %11 = llvm.insertvalue %7, %10[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %12 = llvm.insertvalue %7, %11[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %13 = llvm.insertvalue %7, %12[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %14 = llvm.insertvalue %7, %13[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %15 = llvm.insertvalue %7, %14[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %16 = llvm.insertvalue %7, %15[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc8)
    %17 = llvm.mlir.constant(32 : i32) : i32 loc(#loc8)
    %18 = llvm.mlir.constant(64 : i32) : i32 loc(#loc8)
    %19 = llvm.mlir.constant(true) : i1 loc(#loc8)
    %20 = llvm.mlir.constant(0 : i32) : i32 loc(#loc8)
    %21 = llvm.mlir.constant(4 : i32) : i32 loc(#loc8)
    %22 = llvm.mlir.constant(1 : i32) : i32 loc(#loc8)
    %23 = llvm.mlir.constant(63 : i32) : i32 loc(#loc8)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc115)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc116)
    %accumulator_81 = llvm.bitcast %accumulator : f32 to f32 loc(#loc116)
    %accumulator_82 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc116)
    %accumulator_83 = llvm.insertvalue %accumulator_81, %accumulator_82[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_84 = llvm.insertvalue %accumulator_81, %accumulator_83[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_85 = llvm.insertvalue %accumulator_81, %accumulator_84[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_86 = llvm.insertvalue %accumulator_81, %accumulator_85[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc116)
    %accumulator_87 = builtin.unrealized_conversion_cast %accumulator_86 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc116)
    %accumulator_88 = builtin.unrealized_conversion_cast %accumulator_87 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc78)
    %num_pid_m = llvm.add %M, %23 : i32 loc(#loc118)
    %num_pid_m_89 = llvm.sdiv %num_pid_m, %18 : i32 loc(#loc119)
    %num_pid_n_90 = llvm.add %N, %num_pid_n : i32 loc(#loc120)
    %num_pid_n_91 = llvm.sdiv %num_pid_n_90, %17 : i32 loc(#loc121)
    %num_pid_in_group = llvm.mul %num_pid_n_91, %21 : i32 loc(#loc80)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc81)
    %first_pid_m = llvm.mul %group_id, %21 : i32 loc(#loc82)
    %group_size_m = llvm.sub %num_pid_m_89, %first_pid_m : i32 loc(#loc83)
    %group_size_m_92 = llvm.intr.smin(%group_size_m, %21) : (i32, i32) -> i32 loc(#loc84)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc85)
    %pid_m_93 = llvm.srem %pid_m, %group_size_m_92 : i32 loc(#loc86)
    %pid_m_94 = llvm.add %first_pid_m, %pid_m_93 : i32 loc(#loc87)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_92 : i32 loc(#loc88)
    llvm.intr.assume %19 : i1 loc(#loc26)
    llvm.intr.assume %19 : i1 loc(#loc27)
    llvm.intr.assume %19 : i1 loc(#loc28)
    llvm.intr.assume %19 : i1 loc(#loc29)
    llvm.intr.assume %19 : i1 loc(#loc30)
    llvm.intr.assume %19 : i1 loc(#loc31)
    llvm.intr.assume %19 : i1 loc(#loc32)
    llvm.intr.assume %19 : i1 loc(#loc33)
    %offs_am_95 = llvm.mul %pid_m_94, %18 : i32 loc(#loc89)
    %offs_am_96 = llvm.mlir.constant(0 : index) : i32 loc(#loc74)
    %offs_am_97 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_98 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_99 = llvm.and %offs_am_97, %offs_am_98 : i32 loc(#loc74)
    %offs_am_100 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_101 = llvm.urem %offs_am_99, %offs_am_100 : i32 loc(#loc74)
    %offs_am_102 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_103 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_104 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_105 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_106 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_107 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_108 = llvm.shl %offs_am_101, %offs_am_107 : i32 loc(#loc74)
    %offs_am_109 = llvm.or %offs_am_106, %offs_am_108 : i32 loc(#loc74)
    %offs_am_110 = llvm.mlir.constant(6 : i32) : i32 loc(#loc74)
    %offs_am_111 = llvm.shl %offs_am_77, %offs_am_110 : i32 loc(#loc74)
    %offs_am_112 = llvm.or %offs_am_109, %offs_am_111 : i32 loc(#loc74)
    %offs_am_113 = llvm.mlir.constant(504 : i32) : i32 loc(#loc74)
    %offs_am_114 = llvm.and %offs_am_112, %offs_am_113 : i32 loc(#loc74)
    %offs_am_115 = llvm.mlir.constant(3 : i32) : i32 loc(#loc74)
    %offs_am_116 = llvm.lshr %offs_am_114, %offs_am_115 : i32 loc(#loc74)
    %offs_am_117 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_118 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_119 = llvm.or disjoint %offs_am_116, %offs_am_118 : i32 loc(#loc74)
    %offs_am_120 = llvm.xor %offs_am_105, %offs_am_119 : i32 loc(#loc74)
    %offs_am_121 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_122 = llvm.xor %offs_am_120, %offs_am_121 : i32 loc(#loc74)
    %offs_am_123 = llvm.add %offs_am_122, %offs_am_96 : i32 loc(#loc74)
    %offs_am_124 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc74)
    %offs_am_125 = llvm.insertvalue %offs_am_123, %offs_am_124[0] : !llvm.struct<(i32)>  loc(#loc74)
    %offs_am_126 = llvm.mlir.constant(0 : index) : i32 loc(#loc74)
    %offs_am_127 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_128 = llvm.mlir.constant(511 : i32) : i32 loc(#loc74)
    %offs_am_129 = llvm.and %offs_am_127, %offs_am_128 : i32 loc(#loc74)
    %offs_am_130 = llvm.mlir.constant(64 : i32) : i32 loc(#loc74)
    %offs_am_131 = llvm.urem %offs_am_129, %offs_am_130 : i32 loc(#loc74)
    %offs_am_132 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_133 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_134 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_135 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_136 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_137 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_138 = llvm.shl %offs_am_131, %offs_am_137 : i32 loc(#loc74)
    %offs_am_139 = llvm.or %offs_am_136, %offs_am_138 : i32 loc(#loc74)
    %offs_am_140 = llvm.mlir.constant(6 : i32) : i32 loc(#loc74)
    %offs_am_141 = llvm.shl %offs_am_71, %offs_am_140 : i32 loc(#loc74)
    %offs_am_142 = llvm.or %offs_am_139, %offs_am_141 : i32 loc(#loc74)
    %offs_am_143 = llvm.mlir.constant(15 : i32) : i32 loc(#loc74)
    %offs_am_144 = llvm.and %offs_am_142, %offs_am_143 : i32 loc(#loc74)
    %offs_am_145 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_146 = llvm.lshr %offs_am_144, %offs_am_145 : i32 loc(#loc74)
    %offs_am_147 = llvm.mlir.constant(384 : i32) : i32 loc(#loc74)
    %offs_am_148 = llvm.and %offs_am_142, %offs_am_147 : i32 loc(#loc74)
    %offs_am_149 = llvm.mlir.constant(3 : i32) : i32 loc(#loc74)
    %offs_am_150 = llvm.lshr %offs_am_148, %offs_am_149 : i32 loc(#loc74)
    %offs_am_151 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_152 = llvm.or disjoint %offs_am_146, %offs_am_150 : i32 loc(#loc74)
    %offs_am_153 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_154 = llvm.or disjoint %offs_am_152, %offs_am_153 : i32 loc(#loc74)
    %offs_am_155 = llvm.xor %offs_am_135, %offs_am_154 : i32 loc(#loc74)
    %offs_am_156 = llvm.mlir.constant(0 : i32) : i32 loc(#loc74)
    %offs_am_157 = llvm.xor %offs_am_155, %offs_am_156 : i32 loc(#loc74)
    %offs_am_158 = llvm.add %offs_am_157, %offs_am_126 : i32 loc(#loc74)
    %offs_am_159 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc74)
    %offs_am_160 = llvm.insertvalue %offs_am_158, %offs_am_159[0] : !llvm.struct<(i32)>  loc(#loc74)
    %offs_am_161 = llvm.bitcast %offs_am_95 : i32 to i32 loc(#loc90)
    %offs_am_162 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_163 = llvm.insertvalue %offs_am_161, %offs_am_162[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_164 = llvm.bitcast %offs_am_95 : i32 to i32 loc(#loc90)
    %offs_am_165 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_166 = llvm.insertvalue %offs_am_164, %offs_am_165[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_167 = llvm.extractvalue %offs_am_163[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_168 = llvm.extractvalue %offs_am_125[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_169 = llvm.add %offs_am_167, %offs_am_168 : i32 loc(#loc90)
    %offs_am_170 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_171 = llvm.insertvalue %offs_am_169, %offs_am_170[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_172 = llvm.extractvalue %offs_am_166[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_173 = llvm.extractvalue %offs_am_160[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_174 = llvm.add %offs_am_172, %offs_am_173 : i32 loc(#loc90)
    %offs_am_175 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc90)
    %offs_am_176 = llvm.insertvalue %offs_am_174, %offs_am_175[0] : !llvm.struct<(i32)>  loc(#loc90)
    %offs_am_177 = llvm.bitcast %M : i32 to i32 loc(#loc91)
    %offs_am_178 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc91)
    %offs_am_179 = llvm.insertvalue %offs_am_177, %offs_am_178[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_180 = llvm.extractvalue %offs_am_171[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_181 = llvm.extractvalue %offs_am_179[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_am_182 = llvm.srem %offs_am_180, %offs_am_181 : i32 loc(#loc91)
    %offs_am_183 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc91)
    %offs_am_184 = llvm.insertvalue %offs_am_182, %offs_am_183[0] : !llvm.struct<(i32)>  loc(#loc91)
    %offs_bn_185 = llvm.mul %pid_n, %17 : i32 loc(#loc92)
    %offs_bn_186 = llvm.mlir.constant(0 : index) : i32 loc(#loc73)
    %offs_bn_187 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_188 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_189 = llvm.and %offs_bn_187, %offs_bn_188 : i32 loc(#loc73)
    %offs_bn_190 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_191 = llvm.urem %offs_bn_189, %offs_bn_190 : i32 loc(#loc73)
    %offs_bn_192 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_193 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_194 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_195 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_196 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_197 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_198 = llvm.shl %offs_bn_191, %offs_bn_197 : i32 loc(#loc73)
    %offs_bn_199 = llvm.or %offs_bn_196, %offs_bn_198 : i32 loc(#loc73)
    %offs_bn_200 = llvm.mlir.constant(6 : i32) : i32 loc(#loc73)
    %offs_bn_201 = llvm.shl %offs_bn_66, %offs_bn_200 : i32 loc(#loc73)
    %offs_bn_202 = llvm.or %offs_bn_199, %offs_bn_201 : i32 loc(#loc73)
    %offs_bn_203 = llvm.mlir.constant(112 : i32) : i32 loc(#loc73)
    %offs_bn_204 = llvm.and %offs_bn_202, %offs_bn_203 : i32 loc(#loc73)
    %offs_bn_205 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_206 = llvm.lshr %offs_bn_204, %offs_bn_205 : i32 loc(#loc73)
    %offs_bn_207 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_208 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_209 = llvm.or disjoint %offs_bn_208, %offs_bn_206 : i32 loc(#loc73)
    %offs_bn_210 = llvm.xor %offs_bn_195, %offs_bn_209 : i32 loc(#loc73)
    %offs_bn_211 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_212 = llvm.xor %offs_bn_210, %offs_bn_211 : i32 loc(#loc73)
    %offs_bn_213 = llvm.mlir.constant(1 : i32) : i32 loc(#loc73)
    %offs_bn_214 = llvm.xor %offs_bn_210, %offs_bn_213 : i32 loc(#loc73)
    %offs_bn_215 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_216 = llvm.xor %offs_bn_210, %offs_bn_215 : i32 loc(#loc73)
    %offs_bn_217 = llvm.mlir.constant(3 : i32) : i32 loc(#loc73)
    %offs_bn_218 = llvm.xor %offs_bn_210, %offs_bn_217 : i32 loc(#loc73)
    %offs_bn_219 = llvm.add %offs_bn_212, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_220 = llvm.add %offs_bn_214, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_221 = llvm.add %offs_bn_216, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_222 = llvm.add %offs_bn_218, %offs_bn_186 : i32 loc(#loc73)
    %offs_bn_223 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc73)
    %offs_bn_224 = llvm.insertvalue %offs_bn_219, %offs_bn_223[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_225 = llvm.insertvalue %offs_bn_220, %offs_bn_224[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_226 = llvm.insertvalue %offs_bn_221, %offs_bn_225[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_227 = llvm.insertvalue %offs_bn_222, %offs_bn_226[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_228 = llvm.mlir.constant(0 : index) : i32 loc(#loc73)
    %offs_bn_229 = rocdl.workitem.id.x : i32 loc(#loc73)
    %offs_bn_230 = llvm.mlir.constant(511 : i32) : i32 loc(#loc73)
    %offs_bn_231 = llvm.and %offs_bn_229, %offs_bn_230 : i32 loc(#loc73)
    %offs_bn_232 = llvm.mlir.constant(64 : i32) : i32 loc(#loc73)
    %offs_bn_233 = llvm.urem %offs_bn_231, %offs_bn_232 : i32 loc(#loc73)
    %offs_bn_234 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_235 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_236 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_237 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_238 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_239 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_240 = llvm.shl %offs_bn_233, %offs_bn_239 : i32 loc(#loc73)
    %offs_bn_241 = llvm.or %offs_bn_238, %offs_bn_240 : i32 loc(#loc73)
    %offs_bn_242 = llvm.mlir.constant(6 : i32) : i32 loc(#loc73)
    %offs_bn_243 = llvm.shl %offs_bn_60, %offs_bn_242 : i32 loc(#loc73)
    %offs_bn_244 = llvm.or %offs_bn_241, %offs_bn_243 : i32 loc(#loc73)
    %offs_bn_245 = llvm.mlir.constant(7 : i32) : i32 loc(#loc73)
    %offs_bn_246 = llvm.and %offs_bn_244, %offs_bn_245 : i32 loc(#loc73)
    %offs_bn_247 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_248 = llvm.shl %offs_bn_246, %offs_bn_247 : i32 loc(#loc73)
    %offs_bn_249 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_250 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_251 = llvm.or disjoint %offs_bn_248, %offs_bn_250 : i32 loc(#loc73)
    %offs_bn_252 = llvm.xor %offs_bn_237, %offs_bn_251 : i32 loc(#loc73)
    %offs_bn_253 = llvm.mlir.constant(0 : i32) : i32 loc(#loc73)
    %offs_bn_254 = llvm.xor %offs_bn_252, %offs_bn_253 : i32 loc(#loc73)
    %offs_bn_255 = llvm.mlir.constant(1 : i32) : i32 loc(#loc73)
    %offs_bn_256 = llvm.xor %offs_bn_252, %offs_bn_255 : i32 loc(#loc73)
    %offs_bn_257 = llvm.mlir.constant(2 : i32) : i32 loc(#loc73)
    %offs_bn_258 = llvm.xor %offs_bn_252, %offs_bn_257 : i32 loc(#loc73)
    %offs_bn_259 = llvm.mlir.constant(3 : i32) : i32 loc(#loc73)
    %offs_bn_260 = llvm.xor %offs_bn_252, %offs_bn_259 : i32 loc(#loc73)
    %offs_bn_261 = llvm.add %offs_bn_254, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_262 = llvm.add %offs_bn_256, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_263 = llvm.add %offs_bn_258, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_264 = llvm.add %offs_bn_260, %offs_bn_228 : i32 loc(#loc73)
    %offs_bn_265 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc73)
    %offs_bn_266 = llvm.insertvalue %offs_bn_261, %offs_bn_265[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_267 = llvm.insertvalue %offs_bn_262, %offs_bn_266[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_268 = llvm.insertvalue %offs_bn_263, %offs_bn_267[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_269 = llvm.insertvalue %offs_bn_264, %offs_bn_268[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc73)
    %offs_bn_270 = llvm.bitcast %offs_bn_185 : i32 to i32 loc(#loc93)
    %offs_bn_271 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_272 = llvm.insertvalue %offs_bn_270, %offs_bn_271[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_273 = llvm.insertvalue %offs_bn_270, %offs_bn_272[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_274 = llvm.insertvalue %offs_bn_270, %offs_bn_273[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_275 = llvm.insertvalue %offs_bn_270, %offs_bn_274[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_276 = llvm.bitcast %offs_bn_185 : i32 to i32 loc(#loc93)
    %offs_bn_277 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_278 = llvm.insertvalue %offs_bn_276, %offs_bn_277[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_279 = llvm.insertvalue %offs_bn_276, %offs_bn_278[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_280 = llvm.insertvalue %offs_bn_276, %offs_bn_279[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_281 = llvm.insertvalue %offs_bn_276, %offs_bn_280[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_282 = llvm.extractvalue %offs_bn_275[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_283 = llvm.extractvalue %offs_bn_275[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_284 = llvm.extractvalue %offs_bn_275[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_285 = llvm.extractvalue %offs_bn_275[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_286 = llvm.extractvalue %offs_bn_227[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_287 = llvm.extractvalue %offs_bn_227[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_288 = llvm.extractvalue %offs_bn_227[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_289 = llvm.extractvalue %offs_bn_227[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_290 = llvm.add %offs_bn_282, %offs_bn_286 : i32 loc(#loc93)
    %offs_bn_291 = llvm.add %offs_bn_283, %offs_bn_287 : i32 loc(#loc93)
    %offs_bn_292 = llvm.add %offs_bn_284, %offs_bn_288 : i32 loc(#loc93)
    %offs_bn_293 = llvm.add %offs_bn_285, %offs_bn_289 : i32 loc(#loc93)
    %offs_bn_294 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_295 = llvm.insertvalue %offs_bn_290, %offs_bn_294[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_296 = llvm.insertvalue %offs_bn_291, %offs_bn_295[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_297 = llvm.insertvalue %offs_bn_292, %offs_bn_296[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_298 = llvm.insertvalue %offs_bn_293, %offs_bn_297[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_299 = llvm.extractvalue %offs_bn_281[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_300 = llvm.extractvalue %offs_bn_281[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_301 = llvm.extractvalue %offs_bn_281[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_302 = llvm.extractvalue %offs_bn_281[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_303 = llvm.extractvalue %offs_bn_269[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_304 = llvm.extractvalue %offs_bn_269[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_305 = llvm.extractvalue %offs_bn_269[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_306 = llvm.extractvalue %offs_bn_269[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_307 = llvm.add %offs_bn_299, %offs_bn_303 : i32 loc(#loc93)
    %offs_bn_308 = llvm.add %offs_bn_300, %offs_bn_304 : i32 loc(#loc93)
    %offs_bn_309 = llvm.add %offs_bn_301, %offs_bn_305 : i32 loc(#loc93)
    %offs_bn_310 = llvm.add %offs_bn_302, %offs_bn_306 : i32 loc(#loc93)
    %offs_bn_311 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc93)
    %offs_bn_312 = llvm.insertvalue %offs_bn_307, %offs_bn_311[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_313 = llvm.insertvalue %offs_bn_308, %offs_bn_312[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_314 = llvm.insertvalue %offs_bn_309, %offs_bn_313[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_315 = llvm.insertvalue %offs_bn_310, %offs_bn_314[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc93)
    %offs_bn_316 = llvm.bitcast %N : i32 to i32 loc(#loc94)
    %offs_bn_317 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc94)
    %offs_bn_318 = llvm.insertvalue %offs_bn_316, %offs_bn_317[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_319 = llvm.insertvalue %offs_bn_316, %offs_bn_318[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_320 = llvm.insertvalue %offs_bn_316, %offs_bn_319[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_321 = llvm.insertvalue %offs_bn_316, %offs_bn_320[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_322 = llvm.extractvalue %offs_bn_315[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_323 = llvm.extractvalue %offs_bn_315[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_324 = llvm.extractvalue %offs_bn_315[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_325 = llvm.extractvalue %offs_bn_315[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_326 = llvm.extractvalue %offs_bn_321[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_327 = llvm.extractvalue %offs_bn_321[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_328 = llvm.extractvalue %offs_bn_321[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_329 = llvm.extractvalue %offs_bn_321[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_330 = llvm.srem %offs_bn_322, %offs_bn_326 : i32 loc(#loc94)
    %offs_bn_331 = llvm.srem %offs_bn_323, %offs_bn_327 : i32 loc(#loc94)
    %offs_bn_332 = llvm.srem %offs_bn_324, %offs_bn_328 : i32 loc(#loc94)
    %offs_bn_333 = llvm.srem %offs_bn_325, %offs_bn_329 : i32 loc(#loc94)
    %offs_bn_334 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc94)
    %offs_bn_335 = llvm.insertvalue %offs_bn_330, %offs_bn_334[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_336 = llvm.insertvalue %offs_bn_331, %offs_bn_335[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_337 = llvm.insertvalue %offs_bn_332, %offs_bn_336[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %offs_bn_338 = llvm.insertvalue %offs_bn_333, %offs_bn_337[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc94)
    %a_ptrs_339 = llvm.mlir.constant(0 : index) : i32 loc(#loc72)
    %a_ptrs_340 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_ptrs_341 = llvm.mlir.constant(511 : i32) : i32 loc(#loc72)
    %a_ptrs_342 = llvm.and %a_ptrs_340, %a_ptrs_341 : i32 loc(#loc72)
    %a_ptrs_343 = llvm.mlir.constant(64 : i32) : i32 loc(#loc72)
    %a_ptrs_344 = llvm.urem %a_ptrs_342, %a_ptrs_343 : i32 loc(#loc72)
    %a_ptrs_345 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_346 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_347 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_348 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_349 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_350 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_351 = llvm.shl %a_ptrs_344, %a_ptrs_350 : i32 loc(#loc72)
    %a_ptrs_352 = llvm.or %a_ptrs_349, %a_ptrs_351 : i32 loc(#loc72)
    %a_ptrs_353 = llvm.mlir.constant(6 : i32) : i32 loc(#loc72)
    %a_ptrs_354 = llvm.shl %a_ptrs_55, %a_ptrs_353 : i32 loc(#loc72)
    %a_ptrs_355 = llvm.or %a_ptrs_352, %a_ptrs_354 : i32 loc(#loc72)
    %a_ptrs_356 = llvm.mlir.constant(7 : i32) : i32 loc(#loc72)
    %a_ptrs_357 = llvm.and %a_ptrs_355, %a_ptrs_356 : i32 loc(#loc72)
    %a_ptrs_358 = llvm.mlir.constant(3 : i32) : i32 loc(#loc72)
    %a_ptrs_359 = llvm.shl %a_ptrs_357, %a_ptrs_358 : i32 loc(#loc72)
    %a_ptrs_360 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_361 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_362 = llvm.or disjoint %a_ptrs_359, %a_ptrs_361 : i32 loc(#loc72)
    %a_ptrs_363 = llvm.xor %a_ptrs_348, %a_ptrs_362 : i32 loc(#loc72)
    %a_ptrs_364 = llvm.mlir.constant(0 : i32) : i32 loc(#loc72)
    %a_ptrs_365 = llvm.xor %a_ptrs_363, %a_ptrs_364 : i32 loc(#loc72)
    %a_ptrs_366 = llvm.mlir.constant(1 : i32) : i32 loc(#loc72)
    %a_ptrs_367 = llvm.xor %a_ptrs_363, %a_ptrs_366 : i32 loc(#loc72)
    %a_ptrs_368 = llvm.mlir.constant(2 : i32) : i32 loc(#loc72)
    %a_ptrs_369 = llvm.xor %a_ptrs_363, %a_ptrs_368 : i32 loc(#loc72)
    %a_ptrs_370 = llvm.mlir.constant(3 : i32) : i32 loc(#loc72)
    %a_ptrs_371 = llvm.xor %a_ptrs_363, %a_ptrs_370 : i32 loc(#loc72)
    %a_ptrs_372 = llvm.mlir.constant(4 : i32) : i32 loc(#loc72)
    %a_ptrs_373 = llvm.xor %a_ptrs_363, %a_ptrs_372 : i32 loc(#loc72)
    %a_ptrs_374 = llvm.mlir.constant(5 : i32) : i32 loc(#loc72)
    %a_ptrs_375 = llvm.xor %a_ptrs_363, %a_ptrs_374 : i32 loc(#loc72)
    %a_ptrs_376 = llvm.mlir.constant(6 : i32) : i32 loc(#loc72)
    %a_ptrs_377 = llvm.xor %a_ptrs_363, %a_ptrs_376 : i32 loc(#loc72)
    %a_ptrs_378 = llvm.mlir.constant(7 : i32) : i32 loc(#loc72)
    %a_ptrs_379 = llvm.xor %a_ptrs_363, %a_ptrs_378 : i32 loc(#loc72)
    %a_ptrs_380 = llvm.add %a_ptrs_365, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_381 = llvm.add %a_ptrs_367, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_382 = llvm.add %a_ptrs_369, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_383 = llvm.add %a_ptrs_371, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_384 = llvm.add %a_ptrs_373, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_385 = llvm.add %a_ptrs_375, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_386 = llvm.add %a_ptrs_377, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_387 = llvm.add %a_ptrs_379, %a_ptrs_339 : i32 loc(#loc72)
    %a_ptrs_388 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc72)
    %a_ptrs_389 = llvm.insertvalue %a_ptrs_380, %a_ptrs_388[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_390 = llvm.insertvalue %a_ptrs_381, %a_ptrs_389[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_391 = llvm.insertvalue %a_ptrs_382, %a_ptrs_390[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_392 = llvm.insertvalue %a_ptrs_383, %a_ptrs_391[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_393 = llvm.insertvalue %a_ptrs_384, %a_ptrs_392[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_394 = llvm.insertvalue %a_ptrs_385, %a_ptrs_393[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_395 = llvm.insertvalue %a_ptrs_386, %a_ptrs_394[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_396 = llvm.insertvalue %a_ptrs_387, %a_ptrs_395[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_397 = llvm.extractvalue %a_ptrs_396[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_398 = llvm.extractvalue %a_ptrs_396[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_399 = llvm.extractvalue %a_ptrs_396[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_400 = llvm.extractvalue %a_ptrs_396[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_401 = llvm.extractvalue %a_ptrs_396[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_402 = llvm.extractvalue %a_ptrs_396[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_403 = llvm.extractvalue %a_ptrs_396[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_404 = llvm.extractvalue %a_ptrs_396[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_405 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc72)
    %a_ptrs_406 = llvm.insertvalue %a_ptrs_397, %a_ptrs_405[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_407 = llvm.insertvalue %a_ptrs_398, %a_ptrs_406[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_408 = llvm.insertvalue %a_ptrs_399, %a_ptrs_407[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_409 = llvm.insertvalue %a_ptrs_400, %a_ptrs_408[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_410 = llvm.insertvalue %a_ptrs_401, %a_ptrs_409[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_411 = llvm.insertvalue %a_ptrs_402, %a_ptrs_410[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_412 = llvm.insertvalue %a_ptrs_403, %a_ptrs_411[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_413 = llvm.insertvalue %a_ptrs_404, %a_ptrs_412[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc72)
    %a_ptrs_414 = llvm.extractvalue %offs_am_184[0] : !llvm.struct<(i32)>  loc(#loc95)
    %a_ptrs_415 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_416 = llvm.insertvalue %a_ptrs_414, %a_ptrs_415[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_417 = llvm.insertvalue %a_ptrs_414, %a_ptrs_416[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_418 = llvm.insertvalue %a_ptrs_414, %a_ptrs_417[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_419 = llvm.insertvalue %a_ptrs_414, %a_ptrs_418[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_420 = llvm.insertvalue %a_ptrs_414, %a_ptrs_419[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_421 = llvm.insertvalue %a_ptrs_414, %a_ptrs_420[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_422 = llvm.insertvalue %a_ptrs_414, %a_ptrs_421[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_423 = llvm.insertvalue %a_ptrs_414, %a_ptrs_422[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_424 = llvm.bitcast %stride_am : i32 to i32 loc(#loc95)
    %a_ptrs_425 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_426 = llvm.insertvalue %a_ptrs_424, %a_ptrs_425[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_427 = llvm.insertvalue %a_ptrs_424, %a_ptrs_426[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_428 = llvm.insertvalue %a_ptrs_424, %a_ptrs_427[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_429 = llvm.insertvalue %a_ptrs_424, %a_ptrs_428[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_430 = llvm.insertvalue %a_ptrs_424, %a_ptrs_429[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_431 = llvm.insertvalue %a_ptrs_424, %a_ptrs_430[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_432 = llvm.insertvalue %a_ptrs_424, %a_ptrs_431[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_433 = llvm.insertvalue %a_ptrs_424, %a_ptrs_432[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_434 = llvm.extractvalue %a_ptrs_423[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_435 = llvm.extractvalue %a_ptrs_423[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_436 = llvm.extractvalue %a_ptrs_423[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_437 = llvm.extractvalue %a_ptrs_423[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_438 = llvm.extractvalue %a_ptrs_423[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_439 = llvm.extractvalue %a_ptrs_423[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_440 = llvm.extractvalue %a_ptrs_423[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_441 = llvm.extractvalue %a_ptrs_423[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_442 = llvm.extractvalue %a_ptrs_433[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_443 = llvm.extractvalue %a_ptrs_433[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_444 = llvm.extractvalue %a_ptrs_433[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_445 = llvm.extractvalue %a_ptrs_433[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_446 = llvm.extractvalue %a_ptrs_433[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_447 = llvm.extractvalue %a_ptrs_433[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_448 = llvm.extractvalue %a_ptrs_433[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_449 = llvm.extractvalue %a_ptrs_433[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_450 = llvm.mul %a_ptrs_434, %a_ptrs_442 : i32 loc(#loc95)
    %a_ptrs_451 = llvm.mul %a_ptrs_435, %a_ptrs_443 : i32 loc(#loc95)
    %a_ptrs_452 = llvm.mul %a_ptrs_436, %a_ptrs_444 : i32 loc(#loc95)
    %a_ptrs_453 = llvm.mul %a_ptrs_437, %a_ptrs_445 : i32 loc(#loc95)
    %a_ptrs_454 = llvm.mul %a_ptrs_438, %a_ptrs_446 : i32 loc(#loc95)
    %a_ptrs_455 = llvm.mul %a_ptrs_439, %a_ptrs_447 : i32 loc(#loc95)
    %a_ptrs_456 = llvm.mul %a_ptrs_440, %a_ptrs_448 : i32 loc(#loc95)
    %a_ptrs_457 = llvm.mul %a_ptrs_441, %a_ptrs_449 : i32 loc(#loc95)
    %a_ptrs_458 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_459 = llvm.insertvalue %a_ptrs_450, %a_ptrs_458[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_460 = llvm.insertvalue %a_ptrs_451, %a_ptrs_459[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_461 = llvm.insertvalue %a_ptrs_452, %a_ptrs_460[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_462 = llvm.insertvalue %a_ptrs_453, %a_ptrs_461[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_463 = llvm.insertvalue %a_ptrs_454, %a_ptrs_462[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_464 = llvm.insertvalue %a_ptrs_455, %a_ptrs_463[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_465 = llvm.insertvalue %a_ptrs_456, %a_ptrs_464[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_466 = llvm.insertvalue %a_ptrs_457, %a_ptrs_465[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_467 = llvm.extractvalue %a_ptrs_466[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_468 = llvm.extractvalue %a_ptrs_466[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_469 = llvm.extractvalue %a_ptrs_466[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_470 = llvm.extractvalue %a_ptrs_466[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_471 = llvm.extractvalue %a_ptrs_466[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_472 = llvm.extractvalue %a_ptrs_466[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_473 = llvm.extractvalue %a_ptrs_466[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_474 = llvm.extractvalue %a_ptrs_466[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_475 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_476 = llvm.insertvalue %a_ptrs_474, %a_ptrs_475[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_477 = llvm.insertvalue %a_ptrs_474, %a_ptrs_476[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_478 = llvm.insertvalue %a_ptrs_474, %a_ptrs_477[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_479 = llvm.insertvalue %a_ptrs_474, %a_ptrs_478[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_480 = llvm.insertvalue %a_ptrs_474, %a_ptrs_479[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_481 = llvm.insertvalue %a_ptrs_474, %a_ptrs_480[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_482 = llvm.insertvalue %a_ptrs_474, %a_ptrs_481[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_483 = llvm.insertvalue %a_ptrs_474, %a_ptrs_482[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_484 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_485 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_486 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_487 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_488 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_489 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_490 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_491 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_492 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_493 = llvm.insertvalue %a_ptrs_484, %a_ptrs_492[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_494 = llvm.insertvalue %a_ptrs_485, %a_ptrs_493[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_495 = llvm.insertvalue %a_ptrs_486, %a_ptrs_494[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_496 = llvm.insertvalue %a_ptrs_487, %a_ptrs_495[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_497 = llvm.insertvalue %a_ptrs_488, %a_ptrs_496[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_498 = llvm.insertvalue %a_ptrs_489, %a_ptrs_497[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_499 = llvm.insertvalue %a_ptrs_490, %a_ptrs_498[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_500 = llvm.insertvalue %a_ptrs_491, %a_ptrs_499[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_501 = llvm.extractvalue %a_ptrs_483[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_502 = llvm.extractvalue %a_ptrs_483[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_503 = llvm.extractvalue %a_ptrs_483[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_504 = llvm.extractvalue %a_ptrs_483[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_505 = llvm.extractvalue %a_ptrs_483[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_506 = llvm.extractvalue %a_ptrs_483[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_507 = llvm.extractvalue %a_ptrs_483[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_508 = llvm.extractvalue %a_ptrs_483[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_509 = llvm.extractvalue %a_ptrs_500[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_510 = llvm.extractvalue %a_ptrs_500[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_511 = llvm.extractvalue %a_ptrs_500[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_512 = llvm.extractvalue %a_ptrs_500[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_513 = llvm.extractvalue %a_ptrs_500[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_514 = llvm.extractvalue %a_ptrs_500[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_515 = llvm.extractvalue %a_ptrs_500[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_516 = llvm.extractvalue %a_ptrs_500[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_517 = llvm.add %a_ptrs_501, %a_ptrs_509 : i32 loc(#loc95)
    %a_ptrs_518 = llvm.add %a_ptrs_502, %a_ptrs_510 : i32 loc(#loc95)
    %a_ptrs_519 = llvm.add %a_ptrs_503, %a_ptrs_511 : i32 loc(#loc95)
    %a_ptrs_520 = llvm.add %a_ptrs_504, %a_ptrs_512 : i32 loc(#loc95)
    %a_ptrs_521 = llvm.add %a_ptrs_505, %a_ptrs_513 : i32 loc(#loc95)
    %a_ptrs_522 = llvm.add %a_ptrs_506, %a_ptrs_514 : i32 loc(#loc95)
    %a_ptrs_523 = llvm.add %a_ptrs_507, %a_ptrs_515 : i32 loc(#loc95)
    %a_ptrs_524 = llvm.add %a_ptrs_508, %a_ptrs_516 : i32 loc(#loc95)
    %a_ptrs_525 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc95)
    %a_ptrs_526 = llvm.insertvalue %a_ptrs_517, %a_ptrs_525[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_527 = llvm.insertvalue %a_ptrs_518, %a_ptrs_526[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_528 = llvm.insertvalue %a_ptrs_519, %a_ptrs_527[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_529 = llvm.insertvalue %a_ptrs_520, %a_ptrs_528[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_530 = llvm.insertvalue %a_ptrs_521, %a_ptrs_529[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_531 = llvm.insertvalue %a_ptrs_522, %a_ptrs_530[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_532 = llvm.insertvalue %a_ptrs_523, %a_ptrs_531[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_533 = llvm.insertvalue %a_ptrs_524, %a_ptrs_532[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc95)
    %a_ptrs_534 = builtin.unrealized_conversion_cast %a_ptrs_533 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc95)
    %accumulator_535 = builtin.unrealized_conversion_cast %a_ptrs_534 : tensor<64x64xi32, #blocked> to !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc122)
    %24 = llvm.add %K, %23 : i32 loc(#loc96)
    %25 = llvm.sdiv %24, %18 : i32 loc(#loc97)
    %accumulator_536 = llvm.icmp "sgt" %25, %20 : i32 loc(#loc122)
    %accumulator_537 = llvm.bitcast %accumulator_536 : i1 to i1 loc(#loc122)
    %accumulator_538 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc122)
    %accumulator_539 = llvm.insertvalue %accumulator_537, %accumulator_538[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_540 = llvm.insertvalue %accumulator_537, %accumulator_539[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_541 = llvm.insertvalue %accumulator_537, %accumulator_540[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_542 = llvm.insertvalue %accumulator_537, %accumulator_541[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_543 = llvm.insertvalue %accumulator_537, %accumulator_542[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_544 = llvm.insertvalue %accumulator_537, %accumulator_543[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_545 = llvm.insertvalue %accumulator_537, %accumulator_544[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_546 = llvm.insertvalue %accumulator_537, %accumulator_545[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %a_547 = llvm.bitcast %K : i32 to i32 loc(#loc98)
    %a_548 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc98)
    %a_549 = llvm.insertvalue %a_547, %a_548[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_550 = llvm.insertvalue %a_547, %a_549[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_551 = llvm.insertvalue %a_547, %a_550[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_552 = llvm.insertvalue %a_547, %a_551[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_553 = llvm.insertvalue %a_547, %a_552[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_554 = llvm.insertvalue %a_547, %a_553[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_555 = llvm.insertvalue %a_547, %a_554[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_556 = llvm.insertvalue %a_547, %a_555[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_557 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_558 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_559 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_560 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_561 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_562 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_563 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_564 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_565 = llvm.extractvalue %a_556[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_566 = llvm.extractvalue %a_556[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_567 = llvm.extractvalue %a_556[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_568 = llvm.extractvalue %a_556[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_569 = llvm.extractvalue %a_556[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_570 = llvm.extractvalue %a_556[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_571 = llvm.extractvalue %a_556[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_572 = llvm.extractvalue %a_556[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_573 = llvm.icmp "slt" %a_557, %a_565 : i32 loc(#loc98)
    %a_574 = llvm.icmp "slt" %a_558, %a_566 : i32 loc(#loc98)
    %a_575 = llvm.icmp "slt" %a_559, %a_567 : i32 loc(#loc98)
    %a_576 = llvm.icmp "slt" %a_560, %a_568 : i32 loc(#loc98)
    %a_577 = llvm.icmp "slt" %a_561, %a_569 : i32 loc(#loc98)
    %a_578 = llvm.icmp "slt" %a_562, %a_570 : i32 loc(#loc98)
    %a_579 = llvm.icmp "slt" %a_563, %a_571 : i32 loc(#loc98)
    %a_580 = llvm.icmp "slt" %a_564, %a_572 : i32 loc(#loc98)
    %a_581 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc98)
    %a_582 = llvm.insertvalue %a_573, %a_581[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_583 = llvm.insertvalue %a_573, %a_582[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_584 = llvm.insertvalue %a_573, %a_583[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_585 = llvm.insertvalue %a_573, %a_584[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_586 = llvm.insertvalue %a_573, %a_585[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_587 = llvm.insertvalue %a_573, %a_586[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_588 = llvm.insertvalue %a_573, %a_587[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_589 = llvm.insertvalue %a_573, %a_588[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_590 = llvm.extractvalue %a_589[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_591 = llvm.extractvalue %a_589[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_592 = llvm.extractvalue %a_589[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_593 = llvm.extractvalue %a_589[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_594 = llvm.extractvalue %a_589[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_595 = llvm.extractvalue %a_589[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_596 = llvm.extractvalue %a_589[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_597 = llvm.extractvalue %a_589[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_598 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc70)
    %a_599 = llvm.insertvalue %a_590, %a_598[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_600 = llvm.insertvalue %a_591, %a_599[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_601 = llvm.insertvalue %a_592, %a_600[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_602 = llvm.insertvalue %a_593, %a_601[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_603 = llvm.insertvalue %a_594, %a_602[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_604 = llvm.insertvalue %a_595, %a_603[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_605 = llvm.insertvalue %a_596, %a_604[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_606 = llvm.insertvalue %a_597, %a_605[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %accumulator_607 = llvm.extractvalue %accumulator_546[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_608 = llvm.extractvalue %accumulator_546[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_609 = llvm.extractvalue %accumulator_546[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_610 = llvm.extractvalue %accumulator_546[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_611 = llvm.extractvalue %accumulator_546[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_612 = llvm.extractvalue %accumulator_546[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_613 = llvm.extractvalue %accumulator_546[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_614 = llvm.extractvalue %accumulator_546[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_615 = llvm.extractvalue %a_606[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_616 = llvm.extractvalue %a_606[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_617 = llvm.extractvalue %a_606[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_618 = llvm.extractvalue %a_606[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_619 = llvm.extractvalue %a_606[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_620 = llvm.extractvalue %a_606[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_621 = llvm.extractvalue %a_606[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_622 = llvm.extractvalue %a_606[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_623 = llvm.and %accumulator_607, %accumulator_615 : i1 loc(#loc122)
    %accumulator_624 = llvm.and %accumulator_608, %accumulator_616 : i1 loc(#loc122)
    %accumulator_625 = llvm.and %accumulator_609, %accumulator_617 : i1 loc(#loc122)
    %accumulator_626 = llvm.and %accumulator_610, %accumulator_618 : i1 loc(#loc122)
    %accumulator_627 = llvm.and %accumulator_611, %accumulator_619 : i1 loc(#loc122)
    %accumulator_628 = llvm.and %accumulator_612, %accumulator_620 : i1 loc(#loc122)
    %accumulator_629 = llvm.and %accumulator_613, %accumulator_621 : i1 loc(#loc122)
    %accumulator_630 = llvm.and %accumulator_614, %accumulator_622 : i1 loc(#loc122)
    %accumulator_631 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc122)
    %accumulator_632 = llvm.insertvalue %accumulator_623, %accumulator_631[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_633 = llvm.insertvalue %accumulator_623, %accumulator_632[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_634 = llvm.insertvalue %accumulator_623, %accumulator_633[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_635 = llvm.insertvalue %accumulator_623, %accumulator_634[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_636 = llvm.insertvalue %accumulator_623, %accumulator_635[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_637 = llvm.insertvalue %accumulator_623, %accumulator_636[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_638 = llvm.insertvalue %accumulator_623, %accumulator_637[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_639 = llvm.insertvalue %accumulator_623, %accumulator_638[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc122)
    %a_640 = llvm.extractvalue %a_ptrs_533[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_641 = llvm.extractvalue %a_ptrs_533[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_642 = llvm.extractvalue %a_ptrs_533[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_643 = llvm.extractvalue %a_ptrs_533[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_644 = llvm.extractvalue %a_ptrs_533[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_645 = llvm.extractvalue %a_ptrs_533[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_646 = llvm.extractvalue %a_ptrs_533[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_647 = llvm.extractvalue %a_ptrs_533[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_648 = llvm.extractvalue %accumulator_639[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_649 = llvm.extractvalue %accumulator_639[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_650 = llvm.extractvalue %accumulator_639[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_651 = llvm.extractvalue %accumulator_639[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_652 = llvm.extractvalue %accumulator_639[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_653 = llvm.extractvalue %accumulator_639[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_654 = llvm.extractvalue %accumulator_639[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_655 = llvm.extractvalue %accumulator_639[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_656 = llvm.mlir.constant(0 : i16) : i16 loc(#loc70)
    %a_657 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc70)
    %a_658 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc70)
    %a_659 = rocdl.make.buffer.rsrc %a_ptr, %a_656, %a_658, %a_657 : <1> to <8> loc(#loc70)
    %a_660 = llvm.mlir.constant(dense<0.000000e+00> : vector<8xf16>) : vector<8xf16> loc(#loc70)
    %a_661 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc70)
    %a_662 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_663 = llvm.mul %a_662, %a_640 : i32 loc(#loc70)
    %a_664 = llvm.select %a_648, %a_663, %a_661 : i1, i32 loc(#loc70)
    %a_665 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_666 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_667 = rocdl.raw.ptr.buffer.load %a_659, %a_664, %a_665, %a_666 : vector<4xi32> loc(#loc70)
    %a_668 = llvm.bitcast %a_667 : vector<4xi32> to vector<8xf16> loc(#loc70)
    %a_669 = llvm.mlir.constant(0 : index) : i32 loc(#loc70)
    %a_670 = llvm.extractelement %a_668[%a_669 : i32] : vector<8xf16> loc(#loc70)
    %a_671 = llvm.mlir.constant(1 : index) : i32 loc(#loc70)
    %a_672 = llvm.extractelement %a_668[%a_671 : i32] : vector<8xf16> loc(#loc70)
    %a_673 = llvm.mlir.constant(2 : index) : i32 loc(#loc70)
    %a_674 = llvm.extractelement %a_668[%a_673 : i32] : vector<8xf16> loc(#loc70)
    %a_675 = llvm.mlir.constant(3 : index) : i32 loc(#loc70)
    %a_676 = llvm.extractelement %a_668[%a_675 : i32] : vector<8xf16> loc(#loc70)
    %a_677 = llvm.mlir.constant(4 : index) : i32 loc(#loc70)
    %a_678 = llvm.extractelement %a_668[%a_677 : i32] : vector<8xf16> loc(#loc70)
    %a_679 = llvm.mlir.constant(5 : index) : i32 loc(#loc70)
    %a_680 = llvm.extractelement %a_668[%a_679 : i32] : vector<8xf16> loc(#loc70)
    %a_681 = llvm.mlir.constant(6 : index) : i32 loc(#loc70)
    %a_682 = llvm.extractelement %a_668[%a_681 : i32] : vector<8xf16> loc(#loc70)
    %a_683 = llvm.mlir.constant(7 : index) : i32 loc(#loc70)
    %a_684 = llvm.extractelement %a_668[%a_683 : i32] : vector<8xf16> loc(#loc70)
    %a_685 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_686 = llvm.insertvalue %a_670, %a_685[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_687 = llvm.insertvalue %a_672, %a_686[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_688 = llvm.insertvalue %a_674, %a_687[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_689 = llvm.insertvalue %a_676, %a_688[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_690 = llvm.insertvalue %a_678, %a_689[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_691 = llvm.insertvalue %a_680, %a_690[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_692 = llvm.insertvalue %a_682, %a_691[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_693 = llvm.insertvalue %a_684, %a_692[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_ptrs_694 = llvm.mlir.constant(0 : index) : i32 loc(#loc71)
    %b_ptrs_695 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_ptrs_696 = llvm.mlir.constant(511 : i32) : i32 loc(#loc71)
    %b_ptrs_697 = llvm.and %b_ptrs_695, %b_ptrs_696 : i32 loc(#loc71)
    %b_ptrs_698 = llvm.mlir.constant(64 : i32) : i32 loc(#loc71)
    %b_ptrs_699 = llvm.urem %b_ptrs_697, %b_ptrs_698 : i32 loc(#loc71)
    %b_ptrs_700 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_701 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_702 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_703 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_704 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_705 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_706 = llvm.shl %b_ptrs_699, %b_ptrs_705 : i32 loc(#loc71)
    %b_ptrs_707 = llvm.or %b_ptrs_704, %b_ptrs_706 : i32 loc(#loc71)
    %b_ptrs_708 = llvm.mlir.constant(6 : i32) : i32 loc(#loc71)
    %b_ptrs_709 = llvm.shl %b_ptrs_50, %b_ptrs_708 : i32 loc(#loc71)
    %b_ptrs_710 = llvm.or %b_ptrs_707, %b_ptrs_709 : i32 loc(#loc71)
    %b_ptrs_711 = llvm.mlir.constant(504 : i32) : i32 loc(#loc71)
    %b_ptrs_712 = llvm.and %b_ptrs_710, %b_ptrs_711 : i32 loc(#loc71)
    %b_ptrs_713 = llvm.mlir.constant(3 : i32) : i32 loc(#loc71)
    %b_ptrs_714 = llvm.lshr %b_ptrs_712, %b_ptrs_713 : i32 loc(#loc71)
    %b_ptrs_715 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_716 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_717 = llvm.or disjoint %b_ptrs_714, %b_ptrs_716 : i32 loc(#loc71)
    %b_ptrs_718 = llvm.xor %b_ptrs_703, %b_ptrs_717 : i32 loc(#loc71)
    %b_ptrs_719 = llvm.mlir.constant(0 : i32) : i32 loc(#loc71)
    %b_ptrs_720 = llvm.xor %b_ptrs_718, %b_ptrs_719 : i32 loc(#loc71)
    %b_ptrs_721 = llvm.add %b_ptrs_720, %b_ptrs_694 : i32 loc(#loc71)
    %b_ptrs_722 = llvm.mlir.undef : !llvm.struct<(i32)> loc(#loc71)
    %b_ptrs_723 = llvm.insertvalue %b_ptrs_721, %b_ptrs_722[0] : !llvm.struct<(i32)>  loc(#loc71)
    %b_ptrs_724 = llvm.extractvalue %b_ptrs_723[0] : !llvm.struct<(i32)>  loc(#loc71)
    %b_ptrs_725 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc71)
    %b_ptrs_726 = llvm.insertvalue %b_ptrs_724, %b_ptrs_725[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_727 = llvm.insertvalue %b_ptrs_724, %b_ptrs_726[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_728 = llvm.insertvalue %b_ptrs_724, %b_ptrs_727[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_729 = llvm.insertvalue %b_ptrs_724, %b_ptrs_728[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc71)
    %b_ptrs_730 = llvm.bitcast %stride_bk : i32 to i32 loc(#loc99)
    %b_ptrs_731 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_732 = llvm.insertvalue %b_ptrs_730, %b_ptrs_731[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_733 = llvm.insertvalue %b_ptrs_730, %b_ptrs_732[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_734 = llvm.insertvalue %b_ptrs_730, %b_ptrs_733[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_735 = llvm.insertvalue %b_ptrs_730, %b_ptrs_734[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_736 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_737 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_738 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_739 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_740 = llvm.extractvalue %b_ptrs_735[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_741 = llvm.extractvalue %b_ptrs_735[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_742 = llvm.extractvalue %b_ptrs_735[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_743 = llvm.extractvalue %b_ptrs_735[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_744 = llvm.mul %b_ptrs_736, %b_ptrs_740 : i32 loc(#loc99)
    %b_ptrs_745 = llvm.mul %b_ptrs_737, %b_ptrs_741 : i32 loc(#loc99)
    %b_ptrs_746 = llvm.mul %b_ptrs_738, %b_ptrs_742 : i32 loc(#loc99)
    %b_ptrs_747 = llvm.mul %b_ptrs_739, %b_ptrs_743 : i32 loc(#loc99)
    %b_ptrs_748 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_749 = llvm.insertvalue %b_ptrs_744, %b_ptrs_748[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_750 = llvm.insertvalue %b_ptrs_745, %b_ptrs_749[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_751 = llvm.insertvalue %b_ptrs_746, %b_ptrs_750[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_752 = llvm.insertvalue %b_ptrs_747, %b_ptrs_751[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_753 = llvm.extractvalue %b_ptrs_752[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_754 = llvm.extractvalue %b_ptrs_752[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_755 = llvm.extractvalue %b_ptrs_752[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_756 = llvm.extractvalue %b_ptrs_752[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_757 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_758 = llvm.insertvalue %b_ptrs_756, %b_ptrs_757[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_759 = llvm.insertvalue %b_ptrs_756, %b_ptrs_758[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_760 = llvm.insertvalue %b_ptrs_756, %b_ptrs_759[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_761 = llvm.insertvalue %b_ptrs_756, %b_ptrs_760[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_762 = llvm.extractvalue %offs_bn_338[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_763 = llvm.extractvalue %offs_bn_338[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_764 = llvm.extractvalue %offs_bn_338[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_765 = llvm.extractvalue %offs_bn_338[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_766 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_767 = llvm.insertvalue %b_ptrs_762, %b_ptrs_766[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_768 = llvm.insertvalue %b_ptrs_763, %b_ptrs_767[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_769 = llvm.insertvalue %b_ptrs_764, %b_ptrs_768[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_770 = llvm.insertvalue %b_ptrs_765, %b_ptrs_769[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_771 = llvm.extractvalue %b_ptrs_770[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_772 = llvm.extractvalue %b_ptrs_770[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_773 = llvm.extractvalue %b_ptrs_770[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_774 = llvm.extractvalue %b_ptrs_770[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_775 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_776 = llvm.insertvalue %b_ptrs_771, %b_ptrs_775[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_777 = llvm.insertvalue %b_ptrs_772, %b_ptrs_776[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_778 = llvm.insertvalue %b_ptrs_773, %b_ptrs_777[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_779 = llvm.insertvalue %b_ptrs_774, %b_ptrs_778[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_780 = llvm.extractvalue %b_ptrs_761[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_781 = llvm.extractvalue %b_ptrs_761[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_782 = llvm.extractvalue %b_ptrs_761[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_783 = llvm.extractvalue %b_ptrs_761[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_784 = llvm.extractvalue %b_ptrs_779[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_785 = llvm.extractvalue %b_ptrs_779[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_786 = llvm.extractvalue %b_ptrs_779[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_787 = llvm.extractvalue %b_ptrs_779[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_788 = llvm.add %b_ptrs_780, %b_ptrs_784 : i32 loc(#loc99)
    %b_ptrs_789 = llvm.add %b_ptrs_781, %b_ptrs_785 : i32 loc(#loc99)
    %b_ptrs_790 = llvm.add %b_ptrs_782, %b_ptrs_786 : i32 loc(#loc99)
    %b_ptrs_791 = llvm.add %b_ptrs_783, %b_ptrs_787 : i32 loc(#loc99)
    %b_ptrs_792 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc99)
    %b_ptrs_793 = llvm.insertvalue %b_ptrs_788, %b_ptrs_792[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_794 = llvm.insertvalue %b_ptrs_789, %b_ptrs_793[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_795 = llvm.insertvalue %b_ptrs_790, %b_ptrs_794[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_796 = llvm.insertvalue %b_ptrs_791, %b_ptrs_795[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_797 = builtin.unrealized_conversion_cast %b_ptrs_796 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc99)
    %accumulator_798 = builtin.unrealized_conversion_cast %b_ptrs_797 : tensor<64x32xi32, #blocked1> to !llvm.struct<(i32, i32, i32, i32)> loc(#loc122)
    %accumulator_799 = llvm.bitcast %accumulator_536 : i1 to i1 loc(#loc122)
    %accumulator_800 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc122)
    %accumulator_801 = llvm.insertvalue %accumulator_799, %accumulator_800[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_802 = llvm.insertvalue %accumulator_799, %accumulator_801[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_803 = llvm.insertvalue %accumulator_799, %accumulator_802[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_804 = llvm.insertvalue %accumulator_799, %accumulator_803[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %b_805 = llvm.bitcast %K : i32 to i32 loc(#loc100)
    %b_806 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc100)
    %b_807 = llvm.insertvalue %b_805, %b_806[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_808 = llvm.insertvalue %b_805, %b_807[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_809 = llvm.insertvalue %b_805, %b_808[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_810 = llvm.insertvalue %b_805, %b_809[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_811 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_812 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_813 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_814 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_815 = llvm.extractvalue %b_810[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_816 = llvm.extractvalue %b_810[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_817 = llvm.extractvalue %b_810[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_818 = llvm.extractvalue %b_810[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_819 = llvm.icmp "slt" %b_811, %b_815 : i32 loc(#loc100)
    %b_820 = llvm.icmp "slt" %b_812, %b_816 : i32 loc(#loc100)
    %b_821 = llvm.icmp "slt" %b_813, %b_817 : i32 loc(#loc100)
    %b_822 = llvm.icmp "slt" %b_814, %b_818 : i32 loc(#loc100)
    %b_823 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc100)
    %b_824 = llvm.insertvalue %b_819, %b_823[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_825 = llvm.insertvalue %b_819, %b_824[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_826 = llvm.insertvalue %b_819, %b_825[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_827 = llvm.insertvalue %b_819, %b_826[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_828 = llvm.extractvalue %b_827[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_829 = llvm.extractvalue %b_827[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_830 = llvm.extractvalue %b_827[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_831 = llvm.extractvalue %b_827[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_832 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc69)
    %b_833 = llvm.insertvalue %b_831, %b_832[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_834 = llvm.insertvalue %b_831, %b_833[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_835 = llvm.insertvalue %b_831, %b_834[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_836 = llvm.insertvalue %b_831, %b_835[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %accumulator_837 = llvm.extractvalue %accumulator_804[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_838 = llvm.extractvalue %accumulator_804[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_839 = llvm.extractvalue %accumulator_804[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_840 = llvm.extractvalue %accumulator_804[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_841 = llvm.extractvalue %b_836[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_842 = llvm.extractvalue %b_836[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_843 = llvm.extractvalue %b_836[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_844 = llvm.extractvalue %b_836[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_845 = llvm.and %accumulator_837, %accumulator_841 : i1 loc(#loc122)
    %accumulator_846 = llvm.and %accumulator_838, %accumulator_842 : i1 loc(#loc122)
    %accumulator_847 = llvm.and %accumulator_839, %accumulator_843 : i1 loc(#loc122)
    %accumulator_848 = llvm.and %accumulator_840, %accumulator_844 : i1 loc(#loc122)
    %accumulator_849 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc122)
    %accumulator_850 = llvm.insertvalue %accumulator_845, %accumulator_849[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_851 = llvm.insertvalue %accumulator_845, %accumulator_850[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_852 = llvm.insertvalue %accumulator_845, %accumulator_851[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %accumulator_853 = llvm.insertvalue %accumulator_845, %accumulator_852[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc122)
    %b_854 = llvm.extractvalue %b_ptrs_796[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_855 = llvm.extractvalue %b_ptrs_796[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_856 = llvm.extractvalue %b_ptrs_796[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_857 = llvm.extractvalue %b_ptrs_796[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_858 = llvm.extractvalue %accumulator_853[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_859 = llvm.extractvalue %accumulator_853[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_860 = llvm.extractvalue %accumulator_853[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_861 = llvm.extractvalue %accumulator_853[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_862 = llvm.mlir.constant(0 : i16) : i16 loc(#loc69)
    %b_863 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc69)
    %b_864 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc69)
    %b_865 = rocdl.make.buffer.rsrc %b_ptr, %b_862, %b_864, %b_863 : <1> to <8> loc(#loc69)
    %b_866 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc69)
    %b_867 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc69)
    %b_868 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_869 = llvm.mul %b_868, %b_854 : i32 loc(#loc69)
    %b_870 = llvm.select %b_858, %b_869, %b_867 : i1, i32 loc(#loc69)
    %b_871 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_872 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_873 = rocdl.raw.ptr.buffer.load %b_865, %b_870, %b_871, %b_872 : vector<2xi32> loc(#loc69)
    %b_874 = llvm.bitcast %b_873 : vector<2xi32> to vector<4xf16> loc(#loc69)
    %b_875 = llvm.mlir.constant(0 : index) : i32 loc(#loc69)
    %b_876 = llvm.extractelement %b_874[%b_875 : i32] : vector<4xf16> loc(#loc69)
    %b_877 = llvm.mlir.constant(1 : index) : i32 loc(#loc69)
    %b_878 = llvm.extractelement %b_874[%b_877 : i32] : vector<4xf16> loc(#loc69)
    %b_879 = llvm.mlir.constant(2 : index) : i32 loc(#loc69)
    %b_880 = llvm.extractelement %b_874[%b_879 : i32] : vector<4xf16> loc(#loc69)
    %b_881 = llvm.mlir.constant(3 : index) : i32 loc(#loc69)
    %b_882 = llvm.extractelement %b_874[%b_881 : i32] : vector<4xf16> loc(#loc69)
    %b_883 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc69)
    %b_884 = llvm.insertvalue %b_876, %b_883[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_885 = llvm.insertvalue %b_878, %b_884[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_886 = llvm.insertvalue %b_880, %b_885[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_887 = llvm.insertvalue %b_882, %b_886[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_ptrs_888 = llvm.mul %stride_bk, %18 : i32 loc(#loc101)
    %b_ptrs_889 = llvm.bitcast %b_ptrs_888 : i32 to i32 loc(#loc102)
    %b_ptrs_890 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc102)
    %b_ptrs_891 = llvm.insertvalue %b_ptrs_889, %b_ptrs_890[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_892 = llvm.insertvalue %b_ptrs_889, %b_ptrs_891[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_893 = llvm.insertvalue %b_ptrs_889, %b_ptrs_892[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_894 = llvm.insertvalue %b_ptrs_889, %b_ptrs_893[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %a_895 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %26 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc)
    %a_896 = llvm.getelementptr %26[%a_895] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_897 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_898 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32, i32)> loc(#loc70)
    %a_899 = llvm.insertvalue %a_896, %a_898[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_900 = llvm.insertvalue %a_897, %a_899[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_901 = llvm.insertvalue %a_897, %a_900[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_902 = llvm.insertvalue %a_897, %a_901[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %b_903 = llvm.mlir.constant(8192 : i32) : i32 loc(#loc69)
    %27 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc)
    %b_904 = llvm.getelementptr %27[%b_903] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_905 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_906 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32, i32)> loc(#loc69)
    %b_907 = llvm.insertvalue %b_904, %b_906[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_908 = llvm.insertvalue %b_905, %b_907[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_909 = llvm.insertvalue %b_905, %b_908[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_910 = llvm.insertvalue %b_905, %b_909[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %a_911 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc70)
    %a_912 = llvm.mul %20, %a_911 : i32 loc(#loc70)
    %a_913 = llvm.extractvalue %a_902[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_914 = llvm.extractvalue %a_902[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_915 = llvm.extractvalue %a_902[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_916 = llvm.extractvalue %a_902[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_917 = llvm.getelementptr %a_913[%a_912] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc70)
    %a_918 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc70)
    %a_919 = llvm.insertvalue %a_917, %a_918[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_920 = llvm.insertvalue %a_915, %a_919[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_921 = llvm.insertvalue %a_916, %a_920[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_922 = builtin.unrealized_conversion_cast %a_921 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %accumulator_923 = builtin.unrealized_conversion_cast %a_922 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %a_924 = llvm.extractvalue %a_921[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_925 = llvm.extractvalue %a_921[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_926 = llvm.extractvalue %a_921[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_927 = llvm.extractvalue %a_693[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_928 = llvm.extractvalue %a_693[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_929 = llvm.extractvalue %a_693[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_930 = llvm.extractvalue %a_693[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_931 = llvm.extractvalue %a_693[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_932 = llvm.extractvalue %a_693[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_933 = llvm.extractvalue %a_693[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_934 = llvm.extractvalue %a_693[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_935 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_936 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_937 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_938 = llvm.and %a_936, %a_937 : i32 loc(#loc70)
    %a_939 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_940 = llvm.urem %a_938, %a_939 : i32 loc(#loc70)
    %a_941 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_942 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_943 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_944 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_945 = llvm.shl %a_940, %a_944 : i32 loc(#loc70)
    %a_946 = llvm.or %a_943, %a_945 : i32 loc(#loc70)
    %a_947 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_948 = llvm.shl %a_45, %a_947 : i32 loc(#loc70)
    %a_949 = llvm.or %a_946, %a_948 : i32 loc(#loc70)
    %a_950 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_951 = llvm.and %a_949, %a_950 : i32 loc(#loc70)
    %a_952 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_953 = llvm.shl %a_951, %a_952 : i32 loc(#loc70)
    %a_954 = llvm.mlir.constant(120 : i32) : i32 loc(#loc70)
    %a_955 = llvm.and %a_949, %a_954 : i32 loc(#loc70)
    %a_956 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_957 = llvm.lshr %a_955, %a_956 : i32 loc(#loc70)
    %a_958 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_959 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_960 = llvm.xor %a_953, %a_957 : i32 loc(#loc70)
    %a_961 = llvm.or disjoint %a_959, %a_960 : i32 loc(#loc70)
    %a_962 = llvm.xor %a_942, %a_961 : i32 loc(#loc70)
    %a_963 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_964 = llvm.mul %a_935, %a_963 : i32 loc(#loc70)
    %a_965 = llvm.xor %a_962, %a_964 : i32 loc(#loc70)
    %a_966 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_967 = llvm.xor %a_965, %a_966 : i32 loc(#loc70)
    %a_968 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_969 = llvm.add %a_967, %a_968 : i32 loc(#loc70)
    %a_970 = llvm.getelementptr inbounds %a_924[%a_969] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_971 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_972 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_973 = llvm.insertelement %a_927, %a_971[%a_972 : i32] : vector<4xf16> loc(#loc70)
    %a_974 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_975 = llvm.insertelement %a_928, %a_973[%a_974 : i32] : vector<4xf16> loc(#loc70)
    %a_976 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_977 = llvm.insertelement %a_929, %a_975[%a_976 : i32] : vector<4xf16> loc(#loc70)
    %a_978 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_979 = llvm.insertelement %a_930, %a_977[%a_978 : i32] : vector<4xf16> loc(#loc70)
    %a_980 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_979, %a_970 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %a_981 = llvm.mlir.constant(8 : i32) : i32 loc(#loc70)
    %a_982 = llvm.xor %a_965, %a_981 : i32 loc(#loc70)
    %a_983 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_984 = llvm.add %a_982, %a_983 : i32 loc(#loc70)
    %a_985 = llvm.getelementptr inbounds %a_924[%a_984] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_986 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_987 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_988 = llvm.insertelement %a_931, %a_986[%a_987 : i32] : vector<4xf16> loc(#loc70)
    %a_989 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_990 = llvm.insertelement %a_932, %a_988[%a_989 : i32] : vector<4xf16> loc(#loc70)
    %a_991 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_992 = llvm.insertelement %a_933, %a_990[%a_991 : i32] : vector<4xf16> loc(#loc70)
    %a_993 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_994 = llvm.insertelement %a_934, %a_992[%a_993 : i32] : vector<4xf16> loc(#loc70)
    %a_995 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_994, %a_985 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %b_996 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_997 = llvm.mul %20, %b_996 : i32 loc(#loc69)
    %b_998 = llvm.extractvalue %b_910[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_999 = llvm.extractvalue %b_910[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1000 = llvm.extractvalue %b_910[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1001 = llvm.extractvalue %b_910[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1002 = llvm.getelementptr %b_998[%b_997] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc69)
    %b_1003 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc69)
    %b_1004 = llvm.insertvalue %b_1002, %b_1003[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1005 = llvm.insertvalue %b_1000, %b_1004[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1006 = llvm.insertvalue %b_1001, %b_1005[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1007 = builtin.unrealized_conversion_cast %b_1006 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %accumulator_1008 = builtin.unrealized_conversion_cast %b_1007 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %b_1009 = llvm.extractvalue %b_1006[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1010 = llvm.extractvalue %b_1006[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1011 = llvm.extractvalue %b_1006[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1012 = llvm.extractvalue %b_887[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1013 = llvm.extractvalue %b_887[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1014 = llvm.extractvalue %b_887[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1015 = llvm.extractvalue %b_887[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1016 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1017 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1018 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1019 = llvm.and %b_1017, %b_1018 : i32 loc(#loc69)
    %b_1020 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1021 = llvm.urem %b_1019, %b_1020 : i32 loc(#loc69)
    %b_1022 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1023 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1024 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1025 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1026 = llvm.shl %b_1021, %b_1025 : i32 loc(#loc69)
    %b_1027 = llvm.or %b_1024, %b_1026 : i32 loc(#loc69)
    %b_1028 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_1029 = llvm.shl %b_39, %b_1028 : i32 loc(#loc69)
    %b_1030 = llvm.or %b_1027, %b_1029 : i32 loc(#loc69)
    %b_1031 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1032 = llvm.and %b_1030, %b_1031 : i32 loc(#loc69)
    %b_1033 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_1034 = llvm.shl %b_1032, %b_1033 : i32 loc(#loc69)
    %b_1035 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1036 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1037 = llvm.or disjoint %b_1034, %b_1036 : i32 loc(#loc69)
    %b_1038 = llvm.xor %b_1023, %b_1037 : i32 loc(#loc69)
    %b_1039 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1040 = llvm.mul %b_1016, %b_1039 : i32 loc(#loc69)
    %b_1041 = llvm.xor %b_1038, %b_1040 : i32 loc(#loc69)
    %b_1042 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1043 = llvm.xor %b_1041, %b_1042 : i32 loc(#loc69)
    %b_1044 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1045 = llvm.add %b_1043, %b_1044 : i32 loc(#loc69)
    %b_1046 = llvm.getelementptr inbounds %b_1009[%b_1045] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1047 = llvm.mlir.undef : vector<4xf16> loc(#loc69)
    %b_1048 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1049 = llvm.insertelement %b_1012, %b_1047[%b_1048 : i32] : vector<4xf16> loc(#loc69)
    %b_1050 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_1051 = llvm.insertelement %b_1013, %b_1049[%b_1050 : i32] : vector<4xf16> loc(#loc69)
    %b_1052 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1053 = llvm.insertelement %b_1014, %b_1051[%b_1052 : i32] : vector<4xf16> loc(#loc69)
    %b_1054 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_1055 = llvm.insertelement %b_1015, %b_1053[%b_1054 : i32] : vector<4xf16> loc(#loc69)
    %b_1056 = llvm.mlir.constant(true) : i1 loc(#loc69)
    llvm.store %b_1055, %b_1046 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc69)
    %accumulator_1057 = llvm.sub %25, %22 : i32 loc(#loc122)
    llvm.br ^bb1(%20, %accumulator_88, %accumulator_535, %accumulator_798, %20, %accumulator_923, %accumulator_1008 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc122)
  ^bb1(%accumulator_1058: i32 loc("accumulator"(#loc117)), %accumulator_1059: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc10 at #loc76)), %a_ptrs_1060: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc40)), %b_ptrs_1061: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %28: i32 loc(unknown), %a_1062: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc3)), %b_1063: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc2))):  // 2 preds: ^bb0, ^bb2
    %b_1064 = builtin.unrealized_conversion_cast %b_1063 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %a_1065 = builtin.unrealized_conversion_cast %a_1062 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %b_ptrs_1066 = builtin.unrealized_conversion_cast %b_ptrs_1061 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc99)
    %a_ptrs_1067 = builtin.unrealized_conversion_cast %a_ptrs_1060 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc95)
    %accumulator_1068 = builtin.unrealized_conversion_cast %accumulator_1059 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc116)
    %accumulator_1069 = llvm.icmp "slt" %accumulator_1058, %accumulator_1057 : i32 loc(#loc122)
    llvm.cond_br %accumulator_1069, ^bb2, ^bb3 loc(#loc122)
  ^bb2:  // pred: ^bb1
    %a_ptrs_1070 = llvm.extractvalue %a_ptrs_1060[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1071 = llvm.extractvalue %a_ptrs_1060[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1072 = llvm.extractvalue %a_ptrs_1060[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1073 = llvm.extractvalue %a_ptrs_1060[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1074 = llvm.extractvalue %a_ptrs_1060[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1075 = llvm.extractvalue %a_ptrs_1060[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1076 = llvm.extractvalue %a_ptrs_1060[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1077 = llvm.extractvalue %a_ptrs_1060[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1078 = llvm.extractvalue %16[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1079 = llvm.extractvalue %16[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1080 = llvm.extractvalue %16[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1081 = llvm.extractvalue %16[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1082 = llvm.extractvalue %16[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1083 = llvm.extractvalue %16[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1084 = llvm.extractvalue %16[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1085 = llvm.extractvalue %16[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1086 = llvm.add %a_ptrs_1070, %a_ptrs_1078 : i32 loc(#loc103)
    %a_ptrs_1087 = llvm.add %a_ptrs_1071, %a_ptrs_1079 : i32 loc(#loc103)
    %a_ptrs_1088 = llvm.add %a_ptrs_1072, %a_ptrs_1080 : i32 loc(#loc103)
    %a_ptrs_1089 = llvm.add %a_ptrs_1073, %a_ptrs_1081 : i32 loc(#loc103)
    %a_ptrs_1090 = llvm.add %a_ptrs_1074, %a_ptrs_1082 : i32 loc(#loc103)
    %a_ptrs_1091 = llvm.add %a_ptrs_1075, %a_ptrs_1083 : i32 loc(#loc103)
    %a_ptrs_1092 = llvm.add %a_ptrs_1076, %a_ptrs_1084 : i32 loc(#loc103)
    %a_ptrs_1093 = llvm.add %a_ptrs_1077, %a_ptrs_1085 : i32 loc(#loc103)
    %a_ptrs_1094 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc103)
    %a_ptrs_1095 = llvm.insertvalue %a_ptrs_1086, %a_ptrs_1094[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1096 = llvm.insertvalue %a_ptrs_1087, %a_ptrs_1095[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1097 = llvm.insertvalue %a_ptrs_1088, %a_ptrs_1096[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1098 = llvm.insertvalue %a_ptrs_1089, %a_ptrs_1097[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1099 = llvm.insertvalue %a_ptrs_1090, %a_ptrs_1098[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1100 = llvm.insertvalue %a_ptrs_1091, %a_ptrs_1099[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1101 = llvm.insertvalue %a_ptrs_1092, %a_ptrs_1100[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1102 = llvm.insertvalue %a_ptrs_1093, %a_ptrs_1101[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc103)
    %a_ptrs_1103 = builtin.unrealized_conversion_cast %a_ptrs_1102 : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> to tensor<64x64xi32, #blocked> loc(#loc103)
    %accumulator_1104 = builtin.unrealized_conversion_cast %a_ptrs_1103 : tensor<64x64xi32, #blocked> to !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc122)
    %b_ptrs_1105 = llvm.extractvalue %b_ptrs_1061[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1106 = llvm.extractvalue %b_ptrs_1061[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1107 = llvm.extractvalue %b_ptrs_1061[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1108 = llvm.extractvalue %b_ptrs_1061[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1109 = llvm.extractvalue %b_ptrs_894[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1110 = llvm.extractvalue %b_ptrs_894[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1111 = llvm.extractvalue %b_ptrs_894[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1112 = llvm.extractvalue %b_ptrs_894[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1113 = llvm.add %b_ptrs_1105, %b_ptrs_1109 : i32 loc(#loc102)
    %b_ptrs_1114 = llvm.add %b_ptrs_1106, %b_ptrs_1110 : i32 loc(#loc102)
    %b_ptrs_1115 = llvm.add %b_ptrs_1107, %b_ptrs_1111 : i32 loc(#loc102)
    %b_ptrs_1116 = llvm.add %b_ptrs_1108, %b_ptrs_1112 : i32 loc(#loc102)
    %b_ptrs_1117 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc102)
    %b_ptrs_1118 = llvm.insertvalue %b_ptrs_1113, %b_ptrs_1117[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1119 = llvm.insertvalue %b_ptrs_1114, %b_ptrs_1118[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1120 = llvm.insertvalue %b_ptrs_1115, %b_ptrs_1119[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1121 = llvm.insertvalue %b_ptrs_1116, %b_ptrs_1120[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc102)
    %b_ptrs_1122 = builtin.unrealized_conversion_cast %b_ptrs_1121 : !llvm.struct<(i32, i32, i32, i32)> to tensor<64x32xi32, #blocked1> loc(#loc102)
    %accumulator_1123 = builtin.unrealized_conversion_cast %b_ptrs_1122 : tensor<64x32xi32, #blocked1> to !llvm.struct<(i32, i32, i32, i32)> loc(#loc122)
    %accumulator_1124 = llvm.add %accumulator_1058, %22 : i32 loc(#loc122)
    %a_1125 = llvm.mul %accumulator_1124, %18 : i32 loc(#loc104)
    %a_1126 = llvm.sub %K, %a_1125 : i32 loc(#loc105)
    %a_1127 = llvm.bitcast %a_1126 : i32 to i32 loc(#loc98)
    %a_1128 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc98)
    %a_1129 = llvm.insertvalue %a_1127, %a_1128[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1130 = llvm.insertvalue %a_1127, %a_1129[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1131 = llvm.insertvalue %a_1127, %a_1130[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1132 = llvm.insertvalue %a_1127, %a_1131[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1133 = llvm.insertvalue %a_1127, %a_1132[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1134 = llvm.insertvalue %a_1127, %a_1133[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1135 = llvm.insertvalue %a_1127, %a_1134[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1136 = llvm.insertvalue %a_1127, %a_1135[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1137 = llvm.extractvalue %a_ptrs_413[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1138 = llvm.extractvalue %a_ptrs_413[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1139 = llvm.extractvalue %a_ptrs_413[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1140 = llvm.extractvalue %a_ptrs_413[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1141 = llvm.extractvalue %a_ptrs_413[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1142 = llvm.extractvalue %a_ptrs_413[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1143 = llvm.extractvalue %a_ptrs_413[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1144 = llvm.extractvalue %a_ptrs_413[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1145 = llvm.extractvalue %a_1136[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1146 = llvm.extractvalue %a_1136[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1147 = llvm.extractvalue %a_1136[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1148 = llvm.extractvalue %a_1136[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1149 = llvm.extractvalue %a_1136[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1150 = llvm.extractvalue %a_1136[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1151 = llvm.extractvalue %a_1136[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1152 = llvm.extractvalue %a_1136[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_1153 = llvm.icmp "slt" %a_1137, %a_1145 : i32 loc(#loc98)
    %a_1154 = llvm.icmp "slt" %a_1138, %a_1146 : i32 loc(#loc98)
    %a_1155 = llvm.icmp "slt" %a_1139, %a_1147 : i32 loc(#loc98)
    %a_1156 = llvm.icmp "slt" %a_1140, %a_1148 : i32 loc(#loc98)
    %a_1157 = llvm.icmp "slt" %a_1141, %a_1149 : i32 loc(#loc98)
    %a_1158 = llvm.icmp "slt" %a_1142, %a_1150 : i32 loc(#loc98)
    %a_1159 = llvm.icmp "slt" %a_1143, %a_1151 : i32 loc(#loc98)
    %a_1160 = llvm.icmp "slt" %a_1144, %a_1152 : i32 loc(#loc98)
    %a_1161 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc98)
    %a_1162 = llvm.insertvalue %a_1153, %a_1161[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1163 = llvm.insertvalue %a_1153, %a_1162[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1164 = llvm.insertvalue %a_1153, %a_1163[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1165 = llvm.insertvalue %a_1153, %a_1164[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1166 = llvm.insertvalue %a_1153, %a_1165[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1167 = llvm.insertvalue %a_1153, %a_1166[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1168 = llvm.insertvalue %a_1153, %a_1167[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1169 = llvm.insertvalue %a_1153, %a_1168[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc98)
    %a_1170 = llvm.extractvalue %a_1169[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1171 = llvm.extractvalue %a_1169[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1172 = llvm.extractvalue %a_1169[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1173 = llvm.extractvalue %a_1169[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1174 = llvm.extractvalue %a_1169[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1175 = llvm.extractvalue %a_1169[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1176 = llvm.extractvalue %a_1169[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1177 = llvm.extractvalue %a_1169[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1178 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)> loc(#loc70)
    %a_1179 = llvm.insertvalue %a_1170, %a_1178[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1180 = llvm.insertvalue %a_1171, %a_1179[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1181 = llvm.insertvalue %a_1172, %a_1180[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1182 = llvm.insertvalue %a_1173, %a_1181[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1183 = llvm.insertvalue %a_1174, %a_1182[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1184 = llvm.insertvalue %a_1175, %a_1183[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1185 = llvm.insertvalue %a_1176, %a_1184[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1186 = llvm.insertvalue %a_1177, %a_1185[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1187 = llvm.extractvalue %a_ptrs_1102[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1188 = llvm.extractvalue %a_ptrs_1102[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1189 = llvm.extractvalue %a_ptrs_1102[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1190 = llvm.extractvalue %a_ptrs_1102[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1191 = llvm.extractvalue %a_ptrs_1102[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1192 = llvm.extractvalue %a_ptrs_1102[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1193 = llvm.extractvalue %a_ptrs_1102[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1194 = llvm.extractvalue %a_ptrs_1102[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc70)
    %a_1195 = llvm.extractvalue %a_1186[0] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1196 = llvm.extractvalue %a_1186[1] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1197 = llvm.extractvalue %a_1186[2] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1198 = llvm.extractvalue %a_1186[3] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1199 = llvm.extractvalue %a_1186[4] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1200 = llvm.extractvalue %a_1186[5] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1201 = llvm.extractvalue %a_1186[6] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1202 = llvm.extractvalue %a_1186[7] : !llvm.struct<(i1, i1, i1, i1, i1, i1, i1, i1)>  loc(#loc70)
    %a_1203 = llvm.mlir.constant(0 : i16) : i16 loc(#loc70)
    %a_1204 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc70)
    %a_1205 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc70)
    %a_1206 = rocdl.make.buffer.rsrc %a_ptr, %a_1203, %a_1205, %a_1204 : <1> to <8> loc(#loc70)
    %a_1207 = llvm.mlir.constant(dense<0.000000e+00> : vector<8xf16>) : vector<8xf16> loc(#loc70)
    %a_1208 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc70)
    %a_1209 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1210 = llvm.mul %a_1209, %a_1187 : i32 loc(#loc70)
    %a_1211 = llvm.select %a_1195, %a_1210, %a_1208 : i1, i32 loc(#loc70)
    %a_1212 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1213 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1214 = rocdl.raw.ptr.buffer.load %a_1206, %a_1211, %a_1212, %a_1213 : vector<4xi32> loc(#loc70)
    %a_1215 = llvm.bitcast %a_1214 : vector<4xi32> to vector<8xf16> loc(#loc70)
    %a_1216 = llvm.mlir.constant(0 : index) : i32 loc(#loc70)
    %a_1217 = llvm.extractelement %a_1215[%a_1216 : i32] : vector<8xf16> loc(#loc70)
    %a_1218 = llvm.mlir.constant(1 : index) : i32 loc(#loc70)
    %a_1219 = llvm.extractelement %a_1215[%a_1218 : i32] : vector<8xf16> loc(#loc70)
    %a_1220 = llvm.mlir.constant(2 : index) : i32 loc(#loc70)
    %a_1221 = llvm.extractelement %a_1215[%a_1220 : i32] : vector<8xf16> loc(#loc70)
    %a_1222 = llvm.mlir.constant(3 : index) : i32 loc(#loc70)
    %a_1223 = llvm.extractelement %a_1215[%a_1222 : i32] : vector<8xf16> loc(#loc70)
    %a_1224 = llvm.mlir.constant(4 : index) : i32 loc(#loc70)
    %a_1225 = llvm.extractelement %a_1215[%a_1224 : i32] : vector<8xf16> loc(#loc70)
    %a_1226 = llvm.mlir.constant(5 : index) : i32 loc(#loc70)
    %a_1227 = llvm.extractelement %a_1215[%a_1226 : i32] : vector<8xf16> loc(#loc70)
    %a_1228 = llvm.mlir.constant(6 : index) : i32 loc(#loc70)
    %a_1229 = llvm.extractelement %a_1215[%a_1228 : i32] : vector<8xf16> loc(#loc70)
    %a_1230 = llvm.mlir.constant(7 : index) : i32 loc(#loc70)
    %a_1231 = llvm.extractelement %a_1215[%a_1230 : i32] : vector<8xf16> loc(#loc70)
    %a_1232 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_1233 = llvm.insertvalue %a_1217, %a_1232[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1234 = llvm.insertvalue %a_1219, %a_1233[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1235 = llvm.insertvalue %a_1221, %a_1234[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1236 = llvm.insertvalue %a_1223, %a_1235[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1237 = llvm.insertvalue %a_1225, %a_1236[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1238 = llvm.insertvalue %a_1227, %a_1237[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1239 = llvm.insertvalue %a_1229, %a_1238[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1240 = llvm.insertvalue %a_1231, %a_1239[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_1241 = llvm.extractvalue %a_1062[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1242 = llvm.extractvalue %a_1062[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1243 = llvm.extractvalue %a_1062[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1244 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1245 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_1246 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1247 = llvm.and %a_1245, %a_1246 : i32 loc(#loc70)
    %a_1248 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1249 = llvm.urem %a_1247, %a_1248 : i32 loc(#loc70)
    %a_1250 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1251 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1252 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1253 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1254 = llvm.shl %a_1249, %a_1253 : i32 loc(#loc70)
    %a_1255 = llvm.or %a_1252, %a_1254 : i32 loc(#loc70)
    %a_1256 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_1257 = llvm.shl %a_33, %a_1256 : i32 loc(#loc70)
    %a_1258 = llvm.or %a_1255, %a_1257 : i32 loc(#loc70)
    %a_1259 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_1260 = llvm.and %a_1258, %a_1259 : i32 loc(#loc70)
    %a_1261 = llvm.mlir.constant(7 : i32) : i32 loc(#loc70)
    %a_1262 = llvm.shl %a_1260, %a_1261 : i32 loc(#loc70)
    %a_1263 = llvm.mlir.constant(384 : i32) : i32 loc(#loc70)
    %a_1264 = llvm.and %a_1258, %a_1263 : i32 loc(#loc70)
    %a_1265 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_1266 = llvm.shl %a_1264, %a_1265 : i32 loc(#loc70)
    %a_1267 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_1268 = llvm.and %a_1258, %a_1267 : i32 loc(#loc70)
    %a_1269 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1270 = llvm.shl %a_1268, %a_1269 : i32 loc(#loc70)
    %a_1271 = llvm.mlir.constant(48 : i32) : i32 loc(#loc70)
    %a_1272 = llvm.and %a_1258, %a_1271 : i32 loc(#loc70)
    %a_1273 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1274 = llvm.lshr %a_1272, %a_1273 : i32 loc(#loc70)
    %a_1275 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1276 = llvm.xor %a_1266, %a_1270 : i32 loc(#loc70)
    %a_1277 = llvm.xor %a_1276, %a_1274 : i32 loc(#loc70)
    %a_1278 = llvm.or disjoint %a_1262, %a_1277 : i32 loc(#loc70)
    %a_1279 = llvm.xor %a_1251, %a_1278 : i32 loc(#loc70)
    %a_1280 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1281 = llvm.mul %a_1244, %a_1280 : i32 loc(#loc70)
    %a_1282 = llvm.xor %a_1279, %a_1281 : i32 loc(#loc70)
    %a_1283 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1284 = llvm.xor %a_1282, %a_1283 : i32 loc(#loc70)
    %a_1285 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1286 = llvm.add %a_1284, %a_1285 : i32 loc(#loc70)
    %a_1287 = llvm.getelementptr inbounds %a_1241[%a_1286] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1288 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1289 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1290 = llvm.load %a_1287 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1291 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1292 = llvm.extractelement %a_1290[%a_1291 : i32] : vector<4xf16> loc(#loc70)
    %a_1293 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1294 = llvm.extractelement %a_1290[%a_1293 : i32] : vector<4xf16> loc(#loc70)
    %a_1295 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1296 = llvm.extractelement %a_1290[%a_1295 : i32] : vector<4xf16> loc(#loc70)
    %a_1297 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1298 = llvm.extractelement %a_1290[%a_1297 : i32] : vector<4xf16> loc(#loc70)
    %a_1299 = llvm.mlir.constant(32 : i32) : i32 loc(#loc70)
    %a_1300 = llvm.xor %a_1282, %a_1299 : i32 loc(#loc70)
    %a_1301 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1302 = llvm.add %a_1300, %a_1301 : i32 loc(#loc70)
    %a_1303 = llvm.getelementptr inbounds %a_1241[%a_1302] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1304 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1305 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1306 = llvm.load %a_1303 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1307 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1308 = llvm.extractelement %a_1306[%a_1307 : i32] : vector<4xf16> loc(#loc70)
    %a_1309 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1310 = llvm.extractelement %a_1306[%a_1309 : i32] : vector<4xf16> loc(#loc70)
    %a_1311 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1312 = llvm.extractelement %a_1306[%a_1311 : i32] : vector<4xf16> loc(#loc70)
    %a_1313 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1314 = llvm.extractelement %a_1306[%a_1313 : i32] : vector<4xf16> loc(#loc70)
    %a_1315 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1316 = llvm.xor %a_1282, %a_1315 : i32 loc(#loc70)
    %a_1317 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1318 = llvm.add %a_1316, %a_1317 : i32 loc(#loc70)
    %a_1319 = llvm.getelementptr inbounds %a_1241[%a_1318] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1320 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1321 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1322 = llvm.load %a_1319 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1323 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1324 = llvm.extractelement %a_1322[%a_1323 : i32] : vector<4xf16> loc(#loc70)
    %a_1325 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1326 = llvm.extractelement %a_1322[%a_1325 : i32] : vector<4xf16> loc(#loc70)
    %a_1327 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1328 = llvm.extractelement %a_1322[%a_1327 : i32] : vector<4xf16> loc(#loc70)
    %a_1329 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1330 = llvm.extractelement %a_1322[%a_1329 : i32] : vector<4xf16> loc(#loc70)
    %a_1331 = llvm.mlir.constant(96 : i32) : i32 loc(#loc70)
    %a_1332 = llvm.xor %a_1282, %a_1331 : i32 loc(#loc70)
    %a_1333 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1334 = llvm.add %a_1332, %a_1333 : i32 loc(#loc70)
    %a_1335 = llvm.getelementptr inbounds %a_1241[%a_1334] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1336 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_1337 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_1338 = llvm.load %a_1335 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_1339 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1340 = llvm.extractelement %a_1338[%a_1339 : i32] : vector<4xf16> loc(#loc70)
    %a_1341 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1342 = llvm.extractelement %a_1338[%a_1341 : i32] : vector<4xf16> loc(#loc70)
    %a_1343 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1344 = llvm.extractelement %a_1338[%a_1343 : i32] : vector<4xf16> loc(#loc70)
    %a_1345 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1346 = llvm.extractelement %a_1338[%a_1345 : i32] : vector<4xf16> loc(#loc70)
    %a_1347 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_1348 = llvm.insertvalue %a_1292, %a_1347[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1349 = llvm.insertvalue %a_1294, %a_1348[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1350 = llvm.insertvalue %a_1296, %a_1349[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1351 = llvm.insertvalue %a_1298, %a_1350[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1352 = llvm.insertvalue %a_1308, %a_1351[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1353 = llvm.insertvalue %a_1310, %a_1352[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1354 = llvm.insertvalue %a_1312, %a_1353[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1355 = llvm.insertvalue %a_1314, %a_1354[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1356 = llvm.insertvalue %a_1324, %a_1355[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1357 = llvm.insertvalue %a_1326, %a_1356[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1358 = llvm.insertvalue %a_1328, %a_1357[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1359 = llvm.insertvalue %a_1330, %a_1358[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1360 = llvm.insertvalue %a_1340, %a_1359[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1361 = llvm.insertvalue %a_1342, %a_1360[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1362 = llvm.insertvalue %a_1344, %a_1361[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1363 = llvm.insertvalue %a_1346, %a_1362[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_1364 = llvm.bitcast %a_1126 : i32 to i32 loc(#loc100)
    %b_1365 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc100)
    %b_1366 = llvm.insertvalue %b_1364, %b_1365[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1367 = llvm.insertvalue %b_1364, %b_1366[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1368 = llvm.insertvalue %b_1364, %b_1367[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1369 = llvm.insertvalue %b_1364, %b_1368[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1370 = llvm.extractvalue %b_ptrs_729[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1371 = llvm.extractvalue %b_ptrs_729[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1372 = llvm.extractvalue %b_ptrs_729[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1373 = llvm.extractvalue %b_ptrs_729[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1374 = llvm.extractvalue %b_1369[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1375 = llvm.extractvalue %b_1369[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1376 = llvm.extractvalue %b_1369[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1377 = llvm.extractvalue %b_1369[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc100)
    %b_1378 = llvm.icmp "slt" %b_1370, %b_1374 : i32 loc(#loc100)
    %b_1379 = llvm.icmp "slt" %b_1371, %b_1375 : i32 loc(#loc100)
    %b_1380 = llvm.icmp "slt" %b_1372, %b_1376 : i32 loc(#loc100)
    %b_1381 = llvm.icmp "slt" %b_1373, %b_1377 : i32 loc(#loc100)
    %b_1382 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc100)
    %b_1383 = llvm.insertvalue %b_1378, %b_1382[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1384 = llvm.insertvalue %b_1378, %b_1383[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1385 = llvm.insertvalue %b_1378, %b_1384[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1386 = llvm.insertvalue %b_1378, %b_1385[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc100)
    %b_1387 = llvm.extractvalue %b_1386[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1388 = llvm.extractvalue %b_1386[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1389 = llvm.extractvalue %b_1386[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1390 = llvm.extractvalue %b_1386[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1391 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc69)
    %b_1392 = llvm.insertvalue %b_1390, %b_1391[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1393 = llvm.insertvalue %b_1390, %b_1392[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1394 = llvm.insertvalue %b_1390, %b_1393[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1395 = llvm.insertvalue %b_1390, %b_1394[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1396 = llvm.extractvalue %b_ptrs_1121[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1397 = llvm.extractvalue %b_ptrs_1121[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1398 = llvm.extractvalue %b_ptrs_1121[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1399 = llvm.extractvalue %b_ptrs_1121[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc69)
    %b_1400 = llvm.extractvalue %b_1395[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1401 = llvm.extractvalue %b_1395[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1402 = llvm.extractvalue %b_1395[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1403 = llvm.extractvalue %b_1395[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc69)
    %b_1404 = llvm.mlir.constant(0 : i16) : i16 loc(#loc69)
    %b_1405 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc69)
    %b_1406 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc69)
    %b_1407 = rocdl.make.buffer.rsrc %b_ptr, %b_1404, %b_1406, %b_1405 : <1> to <8> loc(#loc69)
    %b_1408 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc69)
    %b_1409 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc69)
    %b_1410 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1411 = llvm.mul %b_1410, %b_1396 : i32 loc(#loc69)
    %b_1412 = llvm.select %b_1400, %b_1411, %b_1409 : i1, i32 loc(#loc69)
    %b_1413 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1414 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1415 = rocdl.raw.ptr.buffer.load %b_1407, %b_1412, %b_1413, %b_1414 : vector<2xi32> loc(#loc69)
    %b_1416 = llvm.bitcast %b_1415 : vector<2xi32> to vector<4xf16> loc(#loc69)
    %b_1417 = llvm.mlir.constant(0 : index) : i32 loc(#loc69)
    %b_1418 = llvm.extractelement %b_1416[%b_1417 : i32] : vector<4xf16> loc(#loc69)
    %b_1419 = llvm.mlir.constant(1 : index) : i32 loc(#loc69)
    %b_1420 = llvm.extractelement %b_1416[%b_1419 : i32] : vector<4xf16> loc(#loc69)
    %b_1421 = llvm.mlir.constant(2 : index) : i32 loc(#loc69)
    %b_1422 = llvm.extractelement %b_1416[%b_1421 : i32] : vector<4xf16> loc(#loc69)
    %b_1423 = llvm.mlir.constant(3 : index) : i32 loc(#loc69)
    %b_1424 = llvm.extractelement %b_1416[%b_1423 : i32] : vector<4xf16> loc(#loc69)
    %b_1425 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc69)
    %b_1426 = llvm.insertvalue %b_1418, %b_1425[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1427 = llvm.insertvalue %b_1420, %b_1426[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1428 = llvm.insertvalue %b_1422, %b_1427[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1429 = llvm.insertvalue %b_1424, %b_1428[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1430 = llvm.extractvalue %b_1063[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1431 = llvm.extractvalue %b_1063[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1432 = llvm.extractvalue %b_1063[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1433 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1434 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_1435 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_1436 = llvm.and %b_1434, %b_1435 : i32 loc(#loc69)
    %b_1437 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1438 = llvm.urem %b_1436, %b_1437 : i32 loc(#loc69)
    %b_1439 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1440 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1441 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1442 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1443 = llvm.shl %b_1438, %b_1442 : i32 loc(#loc69)
    %b_1444 = llvm.or %b_1441, %b_1443 : i32 loc(#loc69)
    %b_1445 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_1446 = llvm.shl %b_27, %b_1445 : i32 loc(#loc69)
    %b_1447 = llvm.or %b_1444, %b_1446 : i32 loc(#loc69)
    %b_1448 = llvm.mlir.constant(48 : i32) : i32 loc(#loc69)
    %b_1449 = llvm.and %b_1447, %b_1448 : i32 loc(#loc69)
    %b_1450 = llvm.mlir.constant(4 : i32) : i32 loc(#loc69)
    %b_1451 = llvm.shl %b_1449, %b_1450 : i32 loc(#loc69)
    %b_1452 = llvm.mlir.constant(15 : i32) : i32 loc(#loc69)
    %b_1453 = llvm.and %b_1447, %b_1452 : i32 loc(#loc69)
    %b_1454 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_1455 = llvm.shl %b_1453, %b_1454 : i32 loc(#loc69)
    %b_1456 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1457 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1458 = llvm.and %b_1447, %b_1457 : i32 loc(#loc69)
    %b_1459 = llvm.icmp "eq" %b_1458, %b_1456 : i32 loc(#loc69)
    %b_1460 = llvm.mlir.constant(32 : i32) : i32 loc(#loc69)
    %b_1461 = llvm.select %b_1459, %b_1456, %b_1460 : i1, i32 loc(#loc69)
    %b_1462 = llvm.xor %b_1451, %b_1455 : i32 loc(#loc69)
    %b_1463 = llvm.or disjoint %b_1461, %b_1462 : i32 loc(#loc69)
    %b_1464 = llvm.xor %b_1440, %b_1463 : i32 loc(#loc69)
    %b_1465 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_1466 = llvm.mul %b_1433, %b_1465 : i32 loc(#loc69)
    %b_1467 = llvm.xor %b_1464, %b_1466 : i32 loc(#loc69)
    %b_1468 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1469 = llvm.xor %b_1467, %b_1468 : i32 loc(#loc69)
    %b_1470 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1471 = llvm.add %b_1469, %b_1470 : i32 loc(#loc69)
    %b_1472 = llvm.getelementptr inbounds %b_1430[%b_1471] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1473 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1474 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1475 = llvm.load %b_1472 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1476 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1477 = llvm.extractelement %b_1475[%b_1476 : i32] : vector<1xf16> loc(#loc69)
    %b_1478 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_1479 = llvm.add %b_1469, %b_1478 : i32 loc(#loc69)
    %b_1480 = llvm.getelementptr inbounds %b_1430[%b_1479] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1481 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1482 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1483 = llvm.load %b_1480 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1484 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1485 = llvm.extractelement %b_1483[%b_1484 : i32] : vector<1xf16> loc(#loc69)
    %b_1486 = llvm.mlir.constant(128 : i32) : i32 loc(#loc69)
    %b_1487 = llvm.add %b_1469, %b_1486 : i32 loc(#loc69)
    %b_1488 = llvm.getelementptr inbounds %b_1430[%b_1487] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1489 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1490 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1491 = llvm.load %b_1488 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1492 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1493 = llvm.extractelement %b_1491[%b_1492 : i32] : vector<1xf16> loc(#loc69)
    %b_1494 = llvm.mlir.constant(192 : i32) : i32 loc(#loc69)
    %b_1495 = llvm.add %b_1469, %b_1494 : i32 loc(#loc69)
    %b_1496 = llvm.getelementptr inbounds %b_1430[%b_1495] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1497 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1498 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1499 = llvm.load %b_1496 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1500 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1501 = llvm.extractelement %b_1499[%b_1500 : i32] : vector<1xf16> loc(#loc69)
    %b_1502 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc69)
    %b_1503 = llvm.add %b_1469, %b_1502 : i32 loc(#loc69)
    %b_1504 = llvm.getelementptr inbounds %b_1430[%b_1503] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1505 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1506 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1507 = llvm.load %b_1504 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1508 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1509 = llvm.extractelement %b_1507[%b_1508 : i32] : vector<1xf16> loc(#loc69)
    %b_1510 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc69)
    %b_1511 = llvm.add %b_1469, %b_1510 : i32 loc(#loc69)
    %b_1512 = llvm.getelementptr inbounds %b_1430[%b_1511] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1513 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1514 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1515 = llvm.load %b_1512 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1516 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1517 = llvm.extractelement %b_1515[%b_1516 : i32] : vector<1xf16> loc(#loc69)
    %b_1518 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc69)
    %b_1519 = llvm.add %b_1469, %b_1518 : i32 loc(#loc69)
    %b_1520 = llvm.getelementptr inbounds %b_1430[%b_1519] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1521 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1522 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1523 = llvm.load %b_1520 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1524 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1525 = llvm.extractelement %b_1523[%b_1524 : i32] : vector<1xf16> loc(#loc69)
    %b_1526 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc69)
    %b_1527 = llvm.add %b_1469, %b_1526 : i32 loc(#loc69)
    %b_1528 = llvm.getelementptr inbounds %b_1430[%b_1527] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1529 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1530 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1531 = llvm.load %b_1528 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1532 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1533 = llvm.extractelement %b_1531[%b_1532 : i32] : vector<1xf16> loc(#loc69)
    %b_1534 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_1535 = llvm.add %b_1469, %b_1534 : i32 loc(#loc69)
    %b_1536 = llvm.getelementptr inbounds %b_1430[%b_1535] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1537 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1538 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1539 = llvm.load %b_1536 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1540 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1541 = llvm.extractelement %b_1539[%b_1540 : i32] : vector<1xf16> loc(#loc69)
    %b_1542 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc69)
    %b_1543 = llvm.add %b_1469, %b_1542 : i32 loc(#loc69)
    %b_1544 = llvm.getelementptr inbounds %b_1430[%b_1543] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1545 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1546 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1547 = llvm.load %b_1544 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1548 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1549 = llvm.extractelement %b_1547[%b_1548 : i32] : vector<1xf16> loc(#loc69)
    %b_1550 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc69)
    %b_1551 = llvm.add %b_1469, %b_1550 : i32 loc(#loc69)
    %b_1552 = llvm.getelementptr inbounds %b_1430[%b_1551] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1553 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1554 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1555 = llvm.load %b_1552 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1556 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1557 = llvm.extractelement %b_1555[%b_1556 : i32] : vector<1xf16> loc(#loc69)
    %b_1558 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc69)
    %b_1559 = llvm.add %b_1469, %b_1558 : i32 loc(#loc69)
    %b_1560 = llvm.getelementptr inbounds %b_1430[%b_1559] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1561 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1562 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1563 = llvm.load %b_1560 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1564 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1565 = llvm.extractelement %b_1563[%b_1564 : i32] : vector<1xf16> loc(#loc69)
    %b_1566 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc69)
    %b_1567 = llvm.add %b_1469, %b_1566 : i32 loc(#loc69)
    %b_1568 = llvm.getelementptr inbounds %b_1430[%b_1567] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1569 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1570 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1571 = llvm.load %b_1568 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1572 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1573 = llvm.extractelement %b_1571[%b_1572 : i32] : vector<1xf16> loc(#loc69)
    %b_1574 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc69)
    %b_1575 = llvm.add %b_1469, %b_1574 : i32 loc(#loc69)
    %b_1576 = llvm.getelementptr inbounds %b_1430[%b_1575] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1577 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1578 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1579 = llvm.load %b_1576 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1580 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1581 = llvm.extractelement %b_1579[%b_1580 : i32] : vector<1xf16> loc(#loc69)
    %b_1582 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc69)
    %b_1583 = llvm.add %b_1469, %b_1582 : i32 loc(#loc69)
    %b_1584 = llvm.getelementptr inbounds %b_1430[%b_1583] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1585 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1586 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1587 = llvm.load %b_1584 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1588 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1589 = llvm.extractelement %b_1587[%b_1588 : i32] : vector<1xf16> loc(#loc69)
    %b_1590 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc69)
    %b_1591 = llvm.add %b_1469, %b_1590 : i32 loc(#loc69)
    %b_1592 = llvm.getelementptr inbounds %b_1430[%b_1591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_1593 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_1594 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_1595 = llvm.load %b_1592 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_1596 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_1597 = llvm.extractelement %b_1595[%b_1596 : i32] : vector<1xf16> loc(#loc69)
    %b_1598 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc69)
    %b_1599 = llvm.insertvalue %b_1477, %b_1598[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1600 = llvm.insertvalue %b_1485, %b_1599[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1601 = llvm.insertvalue %b_1493, %b_1600[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1602 = llvm.insertvalue %b_1501, %b_1601[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1603 = llvm.insertvalue %b_1509, %b_1602[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1604 = llvm.insertvalue %b_1517, %b_1603[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1605 = llvm.insertvalue %b_1525, %b_1604[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1606 = llvm.insertvalue %b_1533, %b_1605[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1607 = llvm.insertvalue %b_1541, %b_1606[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1608 = llvm.insertvalue %b_1549, %b_1607[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1609 = llvm.insertvalue %b_1557, %b_1608[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1610 = llvm.insertvalue %b_1565, %b_1609[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1611 = llvm.insertvalue %b_1573, %b_1610[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1612 = llvm.insertvalue %b_1581, %b_1611[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1613 = llvm.insertvalue %b_1589, %b_1612[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_1614 = llvm.insertvalue %b_1597, %b_1613[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %accumulator_1615 = llvm.extractvalue %a_1363[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1616 = llvm.extractvalue %a_1363[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1617 = llvm.extractvalue %a_1363[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1618 = llvm.extractvalue %a_1363[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1619 = llvm.extractvalue %a_1363[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1620 = llvm.extractvalue %a_1363[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1621 = llvm.extractvalue %a_1363[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1622 = llvm.extractvalue %a_1363[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1623 = llvm.extractvalue %a_1363[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1624 = llvm.extractvalue %a_1363[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1625 = llvm.extractvalue %a_1363[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1626 = llvm.extractvalue %a_1363[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1627 = llvm.extractvalue %a_1363[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1628 = llvm.extractvalue %a_1363[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1629 = llvm.extractvalue %a_1363[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1630 = llvm.extractvalue %a_1363[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1631 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1632 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1633 = llvm.insertelement %accumulator_1615, %accumulator_1631[%accumulator_1632 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1634 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1635 = llvm.insertelement %accumulator_1616, %accumulator_1633[%accumulator_1634 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1636 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1637 = llvm.insertelement %accumulator_1617, %accumulator_1635[%accumulator_1636 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1638 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1639 = llvm.insertelement %accumulator_1618, %accumulator_1637[%accumulator_1638 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1640 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1641 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1642 = llvm.extractelement %accumulator_1639[%accumulator_1641 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1643 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1644 = llvm.insertelement %accumulator_1642, %accumulator_1640[%accumulator_1643 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1645 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1646 = llvm.extractelement %accumulator_1639[%accumulator_1645 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1647 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1648 = llvm.insertelement %accumulator_1646, %accumulator_1644[%accumulator_1647 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1649 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1650 = llvm.extractelement %accumulator_1639[%accumulator_1649 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1651 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1652 = llvm.insertelement %accumulator_1650, %accumulator_1648[%accumulator_1651 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1653 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1654 = llvm.extractelement %accumulator_1639[%accumulator_1653 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1655 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1656 = llvm.insertelement %accumulator_1654, %accumulator_1652[%accumulator_1655 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1657 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1658 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1659 = llvm.insertelement %accumulator_1619, %accumulator_1657[%accumulator_1658 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1660 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1661 = llvm.insertelement %accumulator_1620, %accumulator_1659[%accumulator_1660 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1662 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1663 = llvm.insertelement %accumulator_1621, %accumulator_1661[%accumulator_1662 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1664 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1665 = llvm.insertelement %accumulator_1622, %accumulator_1663[%accumulator_1664 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1666 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1667 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1668 = llvm.extractelement %accumulator_1665[%accumulator_1667 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1669 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1670 = llvm.insertelement %accumulator_1668, %accumulator_1666[%accumulator_1669 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1671 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1672 = llvm.extractelement %accumulator_1665[%accumulator_1671 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1673 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1674 = llvm.insertelement %accumulator_1672, %accumulator_1670[%accumulator_1673 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1675 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1676 = llvm.extractelement %accumulator_1665[%accumulator_1675 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1677 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1678 = llvm.insertelement %accumulator_1676, %accumulator_1674[%accumulator_1677 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1679 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1680 = llvm.extractelement %accumulator_1665[%accumulator_1679 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1681 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1682 = llvm.insertelement %accumulator_1680, %accumulator_1678[%accumulator_1681 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1683 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1684 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1685 = llvm.insertelement %accumulator_1623, %accumulator_1683[%accumulator_1684 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1686 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1687 = llvm.insertelement %accumulator_1624, %accumulator_1685[%accumulator_1686 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1688 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1689 = llvm.insertelement %accumulator_1625, %accumulator_1687[%accumulator_1688 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1690 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1691 = llvm.insertelement %accumulator_1626, %accumulator_1689[%accumulator_1690 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1692 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1693 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1694 = llvm.extractelement %accumulator_1691[%accumulator_1693 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1695 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1696 = llvm.insertelement %accumulator_1694, %accumulator_1692[%accumulator_1695 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1697 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1698 = llvm.extractelement %accumulator_1691[%accumulator_1697 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1699 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1700 = llvm.insertelement %accumulator_1698, %accumulator_1696[%accumulator_1699 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1701 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1702 = llvm.extractelement %accumulator_1691[%accumulator_1701 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1703 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1704 = llvm.insertelement %accumulator_1702, %accumulator_1700[%accumulator_1703 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1705 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1706 = llvm.extractelement %accumulator_1691[%accumulator_1705 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1707 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1708 = llvm.insertelement %accumulator_1706, %accumulator_1704[%accumulator_1707 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1709 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1710 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1711 = llvm.insertelement %accumulator_1627, %accumulator_1709[%accumulator_1710 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1712 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1713 = llvm.insertelement %accumulator_1628, %accumulator_1711[%accumulator_1712 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1714 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1715 = llvm.insertelement %accumulator_1629, %accumulator_1713[%accumulator_1714 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1716 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1717 = llvm.insertelement %accumulator_1630, %accumulator_1715[%accumulator_1716 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1718 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1719 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1720 = llvm.extractelement %accumulator_1717[%accumulator_1719 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1721 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1722 = llvm.insertelement %accumulator_1720, %accumulator_1718[%accumulator_1721 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1723 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1724 = llvm.extractelement %accumulator_1717[%accumulator_1723 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1725 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1726 = llvm.insertelement %accumulator_1724, %accumulator_1722[%accumulator_1725 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1727 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1728 = llvm.extractelement %accumulator_1717[%accumulator_1727 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1729 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1730 = llvm.insertelement %accumulator_1728, %accumulator_1726[%accumulator_1729 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1731 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1732 = llvm.extractelement %accumulator_1717[%accumulator_1731 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1733 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1734 = llvm.insertelement %accumulator_1732, %accumulator_1730[%accumulator_1733 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1735 = llvm.extractvalue %b_1614[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1736 = llvm.extractvalue %b_1614[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1737 = llvm.extractvalue %b_1614[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1738 = llvm.extractvalue %b_1614[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1739 = llvm.extractvalue %b_1614[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1740 = llvm.extractvalue %b_1614[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1741 = llvm.extractvalue %b_1614[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1742 = llvm.extractvalue %b_1614[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1743 = llvm.extractvalue %b_1614[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1744 = llvm.extractvalue %b_1614[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1745 = llvm.extractvalue %b_1614[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1746 = llvm.extractvalue %b_1614[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1747 = llvm.extractvalue %b_1614[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1748 = llvm.extractvalue %b_1614[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1749 = llvm.extractvalue %b_1614[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1750 = llvm.extractvalue %b_1614[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_1751 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1752 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1753 = llvm.insertelement %accumulator_1735, %accumulator_1751[%accumulator_1752 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1754 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1755 = llvm.insertelement %accumulator_1736, %accumulator_1753[%accumulator_1754 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1756 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1757 = llvm.insertelement %accumulator_1737, %accumulator_1755[%accumulator_1756 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1758 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1759 = llvm.insertelement %accumulator_1738, %accumulator_1757[%accumulator_1758 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1760 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1761 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1762 = llvm.extractelement %accumulator_1759[%accumulator_1761 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1763 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1764 = llvm.insertelement %accumulator_1762, %accumulator_1760[%accumulator_1763 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1765 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1766 = llvm.extractelement %accumulator_1759[%accumulator_1765 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1767 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1768 = llvm.insertelement %accumulator_1766, %accumulator_1764[%accumulator_1767 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1769 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1770 = llvm.extractelement %accumulator_1759[%accumulator_1769 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1771 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1772 = llvm.insertelement %accumulator_1770, %accumulator_1768[%accumulator_1771 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1773 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1774 = llvm.extractelement %accumulator_1759[%accumulator_1773 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1775 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1776 = llvm.insertelement %accumulator_1774, %accumulator_1772[%accumulator_1775 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1777 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1778 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1779 = llvm.insertelement %accumulator_1739, %accumulator_1777[%accumulator_1778 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1780 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1781 = llvm.insertelement %accumulator_1740, %accumulator_1779[%accumulator_1780 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1782 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1783 = llvm.insertelement %accumulator_1741, %accumulator_1781[%accumulator_1782 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1784 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1785 = llvm.insertelement %accumulator_1742, %accumulator_1783[%accumulator_1784 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1786 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1787 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1788 = llvm.extractelement %accumulator_1785[%accumulator_1787 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1789 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1790 = llvm.insertelement %accumulator_1788, %accumulator_1786[%accumulator_1789 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1791 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1792 = llvm.extractelement %accumulator_1785[%accumulator_1791 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1793 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1794 = llvm.insertelement %accumulator_1792, %accumulator_1790[%accumulator_1793 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1795 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1796 = llvm.extractelement %accumulator_1785[%accumulator_1795 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1797 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1798 = llvm.insertelement %accumulator_1796, %accumulator_1794[%accumulator_1797 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1799 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1800 = llvm.extractelement %accumulator_1785[%accumulator_1799 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1801 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1802 = llvm.insertelement %accumulator_1800, %accumulator_1798[%accumulator_1801 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1803 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1804 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1805 = llvm.insertelement %accumulator_1743, %accumulator_1803[%accumulator_1804 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1806 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1807 = llvm.insertelement %accumulator_1744, %accumulator_1805[%accumulator_1806 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1808 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1809 = llvm.insertelement %accumulator_1745, %accumulator_1807[%accumulator_1808 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1810 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1811 = llvm.insertelement %accumulator_1746, %accumulator_1809[%accumulator_1810 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1812 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1813 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1814 = llvm.extractelement %accumulator_1811[%accumulator_1813 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1815 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1816 = llvm.insertelement %accumulator_1814, %accumulator_1812[%accumulator_1815 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1817 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1818 = llvm.extractelement %accumulator_1811[%accumulator_1817 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1819 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1820 = llvm.insertelement %accumulator_1818, %accumulator_1816[%accumulator_1819 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1821 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1822 = llvm.extractelement %accumulator_1811[%accumulator_1821 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1823 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1824 = llvm.insertelement %accumulator_1822, %accumulator_1820[%accumulator_1823 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1825 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1826 = llvm.extractelement %accumulator_1811[%accumulator_1825 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1827 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1828 = llvm.insertelement %accumulator_1826, %accumulator_1824[%accumulator_1827 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1829 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1830 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1831 = llvm.insertelement %accumulator_1747, %accumulator_1829[%accumulator_1830 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1832 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1833 = llvm.insertelement %accumulator_1748, %accumulator_1831[%accumulator_1832 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1834 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1835 = llvm.insertelement %accumulator_1749, %accumulator_1833[%accumulator_1834 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1836 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1837 = llvm.insertelement %accumulator_1750, %accumulator_1835[%accumulator_1836 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1838 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_1839 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1840 = llvm.extractelement %accumulator_1837[%accumulator_1839 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1841 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1842 = llvm.insertelement %accumulator_1840, %accumulator_1838[%accumulator_1841 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1843 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1844 = llvm.extractelement %accumulator_1837[%accumulator_1843 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1845 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1846 = llvm.insertelement %accumulator_1844, %accumulator_1842[%accumulator_1845 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1847 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1848 = llvm.extractelement %accumulator_1837[%accumulator_1847 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1849 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1850 = llvm.insertelement %accumulator_1848, %accumulator_1846[%accumulator_1849 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1851 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1852 = llvm.extractelement %accumulator_1837[%accumulator_1851 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1853 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1854 = llvm.insertelement %accumulator_1852, %accumulator_1850[%accumulator_1853 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_1855 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1856 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1857 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1858 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1859 = llvm.mlir.undef : vector<4xf32> loc(#loc106)
    %accumulator_1860 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1861 = llvm.insertelement %accumulator_1855, %accumulator_1859[%accumulator_1860 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1862 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1863 = llvm.insertelement %accumulator_1856, %accumulator_1861[%accumulator_1862 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1864 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1865 = llvm.insertelement %accumulator_1857, %accumulator_1863[%accumulator_1864 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1866 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1867 = llvm.insertelement %accumulator_1858, %accumulator_1865[%accumulator_1866 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1868 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1869 = rocdl.mfma.f32.16x16x16f16 %accumulator_1776, %accumulator_1656, %accumulator_1867, %accumulator_1868, %accumulator_1868, %accumulator_1868 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1870 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1871 = rocdl.mfma.f32.16x16x16f16 %accumulator_1802, %accumulator_1682, %accumulator_1869, %accumulator_1870, %accumulator_1870, %accumulator_1870 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1872 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1873 = rocdl.mfma.f32.16x16x16f16 %accumulator_1828, %accumulator_1708, %accumulator_1871, %accumulator_1872, %accumulator_1872, %accumulator_1872 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1874 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1875 = rocdl.mfma.f32.16x16x16f16 %accumulator_1854, %accumulator_1734, %accumulator_1873, %accumulator_1874, %accumulator_1874, %accumulator_1874 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_1876 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_1877 = llvm.extractelement %accumulator_1875[%accumulator_1876 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1878 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_1879 = llvm.extractelement %accumulator_1875[%accumulator_1878 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1880 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_1881 = llvm.extractelement %accumulator_1875[%accumulator_1880 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1882 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_1883 = llvm.extractelement %accumulator_1875[%accumulator_1882 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_1884 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    %accumulator_1885 = llvm.insertvalue %accumulator_1877, %accumulator_1884[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1886 = llvm.insertvalue %accumulator_1879, %accumulator_1885[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1887 = llvm.insertvalue %accumulator_1881, %accumulator_1886[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1888 = llvm.insertvalue %accumulator_1883, %accumulator_1887[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_1889 = builtin.unrealized_conversion_cast %accumulator_1888 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_1890 = builtin.unrealized_conversion_cast %accumulator_1889 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %accumulator_1891 = llvm.add %28, %22 : i32 loc(#loc122)
    %accumulator_1892 = llvm.icmp "slt" %accumulator_1891, %22 : i32 loc(#loc122)
    %accumulator_1893 = llvm.select %accumulator_1892, %accumulator_1891, %20 : i1, i32 loc(#loc122)
    %a_1894 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc70)
    %a_1895 = llvm.mul %accumulator_1893, %a_1894 : i32 loc(#loc70)
    %a_1896 = llvm.extractvalue %a_902[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1897 = llvm.extractvalue %a_902[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1898 = llvm.extractvalue %a_902[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1899 = llvm.extractvalue %a_902[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc70)
    %a_1900 = llvm.getelementptr %a_1896[%a_1895] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc70)
    %a_1901 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc70)
    %a_1902 = llvm.insertvalue %a_1900, %a_1901[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1903 = llvm.insertvalue %a_1898, %a_1902[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1904 = llvm.insertvalue %a_1899, %a_1903[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1905 = builtin.unrealized_conversion_cast %a_1904 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x64xf16, #shared, #smem, mutable> loc(#loc70)
    %accumulator_1906 = builtin.unrealized_conversion_cast %a_1905 : !ttg.memdesc<64x64xf16, #shared, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_1907 = llvm.extractvalue %a_1904[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1908 = llvm.extractvalue %a_1904[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1909 = llvm.extractvalue %a_1904[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_1910 = llvm.extractvalue %a_1240[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1911 = llvm.extractvalue %a_1240[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1912 = llvm.extractvalue %a_1240[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1913 = llvm.extractvalue %a_1240[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1914 = llvm.extractvalue %a_1240[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1915 = llvm.extractvalue %a_1240[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1916 = llvm.extractvalue %a_1240[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1917 = llvm.extractvalue %a_1240[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_1918 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1919 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_1920 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1921 = llvm.and %a_1919, %a_1920 : i32 loc(#loc70)
    %a_1922 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_1923 = llvm.urem %a_1921, %a_1922 : i32 loc(#loc70)
    %a_1924 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1925 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1926 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1927 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1928 = llvm.shl %a_1923, %a_1927 : i32 loc(#loc70)
    %a_1929 = llvm.or %a_1926, %a_1928 : i32 loc(#loc70)
    %a_1930 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_1931 = llvm.shl %a_21, %a_1930 : i32 loc(#loc70)
    %a_1932 = llvm.or %a_1929, %a_1931 : i32 loc(#loc70)
    %a_1933 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_1934 = llvm.and %a_1932, %a_1933 : i32 loc(#loc70)
    %a_1935 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_1936 = llvm.shl %a_1934, %a_1935 : i32 loc(#loc70)
    %a_1937 = llvm.mlir.constant(120 : i32) : i32 loc(#loc70)
    %a_1938 = llvm.and %a_1932, %a_1937 : i32 loc(#loc70)
    %a_1939 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1940 = llvm.lshr %a_1938, %a_1939 : i32 loc(#loc70)
    %a_1941 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1942 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1943 = llvm.xor %a_1936, %a_1940 : i32 loc(#loc70)
    %a_1944 = llvm.or disjoint %a_1942, %a_1943 : i32 loc(#loc70)
    %a_1945 = llvm.xor %a_1925, %a_1944 : i32 loc(#loc70)
    %a_1946 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1947 = llvm.mul %a_1918, %a_1946 : i32 loc(#loc70)
    %a_1948 = llvm.xor %a_1945, %a_1947 : i32 loc(#loc70)
    %a_1949 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1950 = llvm.xor %a_1948, %a_1949 : i32 loc(#loc70)
    %a_1951 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1952 = llvm.add %a_1950, %a_1951 : i32 loc(#loc70)
    %a_1953 = llvm.getelementptr inbounds %a_1907[%a_1952] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1954 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_1955 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1956 = llvm.insertelement %a_1910, %a_1954[%a_1955 : i32] : vector<4xf16> loc(#loc70)
    %a_1957 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1958 = llvm.insertelement %a_1911, %a_1956[%a_1957 : i32] : vector<4xf16> loc(#loc70)
    %a_1959 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1960 = llvm.insertelement %a_1912, %a_1958[%a_1959 : i32] : vector<4xf16> loc(#loc70)
    %a_1961 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1962 = llvm.insertelement %a_1913, %a_1960[%a_1961 : i32] : vector<4xf16> loc(#loc70)
    %a_1963 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_1962, %a_1953 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %a_1964 = llvm.mlir.constant(8 : i32) : i32 loc(#loc70)
    %a_1965 = llvm.xor %a_1948, %a_1964 : i32 loc(#loc70)
    %a_1966 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1967 = llvm.add %a_1965, %a_1966 : i32 loc(#loc70)
    %a_1968 = llvm.getelementptr inbounds %a_1907[%a_1967] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_1969 = llvm.mlir.undef : vector<4xf16> loc(#loc70)
    %a_1970 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_1971 = llvm.insertelement %a_1914, %a_1969[%a_1970 : i32] : vector<4xf16> loc(#loc70)
    %a_1972 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_1973 = llvm.insertelement %a_1915, %a_1971[%a_1972 : i32] : vector<4xf16> loc(#loc70)
    %a_1974 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_1975 = llvm.insertelement %a_1916, %a_1973[%a_1974 : i32] : vector<4xf16> loc(#loc70)
    %a_1976 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_1977 = llvm.insertelement %a_1917, %a_1975[%a_1976 : i32] : vector<4xf16> loc(#loc70)
    %a_1978 = llvm.mlir.constant(true) : i1 loc(#loc70)
    llvm.store %a_1977, %a_1968 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc70)
    %b_1979 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_1980 = llvm.mul %accumulator_1893, %b_1979 : i32 loc(#loc69)
    %b_1981 = llvm.extractvalue %b_910[0] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1982 = llvm.extractvalue %b_910[1] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1983 = llvm.extractvalue %b_910[2] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1984 = llvm.extractvalue %b_910[3] : !llvm.struct<(ptr<3>, i32, i32, i32)>  loc(#loc69)
    %b_1985 = llvm.getelementptr %b_1981[%b_1980] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc69)
    %b_1986 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc69)
    %b_1987 = llvm.insertvalue %b_1985, %b_1986[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1988 = llvm.insertvalue %b_1983, %b_1987[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1989 = llvm.insertvalue %b_1984, %b_1988[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1990 = builtin.unrealized_conversion_cast %b_1989 : !llvm.struct<(ptr<3>, i32, i32)> to !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> loc(#loc69)
    %accumulator_1991 = builtin.unrealized_conversion_cast %b_1990 : !ttg.memdesc<64x32xf16, #shared1, #smem, mutable> to !llvm.struct<(ptr<3>, i32, i32)> loc(#loc122)
    %b_1992 = llvm.extractvalue %b_1989[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1993 = llvm.extractvalue %b_1989[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1994 = llvm.extractvalue %b_1989[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_1995 = llvm.extractvalue %b_1429[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1996 = llvm.extractvalue %b_1429[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1997 = llvm.extractvalue %b_1429[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1998 = llvm.extractvalue %b_1429[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc69)
    %b_1999 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2000 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_2001 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2002 = llvm.and %b_2000, %b_2001 : i32 loc(#loc69)
    %b_2003 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2004 = llvm.urem %b_2002, %b_2003 : i32 loc(#loc69)
    %b_2005 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2006 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2007 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2008 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2009 = llvm.shl %b_2004, %b_2008 : i32 loc(#loc69)
    %b_2010 = llvm.or %b_2007, %b_2009 : i32 loc(#loc69)
    %b_2011 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_2012 = llvm.shl %b_15, %b_2011 : i32 loc(#loc69)
    %b_2013 = llvm.or %b_2010, %b_2012 : i32 loc(#loc69)
    %b_2014 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2015 = llvm.and %b_2013, %b_2014 : i32 loc(#loc69)
    %b_2016 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_2017 = llvm.shl %b_2015, %b_2016 : i32 loc(#loc69)
    %b_2018 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2019 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2020 = llvm.or disjoint %b_2017, %b_2019 : i32 loc(#loc69)
    %b_2021 = llvm.xor %b_2006, %b_2020 : i32 loc(#loc69)
    %b_2022 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2023 = llvm.mul %b_1999, %b_2022 : i32 loc(#loc69)
    %b_2024 = llvm.xor %b_2021, %b_2023 : i32 loc(#loc69)
    %b_2025 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2026 = llvm.xor %b_2024, %b_2025 : i32 loc(#loc69)
    %b_2027 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2028 = llvm.add %b_2026, %b_2027 : i32 loc(#loc69)
    %b_2029 = llvm.getelementptr inbounds %b_1992[%b_2028] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2030 = llvm.mlir.undef : vector<4xf16> loc(#loc69)
    %b_2031 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2032 = llvm.insertelement %b_1995, %b_2030[%b_2031 : i32] : vector<4xf16> loc(#loc69)
    %b_2033 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_2034 = llvm.insertelement %b_1996, %b_2032[%b_2033 : i32] : vector<4xf16> loc(#loc69)
    %b_2035 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2036 = llvm.insertelement %b_1997, %b_2034[%b_2035 : i32] : vector<4xf16> loc(#loc69)
    %b_2037 = llvm.mlir.constant(3 : i32) : i32 loc(#loc69)
    %b_2038 = llvm.insertelement %b_1998, %b_2036[%b_2037 : i32] : vector<4xf16> loc(#loc69)
    %b_2039 = llvm.mlir.constant(true) : i1 loc(#loc69)
    llvm.store %b_2038, %b_2029 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc69)
    %accumulator_2040 = llvm.add %accumulator_1058, %22 : i32 loc(#loc122)
    llvm.br ^bb1(%accumulator_2040, %accumulator_1890, %accumulator_1104, %accumulator_1123, %accumulator_1893, %accumulator_1906, %accumulator_1991 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc122)
  ^bb3:  // pred: ^bb1
    %accumulator_2041 = llvm.icmp "sge" %25, %22 : i32 loc(#loc122)
    rocdl.s.waitcnt 49279 loc(#loc70)
    rocdl.s.barrier loc(#loc70)
    %a_2042 = llvm.extractvalue %a_1062[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2043 = llvm.extractvalue %a_1062[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2044 = llvm.extractvalue %a_1062[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc70)
    %a_2045 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2046 = rocdl.workitem.id.x : i32 loc(#loc70)
    %a_2047 = llvm.mlir.constant(511 : i32) : i32 loc(#loc70)
    %a_2048 = llvm.and %a_2046, %a_2047 : i32 loc(#loc70)
    %a_2049 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_2050 = llvm.urem %a_2048, %a_2049 : i32 loc(#loc70)
    %a_2051 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2052 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2053 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2054 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2055 = llvm.shl %a_2050, %a_2054 : i32 loc(#loc70)
    %a_2056 = llvm.or %a_2053, %a_2055 : i32 loc(#loc70)
    %a_2057 = llvm.mlir.constant(6 : i32) : i32 loc(#loc70)
    %a_2058 = llvm.shl %a_9, %a_2057 : i32 loc(#loc70)
    %a_2059 = llvm.or %a_2056, %a_2058 : i32 loc(#loc70)
    %a_2060 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_2061 = llvm.and %a_2059, %a_2060 : i32 loc(#loc70)
    %a_2062 = llvm.mlir.constant(7 : i32) : i32 loc(#loc70)
    %a_2063 = llvm.shl %a_2061, %a_2062 : i32 loc(#loc70)
    %a_2064 = llvm.mlir.constant(384 : i32) : i32 loc(#loc70)
    %a_2065 = llvm.and %a_2059, %a_2064 : i32 loc(#loc70)
    %a_2066 = llvm.mlir.constant(4 : i32) : i32 loc(#loc70)
    %a_2067 = llvm.shl %a_2065, %a_2066 : i32 loc(#loc70)
    %a_2068 = llvm.mlir.constant(15 : i32) : i32 loc(#loc70)
    %a_2069 = llvm.and %a_2059, %a_2068 : i32 loc(#loc70)
    %a_2070 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2071 = llvm.shl %a_2069, %a_2070 : i32 loc(#loc70)
    %a_2072 = llvm.mlir.constant(48 : i32) : i32 loc(#loc70)
    %a_2073 = llvm.and %a_2059, %a_2072 : i32 loc(#loc70)
    %a_2074 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2075 = llvm.lshr %a_2073, %a_2074 : i32 loc(#loc70)
    %a_2076 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2077 = llvm.xor %a_2067, %a_2071 : i32 loc(#loc70)
    %a_2078 = llvm.xor %a_2077, %a_2075 : i32 loc(#loc70)
    %a_2079 = llvm.or disjoint %a_2063, %a_2078 : i32 loc(#loc70)
    %a_2080 = llvm.xor %a_2052, %a_2079 : i32 loc(#loc70)
    %a_2081 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2082 = llvm.mul %a_2045, %a_2081 : i32 loc(#loc70)
    %a_2083 = llvm.xor %a_2080, %a_2082 : i32 loc(#loc70)
    %a_2084 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2085 = llvm.xor %a_2083, %a_2084 : i32 loc(#loc70)
    %a_2086 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2087 = llvm.add %a_2085, %a_2086 : i32 loc(#loc70)
    %a_2088 = llvm.getelementptr inbounds %a_2042[%a_2087] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2089 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2090 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2091 = llvm.load %a_2088 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2092 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2093 = llvm.extractelement %a_2091[%a_2092 : i32] : vector<4xf16> loc(#loc70)
    %a_2094 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2095 = llvm.extractelement %a_2091[%a_2094 : i32] : vector<4xf16> loc(#loc70)
    %a_2096 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2097 = llvm.extractelement %a_2091[%a_2096 : i32] : vector<4xf16> loc(#loc70)
    %a_2098 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2099 = llvm.extractelement %a_2091[%a_2098 : i32] : vector<4xf16> loc(#loc70)
    %a_2100 = llvm.mlir.constant(32 : i32) : i32 loc(#loc70)
    %a_2101 = llvm.xor %a_2083, %a_2100 : i32 loc(#loc70)
    %a_2102 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2103 = llvm.add %a_2101, %a_2102 : i32 loc(#loc70)
    %a_2104 = llvm.getelementptr inbounds %a_2042[%a_2103] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2105 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2106 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2107 = llvm.load %a_2104 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2108 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2109 = llvm.extractelement %a_2107[%a_2108 : i32] : vector<4xf16> loc(#loc70)
    %a_2110 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2111 = llvm.extractelement %a_2107[%a_2110 : i32] : vector<4xf16> loc(#loc70)
    %a_2112 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2113 = llvm.extractelement %a_2107[%a_2112 : i32] : vector<4xf16> loc(#loc70)
    %a_2114 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2115 = llvm.extractelement %a_2107[%a_2114 : i32] : vector<4xf16> loc(#loc70)
    %a_2116 = llvm.mlir.constant(64 : i32) : i32 loc(#loc70)
    %a_2117 = llvm.xor %a_2083, %a_2116 : i32 loc(#loc70)
    %a_2118 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2119 = llvm.add %a_2117, %a_2118 : i32 loc(#loc70)
    %a_2120 = llvm.getelementptr inbounds %a_2042[%a_2119] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2121 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2122 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2123 = llvm.load %a_2120 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2124 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2125 = llvm.extractelement %a_2123[%a_2124 : i32] : vector<4xf16> loc(#loc70)
    %a_2126 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2127 = llvm.extractelement %a_2123[%a_2126 : i32] : vector<4xf16> loc(#loc70)
    %a_2128 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2129 = llvm.extractelement %a_2123[%a_2128 : i32] : vector<4xf16> loc(#loc70)
    %a_2130 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2131 = llvm.extractelement %a_2123[%a_2130 : i32] : vector<4xf16> loc(#loc70)
    %a_2132 = llvm.mlir.constant(96 : i32) : i32 loc(#loc70)
    %a_2133 = llvm.xor %a_2083, %a_2132 : i32 loc(#loc70)
    %a_2134 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2135 = llvm.add %a_2133, %a_2134 : i32 loc(#loc70)
    %a_2136 = llvm.getelementptr inbounds %a_2042[%a_2135] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc70)
    %a_2137 = llvm.mlir.constant(true) : i1 loc(#loc70)
    %a_2138 = llvm.mlir.constant(dense<0.000000e+00> : vector<4xf16>) : vector<4xf16> loc(#loc70)
    %a_2139 = llvm.load %a_2136 : !llvm.ptr<3> -> vector<4xf16> loc(#loc70)
    %a_2140 = llvm.mlir.constant(0 : i32) : i32 loc(#loc70)
    %a_2141 = llvm.extractelement %a_2139[%a_2140 : i32] : vector<4xf16> loc(#loc70)
    %a_2142 = llvm.mlir.constant(1 : i32) : i32 loc(#loc70)
    %a_2143 = llvm.extractelement %a_2139[%a_2142 : i32] : vector<4xf16> loc(#loc70)
    %a_2144 = llvm.mlir.constant(2 : i32) : i32 loc(#loc70)
    %a_2145 = llvm.extractelement %a_2139[%a_2144 : i32] : vector<4xf16> loc(#loc70)
    %a_2146 = llvm.mlir.constant(3 : i32) : i32 loc(#loc70)
    %a_2147 = llvm.extractelement %a_2139[%a_2146 : i32] : vector<4xf16> loc(#loc70)
    %a_2148 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc70)
    %a_2149 = llvm.insertvalue %a_2093, %a_2148[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2150 = llvm.insertvalue %a_2095, %a_2149[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2151 = llvm.insertvalue %a_2097, %a_2150[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2152 = llvm.insertvalue %a_2099, %a_2151[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2153 = llvm.insertvalue %a_2109, %a_2152[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2154 = llvm.insertvalue %a_2111, %a_2153[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2155 = llvm.insertvalue %a_2113, %a_2154[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2156 = llvm.insertvalue %a_2115, %a_2155[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2157 = llvm.insertvalue %a_2125, %a_2156[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2158 = llvm.insertvalue %a_2127, %a_2157[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2159 = llvm.insertvalue %a_2129, %a_2158[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2160 = llvm.insertvalue %a_2131, %a_2159[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2161 = llvm.insertvalue %a_2141, %a_2160[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2162 = llvm.insertvalue %a_2143, %a_2161[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2163 = llvm.insertvalue %a_2145, %a_2162[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %a_2164 = llvm.insertvalue %a_2147, %a_2163[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc70)
    %b_2165 = llvm.extractvalue %b_1063[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2166 = llvm.extractvalue %b_1063[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2167 = llvm.extractvalue %b_1063[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc69)
    %b_2168 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2169 = rocdl.workitem.id.x : i32 loc(#loc69)
    %b_2170 = llvm.mlir.constant(511 : i32) : i32 loc(#loc69)
    %b_2171 = llvm.and %b_2169, %b_2170 : i32 loc(#loc69)
    %b_2172 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2173 = llvm.urem %b_2171, %b_2172 : i32 loc(#loc69)
    %b_2174 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2175 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2176 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2177 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2178 = llvm.shl %b_2173, %b_2177 : i32 loc(#loc69)
    %b_2179 = llvm.or %b_2176, %b_2178 : i32 loc(#loc69)
    %b_2180 = llvm.mlir.constant(6 : i32) : i32 loc(#loc69)
    %b_2181 = llvm.shl %b_4, %b_2180 : i32 loc(#loc69)
    %b_2182 = llvm.or %b_2179, %b_2181 : i32 loc(#loc69)
    %b_2183 = llvm.mlir.constant(48 : i32) : i32 loc(#loc69)
    %b_2184 = llvm.and %b_2182, %b_2183 : i32 loc(#loc69)
    %b_2185 = llvm.mlir.constant(4 : i32) : i32 loc(#loc69)
    %b_2186 = llvm.shl %b_2184, %b_2185 : i32 loc(#loc69)
    %b_2187 = llvm.mlir.constant(15 : i32) : i32 loc(#loc69)
    %b_2188 = llvm.and %b_2182, %b_2187 : i32 loc(#loc69)
    %b_2189 = llvm.mlir.constant(1 : i32) : i32 loc(#loc69)
    %b_2190 = llvm.shl %b_2188, %b_2189 : i32 loc(#loc69)
    %b_2191 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2192 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2193 = llvm.and %b_2182, %b_2192 : i32 loc(#loc69)
    %b_2194 = llvm.icmp "eq" %b_2193, %b_2191 : i32 loc(#loc69)
    %b_2195 = llvm.mlir.constant(32 : i32) : i32 loc(#loc69)
    %b_2196 = llvm.select %b_2194, %b_2191, %b_2195 : i1, i32 loc(#loc69)
    %b_2197 = llvm.xor %b_2186, %b_2190 : i32 loc(#loc69)
    %b_2198 = llvm.or disjoint %b_2196, %b_2197 : i32 loc(#loc69)
    %b_2199 = llvm.xor %b_2175, %b_2198 : i32 loc(#loc69)
    %b_2200 = llvm.mlir.constant(2 : i32) : i32 loc(#loc69)
    %b_2201 = llvm.mul %b_2168, %b_2200 : i32 loc(#loc69)
    %b_2202 = llvm.xor %b_2199, %b_2201 : i32 loc(#loc69)
    %b_2203 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2204 = llvm.xor %b_2202, %b_2203 : i32 loc(#loc69)
    %b_2205 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2206 = llvm.add %b_2204, %b_2205 : i32 loc(#loc69)
    %b_2207 = llvm.getelementptr inbounds %b_2165[%b_2206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2208 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2209 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2210 = llvm.load %b_2207 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2211 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2212 = llvm.extractelement %b_2210[%b_2211 : i32] : vector<1xf16> loc(#loc69)
    %b_2213 = llvm.mlir.constant(64 : i32) : i32 loc(#loc69)
    %b_2214 = llvm.add %b_2204, %b_2213 : i32 loc(#loc69)
    %b_2215 = llvm.getelementptr inbounds %b_2165[%b_2214] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2216 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2217 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2218 = llvm.load %b_2215 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2219 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2220 = llvm.extractelement %b_2218[%b_2219 : i32] : vector<1xf16> loc(#loc69)
    %b_2221 = llvm.mlir.constant(128 : i32) : i32 loc(#loc69)
    %b_2222 = llvm.add %b_2204, %b_2221 : i32 loc(#loc69)
    %b_2223 = llvm.getelementptr inbounds %b_2165[%b_2222] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2224 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2225 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2226 = llvm.load %b_2223 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2227 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2228 = llvm.extractelement %b_2226[%b_2227 : i32] : vector<1xf16> loc(#loc69)
    %b_2229 = llvm.mlir.constant(192 : i32) : i32 loc(#loc69)
    %b_2230 = llvm.add %b_2204, %b_2229 : i32 loc(#loc69)
    %b_2231 = llvm.getelementptr inbounds %b_2165[%b_2230] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2232 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2233 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2234 = llvm.load %b_2231 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2235 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2236 = llvm.extractelement %b_2234[%b_2235 : i32] : vector<1xf16> loc(#loc69)
    %b_2237 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc69)
    %b_2238 = llvm.add %b_2204, %b_2237 : i32 loc(#loc69)
    %b_2239 = llvm.getelementptr inbounds %b_2165[%b_2238] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2240 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2241 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2242 = llvm.load %b_2239 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2243 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2244 = llvm.extractelement %b_2242[%b_2243 : i32] : vector<1xf16> loc(#loc69)
    %b_2245 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc69)
    %b_2246 = llvm.add %b_2204, %b_2245 : i32 loc(#loc69)
    %b_2247 = llvm.getelementptr inbounds %b_2165[%b_2246] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2248 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2249 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2250 = llvm.load %b_2247 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2251 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2252 = llvm.extractelement %b_2250[%b_2251 : i32] : vector<1xf16> loc(#loc69)
    %b_2253 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc69)
    %b_2254 = llvm.add %b_2204, %b_2253 : i32 loc(#loc69)
    %b_2255 = llvm.getelementptr inbounds %b_2165[%b_2254] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2256 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2257 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2258 = llvm.load %b_2255 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2259 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2260 = llvm.extractelement %b_2258[%b_2259 : i32] : vector<1xf16> loc(#loc69)
    %b_2261 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc69)
    %b_2262 = llvm.add %b_2204, %b_2261 : i32 loc(#loc69)
    %b_2263 = llvm.getelementptr inbounds %b_2165[%b_2262] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2264 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2265 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2266 = llvm.load %b_2263 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2267 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2268 = llvm.extractelement %b_2266[%b_2267 : i32] : vector<1xf16> loc(#loc69)
    %b_2269 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc69)
    %b_2270 = llvm.add %b_2204, %b_2269 : i32 loc(#loc69)
    %b_2271 = llvm.getelementptr inbounds %b_2165[%b_2270] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2272 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2273 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2274 = llvm.load %b_2271 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2275 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2276 = llvm.extractelement %b_2274[%b_2275 : i32] : vector<1xf16> loc(#loc69)
    %b_2277 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc69)
    %b_2278 = llvm.add %b_2204, %b_2277 : i32 loc(#loc69)
    %b_2279 = llvm.getelementptr inbounds %b_2165[%b_2278] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2280 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2281 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2282 = llvm.load %b_2279 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2283 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2284 = llvm.extractelement %b_2282[%b_2283 : i32] : vector<1xf16> loc(#loc69)
    %b_2285 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc69)
    %b_2286 = llvm.add %b_2204, %b_2285 : i32 loc(#loc69)
    %b_2287 = llvm.getelementptr inbounds %b_2165[%b_2286] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2288 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2289 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2290 = llvm.load %b_2287 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2291 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2292 = llvm.extractelement %b_2290[%b_2291 : i32] : vector<1xf16> loc(#loc69)
    %b_2293 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc69)
    %b_2294 = llvm.add %b_2204, %b_2293 : i32 loc(#loc69)
    %b_2295 = llvm.getelementptr inbounds %b_2165[%b_2294] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2296 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2297 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2298 = llvm.load %b_2295 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2299 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2300 = llvm.extractelement %b_2298[%b_2299 : i32] : vector<1xf16> loc(#loc69)
    %b_2301 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc69)
    %b_2302 = llvm.add %b_2204, %b_2301 : i32 loc(#loc69)
    %b_2303 = llvm.getelementptr inbounds %b_2165[%b_2302] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2304 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2305 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2306 = llvm.load %b_2303 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2307 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2308 = llvm.extractelement %b_2306[%b_2307 : i32] : vector<1xf16> loc(#loc69)
    %b_2309 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc69)
    %b_2310 = llvm.add %b_2204, %b_2309 : i32 loc(#loc69)
    %b_2311 = llvm.getelementptr inbounds %b_2165[%b_2310] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2312 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2313 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2314 = llvm.load %b_2311 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2315 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2316 = llvm.extractelement %b_2314[%b_2315 : i32] : vector<1xf16> loc(#loc69)
    %b_2317 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc69)
    %b_2318 = llvm.add %b_2204, %b_2317 : i32 loc(#loc69)
    %b_2319 = llvm.getelementptr inbounds %b_2165[%b_2318] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2320 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2321 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2322 = llvm.load %b_2319 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2323 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2324 = llvm.extractelement %b_2322[%b_2323 : i32] : vector<1xf16> loc(#loc69)
    %b_2325 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc69)
    %b_2326 = llvm.add %b_2204, %b_2325 : i32 loc(#loc69)
    %b_2327 = llvm.getelementptr inbounds %b_2165[%b_2326] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc69)
    %b_2328 = llvm.mlir.constant(true) : i1 loc(#loc69)
    %b_2329 = llvm.mlir.constant(dense<0.000000e+00> : vector<1xf16>) : vector<1xf16> loc(#loc69)
    %b_2330 = llvm.load %b_2327 : !llvm.ptr<3> -> vector<1xf16> loc(#loc69)
    %b_2331 = llvm.mlir.constant(0 : i32) : i32 loc(#loc69)
    %b_2332 = llvm.extractelement %b_2330[%b_2331 : i32] : vector<1xf16> loc(#loc69)
    %b_2333 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)> loc(#loc69)
    %b_2334 = llvm.insertvalue %b_2212, %b_2333[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2335 = llvm.insertvalue %b_2220, %b_2334[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2336 = llvm.insertvalue %b_2228, %b_2335[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2337 = llvm.insertvalue %b_2236, %b_2336[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2338 = llvm.insertvalue %b_2244, %b_2337[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2339 = llvm.insertvalue %b_2252, %b_2338[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2340 = llvm.insertvalue %b_2260, %b_2339[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2341 = llvm.insertvalue %b_2268, %b_2340[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2342 = llvm.insertvalue %b_2276, %b_2341[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2343 = llvm.insertvalue %b_2284, %b_2342[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2344 = llvm.insertvalue %b_2292, %b_2343[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2345 = llvm.insertvalue %b_2300, %b_2344[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2346 = llvm.insertvalue %b_2308, %b_2345[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2347 = llvm.insertvalue %b_2316, %b_2346[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2348 = llvm.insertvalue %b_2324, %b_2347[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    %b_2349 = llvm.insertvalue %b_2332, %b_2348[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc69)
    llvm.cond_br %accumulator_2041, ^bb4, ^bb5 loc(#loc106)
  ^bb4:  // pred: ^bb3
    %accumulator_2350 = llvm.extractvalue %a_2164[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2351 = llvm.extractvalue %a_2164[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2352 = llvm.extractvalue %a_2164[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2353 = llvm.extractvalue %a_2164[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2354 = llvm.extractvalue %a_2164[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2355 = llvm.extractvalue %a_2164[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2356 = llvm.extractvalue %a_2164[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2357 = llvm.extractvalue %a_2164[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2358 = llvm.extractvalue %a_2164[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2359 = llvm.extractvalue %a_2164[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2360 = llvm.extractvalue %a_2164[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2361 = llvm.extractvalue %a_2164[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2362 = llvm.extractvalue %a_2164[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2363 = llvm.extractvalue %a_2164[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2364 = llvm.extractvalue %a_2164[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2365 = llvm.extractvalue %a_2164[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2366 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2367 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2368 = llvm.insertelement %accumulator_2350, %accumulator_2366[%accumulator_2367 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2369 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2370 = llvm.insertelement %accumulator_2351, %accumulator_2368[%accumulator_2369 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2371 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2372 = llvm.insertelement %accumulator_2352, %accumulator_2370[%accumulator_2371 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2373 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2374 = llvm.insertelement %accumulator_2353, %accumulator_2372[%accumulator_2373 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2375 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2376 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2377 = llvm.extractelement %accumulator_2374[%accumulator_2376 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2378 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2379 = llvm.insertelement %accumulator_2377, %accumulator_2375[%accumulator_2378 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2380 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2381 = llvm.extractelement %accumulator_2374[%accumulator_2380 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2382 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2383 = llvm.insertelement %accumulator_2381, %accumulator_2379[%accumulator_2382 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2384 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2385 = llvm.extractelement %accumulator_2374[%accumulator_2384 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2386 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2387 = llvm.insertelement %accumulator_2385, %accumulator_2383[%accumulator_2386 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2388 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2389 = llvm.extractelement %accumulator_2374[%accumulator_2388 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2390 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2391 = llvm.insertelement %accumulator_2389, %accumulator_2387[%accumulator_2390 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2392 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2393 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2394 = llvm.insertelement %accumulator_2354, %accumulator_2392[%accumulator_2393 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2395 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2396 = llvm.insertelement %accumulator_2355, %accumulator_2394[%accumulator_2395 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2397 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2398 = llvm.insertelement %accumulator_2356, %accumulator_2396[%accumulator_2397 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2399 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2400 = llvm.insertelement %accumulator_2357, %accumulator_2398[%accumulator_2399 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2401 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2402 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2403 = llvm.extractelement %accumulator_2400[%accumulator_2402 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2404 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2405 = llvm.insertelement %accumulator_2403, %accumulator_2401[%accumulator_2404 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2406 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2407 = llvm.extractelement %accumulator_2400[%accumulator_2406 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2408 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2409 = llvm.insertelement %accumulator_2407, %accumulator_2405[%accumulator_2408 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2410 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2411 = llvm.extractelement %accumulator_2400[%accumulator_2410 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2412 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2413 = llvm.insertelement %accumulator_2411, %accumulator_2409[%accumulator_2412 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2414 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2415 = llvm.extractelement %accumulator_2400[%accumulator_2414 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2416 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2417 = llvm.insertelement %accumulator_2415, %accumulator_2413[%accumulator_2416 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2418 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2419 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2420 = llvm.insertelement %accumulator_2358, %accumulator_2418[%accumulator_2419 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2421 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2422 = llvm.insertelement %accumulator_2359, %accumulator_2420[%accumulator_2421 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2423 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2424 = llvm.insertelement %accumulator_2360, %accumulator_2422[%accumulator_2423 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2425 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2426 = llvm.insertelement %accumulator_2361, %accumulator_2424[%accumulator_2425 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2427 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2428 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2429 = llvm.extractelement %accumulator_2426[%accumulator_2428 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2430 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2431 = llvm.insertelement %accumulator_2429, %accumulator_2427[%accumulator_2430 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2432 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2433 = llvm.extractelement %accumulator_2426[%accumulator_2432 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2434 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2435 = llvm.insertelement %accumulator_2433, %accumulator_2431[%accumulator_2434 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2436 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2437 = llvm.extractelement %accumulator_2426[%accumulator_2436 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2438 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2439 = llvm.insertelement %accumulator_2437, %accumulator_2435[%accumulator_2438 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2440 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2441 = llvm.extractelement %accumulator_2426[%accumulator_2440 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2442 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2443 = llvm.insertelement %accumulator_2441, %accumulator_2439[%accumulator_2442 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2444 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2445 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2446 = llvm.insertelement %accumulator_2362, %accumulator_2444[%accumulator_2445 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2447 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2448 = llvm.insertelement %accumulator_2363, %accumulator_2446[%accumulator_2447 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2449 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2450 = llvm.insertelement %accumulator_2364, %accumulator_2448[%accumulator_2449 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2451 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2452 = llvm.insertelement %accumulator_2365, %accumulator_2450[%accumulator_2451 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2453 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2454 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2455 = llvm.extractelement %accumulator_2452[%accumulator_2454 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2456 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2457 = llvm.insertelement %accumulator_2455, %accumulator_2453[%accumulator_2456 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2458 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2459 = llvm.extractelement %accumulator_2452[%accumulator_2458 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2460 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2461 = llvm.insertelement %accumulator_2459, %accumulator_2457[%accumulator_2460 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2462 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2463 = llvm.extractelement %accumulator_2452[%accumulator_2462 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2464 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2465 = llvm.insertelement %accumulator_2463, %accumulator_2461[%accumulator_2464 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2466 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2467 = llvm.extractelement %accumulator_2452[%accumulator_2466 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2468 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2469 = llvm.insertelement %accumulator_2467, %accumulator_2465[%accumulator_2468 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2470 = llvm.extractvalue %b_2349[0] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2471 = llvm.extractvalue %b_2349[1] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2472 = llvm.extractvalue %b_2349[2] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2473 = llvm.extractvalue %b_2349[3] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2474 = llvm.extractvalue %b_2349[4] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2475 = llvm.extractvalue %b_2349[5] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2476 = llvm.extractvalue %b_2349[6] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2477 = llvm.extractvalue %b_2349[7] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2478 = llvm.extractvalue %b_2349[8] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2479 = llvm.extractvalue %b_2349[9] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2480 = llvm.extractvalue %b_2349[10] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2481 = llvm.extractvalue %b_2349[11] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2482 = llvm.extractvalue %b_2349[12] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2483 = llvm.extractvalue %b_2349[13] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2484 = llvm.extractvalue %b_2349[14] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2485 = llvm.extractvalue %b_2349[15] : !llvm.struct<(f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16, f16)>  loc(#loc106)
    %accumulator_2486 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2487 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2488 = llvm.insertelement %accumulator_2470, %accumulator_2486[%accumulator_2487 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2489 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2490 = llvm.insertelement %accumulator_2471, %accumulator_2488[%accumulator_2489 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2491 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2492 = llvm.insertelement %accumulator_2472, %accumulator_2490[%accumulator_2491 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2493 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2494 = llvm.insertelement %accumulator_2473, %accumulator_2492[%accumulator_2493 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2495 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2496 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2497 = llvm.extractelement %accumulator_2494[%accumulator_2496 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2498 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2499 = llvm.insertelement %accumulator_2497, %accumulator_2495[%accumulator_2498 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2500 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2501 = llvm.extractelement %accumulator_2494[%accumulator_2500 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2502 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2503 = llvm.insertelement %accumulator_2501, %accumulator_2499[%accumulator_2502 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2504 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2505 = llvm.extractelement %accumulator_2494[%accumulator_2504 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2506 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2507 = llvm.insertelement %accumulator_2505, %accumulator_2503[%accumulator_2506 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2508 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2509 = llvm.extractelement %accumulator_2494[%accumulator_2508 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2510 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2511 = llvm.insertelement %accumulator_2509, %accumulator_2507[%accumulator_2510 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2512 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2513 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2514 = llvm.insertelement %accumulator_2474, %accumulator_2512[%accumulator_2513 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2515 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2516 = llvm.insertelement %accumulator_2475, %accumulator_2514[%accumulator_2515 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2517 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2518 = llvm.insertelement %accumulator_2476, %accumulator_2516[%accumulator_2517 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2519 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2520 = llvm.insertelement %accumulator_2477, %accumulator_2518[%accumulator_2519 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2521 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2522 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2523 = llvm.extractelement %accumulator_2520[%accumulator_2522 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2524 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2525 = llvm.insertelement %accumulator_2523, %accumulator_2521[%accumulator_2524 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2526 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2527 = llvm.extractelement %accumulator_2520[%accumulator_2526 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2528 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2529 = llvm.insertelement %accumulator_2527, %accumulator_2525[%accumulator_2528 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2530 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2531 = llvm.extractelement %accumulator_2520[%accumulator_2530 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2532 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2533 = llvm.insertelement %accumulator_2531, %accumulator_2529[%accumulator_2532 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2534 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2535 = llvm.extractelement %accumulator_2520[%accumulator_2534 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2536 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2537 = llvm.insertelement %accumulator_2535, %accumulator_2533[%accumulator_2536 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2538 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2539 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2540 = llvm.insertelement %accumulator_2478, %accumulator_2538[%accumulator_2539 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2541 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2542 = llvm.insertelement %accumulator_2479, %accumulator_2540[%accumulator_2541 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2543 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2544 = llvm.insertelement %accumulator_2480, %accumulator_2542[%accumulator_2543 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2545 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2546 = llvm.insertelement %accumulator_2481, %accumulator_2544[%accumulator_2545 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2547 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2548 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2549 = llvm.extractelement %accumulator_2546[%accumulator_2548 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2550 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2551 = llvm.insertelement %accumulator_2549, %accumulator_2547[%accumulator_2550 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2552 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2553 = llvm.extractelement %accumulator_2546[%accumulator_2552 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2554 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2555 = llvm.insertelement %accumulator_2553, %accumulator_2551[%accumulator_2554 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2556 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2557 = llvm.extractelement %accumulator_2546[%accumulator_2556 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2558 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2559 = llvm.insertelement %accumulator_2557, %accumulator_2555[%accumulator_2558 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2560 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2561 = llvm.extractelement %accumulator_2546[%accumulator_2560 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2562 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2563 = llvm.insertelement %accumulator_2561, %accumulator_2559[%accumulator_2562 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2564 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2565 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2566 = llvm.insertelement %accumulator_2482, %accumulator_2564[%accumulator_2565 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2567 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2568 = llvm.insertelement %accumulator_2483, %accumulator_2566[%accumulator_2567 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2569 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2570 = llvm.insertelement %accumulator_2484, %accumulator_2568[%accumulator_2569 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2571 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2572 = llvm.insertelement %accumulator_2485, %accumulator_2570[%accumulator_2571 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2573 = llvm.mlir.undef : vector<4xf16> loc(#loc106)
    %accumulator_2574 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2575 = llvm.extractelement %accumulator_2572[%accumulator_2574 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2576 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2577 = llvm.insertelement %accumulator_2575, %accumulator_2573[%accumulator_2576 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2578 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2579 = llvm.extractelement %accumulator_2572[%accumulator_2578 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2580 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2581 = llvm.insertelement %accumulator_2579, %accumulator_2577[%accumulator_2580 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2582 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2583 = llvm.extractelement %accumulator_2572[%accumulator_2582 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2584 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2585 = llvm.insertelement %accumulator_2583, %accumulator_2581[%accumulator_2584 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2586 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2587 = llvm.extractelement %accumulator_2572[%accumulator_2586 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2588 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2589 = llvm.insertelement %accumulator_2587, %accumulator_2585[%accumulator_2588 : i32] : vector<4xf16> loc(#loc106)
    %accumulator_2590 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2591 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2592 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2593 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2594 = llvm.mlir.undef : vector<4xf32> loc(#loc106)
    %accumulator_2595 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2596 = llvm.insertelement %accumulator_2590, %accumulator_2594[%accumulator_2595 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2597 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2598 = llvm.insertelement %accumulator_2591, %accumulator_2596[%accumulator_2597 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2599 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2600 = llvm.insertelement %accumulator_2592, %accumulator_2598[%accumulator_2599 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2601 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2602 = llvm.insertelement %accumulator_2593, %accumulator_2600[%accumulator_2601 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2603 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2604 = rocdl.mfma.f32.16x16x16f16 %accumulator_2511, %accumulator_2391, %accumulator_2602, %accumulator_2603, %accumulator_2603, %accumulator_2603 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2605 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2606 = rocdl.mfma.f32.16x16x16f16 %accumulator_2537, %accumulator_2417, %accumulator_2604, %accumulator_2605, %accumulator_2605, %accumulator_2605 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2607 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2608 = rocdl.mfma.f32.16x16x16f16 %accumulator_2563, %accumulator_2443, %accumulator_2606, %accumulator_2607, %accumulator_2607, %accumulator_2607 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2609 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2610 = rocdl.mfma.f32.16x16x16f16 %accumulator_2589, %accumulator_2469, %accumulator_2608, %accumulator_2609, %accumulator_2609, %accumulator_2609 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc106)
    %accumulator_2611 = llvm.mlir.constant(0 : i32) : i32 loc(#loc106)
    %accumulator_2612 = llvm.extractelement %accumulator_2610[%accumulator_2611 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2613 = llvm.mlir.constant(1 : i32) : i32 loc(#loc106)
    %accumulator_2614 = llvm.extractelement %accumulator_2610[%accumulator_2613 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2615 = llvm.mlir.constant(2 : i32) : i32 loc(#loc106)
    %accumulator_2616 = llvm.extractelement %accumulator_2610[%accumulator_2615 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2617 = llvm.mlir.constant(3 : i32) : i32 loc(#loc106)
    %accumulator_2618 = llvm.extractelement %accumulator_2610[%accumulator_2617 : i32] : vector<4xf32> loc(#loc106)
    %accumulator_2619 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    %accumulator_2620 = llvm.insertvalue %accumulator_2612, %accumulator_2619[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2621 = llvm.insertvalue %accumulator_2614, %accumulator_2620[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2622 = llvm.insertvalue %accumulator_2616, %accumulator_2621[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2623 = llvm.insertvalue %accumulator_2618, %accumulator_2622[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc106)
    %accumulator_2624 = builtin.unrealized_conversion_cast %accumulator_2623 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    %accumulator_2625 = builtin.unrealized_conversion_cast %accumulator_2624 : tensor<64x32xf32, #mma> to !llvm.struct<(f32, f32, f32, f32)> loc(#loc106)
    llvm.br ^bb6(%accumulator_2625 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc106)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_1059 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc106)
  ^bb6(%accumulator_2626: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    %accumulator_2627 = builtin.unrealized_conversion_cast %accumulator_2626 : !llvm.struct<(f32, f32, f32, f32)> to tensor<64x32xf32, #mma> loc(#loc106)
    llvm.br ^bb7 loc(#loc106)
  ^bb7:  // pred: ^bb6
    %accumulator_2628 = llvm.extractvalue %accumulator_2626[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2629 = llvm.extractvalue %accumulator_2626[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2630 = llvm.extractvalue %accumulator_2626[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2631 = llvm.extractvalue %accumulator_2626[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2632 = llvm.extractvalue %accumulator_1059[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2633 = llvm.extractvalue %accumulator_1059[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2634 = llvm.extractvalue %accumulator_1059[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2635 = llvm.extractvalue %accumulator_1059[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2636 = llvm.select %accumulator_2041, %accumulator_2628, %accumulator_2632 : i1, f32 loc(#loc122)
    %accumulator_2637 = llvm.select %accumulator_2041, %accumulator_2629, %accumulator_2633 : i1, f32 loc(#loc122)
    %accumulator_2638 = llvm.select %accumulator_2041, %accumulator_2630, %accumulator_2634 : i1, f32 loc(#loc122)
    %accumulator_2639 = llvm.select %accumulator_2041, %accumulator_2631, %accumulator_2635 : i1, f32 loc(#loc122)
    %accumulator_2640 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc122)
    %accumulator_2641 = llvm.insertvalue %accumulator_2636, %accumulator_2640[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2642 = llvm.insertvalue %accumulator_2637, %accumulator_2641[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2643 = llvm.insertvalue %accumulator_2638, %accumulator_2642[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %accumulator_2644 = llvm.insertvalue %accumulator_2639, %accumulator_2643[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc122)
    %c = llvm.extractvalue %accumulator_2644[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2645 = llvm.extractvalue %accumulator_2644[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2646 = llvm.extractvalue %accumulator_2644[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2647 = llvm.extractvalue %accumulator_2644[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc107)
    %c_2648 = llvm.fptrunc %c : f32 to f16 loc(#loc107)
    %c_2649 = llvm.fptrunc %c_2645 : f32 to f16 loc(#loc107)
    %c_2650 = llvm.fptrunc %c_2646 : f32 to f16 loc(#loc107)
    %c_2651 = llvm.fptrunc %c_2647 : f32 to f16 loc(#loc107)
    %c_2652 = llvm.mlir.undef : !llvm.struct<(f16, f16, f16, f16)> loc(#loc107)
    %c_2653 = llvm.insertvalue %c_2648, %c_2652[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2654 = llvm.insertvalue %c_2649, %c_2653[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2655 = llvm.insertvalue %c_2650, %c_2654[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_2656 = llvm.insertvalue %c_2651, %c_2655[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc107)
    %c_ptrs = llvm.extractvalue %offs_am_176[0] : !llvm.struct<(i32)>  loc(#loc108)
    %c_ptrs_2657 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc108)
    %c_ptrs_2658 = llvm.insertvalue %c_ptrs, %c_ptrs_2657[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2659 = llvm.insertvalue %c_ptrs, %c_ptrs_2658[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2660 = llvm.insertvalue %c_ptrs, %c_ptrs_2659[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2661 = llvm.insertvalue %c_ptrs, %c_ptrs_2660[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc108)
    %c_ptrs_2662 = llvm.mul %stride_cm, %offs_am_95 : i32 loc(#loc109)
    %c_ptrs_2663 = llvm.extractvalue %offs_bn_298[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2664 = llvm.extractvalue %offs_bn_298[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2665 = llvm.extractvalue %offs_bn_298[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2666 = llvm.extractvalue %offs_bn_298[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2667 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc110)
    %c_ptrs_2668 = llvm.insertvalue %c_ptrs_2663, %c_ptrs_2667[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2669 = llvm.insertvalue %c_ptrs_2664, %c_ptrs_2668[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2670 = llvm.insertvalue %c_ptrs_2665, %c_ptrs_2669[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2671 = llvm.insertvalue %c_ptrs_2666, %c_ptrs_2670[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc110)
    %c_ptrs_2672 = llvm.extractvalue %offs_am_160[0] : !llvm.struct<(i32)>  loc(#loc111)
    %c_ptrs_2673 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2674 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2673[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2675 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2674[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2676 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2675[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2677 = llvm.insertvalue %c_ptrs_2672, %c_ptrs_2676[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2678 = llvm.bitcast %stride_cm : i32 to i32 loc(#loc111)
    %c_ptrs_2679 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2680 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2679[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2681 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2680[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2682 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2681[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2683 = llvm.insertvalue %c_ptrs_2678, %c_ptrs_2682[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2684 = llvm.extractvalue %c_ptrs_2683[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2685 = llvm.extractvalue %c_ptrs_2683[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2686 = llvm.extractvalue %c_ptrs_2683[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2687 = llvm.extractvalue %c_ptrs_2683[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2688 = llvm.extractvalue %c_ptrs_2677[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2689 = llvm.extractvalue %c_ptrs_2677[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2690 = llvm.extractvalue %c_ptrs_2677[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2691 = llvm.extractvalue %c_ptrs_2677[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2692 = llvm.mul %c_ptrs_2684, %c_ptrs_2688 : i32 loc(#loc111)
    %c_ptrs_2693 = llvm.mul %c_ptrs_2685, %c_ptrs_2689 : i32 loc(#loc111)
    %c_ptrs_2694 = llvm.mul %c_ptrs_2686, %c_ptrs_2690 : i32 loc(#loc111)
    %c_ptrs_2695 = llvm.mul %c_ptrs_2687, %c_ptrs_2691 : i32 loc(#loc111)
    %c_ptrs_2696 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2697 = llvm.insertvalue %c_ptrs_2692, %c_ptrs_2696[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2698 = llvm.insertvalue %c_ptrs_2693, %c_ptrs_2697[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2699 = llvm.insertvalue %c_ptrs_2694, %c_ptrs_2698[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2700 = llvm.insertvalue %c_ptrs_2695, %c_ptrs_2699[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2701 = llvm.extractvalue %c_ptrs_2700[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2702 = llvm.extractvalue %c_ptrs_2700[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2703 = llvm.extractvalue %c_ptrs_2700[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2704 = llvm.extractvalue %c_ptrs_2700[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2705 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2706 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2705[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2707 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2706[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2708 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2707[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2709 = llvm.insertvalue %c_ptrs_2704, %c_ptrs_2708[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2710 = llvm.extractvalue %offs_bn_227[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2711 = llvm.extractvalue %offs_bn_227[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2712 = llvm.extractvalue %offs_bn_227[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2713 = llvm.extractvalue %offs_bn_227[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2714 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2715 = llvm.insertvalue %c_ptrs_2710, %c_ptrs_2714[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2716 = llvm.insertvalue %c_ptrs_2711, %c_ptrs_2715[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2717 = llvm.insertvalue %c_ptrs_2712, %c_ptrs_2716[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2718 = llvm.insertvalue %c_ptrs_2713, %c_ptrs_2717[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2719 = llvm.extractvalue %c_ptrs_2718[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2720 = llvm.extractvalue %c_ptrs_2718[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2721 = llvm.extractvalue %c_ptrs_2718[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2722 = llvm.extractvalue %c_ptrs_2718[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2723 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2724 = llvm.insertvalue %c_ptrs_2719, %c_ptrs_2723[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2725 = llvm.insertvalue %c_ptrs_2720, %c_ptrs_2724[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2726 = llvm.insertvalue %c_ptrs_2721, %c_ptrs_2725[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2727 = llvm.insertvalue %c_ptrs_2722, %c_ptrs_2726[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2728 = llvm.add %c_ptrs_2662, %offs_bn_185 : i32 loc(#loc111)
    %c_ptrs_2729 = llvm.extractvalue %c_ptrs_2709[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2730 = llvm.extractvalue %c_ptrs_2709[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2731 = llvm.extractvalue %c_ptrs_2709[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2732 = llvm.extractvalue %c_ptrs_2709[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2733 = llvm.extractvalue %c_ptrs_2727[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2734 = llvm.extractvalue %c_ptrs_2727[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2735 = llvm.extractvalue %c_ptrs_2727[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2736 = llvm.extractvalue %c_ptrs_2727[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2737 = llvm.add %c_ptrs_2729, %c_ptrs_2733 : i32 loc(#loc111)
    %c_ptrs_2738 = llvm.add %c_ptrs_2730, %c_ptrs_2734 : i32 loc(#loc111)
    %c_ptrs_2739 = llvm.add %c_ptrs_2731, %c_ptrs_2735 : i32 loc(#loc111)
    %c_ptrs_2740 = llvm.add %c_ptrs_2732, %c_ptrs_2736 : i32 loc(#loc111)
    %c_ptrs_2741 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2742 = llvm.insertvalue %c_ptrs_2737, %c_ptrs_2741[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2743 = llvm.insertvalue %c_ptrs_2738, %c_ptrs_2742[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2744 = llvm.insertvalue %c_ptrs_2739, %c_ptrs_2743[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2745 = llvm.insertvalue %c_ptrs_2740, %c_ptrs_2744[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2746 = llvm.bitcast %c_ptrs_2728 : i32 to i32 loc(#loc111)
    %c_ptrs_2747 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2748 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2747[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2749 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2748[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2750 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2749[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2751 = llvm.insertvalue %c_ptrs_2746, %c_ptrs_2750[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2752 = llvm.extractvalue %c_ptrs_2751[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2753 = llvm.extractvalue %c_ptrs_2751[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2754 = llvm.extractvalue %c_ptrs_2751[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2755 = llvm.extractvalue %c_ptrs_2751[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2756 = llvm.extractvalue %c_ptrs_2745[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2757 = llvm.extractvalue %c_ptrs_2745[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2758 = llvm.extractvalue %c_ptrs_2745[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2759 = llvm.extractvalue %c_ptrs_2745[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2760 = llvm.add %c_ptrs_2752, %c_ptrs_2756 : i32 loc(#loc111)
    %c_ptrs_2761 = llvm.add %c_ptrs_2753, %c_ptrs_2757 : i32 loc(#loc111)
    %c_ptrs_2762 = llvm.add %c_ptrs_2754, %c_ptrs_2758 : i32 loc(#loc111)
    %c_ptrs_2763 = llvm.add %c_ptrs_2755, %c_ptrs_2759 : i32 loc(#loc111)
    %c_ptrs_2764 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc111)
    %c_ptrs_2765 = llvm.insertvalue %c_ptrs_2760, %c_ptrs_2764[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2766 = llvm.insertvalue %c_ptrs_2761, %c_ptrs_2765[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2767 = llvm.insertvalue %c_ptrs_2762, %c_ptrs_2766[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_ptrs_2768 = llvm.insertvalue %c_ptrs_2763, %c_ptrs_2767[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc111)
    %c_mask = llvm.bitcast %M : i32 to i32 loc(#loc112)
    %c_mask_2769 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc112)
    %c_mask_2770 = llvm.insertvalue %c_mask, %c_mask_2769[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2771 = llvm.insertvalue %c_mask, %c_mask_2770[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2772 = llvm.insertvalue %c_mask, %c_mask_2771[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2773 = llvm.insertvalue %c_mask, %c_mask_2772[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2774 = llvm.extractvalue %c_ptrs_2661[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2775 = llvm.extractvalue %c_ptrs_2661[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2776 = llvm.extractvalue %c_ptrs_2661[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2777 = llvm.extractvalue %c_ptrs_2661[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2778 = llvm.extractvalue %c_mask_2773[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2779 = llvm.extractvalue %c_mask_2773[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2780 = llvm.extractvalue %c_mask_2773[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2781 = llvm.extractvalue %c_mask_2773[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc112)
    %c_mask_2782 = llvm.icmp "slt" %c_mask_2774, %c_mask_2778 : i32 loc(#loc112)
    %c_mask_2783 = llvm.icmp "slt" %c_mask_2775, %c_mask_2779 : i32 loc(#loc112)
    %c_mask_2784 = llvm.icmp "slt" %c_mask_2776, %c_mask_2780 : i32 loc(#loc112)
    %c_mask_2785 = llvm.icmp "slt" %c_mask_2777, %c_mask_2781 : i32 loc(#loc112)
    %c_mask_2786 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc112)
    %c_mask_2787 = llvm.insertvalue %c_mask_2782, %c_mask_2786[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2788 = llvm.insertvalue %c_mask_2782, %c_mask_2787[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2789 = llvm.insertvalue %c_mask_2782, %c_mask_2788[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2790 = llvm.insertvalue %c_mask_2782, %c_mask_2789[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc112)
    %c_mask_2791 = llvm.bitcast %N : i32 to i32 loc(#loc113)
    %c_mask_2792 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc113)
    %c_mask_2793 = llvm.insertvalue %c_mask_2791, %c_mask_2792[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2794 = llvm.insertvalue %c_mask_2791, %c_mask_2793[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2795 = llvm.insertvalue %c_mask_2791, %c_mask_2794[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2796 = llvm.insertvalue %c_mask_2791, %c_mask_2795[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2797 = llvm.extractvalue %c_ptrs_2671[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2798 = llvm.extractvalue %c_ptrs_2671[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2799 = llvm.extractvalue %c_ptrs_2671[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2800 = llvm.extractvalue %c_ptrs_2671[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2801 = llvm.extractvalue %c_mask_2796[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2802 = llvm.extractvalue %c_mask_2796[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2803 = llvm.extractvalue %c_mask_2796[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2804 = llvm.extractvalue %c_mask_2796[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc113)
    %c_mask_2805 = llvm.icmp "slt" %c_mask_2797, %c_mask_2801 : i32 loc(#loc113)
    %c_mask_2806 = llvm.icmp "slt" %c_mask_2798, %c_mask_2802 : i32 loc(#loc113)
    %c_mask_2807 = llvm.icmp "slt" %c_mask_2799, %c_mask_2803 : i32 loc(#loc113)
    %c_mask_2808 = llvm.icmp "slt" %c_mask_2800, %c_mask_2804 : i32 loc(#loc113)
    %c_mask_2809 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc113)
    %c_mask_2810 = llvm.insertvalue %c_mask_2805, %c_mask_2809[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2811 = llvm.insertvalue %c_mask_2805, %c_mask_2810[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2812 = llvm.insertvalue %c_mask_2805, %c_mask_2811[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2813 = llvm.insertvalue %c_mask_2805, %c_mask_2812[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc113)
    %c_mask_2814 = llvm.extractvalue %c_mask_2790[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2815 = llvm.extractvalue %c_mask_2790[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2816 = llvm.extractvalue %c_mask_2790[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2817 = llvm.extractvalue %c_mask_2790[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2818 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2819 = llvm.insertvalue %c_mask_2817, %c_mask_2818[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2820 = llvm.insertvalue %c_mask_2817, %c_mask_2819[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2821 = llvm.insertvalue %c_mask_2817, %c_mask_2820[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2822 = llvm.insertvalue %c_mask_2817, %c_mask_2821[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2823 = llvm.extractvalue %c_mask_2813[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2824 = llvm.extractvalue %c_mask_2813[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2825 = llvm.extractvalue %c_mask_2813[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2826 = llvm.extractvalue %c_mask_2813[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2827 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2828 = llvm.insertvalue %c_mask_2823, %c_mask_2827[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2829 = llvm.insertvalue %c_mask_2824, %c_mask_2828[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2830 = llvm.insertvalue %c_mask_2825, %c_mask_2829[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2831 = llvm.insertvalue %c_mask_2826, %c_mask_2830[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2832 = llvm.extractvalue %c_mask_2822[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2833 = llvm.extractvalue %c_mask_2822[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2834 = llvm.extractvalue %c_mask_2822[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2835 = llvm.extractvalue %c_mask_2822[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2836 = llvm.extractvalue %c_mask_2831[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2837 = llvm.extractvalue %c_mask_2831[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2838 = llvm.extractvalue %c_mask_2831[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2839 = llvm.extractvalue %c_mask_2831[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2840 = llvm.and %c_mask_2832, %c_mask_2836 : i1 loc(#loc114)
    %c_mask_2841 = llvm.and %c_mask_2833, %c_mask_2837 : i1 loc(#loc114)
    %c_mask_2842 = llvm.and %c_mask_2834, %c_mask_2838 : i1 loc(#loc114)
    %c_mask_2843 = llvm.and %c_mask_2835, %c_mask_2839 : i1 loc(#loc114)
    %c_mask_2844 = llvm.mlir.undef : !llvm.struct<(i1, i1, i1, i1)> loc(#loc114)
    %c_mask_2845 = llvm.insertvalue %c_mask_2840, %c_mask_2844[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2846 = llvm.insertvalue %c_mask_2840, %c_mask_2845[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2847 = llvm.insertvalue %c_mask_2840, %c_mask_2846[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %c_mask_2848 = llvm.insertvalue %c_mask_2840, %c_mask_2847[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc114)
    %29 = llvm.extractvalue %c_ptrs_2768[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %30 = llvm.extractvalue %c_ptrs_2768[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %31 = llvm.extractvalue %c_ptrs_2768[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %32 = llvm.extractvalue %c_ptrs_2768[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc1)
    %33 = llvm.extractvalue %c_2656[0] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %34 = llvm.extractvalue %c_2656[1] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %35 = llvm.extractvalue %c_2656[2] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %36 = llvm.extractvalue %c_2656[3] : !llvm.struct<(f16, f16, f16, f16)>  loc(#loc1)
    %37 = llvm.extractvalue %c_mask_2848[0] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %38 = llvm.extractvalue %c_mask_2848[1] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %39 = llvm.extractvalue %c_mask_2848[2] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %40 = llvm.extractvalue %c_mask_2848[3] : !llvm.struct<(i1, i1, i1, i1)>  loc(#loc1)
    %41 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %42 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %43 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %44 = rocdl.make.buffer.rsrc %c_ptr, %41, %43, %42 : <1> to <8> loc(#loc1)
    %45 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %46 = rocdl.workitem.id.x : i32 loc(#loc1)
    %47 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %48 = llvm.and %46, %47 : i32 loc(#loc1)
    %49 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %50 = llvm.urem %48, %49 : i32 loc(#loc1)
    %51 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %52 = llvm.and %51, %37 : i1 loc(#loc1)
    %53 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %54 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %55 = llvm.insertelement %33, %53[%54 : i32] : vector<4xf16> loc(#loc1)
    %56 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %57 = llvm.insertelement %34, %55[%56 : i32] : vector<4xf16> loc(#loc1)
    %58 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %59 = llvm.insertelement %35, %57[%58 : i32] : vector<4xf16> loc(#loc1)
    %60 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %61 = llvm.insertelement %36, %59[%60 : i32] : vector<4xf16> loc(#loc1)
    %62 = llvm.bitcast %61 : vector<4xf16> to vector<2xi32> loc(#loc1)
    %63 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %64 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %65 = llvm.mul %64, %29 : i32 loc(#loc1)
    %66 = llvm.select %52, %65, %63 : i1, i32 loc(#loc1)
    %67 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %68 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    rocdl.raw.ptr.buffer.store %62, %44, %66, %67, %68 : vector<2xi32> loc(#loc1)
    llvm.return loc(#loc59)
  } loc(#loc)
} loc(#loc)
#loc1 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc4 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc13 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc14 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc15 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc16 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:41)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:72)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc58 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc59 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc71 = loc("b_ptrs"(#loc4))
#loc72 = loc("a_ptrs"(#loc5))
#loc73 = loc("offs_bn"(#loc6))
#loc74 = loc("offs_am"(#loc7))
#loc75 = loc("num_pid_n"(#loc9))
#loc78 = loc("pid"(#loc13))
#loc79 = loc("num_pid_m"(#loc15))
#loc80 = loc("num_pid_in_group"(#loc17))
#loc81 = loc("group_id"(#loc18))
#loc82 = loc("first_pid_m"(#loc19))
#loc83 = loc("group_size_m"(#loc20))
#loc84 = loc("group_size_m"(#loc21))
#loc85 = loc("pid_m"(#loc22))
#loc86 = loc("pid_m"(#loc23))
#loc87 = loc("pid_m"(#loc24))
#loc88 = loc("pid_n"(#loc25))
#loc89 = loc("offs_am"(#loc34))
#loc90 = loc("offs_am"(#loc35))
#loc91 = loc("offs_am"(#loc36))
#loc92 = loc("offs_bn"(#loc37))
#loc93 = loc("offs_bn"(#loc38))
#loc94 = loc("offs_bn"(#loc39))
#loc96 = loc(callsite(#loc14 at #loc41))
#loc97 = loc(callsite(#loc16 at #loc41))
#loc98 = loc("a"(#loc42))
#loc100 = loc("b"(#loc44))
#loc101 = loc("b_ptrs"(#loc45))
#loc102 = loc("b_ptrs"(#loc46))
#loc103 = loc("a_ptrs"(#loc47))
#loc104 = loc("a"(#loc48))
#loc105 = loc("a"(#loc49))
#loc107 = loc("c"(#loc51))
#loc108 = loc("c_ptrs"(#loc52))
#loc109 = loc("c_ptrs"(#loc53))
#loc110 = loc("c_ptrs"(#loc54))
#loc111 = loc("c_ptrs"(#loc55))
#loc112 = loc("c_mask"(#loc56))
#loc113 = loc("c_mask"(#loc57))
#loc114 = loc("c_mask"(#loc58))
#loc115 = loc(callsite(#loc8 at #loc75))
#loc118 = loc(callsite(#loc14 at #loc79))
#loc119 = loc(callsite(#loc16 at #loc79))
#loc120 = loc(callsite(#loc14 at #loc75))
#loc121 = loc(callsite(#loc16 at #loc75))


// -----// IR Dump Before CSE (cse) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_0 = llvm.and %b, %51 : i32 loc(#loc71)
    %b_1 = llvm.udiv %b_0, %52 : i32 loc(#loc71)
    %b_2 = rocdl.readfirstlane %b_1 : i32 loc(#loc71)
    %a = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_3 = llvm.and %a, %51 : i32 loc(#loc72)
    %a_4 = llvm.udiv %a_3, %52 : i32 loc(#loc72)
    %a_5 = rocdl.readfirstlane %a_4 : i32 loc(#loc72)
    %b_6 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_7 = llvm.and %b_6, %51 : i32 loc(#loc71)
    %b_8 = llvm.udiv %b_7, %52 : i32 loc(#loc71)
    %b_9 = rocdl.readfirstlane %b_8 : i32 loc(#loc71)
    %a_10 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_11 = llvm.and %a_10, %51 : i32 loc(#loc72)
    %a_12 = llvm.udiv %a_11, %52 : i32 loc(#loc72)
    %a_13 = rocdl.readfirstlane %a_12 : i32 loc(#loc72)
    %b_14 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_15 = llvm.and %b_14, %51 : i32 loc(#loc71)
    %b_16 = llvm.udiv %b_15, %52 : i32 loc(#loc71)
    %b_17 = rocdl.readfirstlane %b_16 : i32 loc(#loc71)
    %a_18 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_19 = llvm.and %a_18, %51 : i32 loc(#loc72)
    %a_20 = llvm.udiv %a_19, %52 : i32 loc(#loc72)
    %a_21 = rocdl.readfirstlane %a_20 : i32 loc(#loc72)
    %b_22 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_23 = llvm.and %b_22, %51 : i32 loc(#loc71)
    %b_24 = llvm.udiv %b_23, %52 : i32 loc(#loc71)
    %b_25 = rocdl.readfirstlane %b_24 : i32 loc(#loc71)
    %a_26 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_27 = llvm.and %a_26, %51 : i32 loc(#loc72)
    %a_28 = llvm.udiv %a_27, %52 : i32 loc(#loc72)
    %a_29 = rocdl.readfirstlane %a_28 : i32 loc(#loc72)
    %b_ptrs = rocdl.workitem.id.x : i32 loc(#loc73)
    %b_ptrs_30 = llvm.and %b_ptrs, %51 : i32 loc(#loc73)
    %b_ptrs_31 = llvm.udiv %b_ptrs_30, %52 : i32 loc(#loc73)
    %b_ptrs_32 = rocdl.readfirstlane %b_ptrs_31 : i32 loc(#loc73)
    %a_ptrs_33 = rocdl.workitem.id.x : i32 loc(#loc67)
    %a_ptrs_34 = llvm.and %a_ptrs_33, %51 : i32 loc(#loc67)
    %a_ptrs_35 = llvm.udiv %a_ptrs_34, %52 : i32 loc(#loc67)
    %a_ptrs_36 = rocdl.readfirstlane %a_ptrs_35 : i32 loc(#loc67)
    %offs_bn_37 = rocdl.workitem.id.x : i32 loc(#loc68)
    %offs_bn_38 = llvm.and %offs_bn_37, %51 : i32 loc(#loc68)
    %offs_bn_39 = llvm.udiv %offs_bn_38, %52 : i32 loc(#loc68)
    %offs_bn_40 = rocdl.readfirstlane %offs_bn_39 : i32 loc(#loc68)
    %offs_bn_41 = rocdl.workitem.id.x : i32 loc(#loc68)
    %offs_bn_42 = llvm.and %offs_bn_41, %51 : i32 loc(#loc68)
    %offs_bn_43 = llvm.udiv %offs_bn_42, %52 : i32 loc(#loc68)
    %offs_bn_44 = rocdl.readfirstlane %offs_bn_43 : i32 loc(#loc68)
    %offs_am = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_45 = llvm.and %offs_am, %51 : i32 loc(#loc74)
    %offs_am_46 = llvm.udiv %offs_am_45, %52 : i32 loc(#loc74)
    %offs_am_47 = rocdl.readfirstlane %offs_am_46 : i32 loc(#loc74)
    %offs_am_48 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_49 = llvm.and %offs_am_48, %51 : i32 loc(#loc74)
    %offs_am_50 = llvm.udiv %offs_am_49, %52 : i32 loc(#loc74)
    %offs_am_51 = rocdl.readfirstlane %offs_am_50 : i32 loc(#loc74)
    %accumulator_52 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_53 = llvm.insertvalue %accumulator, %accumulator_52[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_54 = llvm.insertvalue %accumulator, %accumulator_53[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_55 = llvm.insertvalue %accumulator, %accumulator_54[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_56 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_57 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_58 = llvm.sdiv %num_pid_n_57, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_58, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_56, %first_pid_m : i32 loc(#loc80)
    %group_size_m_59 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_60 = llvm.srem %pid_m, %group_size_m_59 : i32 loc(#loc83)
    %pid_m_61 = llvm.add %first_pid_m, %pid_m_60 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_59 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_62 = llvm.mul %pid_m_61, %52 : i32 loc(#loc86)
    %offs_am_63 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_64 = llvm.and %offs_am_63, %51 : i32 loc(#loc74)
    %offs_am_65 = llvm.urem %offs_am_64, %52 : i32 loc(#loc74)
    %offs_am_66 = llvm.shl %offs_am_65, %47 : i32 loc(#loc74)
    %offs_am_67 = llvm.or %47, %offs_am_66 : i32 loc(#loc74)
    %offs_am_68 = llvm.shl %offs_am_51, %41 : i32 loc(#loc74)
    %offs_am_69 = llvm.or %offs_am_67, %offs_am_68 : i32 loc(#loc74)
    %offs_am_70 = llvm.and %offs_am_69, %40 : i32 loc(#loc74)
    %offs_am_71 = llvm.lshr %offs_am_70, %39 : i32 loc(#loc74)
    %offs_am_72 = llvm.or disjoint %offs_am_71, %47 : i32 loc(#loc74)
    %offs_am_73 = llvm.xor %47, %offs_am_72 : i32 loc(#loc74)
    %offs_am_74 = llvm.xor %offs_am_73, %47 : i32 loc(#loc74)
    %offs_am_75 = llvm.add %offs_am_74, %42 : i32 loc(#loc74)
    %offs_am_76 = rocdl.workitem.id.x : i32 loc(#loc74)
    %offs_am_77 = llvm.and %offs_am_76, %51 : i32 loc(#loc74)
    %offs_am_78 = llvm.urem %offs_am_77, %52 : i32 loc(#loc74)
    %offs_am_79 = llvm.shl %offs_am_78, %47 : i32 loc(#loc74)
    %offs_am_80 = llvm.or %47, %offs_am_79 : i32 loc(#loc74)
    %offs_am_81 = llvm.shl %offs_am_47, %41 : i32 loc(#loc74)
    %offs_am_82 = llvm.or %offs_am_80, %offs_am_81 : i32 loc(#loc74)
    %offs_am_83 = llvm.and %offs_am_82, %38 : i32 loc(#loc74)
    %offs_am_84 = llvm.lshr %offs_am_83, %47 : i32 loc(#loc74)
    %offs_am_85 = llvm.and %offs_am_82, %37 : i32 loc(#loc74)
    %offs_am_86 = llvm.lshr %offs_am_85, %39 : i32 loc(#loc74)
    %offs_am_87 = llvm.or disjoint %offs_am_84, %offs_am_86 : i32 loc(#loc74)
    %offs_am_88 = llvm.or disjoint %offs_am_87, %47 : i32 loc(#loc74)
    %offs_am_89 = llvm.xor %47, %offs_am_88 : i32 loc(#loc74)
    %offs_am_90 = llvm.xor %offs_am_89, %47 : i32 loc(#loc74)
    %offs_am_91 = llvm.add %offs_am_90, %42 : i32 loc(#loc74)
    %offs_am_92 = llvm.add %offs_am_62, %offs_am_75 : i32 loc(#loc87)
    %offs_am_93 = llvm.add %offs_am_62, %offs_am_91 : i32 loc(#loc87)
    %offs_am_94 = llvm.srem %offs_am_92, %M : i32 loc(#loc88)
    %offs_bn_95 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_96 = rocdl.workitem.id.x : i32 loc(#loc68)
    %offs_bn_97 = llvm.and %offs_bn_96, %51 : i32 loc(#loc68)
    %offs_bn_98 = llvm.urem %offs_bn_97, %52 : i32 loc(#loc68)
    %offs_bn_99 = llvm.shl %offs_bn_98, %47 : i32 loc(#loc68)
    %offs_bn_100 = llvm.or %47, %offs_bn_99 : i32 loc(#loc68)
    %offs_bn_101 = llvm.shl %offs_bn_44, %41 : i32 loc(#loc68)
    %offs_bn_102 = llvm.or %offs_bn_100, %offs_bn_101 : i32 loc(#loc68)
    %offs_bn_103 = llvm.and %offs_bn_102, %offs_bn : i32 loc(#loc68)
    %offs_bn_104 = llvm.lshr %offs_bn_103, %36 : i32 loc(#loc68)
    %offs_bn_105 = llvm.or disjoint %47, %offs_bn_104 : i32 loc(#loc68)
    %offs_bn_106 = llvm.xor %47, %offs_bn_105 : i32 loc(#loc68)
    %offs_bn_107 = llvm.xor %offs_bn_106, %47 : i32 loc(#loc68)
    %offs_bn_108 = llvm.add %offs_bn_107, %42 : i32 loc(#loc68)
    %offs_bn_109 = rocdl.workitem.id.x : i32 loc(#loc68)
    %offs_bn_110 = llvm.and %offs_bn_109, %51 : i32 loc(#loc68)
    %offs_bn_111 = llvm.urem %offs_bn_110, %52 : i32 loc(#loc68)
    %offs_bn_112 = llvm.shl %offs_bn_111, %47 : i32 loc(#loc68)
    %offs_bn_113 = llvm.or %47, %offs_bn_112 : i32 loc(#loc68)
    %offs_bn_114 = llvm.shl %offs_bn_40, %41 : i32 loc(#loc68)
    %offs_bn_115 = llvm.or %offs_bn_113, %offs_bn_114 : i32 loc(#loc68)
    %offs_bn_116 = llvm.and %offs_bn_115, %34 : i32 loc(#loc68)
    %offs_bn_117 = llvm.shl %offs_bn_116, %36 : i32 loc(#loc68)
    %offs_bn_118 = llvm.or disjoint %offs_bn_117, %47 : i32 loc(#loc68)
    %offs_bn_119 = llvm.xor %47, %offs_bn_118 : i32 loc(#loc68)
    %offs_bn_120 = llvm.xor %offs_bn_119, %47 : i32 loc(#loc68)
    %offs_bn_121 = llvm.xor %offs_bn_119, %45 : i32 loc(#loc68)
    %offs_bn_122 = llvm.xor %offs_bn_119, %36 : i32 loc(#loc68)
    %offs_bn_123 = llvm.xor %offs_bn_119, %39 : i32 loc(#loc68)
    %offs_bn_124 = llvm.add %offs_bn_120, %42 : i32 loc(#loc68)
    %offs_bn_125 = llvm.add %offs_bn_121, %42 : i32 loc(#loc68)
    %offs_bn_126 = llvm.add %offs_bn_122, %42 : i32 loc(#loc68)
    %offs_bn_127 = llvm.add %offs_bn_123, %42 : i32 loc(#loc68)
    %offs_bn_128 = llvm.add %offs_bn_95, %offs_bn_108 : i32 loc(#loc90)
    %offs_bn_129 = llvm.add %offs_bn_95, %offs_bn_124 : i32 loc(#loc90)
    %offs_bn_130 = llvm.add %offs_bn_95, %offs_bn_125 : i32 loc(#loc90)
    %offs_bn_131 = llvm.add %offs_bn_95, %offs_bn_126 : i32 loc(#loc90)
    %offs_bn_132 = llvm.add %offs_bn_95, %offs_bn_127 : i32 loc(#loc90)
    %offs_bn_133 = llvm.srem %offs_bn_129, %N : i32 loc(#loc91)
    %offs_bn_134 = llvm.srem %offs_bn_130, %N : i32 loc(#loc91)
    %offs_bn_135 = llvm.srem %offs_bn_131, %N : i32 loc(#loc91)
    %offs_bn_136 = llvm.srem %offs_bn_132, %N : i32 loc(#loc91)
    %a_ptrs_137 = rocdl.workitem.id.x : i32 loc(#loc67)
    %a_ptrs_138 = llvm.and %a_ptrs_137, %51 : i32 loc(#loc67)
    %a_ptrs_139 = llvm.urem %a_ptrs_138, %52 : i32 loc(#loc67)
    %a_ptrs_140 = llvm.shl %a_ptrs_139, %47 : i32 loc(#loc67)
    %a_ptrs_141 = llvm.or %47, %a_ptrs_140 : i32 loc(#loc67)
    %a_ptrs_142 = llvm.shl %a_ptrs_36, %41 : i32 loc(#loc67)
    %a_ptrs_143 = llvm.or %a_ptrs_141, %a_ptrs_142 : i32 loc(#loc67)
    %a_ptrs_144 = llvm.and %a_ptrs_143, %34 : i32 loc(#loc67)
    %a_ptrs_145 = llvm.shl %a_ptrs_144, %39 : i32 loc(#loc67)
    %a_ptrs_146 = llvm.or disjoint %a_ptrs_145, %47 : i32 loc(#loc67)
    %a_ptrs_147 = llvm.xor %47, %a_ptrs_146 : i32 loc(#loc67)
    %a_ptrs_148 = llvm.xor %a_ptrs_147, %47 : i32 loc(#loc67)
    %a_ptrs_149 = llvm.xor %a_ptrs_147, %45 : i32 loc(#loc67)
    %a_ptrs_150 = llvm.xor %a_ptrs_147, %36 : i32 loc(#loc67)
    %a_ptrs_151 = llvm.xor %a_ptrs_147, %39 : i32 loc(#loc67)
    %a_ptrs_152 = llvm.xor %a_ptrs_147, %46 : i32 loc(#loc67)
    %a_ptrs_153 = llvm.xor %a_ptrs_147, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_154 = llvm.xor %a_ptrs_147, %41 : i32 loc(#loc67)
    %a_ptrs_155 = llvm.xor %a_ptrs_147, %34 : i32 loc(#loc67)
    %a_ptrs_156 = llvm.add %a_ptrs_148, %42 : i32 loc(#loc67)
    %a_ptrs_157 = llvm.add %a_ptrs_149, %42 : i32 loc(#loc67)
    %a_ptrs_158 = llvm.add %a_ptrs_150, %42 : i32 loc(#loc67)
    %a_ptrs_159 = llvm.add %a_ptrs_151, %42 : i32 loc(#loc67)
    %a_ptrs_160 = llvm.add %a_ptrs_152, %42 : i32 loc(#loc67)
    %a_ptrs_161 = llvm.add %a_ptrs_153, %42 : i32 loc(#loc67)
    %a_ptrs_162 = llvm.add %a_ptrs_154, %42 : i32 loc(#loc67)
    %a_ptrs_163 = llvm.add %a_ptrs_155, %42 : i32 loc(#loc67)
    %a_ptrs_164 = llvm.mul %offs_am_94, %stride_am : i32 loc(#loc92)
    %a_ptrs_165 = llvm.add %a_ptrs_164, %a_ptrs_156 : i32 loc(#loc92)
    %a_ptrs_166 = llvm.add %a_ptrs_164, %a_ptrs_157 : i32 loc(#loc92)
    %a_ptrs_167 = llvm.add %a_ptrs_164, %a_ptrs_158 : i32 loc(#loc92)
    %a_ptrs_168 = llvm.add %a_ptrs_164, %a_ptrs_159 : i32 loc(#loc92)
    %a_ptrs_169 = llvm.add %a_ptrs_164, %a_ptrs_160 : i32 loc(#loc92)
    %a_ptrs_170 = llvm.add %a_ptrs_164, %a_ptrs_161 : i32 loc(#loc92)
    %a_ptrs_171 = llvm.add %a_ptrs_164, %a_ptrs_162 : i32 loc(#loc92)
    %a_ptrs_172 = llvm.add %a_ptrs_164, %a_ptrs_163 : i32 loc(#loc92)
    %a_ptrs_173 = llvm.insertvalue %a_ptrs_165, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_174 = llvm.insertvalue %a_ptrs_166, %a_ptrs_173[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_175 = llvm.insertvalue %a_ptrs_167, %a_ptrs_174[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_176 = llvm.insertvalue %a_ptrs_168, %a_ptrs_175[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_177 = llvm.insertvalue %a_ptrs_169, %a_ptrs_176[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_178 = llvm.insertvalue %a_ptrs_170, %a_ptrs_177[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_179 = llvm.insertvalue %a_ptrs_171, %a_ptrs_178[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_180 = llvm.insertvalue %a_ptrs_172, %a_ptrs_179[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_181 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_182 = llvm.icmp "slt" %a_ptrs_156, %K : i32 loc(#loc96)
    %accumulator_183 = llvm.and %accumulator_181, %a_182 : i1 loc(#loc118)
    %a_184 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_185 = llvm.mul %a_ptrs_165, %36 : i32 loc(#loc72)
    %a_186 = llvm.select %accumulator_183, %a_185, %30 : i1, i32 loc(#loc72)
    %a_187 = rocdl.raw.ptr.buffer.load %a_184, %a_186, %47, %47 : vector<4xi32> loc(#loc72)
    %a_188 = llvm.bitcast %a_187 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_189 = llvm.extractelement %a_188[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_190 = llvm.extractelement %a_188[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_191 = llvm.extractelement %a_188[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_192 = llvm.extractelement %a_188[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_193 = llvm.extractelement %a_188[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_194 = llvm.extractelement %a_188[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_195 = llvm.extractelement %a_188[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_196 = llvm.extractelement %a_188[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_197 = rocdl.workitem.id.x : i32 loc(#loc73)
    %b_ptrs_198 = llvm.and %b_ptrs_197, %51 : i32 loc(#loc73)
    %b_ptrs_199 = llvm.urem %b_ptrs_198, %52 : i32 loc(#loc73)
    %b_ptrs_200 = llvm.shl %b_ptrs_199, %47 : i32 loc(#loc73)
    %b_ptrs_201 = llvm.or %47, %b_ptrs_200 : i32 loc(#loc73)
    %b_ptrs_202 = llvm.shl %b_ptrs_32, %41 : i32 loc(#loc73)
    %b_ptrs_203 = llvm.or %b_ptrs_201, %b_ptrs_202 : i32 loc(#loc73)
    %b_ptrs_204 = llvm.and %b_ptrs_203, %40 : i32 loc(#loc73)
    %b_ptrs_205 = llvm.lshr %b_ptrs_204, %39 : i32 loc(#loc73)
    %b_ptrs_206 = llvm.or disjoint %b_ptrs_205, %47 : i32 loc(#loc73)
    %b_ptrs_207 = llvm.xor %47, %b_ptrs_206 : i32 loc(#loc73)
    %b_ptrs_208 = llvm.xor %b_ptrs_207, %47 : i32 loc(#loc73)
    %b_ptrs_209 = llvm.add %b_ptrs_208, %42 : i32 loc(#loc73)
    %b_ptrs_210 = llvm.mul %b_ptrs_209, %stride_bk : i32 loc(#loc97)
    %b_ptrs_211 = llvm.add %b_ptrs_210, %offs_bn_133 : i32 loc(#loc97)
    %b_ptrs_212 = llvm.add %b_ptrs_210, %offs_bn_134 : i32 loc(#loc97)
    %b_ptrs_213 = llvm.add %b_ptrs_210, %offs_bn_135 : i32 loc(#loc97)
    %b_ptrs_214 = llvm.add %b_ptrs_210, %offs_bn_136 : i32 loc(#loc97)
    %b_ptrs_215 = llvm.insertvalue %b_ptrs_211, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_216 = llvm.insertvalue %b_ptrs_212, %b_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_217 = llvm.insertvalue %b_ptrs_213, %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_218 = llvm.insertvalue %b_ptrs_214, %b_ptrs_217[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_219 = llvm.icmp "slt" %b_ptrs_209, %K : i32 loc(#loc98)
    %accumulator_220 = llvm.and %accumulator_181, %b_219 : i1 loc(#loc118)
    %b_221 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_222 = llvm.mul %b_ptrs_211, %36 : i32 loc(#loc71)
    %b_223 = llvm.select %accumulator_220, %b_222, %30 : i1, i32 loc(#loc71)
    %b_224 = rocdl.raw.ptr.buffer.load %b_221, %b_223, %47, %47 : vector<2xi32> loc(#loc71)
    %b_225 = llvm.bitcast %b_224 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_226 = llvm.extractelement %b_225[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_227 = llvm.extractelement %b_225[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_228 = llvm.extractelement %b_225[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_229 = llvm.extractelement %b_225[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_230 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_231 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_232 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_233 = llvm.getelementptr %22[%a_232] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_234 = llvm.insertvalue %a_233, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_235 = llvm.insertvalue %47, %a_234[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_236 = llvm.insertvalue %47, %a_235[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_237 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_238 = llvm.and %a_237, %51 : i32 loc(#loc72)
    %a_239 = llvm.urem %a_238, %52 : i32 loc(#loc72)
    %a_240 = llvm.shl %a_239, %47 : i32 loc(#loc72)
    %a_241 = llvm.or %47, %a_240 : i32 loc(#loc72)
    %a_242 = llvm.shl %a_29, %41 : i32 loc(#loc72)
    %a_243 = llvm.or %a_241, %a_242 : i32 loc(#loc72)
    %a_244 = llvm.and %a_243, %51 : i32 loc(#loc72)
    %a_245 = llvm.shl %a_244, %46 : i32 loc(#loc72)
    %a_246 = llvm.and %a_243, %19 : i32 loc(#loc72)
    %a_247 = llvm.lshr %a_246, %47 : i32 loc(#loc72)
    %a_248 = llvm.xor %a_245, %a_247 : i32 loc(#loc72)
    %a_249 = llvm.or disjoint %47, %a_248 : i32 loc(#loc72)
    %a_250 = llvm.xor %47, %a_249 : i32 loc(#loc72)
    %a_251 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_252 = llvm.xor %a_250, %a_251 : i32 loc(#loc72)
    %a_253 = llvm.xor %a_252, %47 : i32 loc(#loc72)
    %a_254 = llvm.add %a_253, %47 : i32 loc(#loc72)
    %a_255 = llvm.getelementptr inbounds %a_233[%a_254] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_256 = llvm.insertelement %a_189, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_257 = llvm.insertelement %a_190, %a_256[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_258 = llvm.insertelement %a_191, %a_257[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_259 = llvm.insertelement %a_192, %a_258[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_259, %a_255 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_260 = llvm.xor %a_252, %17 : i32 loc(#loc72)
    %a_261 = llvm.add %a_260, %47 : i32 loc(#loc72)
    %a_262 = llvm.getelementptr inbounds %a_233[%a_261] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_263 = llvm.insertelement %a_193, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_264 = llvm.insertelement %a_194, %a_263[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_265 = llvm.insertelement %a_195, %a_264[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_266 = llvm.insertelement %a_196, %a_265[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_266, %a_262 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_267 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_268 = llvm.getelementptr %b_231[%b_267] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_269 = llvm.insertvalue %b_268, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_270 = llvm.insertvalue %47, %b_269[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_271 = llvm.insertvalue %47, %b_270[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_272 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_273 = llvm.and %b_272, %51 : i32 loc(#loc71)
    %b_274 = llvm.urem %b_273, %52 : i32 loc(#loc71)
    %b_275 = llvm.shl %b_274, %47 : i32 loc(#loc71)
    %b_276 = llvm.or %47, %b_275 : i32 loc(#loc71)
    %b_277 = llvm.shl %b_25, %41 : i32 loc(#loc71)
    %b_278 = llvm.or %b_276, %b_277 : i32 loc(#loc71)
    %b_279 = llvm.and %b_278, %51 : i32 loc(#loc71)
    %b_280 = llvm.shl %b_279, %39 : i32 loc(#loc71)
    %b_281 = llvm.or disjoint %b_280, %47 : i32 loc(#loc71)
    %b_282 = llvm.xor %47, %b_281 : i32 loc(#loc71)
    %b_283 = llvm.mul %47, %36 : i32 loc(#loc71)
    %b_284 = llvm.xor %b_282, %b_283 : i32 loc(#loc71)
    %b_285 = llvm.xor %b_284, %47 : i32 loc(#loc71)
    %b_286 = llvm.add %b_285, %47 : i32 loc(#loc71)
    %b_287 = llvm.getelementptr inbounds %b_268[%b_286] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_288 = llvm.insertelement %b_226, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_289 = llvm.insertelement %b_227, %b_288[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_290 = llvm.insertelement %b_228, %b_289[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_291 = llvm.insertelement %b_229, %b_290[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_291, %b_287 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_292 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_55, %a_ptrs_180, %b_ptrs_218, %47, %a_236, %b_271 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_293: i32 loc("accumulator"(#loc117)), %accumulator_294: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_295: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_296: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_297: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_298: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_299 = llvm.icmp "slt" %accumulator_293, %accumulator_292 : i32 loc(#loc118)
    llvm.cond_br %accumulator_299, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_300 = llvm.extractvalue %a_ptrs_295[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_301 = llvm.extractvalue %a_ptrs_295[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_302 = llvm.extractvalue %a_ptrs_295[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_303 = llvm.extractvalue %a_ptrs_295[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_304 = llvm.extractvalue %a_ptrs_295[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_305 = llvm.extractvalue %a_ptrs_295[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_306 = llvm.extractvalue %a_ptrs_295[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_307 = llvm.extractvalue %a_ptrs_295[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_308 = llvm.add %a_ptrs_300, %52 : i32 loc(#loc100)
    %a_ptrs_309 = llvm.add %a_ptrs_301, %52 : i32 loc(#loc100)
    %a_ptrs_310 = llvm.add %a_ptrs_302, %52 : i32 loc(#loc100)
    %a_ptrs_311 = llvm.add %a_ptrs_303, %52 : i32 loc(#loc100)
    %a_ptrs_312 = llvm.add %a_ptrs_304, %52 : i32 loc(#loc100)
    %a_ptrs_313 = llvm.add %a_ptrs_305, %52 : i32 loc(#loc100)
    %a_ptrs_314 = llvm.add %a_ptrs_306, %52 : i32 loc(#loc100)
    %a_ptrs_315 = llvm.add %a_ptrs_307, %52 : i32 loc(#loc100)
    %a_ptrs_316 = llvm.insertvalue %a_ptrs_308, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_317 = llvm.insertvalue %a_ptrs_309, %a_ptrs_316[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_318 = llvm.insertvalue %a_ptrs_310, %a_ptrs_317[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_319 = llvm.insertvalue %a_ptrs_311, %a_ptrs_318[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_320 = llvm.insertvalue %a_ptrs_312, %a_ptrs_319[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_321 = llvm.insertvalue %a_ptrs_313, %a_ptrs_320[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_322 = llvm.insertvalue %a_ptrs_314, %a_ptrs_321[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_323 = llvm.insertvalue %a_ptrs_315, %a_ptrs_322[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_324 = llvm.extractvalue %b_ptrs_296[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_325 = llvm.extractvalue %b_ptrs_296[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_326 = llvm.extractvalue %b_ptrs_296[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_327 = llvm.extractvalue %b_ptrs_296[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_328 = llvm.add %b_ptrs_324, %b_ptrs_230 : i32 loc(#loc101)
    %b_ptrs_329 = llvm.add %b_ptrs_325, %b_ptrs_230 : i32 loc(#loc101)
    %b_ptrs_330 = llvm.add %b_ptrs_326, %b_ptrs_230 : i32 loc(#loc101)
    %b_ptrs_331 = llvm.add %b_ptrs_327, %b_ptrs_230 : i32 loc(#loc101)
    %b_ptrs_332 = llvm.insertvalue %b_ptrs_328, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_333 = llvm.insertvalue %b_ptrs_329, %b_ptrs_332[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_334 = llvm.insertvalue %b_ptrs_330, %b_ptrs_333[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_335 = llvm.insertvalue %b_ptrs_331, %b_ptrs_334[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_336 = llvm.add %accumulator_293, %45 : i32 loc(#loc118)
    %a_337 = llvm.mul %accumulator_336, %52 : i32 loc(#loc102)
    %a_338 = llvm.sub %K, %a_337 : i32 loc(#loc103)
    %a_339 = llvm.icmp "slt" %a_ptrs_156, %a_338 : i32 loc(#loc96)
    %a_340 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_341 = llvm.mul %a_ptrs_308, %36 : i32 loc(#loc72)
    %a_342 = llvm.select %a_339, %a_341, %30 : i1, i32 loc(#loc72)
    %a_343 = rocdl.raw.ptr.buffer.load %a_340, %a_342, %47, %47 : vector<4xi32> loc(#loc72)
    %a_344 = llvm.bitcast %a_343 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_345 = llvm.extractelement %a_344[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_346 = llvm.extractelement %a_344[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_347 = llvm.extractelement %a_344[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_348 = llvm.extractelement %a_344[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_349 = llvm.extractelement %a_344[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_350 = llvm.extractelement %a_344[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_351 = llvm.extractelement %a_344[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_352 = llvm.extractelement %a_344[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_353 = llvm.extractvalue %a_297[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_354 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_355 = llvm.and %a_354, %51 : i32 loc(#loc72)
    %a_356 = llvm.urem %a_355, %52 : i32 loc(#loc72)
    %a_357 = llvm.shl %a_356, %47 : i32 loc(#loc72)
    %a_358 = llvm.or %47, %a_357 : i32 loc(#loc72)
    %a_359 = llvm.shl %a_21, %41 : i32 loc(#loc72)
    %a_360 = llvm.or %a_358, %a_359 : i32 loc(#loc72)
    %a_361 = llvm.and %a_360, %38 : i32 loc(#loc72)
    %a_362 = llvm.shl %a_361, %34 : i32 loc(#loc72)
    %a_363 = llvm.and %a_360, %37 : i32 loc(#loc72)
    %a_364 = llvm.shl %a_363, %46 : i32 loc(#loc72)
    %a_365 = llvm.and %a_360, %38 : i32 loc(#loc72)
    %a_366 = llvm.shl %a_365, %39 : i32 loc(#loc72)
    %a_367 = llvm.and %a_360, %15 : i32 loc(#loc72)
    %a_368 = llvm.lshr %a_367, %45 : i32 loc(#loc72)
    %a_369 = llvm.xor %a_364, %a_366 : i32 loc(#loc72)
    %a_370 = llvm.xor %a_369, %a_368 : i32 loc(#loc72)
    %a_371 = llvm.or disjoint %a_362, %a_370 : i32 loc(#loc72)
    %a_372 = llvm.xor %47, %a_371 : i32 loc(#loc72)
    %a_373 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_374 = llvm.xor %a_372, %a_373 : i32 loc(#loc72)
    %a_375 = llvm.xor %a_374, %47 : i32 loc(#loc72)
    %a_376 = llvm.add %a_375, %47 : i32 loc(#loc72)
    %a_377 = llvm.getelementptr inbounds %a_353[%a_376] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_378 = llvm.load %a_377 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_379 = llvm.extractelement %a_378[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_380 = llvm.extractelement %a_378[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_381 = llvm.extractelement %a_378[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_382 = llvm.extractelement %a_378[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_383 = llvm.xor %a_374, %49 : i32 loc(#loc72)
    %a_384 = llvm.add %a_383, %47 : i32 loc(#loc72)
    %a_385 = llvm.getelementptr inbounds %a_353[%a_384] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_386 = llvm.load %a_385 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_387 = llvm.extractelement %a_386[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_388 = llvm.extractelement %a_386[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_389 = llvm.extractelement %a_386[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_390 = llvm.extractelement %a_386[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_391 = llvm.xor %a_374, %52 : i32 loc(#loc72)
    %a_392 = llvm.add %a_391, %47 : i32 loc(#loc72)
    %a_393 = llvm.getelementptr inbounds %a_353[%a_392] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_394 = llvm.load %a_393 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_395 = llvm.extractelement %a_394[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_396 = llvm.extractelement %a_394[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_397 = llvm.extractelement %a_394[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_398 = llvm.extractelement %a_394[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_399 = llvm.xor %a_374, %14 : i32 loc(#loc72)
    %a_400 = llvm.add %a_399, %47 : i32 loc(#loc72)
    %a_401 = llvm.getelementptr inbounds %a_353[%a_400] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_402 = llvm.load %a_401 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_403 = llvm.extractelement %a_402[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_404 = llvm.extractelement %a_402[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_405 = llvm.extractelement %a_402[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_406 = llvm.extractelement %a_402[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_407 = llvm.icmp "slt" %b_ptrs_209, %a_338 : i32 loc(#loc98)
    %b_408 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_409 = llvm.mul %b_ptrs_328, %36 : i32 loc(#loc71)
    %b_410 = llvm.select %b_407, %b_409, %30 : i1, i32 loc(#loc71)
    %b_411 = rocdl.raw.ptr.buffer.load %b_408, %b_410, %47, %47 : vector<2xi32> loc(#loc71)
    %b_412 = llvm.bitcast %b_411 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_413 = llvm.extractelement %b_412[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_414 = llvm.extractelement %b_412[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_415 = llvm.extractelement %b_412[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_416 = llvm.extractelement %b_412[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_417 = llvm.extractvalue %b_298[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_418 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_419 = llvm.and %b_418, %51 : i32 loc(#loc71)
    %b_420 = llvm.urem %b_419, %52 : i32 loc(#loc71)
    %b_421 = llvm.shl %b_420, %47 : i32 loc(#loc71)
    %b_422 = llvm.or %47, %b_421 : i32 loc(#loc71)
    %b_423 = llvm.shl %b_17, %41 : i32 loc(#loc71)
    %b_424 = llvm.or %b_422, %b_423 : i32 loc(#loc71)
    %b_425 = llvm.and %b_424, %15 : i32 loc(#loc71)
    %b_426 = llvm.shl %b_425, %46 : i32 loc(#loc71)
    %b_427 = llvm.and %b_424, %38 : i32 loc(#loc71)
    %b_428 = llvm.shl %b_427, %45 : i32 loc(#loc71)
    %b_429 = llvm.and %b_424, %52 : i32 loc(#loc71)
    %b_430 = llvm.icmp "eq" %b_429, %47 : i32 loc(#loc71)
    %b_431 = llvm.select %b_430, %47, %49 : i1, i32 loc(#loc71)
    %b_432 = llvm.xor %b_426, %b_428 : i32 loc(#loc71)
    %b_433 = llvm.or disjoint %b_431, %b_432 : i32 loc(#loc71)
    %b_434 = llvm.xor %47, %b_433 : i32 loc(#loc71)
    %b_435 = llvm.mul %47, %36 : i32 loc(#loc71)
    %b_436 = llvm.xor %b_434, %b_435 : i32 loc(#loc71)
    %b_437 = llvm.xor %b_436, %47 : i32 loc(#loc71)
    %b_438 = llvm.add %b_437, %47 : i32 loc(#loc71)
    %b_439 = llvm.getelementptr inbounds %b_417[%b_438] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_440 = llvm.load %b_439 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_441 = llvm.extractelement %b_440[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_442 = llvm.add %b_437, %52 : i32 loc(#loc71)
    %b_443 = llvm.getelementptr inbounds %b_417[%b_442] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_444 = llvm.load %b_443 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_445 = llvm.extractelement %b_444[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_446 = llvm.add %b_437, %13 : i32 loc(#loc71)
    %b_447 = llvm.getelementptr inbounds %b_417[%b_446] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_448 = llvm.load %b_447 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_449 = llvm.extractelement %b_448[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_450 = llvm.add %b_437, %12 : i32 loc(#loc71)
    %b_451 = llvm.getelementptr inbounds %b_417[%b_450] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_452 = llvm.load %b_451 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_453 = llvm.extractelement %b_452[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_454 = llvm.add %b_437, %11 : i32 loc(#loc71)
    %b_455 = llvm.getelementptr inbounds %b_417[%b_454] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_456 = llvm.load %b_455 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_457 = llvm.extractelement %b_456[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_458 = llvm.add %b_437, %10 : i32 loc(#loc71)
    %b_459 = llvm.getelementptr inbounds %b_417[%b_458] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_460 = llvm.load %b_459 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_461 = llvm.extractelement %b_460[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_462 = llvm.add %b_437, %9 : i32 loc(#loc71)
    %b_463 = llvm.getelementptr inbounds %b_417[%b_462] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_464 = llvm.load %b_463 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_465 = llvm.extractelement %b_464[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_466 = llvm.add %b_437, %8 : i32 loc(#loc71)
    %b_467 = llvm.getelementptr inbounds %b_417[%b_466] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_468 = llvm.load %b_467 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_469 = llvm.extractelement %b_468[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_470 = llvm.add %b_437, %16 : i32 loc(#loc71)
    %b_471 = llvm.getelementptr inbounds %b_417[%b_470] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_472 = llvm.load %b_471 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_473 = llvm.extractelement %b_472[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_474 = llvm.add %b_437, %7 : i32 loc(#loc71)
    %b_475 = llvm.getelementptr inbounds %b_417[%b_474] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_476 = llvm.load %b_475 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_477 = llvm.extractelement %b_476[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_478 = llvm.add %b_437, %6 : i32 loc(#loc71)
    %b_479 = llvm.getelementptr inbounds %b_417[%b_478] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_480 = llvm.load %b_479 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_481 = llvm.extractelement %b_480[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_482 = llvm.add %b_437, %5 : i32 loc(#loc71)
    %b_483 = llvm.getelementptr inbounds %b_417[%b_482] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_484 = llvm.load %b_483 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_485 = llvm.extractelement %b_484[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_486 = llvm.add %b_437, %4 : i32 loc(#loc71)
    %b_487 = llvm.getelementptr inbounds %b_417[%b_486] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_488 = llvm.load %b_487 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_489 = llvm.extractelement %b_488[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_490 = llvm.add %b_437, %3 : i32 loc(#loc71)
    %b_491 = llvm.getelementptr inbounds %b_417[%b_490] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_492 = llvm.load %b_491 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_493 = llvm.extractelement %b_492[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_494 = llvm.add %b_437, %2 : i32 loc(#loc71)
    %b_495 = llvm.getelementptr inbounds %b_417[%b_494] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_496 = llvm.load %b_495 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_497 = llvm.extractelement %b_496[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_498 = llvm.add %b_437, %1 : i32 loc(#loc71)
    %b_499 = llvm.getelementptr inbounds %b_417[%b_498] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_500 = llvm.load %b_499 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_501 = llvm.extractelement %b_500[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_502 = llvm.insertelement %a_379, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.insertelement %a_380, %accumulator_502[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_504 = llvm.insertelement %a_381, %accumulator_503[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_505 = llvm.insertelement %a_382, %accumulator_504[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_506 = llvm.extractelement %accumulator_505[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_506, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_508 = llvm.extractelement %accumulator_505[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_508, %accumulator_507[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_510 = llvm.extractelement %accumulator_505[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_511 = llvm.insertelement %accumulator_510, %accumulator_509[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_512 = llvm.extractelement %accumulator_505[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_513 = llvm.insertelement %accumulator_512, %accumulator_511[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_514 = llvm.insertelement %a_387, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_515 = llvm.insertelement %a_388, %accumulator_514[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_516 = llvm.insertelement %a_389, %accumulator_515[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_517 = llvm.insertelement %a_390, %accumulator_516[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_517[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_519 = llvm.insertelement %accumulator_518, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_520 = llvm.extractelement %accumulator_517[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_521 = llvm.insertelement %accumulator_520, %accumulator_519[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_522 = llvm.extractelement %accumulator_517[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_523 = llvm.insertelement %accumulator_522, %accumulator_521[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_524 = llvm.extractelement %accumulator_517[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_525 = llvm.insertelement %accumulator_524, %accumulator_523[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_526 = llvm.insertelement %a_395, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_527 = llvm.insertelement %a_396, %accumulator_526[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_528 = llvm.insertelement %a_397, %accumulator_527[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_529 = llvm.insertelement %a_398, %accumulator_528[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_530 = llvm.extractelement %accumulator_529[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_531 = llvm.insertelement %accumulator_530, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_532 = llvm.extractelement %accumulator_529[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_533 = llvm.insertelement %accumulator_532, %accumulator_531[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_534 = llvm.extractelement %accumulator_529[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_535 = llvm.insertelement %accumulator_534, %accumulator_533[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_536 = llvm.extractelement %accumulator_529[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_537 = llvm.insertelement %accumulator_536, %accumulator_535[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_538 = llvm.insertelement %a_403, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_539 = llvm.insertelement %a_404, %accumulator_538[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_540 = llvm.insertelement %a_405, %accumulator_539[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_541 = llvm.insertelement %a_406, %accumulator_540[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_542 = llvm.extractelement %accumulator_541[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_543 = llvm.insertelement %accumulator_542, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_544 = llvm.extractelement %accumulator_541[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_545 = llvm.insertelement %accumulator_544, %accumulator_543[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_546 = llvm.extractelement %accumulator_541[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_547 = llvm.insertelement %accumulator_546, %accumulator_545[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_548 = llvm.extractelement %accumulator_541[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_549 = llvm.insertelement %accumulator_548, %accumulator_547[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_550 = llvm.insertelement %b_441, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_551 = llvm.insertelement %b_445, %accumulator_550[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_552 = llvm.insertelement %b_449, %accumulator_551[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_553 = llvm.insertelement %b_453, %accumulator_552[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_554 = llvm.extractelement %accumulator_553[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_555 = llvm.insertelement %accumulator_554, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_556 = llvm.extractelement %accumulator_553[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_557 = llvm.insertelement %accumulator_556, %accumulator_555[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_558 = llvm.extractelement %accumulator_553[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_559 = llvm.insertelement %accumulator_558, %accumulator_557[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_560 = llvm.extractelement %accumulator_553[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_561 = llvm.insertelement %accumulator_560, %accumulator_559[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_562 = llvm.insertelement %b_457, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_563 = llvm.insertelement %b_461, %accumulator_562[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_564 = llvm.insertelement %b_465, %accumulator_563[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_565 = llvm.insertelement %b_469, %accumulator_564[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_566 = llvm.extractelement %accumulator_565[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_567 = llvm.insertelement %accumulator_566, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_568 = llvm.extractelement %accumulator_565[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_569 = llvm.insertelement %accumulator_568, %accumulator_567[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_570 = llvm.extractelement %accumulator_565[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_571 = llvm.insertelement %accumulator_570, %accumulator_569[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_572 = llvm.extractelement %accumulator_565[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_573 = llvm.insertelement %accumulator_572, %accumulator_571[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_574 = llvm.insertelement %b_473, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_575 = llvm.insertelement %b_477, %accumulator_574[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_576 = llvm.insertelement %b_481, %accumulator_575[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_577 = llvm.insertelement %b_485, %accumulator_576[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_578 = llvm.extractelement %accumulator_577[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_579 = llvm.insertelement %accumulator_578, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_580 = llvm.extractelement %accumulator_577[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_581 = llvm.insertelement %accumulator_580, %accumulator_579[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_582 = llvm.extractelement %accumulator_577[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_583 = llvm.insertelement %accumulator_582, %accumulator_581[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_584 = llvm.extractelement %accumulator_577[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_585 = llvm.insertelement %accumulator_584, %accumulator_583[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_586 = llvm.insertelement %b_489, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_587 = llvm.insertelement %b_493, %accumulator_586[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_588 = llvm.insertelement %b_497, %accumulator_587[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_589 = llvm.insertelement %b_501, %accumulator_588[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_590 = llvm.extractelement %accumulator_589[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_591 = llvm.insertelement %accumulator_590, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_592 = llvm.extractelement %accumulator_589[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_593 = llvm.insertelement %accumulator_592, %accumulator_591[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_594 = llvm.extractelement %accumulator_589[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_595 = llvm.insertelement %accumulator_594, %accumulator_593[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_596 = llvm.extractelement %accumulator_589[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_597 = llvm.insertelement %accumulator_596, %accumulator_595[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_598 = llvm.extractvalue %accumulator_294[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_599 = llvm.extractvalue %accumulator_294[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_600 = llvm.extractvalue %accumulator_294[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_601 = llvm.extractvalue %accumulator_294[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_602 = llvm.insertelement %accumulator_598, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_603 = llvm.insertelement %accumulator_599, %accumulator_602[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_604 = llvm.insertelement %accumulator_600, %accumulator_603[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_605 = llvm.insertelement %accumulator_601, %accumulator_604[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_606 = rocdl.mfma.f32.16x16x16f16 %accumulator_561, %accumulator_513, %accumulator_605, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_607 = rocdl.mfma.f32.16x16x16f16 %accumulator_573, %accumulator_525, %accumulator_606, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_608 = rocdl.mfma.f32.16x16x16f16 %accumulator_585, %accumulator_537, %accumulator_607, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_609 = rocdl.mfma.f32.16x16x16f16 %accumulator_597, %accumulator_549, %accumulator_608, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_610 = llvm.extractelement %accumulator_609[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_611 = llvm.extractelement %accumulator_609[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_612 = llvm.extractelement %accumulator_609[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_613 = llvm.extractelement %accumulator_609[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_614 = llvm.insertvalue %accumulator_610, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_615 = llvm.insertvalue %accumulator_611, %accumulator_614[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_616 = llvm.insertvalue %accumulator_612, %accumulator_615[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_617 = llvm.insertvalue %accumulator_613, %accumulator_616[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_618 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_619 = llvm.icmp "slt" %accumulator_618, %45 : i32 loc(#loc118)
    %accumulator_620 = llvm.select %accumulator_619, %accumulator_618, %47 : i1, i32 loc(#loc118)
    %a_621 = llvm.mul %accumulator_620, %21 : i32 loc(#loc72)
    %a_622 = llvm.getelementptr %22[%a_621] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_623 = llvm.insertvalue %a_622, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_624 = llvm.insertvalue %47, %a_623[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_625 = llvm.insertvalue %47, %a_624[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_626 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_627 = llvm.and %a_626, %51 : i32 loc(#loc72)
    %a_628 = llvm.urem %a_627, %52 : i32 loc(#loc72)
    %a_629 = llvm.shl %a_628, %47 : i32 loc(#loc72)
    %a_630 = llvm.or %47, %a_629 : i32 loc(#loc72)
    %a_631 = llvm.shl %a_13, %41 : i32 loc(#loc72)
    %a_632 = llvm.or %a_630, %a_631 : i32 loc(#loc72)
    %a_633 = llvm.and %a_632, %51 : i32 loc(#loc72)
    %a_634 = llvm.shl %a_633, %46 : i32 loc(#loc72)
    %a_635 = llvm.and %a_632, %19 : i32 loc(#loc72)
    %a_636 = llvm.lshr %a_635, %47 : i32 loc(#loc72)
    %a_637 = llvm.xor %a_634, %a_636 : i32 loc(#loc72)
    %a_638 = llvm.or disjoint %47, %a_637 : i32 loc(#loc72)
    %a_639 = llvm.xor %47, %a_638 : i32 loc(#loc72)
    %a_640 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_641 = llvm.xor %a_639, %a_640 : i32 loc(#loc72)
    %a_642 = llvm.xor %a_641, %47 : i32 loc(#loc72)
    %a_643 = llvm.add %a_642, %47 : i32 loc(#loc72)
    %a_644 = llvm.getelementptr inbounds %a_622[%a_643] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_645 = llvm.insertelement %a_345, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_646 = llvm.insertelement %a_346, %a_645[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_647 = llvm.insertelement %a_347, %a_646[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_648 = llvm.insertelement %a_348, %a_647[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_648, %a_644 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_649 = llvm.xor %a_641, %17 : i32 loc(#loc72)
    %a_650 = llvm.add %a_649, %47 : i32 loc(#loc72)
    %a_651 = llvm.getelementptr inbounds %a_622[%a_650] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_652 = llvm.insertelement %a_349, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_653 = llvm.insertelement %a_350, %a_652[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_654 = llvm.insertelement %a_351, %a_653[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_655 = llvm.insertelement %a_352, %a_654[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_655, %a_651 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_656 = llvm.mul %accumulator_620, %16 : i32 loc(#loc71)
    %b_657 = llvm.getelementptr %b_231[%b_656] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_658 = llvm.insertvalue %b_657, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_659 = llvm.insertvalue %47, %b_658[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_660 = llvm.insertvalue %47, %b_659[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_661 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_662 = llvm.and %b_661, %51 : i32 loc(#loc71)
    %b_663 = llvm.urem %b_662, %52 : i32 loc(#loc71)
    %b_664 = llvm.shl %b_663, %47 : i32 loc(#loc71)
    %b_665 = llvm.or %47, %b_664 : i32 loc(#loc71)
    %b_666 = llvm.shl %b_9, %41 : i32 loc(#loc71)
    %b_667 = llvm.or %b_665, %b_666 : i32 loc(#loc71)
    %b_668 = llvm.and %b_667, %51 : i32 loc(#loc71)
    %b_669 = llvm.shl %b_668, %39 : i32 loc(#loc71)
    %b_670 = llvm.or disjoint %b_669, %47 : i32 loc(#loc71)
    %b_671 = llvm.xor %47, %b_670 : i32 loc(#loc71)
    %b_672 = llvm.mul %47, %36 : i32 loc(#loc71)
    %b_673 = llvm.xor %b_671, %b_672 : i32 loc(#loc71)
    %b_674 = llvm.xor %b_673, %47 : i32 loc(#loc71)
    %b_675 = llvm.add %b_674, %47 : i32 loc(#loc71)
    %b_676 = llvm.getelementptr inbounds %b_657[%b_675] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_677 = llvm.insertelement %b_413, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_678 = llvm.insertelement %b_414, %b_677[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_679 = llvm.insertelement %b_415, %b_678[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_680 = llvm.insertelement %b_416, %b_679[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_680, %b_676 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_681 = llvm.add %accumulator_293, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%accumulator_681, %accumulator_617, %a_ptrs_323, %b_ptrs_335, %accumulator_620, %a_625, %b_660 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_682 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_683 = llvm.extractvalue %a_297[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_684 = rocdl.workitem.id.x : i32 loc(#loc72)
    %a_685 = llvm.and %a_684, %51 : i32 loc(#loc72)
    %a_686 = llvm.urem %a_685, %52 : i32 loc(#loc72)
    %a_687 = llvm.shl %a_686, %47 : i32 loc(#loc72)
    %a_688 = llvm.or %47, %a_687 : i32 loc(#loc72)
    %a_689 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_690 = llvm.or %a_688, %a_689 : i32 loc(#loc72)
    %a_691 = llvm.and %a_690, %38 : i32 loc(#loc72)
    %a_692 = llvm.shl %a_691, %34 : i32 loc(#loc72)
    %a_693 = llvm.and %a_690, %37 : i32 loc(#loc72)
    %a_694 = llvm.shl %a_693, %46 : i32 loc(#loc72)
    %a_695 = llvm.and %a_690, %38 : i32 loc(#loc72)
    %a_696 = llvm.shl %a_695, %39 : i32 loc(#loc72)
    %a_697 = llvm.and %a_690, %15 : i32 loc(#loc72)
    %a_698 = llvm.lshr %a_697, %45 : i32 loc(#loc72)
    %a_699 = llvm.xor %a_694, %a_696 : i32 loc(#loc72)
    %a_700 = llvm.xor %a_699, %a_698 : i32 loc(#loc72)
    %a_701 = llvm.or disjoint %a_692, %a_700 : i32 loc(#loc72)
    %a_702 = llvm.xor %47, %a_701 : i32 loc(#loc72)
    %a_703 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_704 = llvm.xor %a_702, %a_703 : i32 loc(#loc72)
    %a_705 = llvm.xor %a_704, %47 : i32 loc(#loc72)
    %a_706 = llvm.add %a_705, %47 : i32 loc(#loc72)
    %a_707 = llvm.getelementptr inbounds %a_683[%a_706] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_708 = llvm.load %a_707 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_709 = llvm.extractelement %a_708[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_710 = llvm.extractelement %a_708[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_711 = llvm.extractelement %a_708[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_712 = llvm.extractelement %a_708[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_713 = llvm.xor %a_704, %49 : i32 loc(#loc72)
    %a_714 = llvm.add %a_713, %47 : i32 loc(#loc72)
    %a_715 = llvm.getelementptr inbounds %a_683[%a_714] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_716 = llvm.load %a_715 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_717 = llvm.extractelement %a_716[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_718 = llvm.extractelement %a_716[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_719 = llvm.extractelement %a_716[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_720 = llvm.extractelement %a_716[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_721 = llvm.xor %a_704, %52 : i32 loc(#loc72)
    %a_722 = llvm.add %a_721, %47 : i32 loc(#loc72)
    %a_723 = llvm.getelementptr inbounds %a_683[%a_722] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_724 = llvm.load %a_723 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_725 = llvm.extractelement %a_724[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_726 = llvm.extractelement %a_724[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_727 = llvm.extractelement %a_724[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_728 = llvm.extractelement %a_724[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_729 = llvm.xor %a_704, %14 : i32 loc(#loc72)
    %a_730 = llvm.add %a_729, %47 : i32 loc(#loc72)
    %a_731 = llvm.getelementptr inbounds %a_683[%a_730] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_732 = llvm.load %a_731 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_733 = llvm.extractelement %a_732[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_734 = llvm.extractelement %a_732[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_735 = llvm.extractelement %a_732[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_736 = llvm.extractelement %a_732[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_737 = llvm.extractvalue %b_298[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_738 = rocdl.workitem.id.x : i32 loc(#loc71)
    %b_739 = llvm.and %b_738, %51 : i32 loc(#loc71)
    %b_740 = llvm.urem %b_739, %52 : i32 loc(#loc71)
    %b_741 = llvm.shl %b_740, %47 : i32 loc(#loc71)
    %b_742 = llvm.or %47, %b_741 : i32 loc(#loc71)
    %b_743 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_744 = llvm.or %b_742, %b_743 : i32 loc(#loc71)
    %b_745 = llvm.and %b_744, %15 : i32 loc(#loc71)
    %b_746 = llvm.shl %b_745, %46 : i32 loc(#loc71)
    %b_747 = llvm.and %b_744, %38 : i32 loc(#loc71)
    %b_748 = llvm.shl %b_747, %45 : i32 loc(#loc71)
    %b_749 = llvm.and %b_744, %52 : i32 loc(#loc71)
    %b_750 = llvm.icmp "eq" %b_749, %47 : i32 loc(#loc71)
    %b_751 = llvm.select %b_750, %47, %49 : i1, i32 loc(#loc71)
    %b_752 = llvm.xor %b_746, %b_748 : i32 loc(#loc71)
    %b_753 = llvm.or disjoint %b_751, %b_752 : i32 loc(#loc71)
    %b_754 = llvm.xor %47, %b_753 : i32 loc(#loc71)
    %b_755 = llvm.mul %47, %36 : i32 loc(#loc71)
    %b_756 = llvm.xor %b_754, %b_755 : i32 loc(#loc71)
    %b_757 = llvm.xor %b_756, %47 : i32 loc(#loc71)
    %b_758 = llvm.add %b_757, %47 : i32 loc(#loc71)
    %b_759 = llvm.getelementptr inbounds %b_737[%b_758] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_760 = llvm.load %b_759 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_761 = llvm.extractelement %b_760[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_762 = llvm.add %b_757, %52 : i32 loc(#loc71)
    %b_763 = llvm.getelementptr inbounds %b_737[%b_762] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_764 = llvm.load %b_763 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_765 = llvm.extractelement %b_764[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_766 = llvm.add %b_757, %13 : i32 loc(#loc71)
    %b_767 = llvm.getelementptr inbounds %b_737[%b_766] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_768 = llvm.load %b_767 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_769 = llvm.extractelement %b_768[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_770 = llvm.add %b_757, %12 : i32 loc(#loc71)
    %b_771 = llvm.getelementptr inbounds %b_737[%b_770] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_772 = llvm.load %b_771 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_773 = llvm.extractelement %b_772[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_774 = llvm.add %b_757, %11 : i32 loc(#loc71)
    %b_775 = llvm.getelementptr inbounds %b_737[%b_774] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_776 = llvm.load %b_775 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_777 = llvm.extractelement %b_776[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_778 = llvm.add %b_757, %10 : i32 loc(#loc71)
    %b_779 = llvm.getelementptr inbounds %b_737[%b_778] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_780 = llvm.load %b_779 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_781 = llvm.extractelement %b_780[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_782 = llvm.add %b_757, %9 : i32 loc(#loc71)
    %b_783 = llvm.getelementptr inbounds %b_737[%b_782] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_784 = llvm.load %b_783 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_785 = llvm.extractelement %b_784[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_786 = llvm.add %b_757, %8 : i32 loc(#loc71)
    %b_787 = llvm.getelementptr inbounds %b_737[%b_786] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_788 = llvm.load %b_787 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_789 = llvm.extractelement %b_788[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_790 = llvm.add %b_757, %16 : i32 loc(#loc71)
    %b_791 = llvm.getelementptr inbounds %b_737[%b_790] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_792 = llvm.load %b_791 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_793 = llvm.extractelement %b_792[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_794 = llvm.add %b_757, %7 : i32 loc(#loc71)
    %b_795 = llvm.getelementptr inbounds %b_737[%b_794] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_796 = llvm.load %b_795 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_797 = llvm.extractelement %b_796[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_798 = llvm.add %b_757, %6 : i32 loc(#loc71)
    %b_799 = llvm.getelementptr inbounds %b_737[%b_798] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_800 = llvm.load %b_799 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_801 = llvm.extractelement %b_800[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_802 = llvm.add %b_757, %5 : i32 loc(#loc71)
    %b_803 = llvm.getelementptr inbounds %b_737[%b_802] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_804 = llvm.load %b_803 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_805 = llvm.extractelement %b_804[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_806 = llvm.add %b_757, %4 : i32 loc(#loc71)
    %b_807 = llvm.getelementptr inbounds %b_737[%b_806] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_808 = llvm.load %b_807 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_809 = llvm.extractelement %b_808[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_810 = llvm.add %b_757, %3 : i32 loc(#loc71)
    %b_811 = llvm.getelementptr inbounds %b_737[%b_810] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_812 = llvm.load %b_811 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_813 = llvm.extractelement %b_812[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_814 = llvm.add %b_757, %2 : i32 loc(#loc71)
    %b_815 = llvm.getelementptr inbounds %b_737[%b_814] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_816 = llvm.load %b_815 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_817 = llvm.extractelement %b_816[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_818 = llvm.add %b_757, %1 : i32 loc(#loc71)
    %b_819 = llvm.getelementptr inbounds %b_737[%b_818] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_820 = llvm.load %b_819 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_821 = llvm.extractelement %b_820[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_682, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_822 = llvm.insertelement %a_709, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_823 = llvm.insertelement %a_710, %accumulator_822[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_824 = llvm.insertelement %a_711, %accumulator_823[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_825 = llvm.insertelement %a_712, %accumulator_824[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_826 = llvm.extractelement %accumulator_825[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_827 = llvm.insertelement %accumulator_826, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_828 = llvm.extractelement %accumulator_825[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_829 = llvm.insertelement %accumulator_828, %accumulator_827[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_830 = llvm.extractelement %accumulator_825[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_831 = llvm.insertelement %accumulator_830, %accumulator_829[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_832 = llvm.extractelement %accumulator_825[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_833 = llvm.insertelement %accumulator_832, %accumulator_831[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_834 = llvm.insertelement %a_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_835 = llvm.insertelement %a_718, %accumulator_834[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_836 = llvm.insertelement %a_719, %accumulator_835[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_837 = llvm.insertelement %a_720, %accumulator_836[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_838 = llvm.extractelement %accumulator_837[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_839 = llvm.insertelement %accumulator_838, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_840 = llvm.extractelement %accumulator_837[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_841 = llvm.insertelement %accumulator_840, %accumulator_839[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_842 = llvm.extractelement %accumulator_837[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_843 = llvm.insertelement %accumulator_842, %accumulator_841[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_844 = llvm.extractelement %accumulator_837[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_845 = llvm.insertelement %accumulator_844, %accumulator_843[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_846 = llvm.insertelement %a_725, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_847 = llvm.insertelement %a_726, %accumulator_846[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_848 = llvm.insertelement %a_727, %accumulator_847[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_849 = llvm.insertelement %a_728, %accumulator_848[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_850 = llvm.extractelement %accumulator_849[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_851 = llvm.insertelement %accumulator_850, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_852 = llvm.extractelement %accumulator_849[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_853 = llvm.insertelement %accumulator_852, %accumulator_851[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_854 = llvm.extractelement %accumulator_849[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_855 = llvm.insertelement %accumulator_854, %accumulator_853[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_856 = llvm.extractelement %accumulator_849[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_857 = llvm.insertelement %accumulator_856, %accumulator_855[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_858 = llvm.insertelement %a_733, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_859 = llvm.insertelement %a_734, %accumulator_858[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_860 = llvm.insertelement %a_735, %accumulator_859[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_861 = llvm.insertelement %a_736, %accumulator_860[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_862 = llvm.extractelement %accumulator_861[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_863 = llvm.insertelement %accumulator_862, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_864 = llvm.extractelement %accumulator_861[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_865 = llvm.insertelement %accumulator_864, %accumulator_863[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_866 = llvm.extractelement %accumulator_861[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_867 = llvm.insertelement %accumulator_866, %accumulator_865[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_868 = llvm.extractelement %accumulator_861[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_869 = llvm.insertelement %accumulator_868, %accumulator_867[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_870 = llvm.insertelement %b_761, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_871 = llvm.insertelement %b_765, %accumulator_870[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_872 = llvm.insertelement %b_769, %accumulator_871[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_873 = llvm.insertelement %b_773, %accumulator_872[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_874 = llvm.extractelement %accumulator_873[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_875 = llvm.insertelement %accumulator_874, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_876 = llvm.extractelement %accumulator_873[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_877 = llvm.insertelement %accumulator_876, %accumulator_875[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_878 = llvm.extractelement %accumulator_873[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_879 = llvm.insertelement %accumulator_878, %accumulator_877[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_880 = llvm.extractelement %accumulator_873[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_881 = llvm.insertelement %accumulator_880, %accumulator_879[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_882 = llvm.insertelement %b_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_883 = llvm.insertelement %b_781, %accumulator_882[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_884 = llvm.insertelement %b_785, %accumulator_883[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_885 = llvm.insertelement %b_789, %accumulator_884[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_886 = llvm.extractelement %accumulator_885[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_887 = llvm.insertelement %accumulator_886, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_888 = llvm.extractelement %accumulator_885[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_889 = llvm.insertelement %accumulator_888, %accumulator_887[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_890 = llvm.extractelement %accumulator_885[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_891 = llvm.insertelement %accumulator_890, %accumulator_889[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_892 = llvm.extractelement %accumulator_885[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_893 = llvm.insertelement %accumulator_892, %accumulator_891[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_894 = llvm.insertelement %b_793, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_895 = llvm.insertelement %b_797, %accumulator_894[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_896 = llvm.insertelement %b_801, %accumulator_895[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_897 = llvm.insertelement %b_805, %accumulator_896[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_898 = llvm.extractelement %accumulator_897[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_899 = llvm.insertelement %accumulator_898, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_900 = llvm.extractelement %accumulator_897[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_901 = llvm.insertelement %accumulator_900, %accumulator_899[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_902 = llvm.extractelement %accumulator_897[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_903 = llvm.insertelement %accumulator_902, %accumulator_901[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_904 = llvm.extractelement %accumulator_897[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_905 = llvm.insertelement %accumulator_904, %accumulator_903[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_906 = llvm.insertelement %b_809, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_907 = llvm.insertelement %b_813, %accumulator_906[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_908 = llvm.insertelement %b_817, %accumulator_907[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_909 = llvm.insertelement %b_821, %accumulator_908[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_910 = llvm.extractelement %accumulator_909[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_911 = llvm.insertelement %accumulator_910, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_912 = llvm.extractelement %accumulator_909[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_913 = llvm.insertelement %accumulator_912, %accumulator_911[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_914 = llvm.extractelement %accumulator_909[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_915 = llvm.insertelement %accumulator_914, %accumulator_913[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_916 = llvm.extractelement %accumulator_909[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_917 = llvm.insertelement %accumulator_916, %accumulator_915[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_918 = llvm.extractvalue %accumulator_294[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_919 = llvm.extractvalue %accumulator_294[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_920 = llvm.extractvalue %accumulator_294[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_921 = llvm.extractvalue %accumulator_294[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_922 = llvm.insertelement %accumulator_918, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_923 = llvm.insertelement %accumulator_919, %accumulator_922[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_924 = llvm.insertelement %accumulator_920, %accumulator_923[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_925 = llvm.insertelement %accumulator_921, %accumulator_924[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_926 = rocdl.mfma.f32.16x16x16f16 %accumulator_881, %accumulator_833, %accumulator_925, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_927 = rocdl.mfma.f32.16x16x16f16 %accumulator_893, %accumulator_845, %accumulator_926, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_928 = rocdl.mfma.f32.16x16x16f16 %accumulator_905, %accumulator_857, %accumulator_927, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_929 = rocdl.mfma.f32.16x16x16f16 %accumulator_917, %accumulator_869, %accumulator_928, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_930 = llvm.extractelement %accumulator_929[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_931 = llvm.extractelement %accumulator_929[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_932 = llvm.extractelement %accumulator_929[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_933 = llvm.extractelement %accumulator_929[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_934 = llvm.insertvalue %accumulator_930, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_935 = llvm.insertvalue %accumulator_931, %accumulator_934[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_936 = llvm.insertvalue %accumulator_932, %accumulator_935[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_937 = llvm.insertvalue %accumulator_933, %accumulator_936[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_937 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_294 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_938: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_939 = llvm.extractvalue %accumulator_938[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_940 = llvm.extractvalue %accumulator_938[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_941 = llvm.extractvalue %accumulator_938[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_942 = llvm.extractvalue %accumulator_938[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_943 = llvm.extractvalue %accumulator_294[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_944 = llvm.extractvalue %accumulator_294[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_945 = llvm.extractvalue %accumulator_294[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_946 = llvm.extractvalue %accumulator_294[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_947 = llvm.select %accumulator_682, %accumulator_939, %accumulator_943 : i1, f32 loc(#loc118)
    %accumulator_948 = llvm.select %accumulator_682, %accumulator_940, %accumulator_944 : i1, f32 loc(#loc118)
    %accumulator_949 = llvm.select %accumulator_682, %accumulator_941, %accumulator_945 : i1, f32 loc(#loc118)
    %accumulator_950 = llvm.select %accumulator_682, %accumulator_942, %accumulator_946 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_947 : f32 to f16 loc(#loc105)
    %c_951 = llvm.fptrunc %accumulator_948 : f32 to f16 loc(#loc105)
    %c_952 = llvm.fptrunc %accumulator_949 : f32 to f16 loc(#loc105)
    %c_953 = llvm.fptrunc %accumulator_950 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_62 : i32 loc(#loc106)
    %c_ptrs_954 = llvm.mul %stride_cm, %offs_am_91 : i32 loc(#loc107)
    %c_ptrs_955 = llvm.add %c_ptrs, %offs_bn_95 : i32 loc(#loc107)
    %c_ptrs_956 = llvm.add %c_ptrs_954, %offs_bn_108 : i32 loc(#loc107)
    %c_ptrs_957 = llvm.add %c_ptrs_955, %c_ptrs_956 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_93, %M : i32 loc(#loc108)
    %c_mask_958 = llvm.icmp "slt" %offs_bn_128, %N : i32 loc(#loc109)
    %c_mask_959 = llvm.and %c_mask, %c_mask_958 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_959 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_951, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_952, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_953, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_957, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before ConvertControlFlowToLLVMPass (convert-cf-to-llvm) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before ArithToLLVMConversionPass (convert-arith-to-llvm) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before Canonicalizer (canonicalize) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before CSE (cse) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before SymbolDCE (symbol-dce) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before LLVMDIScope (enable-line-info) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc95 = loc("a_ptrs"(#loc41))
#loc97 = loc("b_ptrs"(#loc43))
#loc104 = loc("accumulator"(#loc50))
#loc111 = loc(callsite(#loc4 at #loc69))
#loc117 = loc("b_ptrs"(#loc95))
#loc118 = loc("accumulator"(#loc117))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc111)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc112)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc113)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc114)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc115)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc116)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc93)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc94)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc118)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc96)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc118)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc97)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc97)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc97)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc97)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc97)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc97)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc98)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc118)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc99)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc118)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc117)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc118)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc118)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc100)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc100)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc100)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc100)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc100)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc100)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc100)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc100)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc100)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc101)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc101)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc118)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc102)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc103)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc96)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc98)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc118)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc118)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc118)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc118)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc118)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc104)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc104)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc104)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc104)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc104)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc104)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc104)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc118)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc118)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc118)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc118)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc118)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc105)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc105)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc105)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc105)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc106)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc107)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc107)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc107)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc107)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc108)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc109)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc110)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc)
} loc(#loc)
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc93 = loc(callsite(#loc13 at #loc40))
#loc94 = loc(callsite(#loc15 at #loc40))
#loc96 = loc("a"(#loc42))
#loc98 = loc("b"(#loc44))
#loc99 = loc("b_ptrs"(#loc45))
#loc100 = loc("a_ptrs"(#loc46))
#loc101 = loc("b_ptrs"(#loc47))
#loc102 = loc("a"(#loc48))
#loc103 = loc("a"(#loc49))
#loc105 = loc("c"(#loc51))
#loc106 = loc("c_ptrs"(#loc52))
#loc107 = loc("c_ptrs"(#loc53))
#loc108 = loc("c_mask"(#loc54))
#loc109 = loc("c_mask"(#loc55))
#loc110 = loc("c_mask"(#loc56))
#loc112 = loc(callsite(#loc1 at #loc70))
#loc113 = loc(callsite(#loc13 at #loc76))
#loc114 = loc(callsite(#loc15 at #loc76))
#loc115 = loc(callsite(#loc13 at #loc70))
#loc116 = loc(callsite(#loc15 at #loc70))


// -----// IR Dump Before ConvertBuiltinFuncToLLVM (convert-builtin-func-to-llvm) ('builtin.module' operation) //----- //
#loc = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)
#loc1 = loc(unknown)
#loc4 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":129:31)
#loc5 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":297:27)
#loc8 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:20)
#loc9 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:20)
#loc39 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:22)
#loc41 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:22)
#loc43 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:22)
#loc50 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":304:35)
#loc58 = loc("a_ptr"(#loc))
#loc59 = loc("b_ptr"(#loc))
#loc60 = loc("c_ptr"(#loc))
#loc61 = loc("M"(#loc))
#loc62 = loc("N"(#loc))
#loc63 = loc("K"(#loc))
#loc64 = loc("stride_am"(#loc))
#loc65 = loc("stride_bk"(#loc))
#loc66 = loc("stride_cm"(#loc))
#loc69 = loc("accumulator"(#loc5))
#loc71 = loc("b"(#loc8))
#loc72 = loc("a"(#loc9))
#loc92 = loc("a_ptrs"(#loc39))
#loc93 = loc("a_ptrs"(#loc41))
#loc95 = loc("b_ptrs"(#loc43))
#loc102 = loc("accumulator"(#loc50))
#loc109 = loc("b_ptrs"(#loc93))
#loc110 = loc(callsite(#loc4 at #loc69))
#loc111 = loc("accumulator"(#loc109))
module attributes {"ttg.num-ctas" = 1 : i32, "ttg.num-warps" = 8 : i32, ttg.shared = 12288 : i32, ttg.target = "hip:gfx942", "ttg.threads-per-warp" = 64 : i32} {
  llvm.mlir.global external @global_smem() {addr_space = 3 : i32, alignment = 16 : i64} : !llvm.array<0 x i8> loc(#loc)
  llvm.func @matmul_kernel(%a_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("a_ptr"(#loc)), %b_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("b_ptr"(#loc)), %c_ptr: !llvm.ptr<1> {tt.divisibility = 16 : i32, tt.pointee_type = f16, tt.pointer_range = 32 : i32} loc("c_ptr"(#loc)), %M: i32 {tt.divisibility = 16 : i32} loc("M"(#loc)), %N: i32 {tt.divisibility = 16 : i32} loc("N"(#loc)), %K: i32 {tt.divisibility = 16 : i32} loc("K"(#loc)), %stride_am: i32 {tt.divisibility = 16 : i32} loc("stride_am"(#loc)), %stride_bk: i32 {tt.divisibility = 16 : i32} loc("stride_bk"(#loc)), %stride_cm: i32 {tt.divisibility = 16 : i32} loc("stride_cm"(#loc)), %arg9: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0), %arg10: !llvm.ptr<1> loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":233:0)) attributes {noinline = false} {
    %0 = llvm.mlir.undef : vector<4xf32> loc(#loc1)
    %1 = llvm.mlir.constant(3264 : i32) : i32 loc(#loc1)
    %2 = llvm.mlir.constant(3200 : i32) : i32 loc(#loc1)
    %3 = llvm.mlir.constant(3136 : i32) : i32 loc(#loc1)
    %4 = llvm.mlir.constant(3072 : i32) : i32 loc(#loc1)
    %5 = llvm.mlir.constant(2240 : i32) : i32 loc(#loc1)
    %6 = llvm.mlir.constant(2176 : i32) : i32 loc(#loc1)
    %7 = llvm.mlir.constant(2112 : i32) : i32 loc(#loc1)
    %8 = llvm.mlir.constant(1216 : i32) : i32 loc(#loc1)
    %9 = llvm.mlir.constant(1152 : i32) : i32 loc(#loc1)
    %10 = llvm.mlir.constant(1088 : i32) : i32 loc(#loc1)
    %11 = llvm.mlir.constant(1024 : i32) : i32 loc(#loc1)
    %12 = llvm.mlir.constant(192 : i32) : i32 loc(#loc1)
    %13 = llvm.mlir.constant(128 : i32) : i32 loc(#loc1)
    %14 = llvm.mlir.constant(96 : i32) : i32 loc(#loc1)
    %15 = llvm.mlir.constant(48 : i32) : i32 loc(#loc1)
    %16 = llvm.mlir.constant(2048 : i32) : i32 loc(#loc1)
    %17 = llvm.mlir.constant(8 : i32) : i32 loc(#loc1)
    %18 = llvm.mlir.undef : vector<4xf16> loc(#loc1)
    %19 = llvm.mlir.constant(120 : i32) : i32 loc(#loc1)
    %20 = llvm.mlir.undef : !llvm.struct<(ptr<3>, i32, i32)> loc(#loc1)
    %21 = llvm.mlir.constant(4096 : i32) : i32 loc(#loc1)
    %22 = llvm.mlir.addressof @global_smem : !llvm.ptr<3> loc(#loc1)
    %23 = llvm.mlir.constant(7 : index) : i32 loc(#loc1)
    %24 = llvm.mlir.constant(6 : index) : i32 loc(#loc1)
    %25 = llvm.mlir.constant(5 : index) : i32 loc(#loc1)
    %26 = llvm.mlir.constant(4 : index) : i32 loc(#loc1)
    %27 = llvm.mlir.constant(3 : index) : i32 loc(#loc1)
    %28 = llvm.mlir.constant(2 : index) : i32 loc(#loc1)
    %29 = llvm.mlir.constant(1 : index) : i32 loc(#loc1)
    %30 = llvm.mlir.constant(-2147483648 : i32) : i32 loc(#loc1)
    %31 = llvm.mlir.constant(2147483646 : i64) : i64 loc(#loc1)
    %32 = llvm.mlir.constant(159744 : i32) : i32 loc(#loc1)
    %33 = llvm.mlir.constant(0 : i16) : i16 loc(#loc1)
    %a_ptrs = llvm.mlir.constant(5 : i32) : i32 loc(#loc67)
    %34 = llvm.mlir.constant(7 : i32) : i32 loc(#loc1)
    %35 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32)> loc(#loc1)
    %36 = llvm.mlir.constant(2 : i32) : i32 loc(#loc1)
    %offs_bn = llvm.mlir.constant(112 : i32) : i32 loc(#loc68)
    %37 = llvm.mlir.constant(384 : i32) : i32 loc(#loc1)
    %38 = llvm.mlir.constant(15 : i32) : i32 loc(#loc1)
    %39 = llvm.mlir.constant(3 : i32) : i32 loc(#loc1)
    %40 = llvm.mlir.constant(504 : i32) : i32 loc(#loc1)
    %41 = llvm.mlir.constant(6 : i32) : i32 loc(#loc1)
    %42 = llvm.mlir.constant(0 : index) : i32 loc(#loc1)
    %43 = llvm.mlir.undef : !llvm.struct<(f32, f32, f32, f32)> loc(#loc1)
    %accumulator = llvm.mlir.constant(0.000000e+00 : f32) : f32 loc(#loc121)
    %num_pid_n = llvm.mlir.constant(31 : i32) : i32 loc(#loc122)
    %44 = llvm.mlir.constant(63 : i32) : i32 loc(#loc1)
    %45 = llvm.mlir.constant(1 : i32) : i32 loc(#loc1)
    %46 = llvm.mlir.constant(4 : i32) : i32 loc(#loc1)
    %47 = llvm.mlir.constant(0 : i32) : i32 loc(#loc1)
    %48 = llvm.mlir.constant(true) : i1 loc(#loc1)
    %49 = llvm.mlir.constant(32 : i32) : i32 loc(#loc1)
    %50 = llvm.mlir.undef : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc(#loc1)
    %51 = llvm.mlir.constant(511 : i32) : i32 loc(#loc1)
    %52 = llvm.mlir.constant(64 : i32) : i32 loc(#loc1)
    %53 = rocdl.workitem.id.x : i32 loc(#loc7)
    %54 = llvm.and %53, %51 : i32 loc(#loc7)
    %55 = llvm.udiv %54, %52 : i32 loc(#loc7)
    %56 = rocdl.readfirstlane %55 : i32 loc(#loc7)
    %b = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_0 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_1 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_2 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_3 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_4 = rocdl.readfirstlane %55 : i32 loc(#loc71)
    %a_5 = rocdl.readfirstlane %55 : i32 loc(#loc72)
    %b_ptrs = rocdl.readfirstlane %55 : i32 loc(#loc73)
    %a_ptrs_6 = rocdl.readfirstlane %55 : i32 loc(#loc67)
    %offs_bn_7 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_bn_8 = rocdl.readfirstlane %55 : i32 loc(#loc68)
    %offs_am = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %offs_am_9 = rocdl.readfirstlane %55 : i32 loc(#loc74)
    %accumulator_10 = llvm.insertvalue %accumulator, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc121)
    %accumulator_11 = llvm.insertvalue %accumulator, %accumulator_10[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc121)
    %accumulator_12 = llvm.insertvalue %accumulator, %accumulator_11[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc121)
    %accumulator_13 = llvm.insertvalue %accumulator, %accumulator_12[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc121)
    %pid = rocdl.workgroup.id.x : i32 loc(#loc75)
    %num_pid_m = llvm.add %M, %44 : i32 loc(#loc123)
    %num_pid_m_14 = llvm.sdiv %num_pid_m, %52 : i32 loc(#loc124)
    %num_pid_n_15 = llvm.add %N, %num_pid_n : i32 loc(#loc125)
    %num_pid_n_16 = llvm.sdiv %num_pid_n_15, %49 : i32 loc(#loc126)
    %num_pid_in_group = llvm.mul %num_pid_n_16, %46 : i32 loc(#loc77)
    %group_id = llvm.sdiv %pid, %num_pid_in_group : i32 loc(#loc78)
    %first_pid_m = llvm.mul %group_id, %46 : i32 loc(#loc79)
    %group_size_m = llvm.sub %num_pid_m_14, %first_pid_m : i32 loc(#loc80)
    %group_size_m_17 = llvm.intr.smin(%group_size_m, %46) : (i32, i32) -> i32 loc(#loc81)
    %pid_m = llvm.srem %pid, %num_pid_in_group : i32 loc(#loc82)
    %pid_m_18 = llvm.srem %pid_m, %group_size_m_17 : i32 loc(#loc83)
    %pid_m_19 = llvm.add %first_pid_m, %pid_m_18 : i32 loc(#loc84)
    %pid_n = llvm.sdiv %pid_m, %group_size_m_17 : i32 loc(#loc85)
    llvm.intr.assume %48 : i1 loc(#loc25)
    llvm.intr.assume %48 : i1 loc(#loc26)
    llvm.intr.assume %48 : i1 loc(#loc27)
    llvm.intr.assume %48 : i1 loc(#loc28)
    llvm.intr.assume %48 : i1 loc(#loc29)
    llvm.intr.assume %48 : i1 loc(#loc30)
    llvm.intr.assume %48 : i1 loc(#loc31)
    llvm.intr.assume %48 : i1 loc(#loc32)
    %offs_am_20 = llvm.mul %pid_m_19, %52 : i32 loc(#loc86)
    %offs_am_21 = llvm.urem %54, %52 : i32 loc(#loc74)
    %offs_am_22 = llvm.shl %offs_am_21, %47 : i32 loc(#loc74)
    %offs_am_23 = llvm.or %47, %offs_am_22 : i32 loc(#loc74)
    %offs_am_24 = llvm.shl %offs_am_9, %41 : i32 loc(#loc74)
    %offs_am_25 = llvm.or %offs_am_23, %offs_am_24 : i32 loc(#loc74)
    %offs_am_26 = llvm.and %offs_am_25, %40 : i32 loc(#loc74)
    %offs_am_27 = llvm.lshr %offs_am_26, %39 : i32 loc(#loc74)
    %offs_am_28 = llvm.or disjoint %offs_am_27, %47 : i32 loc(#loc74)
    %offs_am_29 = llvm.xor %47, %offs_am_28 : i32 loc(#loc74)
    %offs_am_30 = llvm.xor %offs_am_29, %47 : i32 loc(#loc74)
    %offs_am_31 = llvm.add %offs_am_30, %42 : i32 loc(#loc74)
    %offs_am_32 = llvm.shl %offs_am, %41 : i32 loc(#loc74)
    %offs_am_33 = llvm.or %offs_am_23, %offs_am_32 : i32 loc(#loc74)
    %offs_am_34 = llvm.and %offs_am_33, %38 : i32 loc(#loc74)
    %offs_am_35 = llvm.lshr %offs_am_34, %47 : i32 loc(#loc74)
    %offs_am_36 = llvm.and %offs_am_33, %37 : i32 loc(#loc74)
    %offs_am_37 = llvm.lshr %offs_am_36, %39 : i32 loc(#loc74)
    %offs_am_38 = llvm.or disjoint %offs_am_35, %offs_am_37 : i32 loc(#loc74)
    %offs_am_39 = llvm.or disjoint %offs_am_38, %47 : i32 loc(#loc74)
    %offs_am_40 = llvm.xor %47, %offs_am_39 : i32 loc(#loc74)
    %offs_am_41 = llvm.xor %offs_am_40, %47 : i32 loc(#loc74)
    %offs_am_42 = llvm.add %offs_am_41, %42 : i32 loc(#loc74)
    %offs_am_43 = llvm.add %offs_am_20, %offs_am_31 : i32 loc(#loc87)
    %offs_am_44 = llvm.add %offs_am_20, %offs_am_42 : i32 loc(#loc87)
    %offs_am_45 = llvm.srem %offs_am_43, %M : i32 loc(#loc88)
    %offs_bn_46 = llvm.mul %pid_n, %49 : i32 loc(#loc89)
    %offs_bn_47 = llvm.shl %offs_bn_8, %41 : i32 loc(#loc68)
    %offs_bn_48 = llvm.or %offs_am_23, %offs_bn_47 : i32 loc(#loc68)
    %offs_bn_49 = llvm.and %offs_bn_48, %offs_bn : i32 loc(#loc68)
    %offs_bn_50 = llvm.lshr %offs_bn_49, %36 : i32 loc(#loc68)
    %offs_bn_51 = llvm.or disjoint %47, %offs_bn_50 : i32 loc(#loc68)
    %offs_bn_52 = llvm.xor %47, %offs_bn_51 : i32 loc(#loc68)
    %offs_bn_53 = llvm.xor %offs_bn_52, %47 : i32 loc(#loc68)
    %offs_bn_54 = llvm.add %offs_bn_53, %42 : i32 loc(#loc68)
    %offs_bn_55 = llvm.shl %offs_bn_7, %41 : i32 loc(#loc68)
    %offs_bn_56 = llvm.or %offs_am_23, %offs_bn_55 : i32 loc(#loc68)
    %offs_bn_57 = llvm.and %offs_bn_56, %34 : i32 loc(#loc68)
    %offs_bn_58 = llvm.shl %offs_bn_57, %36 : i32 loc(#loc68)
    %offs_bn_59 = llvm.or disjoint %offs_bn_58, %47 : i32 loc(#loc68)
    %offs_bn_60 = llvm.xor %47, %offs_bn_59 : i32 loc(#loc68)
    %offs_bn_61 = llvm.xor %offs_bn_60, %47 : i32 loc(#loc68)
    %offs_bn_62 = llvm.xor %offs_bn_60, %45 : i32 loc(#loc68)
    %offs_bn_63 = llvm.xor %offs_bn_60, %36 : i32 loc(#loc68)
    %offs_bn_64 = llvm.xor %offs_bn_60, %39 : i32 loc(#loc68)
    %offs_bn_65 = llvm.add %offs_bn_61, %42 : i32 loc(#loc68)
    %offs_bn_66 = llvm.add %offs_bn_62, %42 : i32 loc(#loc68)
    %offs_bn_67 = llvm.add %offs_bn_63, %42 : i32 loc(#loc68)
    %offs_bn_68 = llvm.add %offs_bn_64, %42 : i32 loc(#loc68)
    %offs_bn_69 = llvm.add %offs_bn_46, %offs_bn_54 : i32 loc(#loc90)
    %offs_bn_70 = llvm.add %offs_bn_46, %offs_bn_65 : i32 loc(#loc90)
    %offs_bn_71 = llvm.add %offs_bn_46, %offs_bn_66 : i32 loc(#loc90)
    %offs_bn_72 = llvm.add %offs_bn_46, %offs_bn_67 : i32 loc(#loc90)
    %offs_bn_73 = llvm.add %offs_bn_46, %offs_bn_68 : i32 loc(#loc90)
    %offs_bn_74 = llvm.srem %offs_bn_70, %N : i32 loc(#loc91)
    %offs_bn_75 = llvm.srem %offs_bn_71, %N : i32 loc(#loc91)
    %offs_bn_76 = llvm.srem %offs_bn_72, %N : i32 loc(#loc91)
    %offs_bn_77 = llvm.srem %offs_bn_73, %N : i32 loc(#loc91)
    %a_ptrs_78 = llvm.shl %a_ptrs_6, %41 : i32 loc(#loc67)
    %a_ptrs_79 = llvm.or %offs_am_23, %a_ptrs_78 : i32 loc(#loc67)
    %a_ptrs_80 = llvm.and %a_ptrs_79, %34 : i32 loc(#loc67)
    %a_ptrs_81 = llvm.shl %a_ptrs_80, %39 : i32 loc(#loc67)
    %a_ptrs_82 = llvm.or disjoint %a_ptrs_81, %47 : i32 loc(#loc67)
    %a_ptrs_83 = llvm.xor %47, %a_ptrs_82 : i32 loc(#loc67)
    %a_ptrs_84 = llvm.xor %a_ptrs_83, %47 : i32 loc(#loc67)
    %a_ptrs_85 = llvm.xor %a_ptrs_83, %45 : i32 loc(#loc67)
    %a_ptrs_86 = llvm.xor %a_ptrs_83, %36 : i32 loc(#loc67)
    %a_ptrs_87 = llvm.xor %a_ptrs_83, %39 : i32 loc(#loc67)
    %a_ptrs_88 = llvm.xor %a_ptrs_83, %46 : i32 loc(#loc67)
    %a_ptrs_89 = llvm.xor %a_ptrs_83, %a_ptrs : i32 loc(#loc67)
    %a_ptrs_90 = llvm.xor %a_ptrs_83, %41 : i32 loc(#loc67)
    %a_ptrs_91 = llvm.xor %a_ptrs_83, %34 : i32 loc(#loc67)
    %a_ptrs_92 = llvm.add %a_ptrs_84, %42 : i32 loc(#loc67)
    %a_ptrs_93 = llvm.add %a_ptrs_85, %42 : i32 loc(#loc67)
    %a_ptrs_94 = llvm.add %a_ptrs_86, %42 : i32 loc(#loc67)
    %a_ptrs_95 = llvm.add %a_ptrs_87, %42 : i32 loc(#loc67)
    %a_ptrs_96 = llvm.add %a_ptrs_88, %42 : i32 loc(#loc67)
    %a_ptrs_97 = llvm.add %a_ptrs_89, %42 : i32 loc(#loc67)
    %a_ptrs_98 = llvm.add %a_ptrs_90, %42 : i32 loc(#loc67)
    %a_ptrs_99 = llvm.add %a_ptrs_91, %42 : i32 loc(#loc67)
    %a_ptrs_100 = llvm.mul %offs_am_45, %stride_am : i32 loc(#loc92)
    %a_ptrs_101 = llvm.add %a_ptrs_100, %a_ptrs_92 : i32 loc(#loc92)
    %a_ptrs_102 = llvm.add %a_ptrs_100, %a_ptrs_93 : i32 loc(#loc92)
    %a_ptrs_103 = llvm.add %a_ptrs_100, %a_ptrs_94 : i32 loc(#loc92)
    %a_ptrs_104 = llvm.add %a_ptrs_100, %a_ptrs_95 : i32 loc(#loc92)
    %a_ptrs_105 = llvm.add %a_ptrs_100, %a_ptrs_96 : i32 loc(#loc92)
    %a_ptrs_106 = llvm.add %a_ptrs_100, %a_ptrs_97 : i32 loc(#loc92)
    %a_ptrs_107 = llvm.add %a_ptrs_100, %a_ptrs_98 : i32 loc(#loc92)
    %a_ptrs_108 = llvm.add %a_ptrs_100, %a_ptrs_99 : i32 loc(#loc92)
    %a_ptrs_109 = llvm.insertvalue %a_ptrs_101, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_110 = llvm.insertvalue %a_ptrs_102, %a_ptrs_109[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_111 = llvm.insertvalue %a_ptrs_103, %a_ptrs_110[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_112 = llvm.insertvalue %a_ptrs_104, %a_ptrs_111[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_113 = llvm.insertvalue %a_ptrs_105, %a_ptrs_112[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_114 = llvm.insertvalue %a_ptrs_106, %a_ptrs_113[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_115 = llvm.insertvalue %a_ptrs_107, %a_ptrs_114[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %a_ptrs_116 = llvm.insertvalue %a_ptrs_108, %a_ptrs_115[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc92)
    %57 = llvm.add %K, %44 : i32 loc(#loc127)
    %58 = llvm.sdiv %57, %52 : i32 loc(#loc128)
    %accumulator_117 = llvm.icmp "sgt" %58, %47 : i32 loc(#loc111)
    %a_118 = llvm.icmp "slt" %a_ptrs_92, %K : i32 loc(#loc94)
    %accumulator_119 = llvm.and %accumulator_117, %a_118 : i1 loc(#loc111)
    %a_120 = rocdl.make.buffer.rsrc %a_ptr, %33, %31, %32 : <1> to <8> loc(#loc72)
    %a_121 = llvm.mul %a_ptrs_101, %36 : i32 loc(#loc72)
    %a_122 = llvm.select %accumulator_119, %a_121, %30 : i1, i32 loc(#loc72)
    %a_123 = rocdl.raw.ptr.buffer.load %a_120, %a_122, %47, %47 : vector<4xi32> loc(#loc72)
    %a_124 = llvm.bitcast %a_123 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_125 = llvm.extractelement %a_124[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_126 = llvm.extractelement %a_124[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_127 = llvm.extractelement %a_124[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_128 = llvm.extractelement %a_124[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_129 = llvm.extractelement %a_124[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_130 = llvm.extractelement %a_124[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_131 = llvm.extractelement %a_124[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_132 = llvm.extractelement %a_124[%23 : i32] : vector<8xf16> loc(#loc72)
    %b_ptrs_133 = llvm.shl %b_ptrs, %41 : i32 loc(#loc73)
    %b_ptrs_134 = llvm.or %offs_am_23, %b_ptrs_133 : i32 loc(#loc73)
    %b_ptrs_135 = llvm.and %b_ptrs_134, %40 : i32 loc(#loc73)
    %b_ptrs_136 = llvm.lshr %b_ptrs_135, %39 : i32 loc(#loc73)
    %b_ptrs_137 = llvm.or disjoint %b_ptrs_136, %47 : i32 loc(#loc73)
    %b_ptrs_138 = llvm.xor %47, %b_ptrs_137 : i32 loc(#loc73)
    %b_ptrs_139 = llvm.xor %b_ptrs_138, %47 : i32 loc(#loc73)
    %b_ptrs_140 = llvm.add %b_ptrs_139, %42 : i32 loc(#loc73)
    %b_ptrs_141 = llvm.mul %b_ptrs_140, %stride_bk : i32 loc(#loc95)
    %b_ptrs_142 = llvm.add %b_ptrs_141, %offs_bn_74 : i32 loc(#loc95)
    %b_ptrs_143 = llvm.add %b_ptrs_141, %offs_bn_75 : i32 loc(#loc95)
    %b_ptrs_144 = llvm.add %b_ptrs_141, %offs_bn_76 : i32 loc(#loc95)
    %b_ptrs_145 = llvm.add %b_ptrs_141, %offs_bn_77 : i32 loc(#loc95)
    %b_ptrs_146 = llvm.insertvalue %b_ptrs_142, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc95)
    %b_ptrs_147 = llvm.insertvalue %b_ptrs_143, %b_ptrs_146[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc95)
    %b_ptrs_148 = llvm.insertvalue %b_ptrs_144, %b_ptrs_147[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc95)
    %b_ptrs_149 = llvm.insertvalue %b_ptrs_145, %b_ptrs_148[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc95)
    %b_150 = llvm.icmp "slt" %b_ptrs_140, %K : i32 loc(#loc96)
    %accumulator_151 = llvm.and %accumulator_117, %b_150 : i1 loc(#loc111)
    %b_152 = rocdl.make.buffer.rsrc %b_ptr, %33, %31, %32 : <1> to <8> loc(#loc71)
    %b_153 = llvm.mul %b_ptrs_142, %36 : i32 loc(#loc71)
    %b_154 = llvm.select %accumulator_151, %b_153, %30 : i1, i32 loc(#loc71)
    %b_155 = rocdl.raw.ptr.buffer.load %b_152, %b_154, %47, %47 : vector<2xi32> loc(#loc71)
    %b_156 = llvm.bitcast %b_155 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_157 = llvm.extractelement %b_156[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_158 = llvm.extractelement %b_156[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_159 = llvm.extractelement %b_156[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_160 = llvm.extractelement %b_156[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_ptrs_161 = llvm.mul %stride_bk, %52 : i32 loc(#loc97)
    %b_162 = llvm.getelementptr %22[8192] : (!llvm.ptr<3>) -> !llvm.ptr<3>, i8 loc(#loc71)
    %a_163 = llvm.mul %47, %21 : i32 loc(#loc72)
    %a_164 = llvm.getelementptr %22[%a_163] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_165 = llvm.insertvalue %a_164, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_166 = llvm.insertvalue %47, %a_165[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_167 = llvm.insertvalue %47, %a_166[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_168 = llvm.shl %a_5, %41 : i32 loc(#loc72)
    %a_169 = llvm.or %offs_am_23, %a_168 : i32 loc(#loc72)
    %a_170 = llvm.and %a_169, %51 : i32 loc(#loc72)
    %a_171 = llvm.shl %a_170, %46 : i32 loc(#loc72)
    %a_172 = llvm.and %a_169, %19 : i32 loc(#loc72)
    %a_173 = llvm.lshr %a_172, %47 : i32 loc(#loc72)
    %a_174 = llvm.xor %a_171, %a_173 : i32 loc(#loc72)
    %a_175 = llvm.or disjoint %47, %a_174 : i32 loc(#loc72)
    %a_176 = llvm.xor %47, %a_175 : i32 loc(#loc72)
    %a_177 = llvm.mul %47, %36 : i32 loc(#loc72)
    %a_178 = llvm.xor %a_176, %a_177 : i32 loc(#loc72)
    %a_179 = llvm.xor %a_178, %47 : i32 loc(#loc72)
    %a_180 = llvm.add %a_179, %47 : i32 loc(#loc72)
    %a_181 = llvm.getelementptr inbounds %a_164[%a_180] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_182 = llvm.insertelement %a_125, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_183 = llvm.insertelement %a_126, %a_182[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_184 = llvm.insertelement %a_127, %a_183[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_185 = llvm.insertelement %a_128, %a_184[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_185, %a_181 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_186 = llvm.xor %a_178, %17 : i32 loc(#loc72)
    %a_187 = llvm.add %a_186, %47 : i32 loc(#loc72)
    %a_188 = llvm.getelementptr inbounds %a_164[%a_187] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_189 = llvm.insertelement %a_129, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_190 = llvm.insertelement %a_130, %a_189[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_191 = llvm.insertelement %a_131, %a_190[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_192 = llvm.insertelement %a_132, %a_191[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_192, %a_188 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_193 = llvm.mul %47, %16 : i32 loc(#loc71)
    %b_194 = llvm.getelementptr %b_162[%b_193] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_195 = llvm.insertvalue %b_194, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_196 = llvm.insertvalue %47, %b_195[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_197 = llvm.insertvalue %47, %b_196[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_198 = llvm.shl %b_4, %41 : i32 loc(#loc71)
    %b_199 = llvm.or %offs_am_23, %b_198 : i32 loc(#loc71)
    %b_200 = llvm.and %b_199, %51 : i32 loc(#loc71)
    %b_201 = llvm.shl %b_200, %39 : i32 loc(#loc71)
    %b_202 = llvm.or disjoint %b_201, %47 : i32 loc(#loc71)
    %b_203 = llvm.xor %47, %b_202 : i32 loc(#loc71)
    %b_204 = llvm.xor %b_203, %a_177 : i32 loc(#loc71)
    %b_205 = llvm.xor %b_204, %47 : i32 loc(#loc71)
    %b_206 = llvm.add %b_205, %47 : i32 loc(#loc71)
    %b_207 = llvm.getelementptr inbounds %b_194[%b_206] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_208 = llvm.insertelement %b_157, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_209 = llvm.insertelement %b_158, %b_208[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_210 = llvm.insertelement %b_159, %b_209[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_211 = llvm.insertelement %b_160, %b_210[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_211, %b_207 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    %accumulator_212 = llvm.sub %58, %45 : i32 loc(#loc111)
    llvm.br ^bb1(%47, %accumulator_13, %a_ptrs_116, %b_ptrs_149, %47, %a_167, %b_197 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc111)
  ^bb1(%accumulator_213: i32 loc("accumulator"(#loc109)), %accumulator_214: !llvm.struct<(f32, f32, f32, f32)> loc(callsite(#loc4 at #loc69)), %a_ptrs_215: !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)> loc("a_ptrs"(#loc39)), %b_ptrs_216: !llvm.struct<(i32, i32, i32, i32)> loc("b_ptrs"(#loc43)), %59: i32 loc(unknown), %a_217: !llvm.struct<(ptr<3>, i32, i32)> loc("a"(#loc9)), %b_218: !llvm.struct<(ptr<3>, i32, i32)> loc("b"(#loc8))):  // 2 preds: ^bb0, ^bb2
    %accumulator_219 = llvm.icmp "slt" %accumulator_213, %accumulator_212 : i32 loc(#loc111)
    llvm.cond_br %accumulator_219, ^bb2, ^bb3 loc(#loc111)
  ^bb2:  // pred: ^bb1
    %a_ptrs_220 = llvm.extractvalue %a_ptrs_215[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_221 = llvm.extractvalue %a_ptrs_215[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_222 = llvm.extractvalue %a_ptrs_215[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_223 = llvm.extractvalue %a_ptrs_215[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_224 = llvm.extractvalue %a_ptrs_215[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_225 = llvm.extractvalue %a_ptrs_215[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_226 = llvm.extractvalue %a_ptrs_215[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_227 = llvm.extractvalue %a_ptrs_215[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_228 = llvm.add %a_ptrs_220, %52 : i32 loc(#loc98)
    %a_ptrs_229 = llvm.add %a_ptrs_221, %52 : i32 loc(#loc98)
    %a_ptrs_230 = llvm.add %a_ptrs_222, %52 : i32 loc(#loc98)
    %a_ptrs_231 = llvm.add %a_ptrs_223, %52 : i32 loc(#loc98)
    %a_ptrs_232 = llvm.add %a_ptrs_224, %52 : i32 loc(#loc98)
    %a_ptrs_233 = llvm.add %a_ptrs_225, %52 : i32 loc(#loc98)
    %a_ptrs_234 = llvm.add %a_ptrs_226, %52 : i32 loc(#loc98)
    %a_ptrs_235 = llvm.add %a_ptrs_227, %52 : i32 loc(#loc98)
    %a_ptrs_236 = llvm.insertvalue %a_ptrs_228, %50[0] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_237 = llvm.insertvalue %a_ptrs_229, %a_ptrs_236[1] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_238 = llvm.insertvalue %a_ptrs_230, %a_ptrs_237[2] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_239 = llvm.insertvalue %a_ptrs_231, %a_ptrs_238[3] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_240 = llvm.insertvalue %a_ptrs_232, %a_ptrs_239[4] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_241 = llvm.insertvalue %a_ptrs_233, %a_ptrs_240[5] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_242 = llvm.insertvalue %a_ptrs_234, %a_ptrs_241[6] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %a_ptrs_243 = llvm.insertvalue %a_ptrs_235, %a_ptrs_242[7] : !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>  loc(#loc98)
    %b_ptrs_244 = llvm.extractvalue %b_ptrs_216[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_245 = llvm.extractvalue %b_ptrs_216[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_246 = llvm.extractvalue %b_ptrs_216[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_247 = llvm.extractvalue %b_ptrs_216[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_248 = llvm.add %b_ptrs_244, %b_ptrs_161 : i32 loc(#loc99)
    %b_ptrs_249 = llvm.add %b_ptrs_245, %b_ptrs_161 : i32 loc(#loc99)
    %b_ptrs_250 = llvm.add %b_ptrs_246, %b_ptrs_161 : i32 loc(#loc99)
    %b_ptrs_251 = llvm.add %b_ptrs_247, %b_ptrs_161 : i32 loc(#loc99)
    %b_ptrs_252 = llvm.insertvalue %b_ptrs_248, %35[0] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_253 = llvm.insertvalue %b_ptrs_249, %b_ptrs_252[1] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_254 = llvm.insertvalue %b_ptrs_250, %b_ptrs_253[2] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %b_ptrs_255 = llvm.insertvalue %b_ptrs_251, %b_ptrs_254[3] : !llvm.struct<(i32, i32, i32, i32)>  loc(#loc99)
    %accumulator_256 = llvm.add %accumulator_213, %45 : i32 loc(#loc111)
    %a_257 = llvm.mul %accumulator_256, %52 : i32 loc(#loc100)
    %a_258 = llvm.sub %K, %a_257 : i32 loc(#loc101)
    %a_259 = llvm.icmp "slt" %a_ptrs_92, %a_258 : i32 loc(#loc94)
    %a_260 = llvm.mul %a_ptrs_228, %36 : i32 loc(#loc72)
    %a_261 = llvm.select %a_259, %a_260, %30 : i1, i32 loc(#loc72)
    %a_262 = rocdl.raw.ptr.buffer.load %a_120, %a_261, %47, %47 : vector<4xi32> loc(#loc72)
    %a_263 = llvm.bitcast %a_262 : vector<4xi32> to vector<8xf16> loc(#loc72)
    %a_264 = llvm.extractelement %a_263[%42 : i32] : vector<8xf16> loc(#loc72)
    %a_265 = llvm.extractelement %a_263[%29 : i32] : vector<8xf16> loc(#loc72)
    %a_266 = llvm.extractelement %a_263[%28 : i32] : vector<8xf16> loc(#loc72)
    %a_267 = llvm.extractelement %a_263[%27 : i32] : vector<8xf16> loc(#loc72)
    %a_268 = llvm.extractelement %a_263[%26 : i32] : vector<8xf16> loc(#loc72)
    %a_269 = llvm.extractelement %a_263[%25 : i32] : vector<8xf16> loc(#loc72)
    %a_270 = llvm.extractelement %a_263[%24 : i32] : vector<8xf16> loc(#loc72)
    %a_271 = llvm.extractelement %a_263[%23 : i32] : vector<8xf16> loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_272 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_273 = llvm.shl %a_3, %41 : i32 loc(#loc72)
    %a_274 = llvm.or %offs_am_23, %a_273 : i32 loc(#loc72)
    %a_275 = llvm.and %a_274, %38 : i32 loc(#loc72)
    %a_276 = llvm.shl %a_275, %34 : i32 loc(#loc72)
    %a_277 = llvm.and %a_274, %37 : i32 loc(#loc72)
    %a_278 = llvm.shl %a_277, %46 : i32 loc(#loc72)
    %a_279 = llvm.shl %a_275, %39 : i32 loc(#loc72)
    %a_280 = llvm.and %a_274, %15 : i32 loc(#loc72)
    %a_281 = llvm.lshr %a_280, %45 : i32 loc(#loc72)
    %a_282 = llvm.xor %a_278, %a_279 : i32 loc(#loc72)
    %a_283 = llvm.xor %a_282, %a_281 : i32 loc(#loc72)
    %a_284 = llvm.or disjoint %a_276, %a_283 : i32 loc(#loc72)
    %a_285 = llvm.xor %47, %a_284 : i32 loc(#loc72)
    %a_286 = llvm.xor %a_285, %a_177 : i32 loc(#loc72)
    %a_287 = llvm.xor %a_286, %47 : i32 loc(#loc72)
    %a_288 = llvm.add %a_287, %47 : i32 loc(#loc72)
    %a_289 = llvm.getelementptr inbounds %a_272[%a_288] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_290 = llvm.load %a_289 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_291 = llvm.extractelement %a_290[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_292 = llvm.extractelement %a_290[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_293 = llvm.extractelement %a_290[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_294 = llvm.extractelement %a_290[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_295 = llvm.xor %a_286, %49 : i32 loc(#loc72)
    %a_296 = llvm.add %a_295, %47 : i32 loc(#loc72)
    %a_297 = llvm.getelementptr inbounds %a_272[%a_296] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_298 = llvm.load %a_297 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_299 = llvm.extractelement %a_298[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_300 = llvm.extractelement %a_298[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_301 = llvm.extractelement %a_298[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_302 = llvm.extractelement %a_298[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_303 = llvm.xor %a_286, %52 : i32 loc(#loc72)
    %a_304 = llvm.add %a_303, %47 : i32 loc(#loc72)
    %a_305 = llvm.getelementptr inbounds %a_272[%a_304] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_306 = llvm.load %a_305 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_307 = llvm.extractelement %a_306[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_308 = llvm.extractelement %a_306[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_309 = llvm.extractelement %a_306[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_310 = llvm.extractelement %a_306[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_311 = llvm.xor %a_286, %14 : i32 loc(#loc72)
    %a_312 = llvm.add %a_311, %47 : i32 loc(#loc72)
    %a_313 = llvm.getelementptr inbounds %a_272[%a_312] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_314 = llvm.load %a_313 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_315 = llvm.extractelement %a_314[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_316 = llvm.extractelement %a_314[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_317 = llvm.extractelement %a_314[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_318 = llvm.extractelement %a_314[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_319 = llvm.icmp "slt" %b_ptrs_140, %a_258 : i32 loc(#loc96)
    %b_320 = llvm.mul %b_ptrs_248, %36 : i32 loc(#loc71)
    %b_321 = llvm.select %b_319, %b_320, %30 : i1, i32 loc(#loc71)
    %b_322 = rocdl.raw.ptr.buffer.load %b_152, %b_321, %47, %47 : vector<2xi32> loc(#loc71)
    %b_323 = llvm.bitcast %b_322 : vector<2xi32> to vector<4xf16> loc(#loc71)
    %b_324 = llvm.extractelement %b_323[%42 : i32] : vector<4xf16> loc(#loc71)
    %b_325 = llvm.extractelement %b_323[%29 : i32] : vector<4xf16> loc(#loc71)
    %b_326 = llvm.extractelement %b_323[%28 : i32] : vector<4xf16> loc(#loc71)
    %b_327 = llvm.extractelement %b_323[%27 : i32] : vector<4xf16> loc(#loc71)
    %b_328 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_329 = llvm.shl %b_2, %41 : i32 loc(#loc71)
    %b_330 = llvm.or %offs_am_23, %b_329 : i32 loc(#loc71)
    %b_331 = llvm.and %b_330, %15 : i32 loc(#loc71)
    %b_332 = llvm.shl %b_331, %46 : i32 loc(#loc71)
    %b_333 = llvm.and %b_330, %38 : i32 loc(#loc71)
    %b_334 = llvm.shl %b_333, %45 : i32 loc(#loc71)
    %b_335 = llvm.and %b_330, %52 : i32 loc(#loc71)
    %b_336 = llvm.icmp "eq" %b_335, %47 : i32 loc(#loc71)
    %b_337 = llvm.select %b_336, %47, %49 : i1, i32 loc(#loc71)
    %b_338 = llvm.xor %b_332, %b_334 : i32 loc(#loc71)
    %b_339 = llvm.or disjoint %b_337, %b_338 : i32 loc(#loc71)
    %b_340 = llvm.xor %47, %b_339 : i32 loc(#loc71)
    %b_341 = llvm.xor %b_340, %a_177 : i32 loc(#loc71)
    %b_342 = llvm.xor %b_341, %47 : i32 loc(#loc71)
    %b_343 = llvm.add %b_342, %47 : i32 loc(#loc71)
    %b_344 = llvm.getelementptr inbounds %b_328[%b_343] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_345 = llvm.load %b_344 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_346 = llvm.extractelement %b_345[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_347 = llvm.add %b_342, %52 : i32 loc(#loc71)
    %b_348 = llvm.getelementptr inbounds %b_328[%b_347] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_349 = llvm.load %b_348 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_350 = llvm.extractelement %b_349[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_351 = llvm.add %b_342, %13 : i32 loc(#loc71)
    %b_352 = llvm.getelementptr inbounds %b_328[%b_351] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_353 = llvm.load %b_352 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_354 = llvm.extractelement %b_353[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_355 = llvm.add %b_342, %12 : i32 loc(#loc71)
    %b_356 = llvm.getelementptr inbounds %b_328[%b_355] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_357 = llvm.load %b_356 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_358 = llvm.extractelement %b_357[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_359 = llvm.add %b_342, %11 : i32 loc(#loc71)
    %b_360 = llvm.getelementptr inbounds %b_328[%b_359] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_361 = llvm.load %b_360 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_362 = llvm.extractelement %b_361[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_363 = llvm.add %b_342, %10 : i32 loc(#loc71)
    %b_364 = llvm.getelementptr inbounds %b_328[%b_363] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_365 = llvm.load %b_364 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_366 = llvm.extractelement %b_365[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_367 = llvm.add %b_342, %9 : i32 loc(#loc71)
    %b_368 = llvm.getelementptr inbounds %b_328[%b_367] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_369 = llvm.load %b_368 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_370 = llvm.extractelement %b_369[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_371 = llvm.add %b_342, %8 : i32 loc(#loc71)
    %b_372 = llvm.getelementptr inbounds %b_328[%b_371] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_373 = llvm.load %b_372 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_374 = llvm.extractelement %b_373[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_375 = llvm.add %b_342, %16 : i32 loc(#loc71)
    %b_376 = llvm.getelementptr inbounds %b_328[%b_375] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_377 = llvm.load %b_376 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_378 = llvm.extractelement %b_377[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_379 = llvm.add %b_342, %7 : i32 loc(#loc71)
    %b_380 = llvm.getelementptr inbounds %b_328[%b_379] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_381 = llvm.load %b_380 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_382 = llvm.extractelement %b_381[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_383 = llvm.add %b_342, %6 : i32 loc(#loc71)
    %b_384 = llvm.getelementptr inbounds %b_328[%b_383] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_385 = llvm.load %b_384 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_386 = llvm.extractelement %b_385[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_387 = llvm.add %b_342, %5 : i32 loc(#loc71)
    %b_388 = llvm.getelementptr inbounds %b_328[%b_387] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_389 = llvm.load %b_388 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_390 = llvm.extractelement %b_389[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_391 = llvm.add %b_342, %4 : i32 loc(#loc71)
    %b_392 = llvm.getelementptr inbounds %b_328[%b_391] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_393 = llvm.load %b_392 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_394 = llvm.extractelement %b_393[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_395 = llvm.add %b_342, %3 : i32 loc(#loc71)
    %b_396 = llvm.getelementptr inbounds %b_328[%b_395] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_397 = llvm.load %b_396 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_398 = llvm.extractelement %b_397[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_399 = llvm.add %b_342, %2 : i32 loc(#loc71)
    %b_400 = llvm.getelementptr inbounds %b_328[%b_399] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_401 = llvm.load %b_400 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_402 = llvm.extractelement %b_401[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_403 = llvm.add %b_342, %1 : i32 loc(#loc71)
    %b_404 = llvm.getelementptr inbounds %b_328[%b_403] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_405 = llvm.load %b_404 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_406 = llvm.extractelement %b_405[%47 : i32] : vector<1xf16> loc(#loc71)
    %accumulator_407 = llvm.insertelement %a_291, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_408 = llvm.insertelement %a_292, %accumulator_407[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_409 = llvm.insertelement %a_293, %accumulator_408[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_410 = llvm.insertelement %a_294, %accumulator_409[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_411 = llvm.extractelement %accumulator_410[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_412 = llvm.insertelement %accumulator_411, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_413 = llvm.extractelement %accumulator_410[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_414 = llvm.insertelement %accumulator_413, %accumulator_412[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_415 = llvm.extractelement %accumulator_410[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_416 = llvm.insertelement %accumulator_415, %accumulator_414[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_417 = llvm.extractelement %accumulator_410[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_418 = llvm.insertelement %accumulator_417, %accumulator_416[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_419 = llvm.insertelement %a_299, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_420 = llvm.insertelement %a_300, %accumulator_419[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_421 = llvm.insertelement %a_301, %accumulator_420[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_422 = llvm.insertelement %a_302, %accumulator_421[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_423 = llvm.extractelement %accumulator_422[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_424 = llvm.insertelement %accumulator_423, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_425 = llvm.extractelement %accumulator_422[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_426 = llvm.insertelement %accumulator_425, %accumulator_424[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_427 = llvm.extractelement %accumulator_422[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_428 = llvm.insertelement %accumulator_427, %accumulator_426[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_429 = llvm.extractelement %accumulator_422[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_430 = llvm.insertelement %accumulator_429, %accumulator_428[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_431 = llvm.insertelement %a_307, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_432 = llvm.insertelement %a_308, %accumulator_431[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_433 = llvm.insertelement %a_309, %accumulator_432[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_434 = llvm.insertelement %a_310, %accumulator_433[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_435 = llvm.extractelement %accumulator_434[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_436 = llvm.insertelement %accumulator_435, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_437 = llvm.extractelement %accumulator_434[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_438 = llvm.insertelement %accumulator_437, %accumulator_436[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_439 = llvm.extractelement %accumulator_434[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_440 = llvm.insertelement %accumulator_439, %accumulator_438[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_441 = llvm.extractelement %accumulator_434[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_442 = llvm.insertelement %accumulator_441, %accumulator_440[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_443 = llvm.insertelement %a_315, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_444 = llvm.insertelement %a_316, %accumulator_443[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_445 = llvm.insertelement %a_317, %accumulator_444[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_446 = llvm.insertelement %a_318, %accumulator_445[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_447 = llvm.extractelement %accumulator_446[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_448 = llvm.insertelement %accumulator_447, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_449 = llvm.extractelement %accumulator_446[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_450 = llvm.insertelement %accumulator_449, %accumulator_448[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_451 = llvm.extractelement %accumulator_446[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_452 = llvm.insertelement %accumulator_451, %accumulator_450[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_453 = llvm.extractelement %accumulator_446[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_454 = llvm.insertelement %accumulator_453, %accumulator_452[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_455 = llvm.insertelement %b_346, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_456 = llvm.insertelement %b_350, %accumulator_455[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_457 = llvm.insertelement %b_354, %accumulator_456[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_458 = llvm.insertelement %b_358, %accumulator_457[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_459 = llvm.extractelement %accumulator_458[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_460 = llvm.insertelement %accumulator_459, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_461 = llvm.extractelement %accumulator_458[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_462 = llvm.insertelement %accumulator_461, %accumulator_460[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_463 = llvm.extractelement %accumulator_458[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_464 = llvm.insertelement %accumulator_463, %accumulator_462[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_465 = llvm.extractelement %accumulator_458[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_466 = llvm.insertelement %accumulator_465, %accumulator_464[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_467 = llvm.insertelement %b_362, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_468 = llvm.insertelement %b_366, %accumulator_467[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_469 = llvm.insertelement %b_370, %accumulator_468[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_470 = llvm.insertelement %b_374, %accumulator_469[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_471 = llvm.extractelement %accumulator_470[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_472 = llvm.insertelement %accumulator_471, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_473 = llvm.extractelement %accumulator_470[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_474 = llvm.insertelement %accumulator_473, %accumulator_472[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_475 = llvm.extractelement %accumulator_470[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_476 = llvm.insertelement %accumulator_475, %accumulator_474[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_477 = llvm.extractelement %accumulator_470[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_478 = llvm.insertelement %accumulator_477, %accumulator_476[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_479 = llvm.insertelement %b_378, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_480 = llvm.insertelement %b_382, %accumulator_479[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_481 = llvm.insertelement %b_386, %accumulator_480[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_482 = llvm.insertelement %b_390, %accumulator_481[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_483 = llvm.extractelement %accumulator_482[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_484 = llvm.insertelement %accumulator_483, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_485 = llvm.extractelement %accumulator_482[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_486 = llvm.insertelement %accumulator_485, %accumulator_484[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_487 = llvm.extractelement %accumulator_482[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_488 = llvm.insertelement %accumulator_487, %accumulator_486[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_489 = llvm.extractelement %accumulator_482[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_490 = llvm.insertelement %accumulator_489, %accumulator_488[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_491 = llvm.insertelement %b_394, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_492 = llvm.insertelement %b_398, %accumulator_491[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_493 = llvm.insertelement %b_402, %accumulator_492[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_494 = llvm.insertelement %b_406, %accumulator_493[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_495 = llvm.extractelement %accumulator_494[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_496 = llvm.insertelement %accumulator_495, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_497 = llvm.extractelement %accumulator_494[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_498 = llvm.insertelement %accumulator_497, %accumulator_496[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_499 = llvm.extractelement %accumulator_494[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_500 = llvm.insertelement %accumulator_499, %accumulator_498[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_501 = llvm.extractelement %accumulator_494[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_502 = llvm.insertelement %accumulator_501, %accumulator_500[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_503 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_504 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_505 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_506 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_507 = llvm.insertelement %accumulator_503, %0[%47 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_508 = llvm.insertelement %accumulator_504, %accumulator_507[%45 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_509 = llvm.insertelement %accumulator_505, %accumulator_508[%36 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_510 = llvm.insertelement %accumulator_506, %accumulator_509[%39 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_511 = rocdl.mfma.f32.16x16x16f16 %accumulator_466, %accumulator_418, %accumulator_510, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_512 = rocdl.mfma.f32.16x16x16f16 %accumulator_478, %accumulator_430, %accumulator_511, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_513 = rocdl.mfma.f32.16x16x16f16 %accumulator_490, %accumulator_442, %accumulator_512, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_514 = rocdl.mfma.f32.16x16x16f16 %accumulator_502, %accumulator_454, %accumulator_513, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_515 = llvm.extractelement %accumulator_514[%47 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_516 = llvm.extractelement %accumulator_514[%45 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_517 = llvm.extractelement %accumulator_514[%36 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_518 = llvm.extractelement %accumulator_514[%39 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_519 = llvm.insertvalue %accumulator_515, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_520 = llvm.insertvalue %accumulator_516, %accumulator_519[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_521 = llvm.insertvalue %accumulator_517, %accumulator_520[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_522 = llvm.insertvalue %accumulator_518, %accumulator_521[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_523 = llvm.add %59, %45 : i32 loc(#loc111)
    %accumulator_524 = llvm.icmp "slt" %accumulator_523, %45 : i32 loc(#loc111)
    %accumulator_525 = llvm.select %accumulator_524, %accumulator_523, %47 : i1, i32 loc(#loc111)
    %a_526 = llvm.mul %accumulator_525, %21 : i32 loc(#loc72)
    %a_527 = llvm.getelementptr %22[%a_526] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc72)
    %a_528 = llvm.insertvalue %a_527, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_529 = llvm.insertvalue %47, %a_528[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_530 = llvm.insertvalue %47, %a_529[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_531 = llvm.shl %a_1, %41 : i32 loc(#loc72)
    %a_532 = llvm.or %offs_am_23, %a_531 : i32 loc(#loc72)
    %a_533 = llvm.and %a_532, %51 : i32 loc(#loc72)
    %a_534 = llvm.shl %a_533, %46 : i32 loc(#loc72)
    %a_535 = llvm.and %a_532, %19 : i32 loc(#loc72)
    %a_536 = llvm.lshr %a_535, %47 : i32 loc(#loc72)
    %a_537 = llvm.xor %a_534, %a_536 : i32 loc(#loc72)
    %a_538 = llvm.or disjoint %47, %a_537 : i32 loc(#loc72)
    %a_539 = llvm.xor %47, %a_538 : i32 loc(#loc72)
    %a_540 = llvm.xor %a_539, %a_177 : i32 loc(#loc72)
    %a_541 = llvm.xor %a_540, %47 : i32 loc(#loc72)
    %a_542 = llvm.add %a_541, %47 : i32 loc(#loc72)
    %a_543 = llvm.getelementptr inbounds %a_527[%a_542] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_544 = llvm.insertelement %a_264, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_545 = llvm.insertelement %a_265, %a_544[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_546 = llvm.insertelement %a_266, %a_545[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_547 = llvm.insertelement %a_267, %a_546[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_547, %a_543 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %a_548 = llvm.xor %a_540, %17 : i32 loc(#loc72)
    %a_549 = llvm.add %a_548, %47 : i32 loc(#loc72)
    %a_550 = llvm.getelementptr inbounds %a_527[%a_549] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_551 = llvm.insertelement %a_268, %18[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_552 = llvm.insertelement %a_269, %a_551[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_553 = llvm.insertelement %a_270, %a_552[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_554 = llvm.insertelement %a_271, %a_553[%39 : i32] : vector<4xf16> loc(#loc72)
    llvm.store %a_554, %a_550 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc72)
    %b_555 = llvm.mul %accumulator_525, %16 : i32 loc(#loc71)
    %b_556 = llvm.getelementptr %b_162[%b_555] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, f16 loc(#loc71)
    %b_557 = llvm.insertvalue %b_556, %20[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_558 = llvm.insertvalue %47, %b_557[1] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_559 = llvm.insertvalue %47, %b_558[2] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_560 = llvm.shl %b_0, %41 : i32 loc(#loc71)
    %b_561 = llvm.or %offs_am_23, %b_560 : i32 loc(#loc71)
    %b_562 = llvm.and %b_561, %51 : i32 loc(#loc71)
    %b_563 = llvm.shl %b_562, %39 : i32 loc(#loc71)
    %b_564 = llvm.or disjoint %b_563, %47 : i32 loc(#loc71)
    %b_565 = llvm.xor %47, %b_564 : i32 loc(#loc71)
    %b_566 = llvm.xor %b_565, %a_177 : i32 loc(#loc71)
    %b_567 = llvm.xor %b_566, %47 : i32 loc(#loc71)
    %b_568 = llvm.add %b_567, %47 : i32 loc(#loc71)
    %b_569 = llvm.getelementptr inbounds %b_556[%b_568] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_570 = llvm.insertelement %b_324, %18[%47 : i32] : vector<4xf16> loc(#loc71)
    %b_571 = llvm.insertelement %b_325, %b_570[%45 : i32] : vector<4xf16> loc(#loc71)
    %b_572 = llvm.insertelement %b_326, %b_571[%36 : i32] : vector<4xf16> loc(#loc71)
    %b_573 = llvm.insertelement %b_327, %b_572[%39 : i32] : vector<4xf16> loc(#loc71)
    llvm.store %b_573, %b_569 {alignment = 8 : i64} : vector<4xf16>, !llvm.ptr<3> loc(#loc71)
    llvm.br ^bb1(%accumulator_256, %accumulator_522, %a_ptrs_243, %b_ptrs_255, %accumulator_525, %a_530, %b_559 : i32, !llvm.struct<(f32, f32, f32, f32)>, !llvm.struct<(i32, i32, i32, i32, i32, i32, i32, i32)>, !llvm.struct<(i32, i32, i32, i32)>, i32, !llvm.struct<(ptr<3>, i32, i32)>, !llvm.struct<(ptr<3>, i32, i32)>) loc(#loc111)
  ^bb3:  // pred: ^bb1
    %accumulator_574 = llvm.icmp "sge" %58, %45 : i32 loc(#loc111)
    rocdl.s.waitcnt 49279 loc(#loc72)
    rocdl.s.barrier loc(#loc72)
    %a_575 = llvm.extractvalue %a_217[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc72)
    %a_576 = llvm.shl %a, %41 : i32 loc(#loc72)
    %a_577 = llvm.or %offs_am_23, %a_576 : i32 loc(#loc72)
    %a_578 = llvm.and %a_577, %38 : i32 loc(#loc72)
    %a_579 = llvm.shl %a_578, %34 : i32 loc(#loc72)
    %a_580 = llvm.and %a_577, %37 : i32 loc(#loc72)
    %a_581 = llvm.shl %a_580, %46 : i32 loc(#loc72)
    %a_582 = llvm.shl %a_578, %39 : i32 loc(#loc72)
    %a_583 = llvm.and %a_577, %15 : i32 loc(#loc72)
    %a_584 = llvm.lshr %a_583, %45 : i32 loc(#loc72)
    %a_585 = llvm.xor %a_581, %a_582 : i32 loc(#loc72)
    %a_586 = llvm.xor %a_585, %a_584 : i32 loc(#loc72)
    %a_587 = llvm.or disjoint %a_579, %a_586 : i32 loc(#loc72)
    %a_588 = llvm.xor %47, %a_587 : i32 loc(#loc72)
    %a_589 = llvm.xor %a_588, %a_177 : i32 loc(#loc72)
    %a_590 = llvm.xor %a_589, %47 : i32 loc(#loc72)
    %a_591 = llvm.add %a_590, %47 : i32 loc(#loc72)
    %a_592 = llvm.getelementptr inbounds %a_575[%a_591] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_593 = llvm.load %a_592 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_594 = llvm.extractelement %a_593[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_595 = llvm.extractelement %a_593[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_596 = llvm.extractelement %a_593[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_597 = llvm.extractelement %a_593[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_598 = llvm.xor %a_589, %49 : i32 loc(#loc72)
    %a_599 = llvm.add %a_598, %47 : i32 loc(#loc72)
    %a_600 = llvm.getelementptr inbounds %a_575[%a_599] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_601 = llvm.load %a_600 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_602 = llvm.extractelement %a_601[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_603 = llvm.extractelement %a_601[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_604 = llvm.extractelement %a_601[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_605 = llvm.extractelement %a_601[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_606 = llvm.xor %a_589, %52 : i32 loc(#loc72)
    %a_607 = llvm.add %a_606, %47 : i32 loc(#loc72)
    %a_608 = llvm.getelementptr inbounds %a_575[%a_607] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_609 = llvm.load %a_608 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_610 = llvm.extractelement %a_609[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_611 = llvm.extractelement %a_609[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_612 = llvm.extractelement %a_609[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_613 = llvm.extractelement %a_609[%39 : i32] : vector<4xf16> loc(#loc72)
    %a_614 = llvm.xor %a_589, %14 : i32 loc(#loc72)
    %a_615 = llvm.add %a_614, %47 : i32 loc(#loc72)
    %a_616 = llvm.getelementptr inbounds %a_575[%a_615] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc72)
    %a_617 = llvm.load %a_616 : !llvm.ptr<3> -> vector<4xf16> loc(#loc72)
    %a_618 = llvm.extractelement %a_617[%47 : i32] : vector<4xf16> loc(#loc72)
    %a_619 = llvm.extractelement %a_617[%45 : i32] : vector<4xf16> loc(#loc72)
    %a_620 = llvm.extractelement %a_617[%36 : i32] : vector<4xf16> loc(#loc72)
    %a_621 = llvm.extractelement %a_617[%39 : i32] : vector<4xf16> loc(#loc72)
    %b_622 = llvm.extractvalue %b_218[0] : !llvm.struct<(ptr<3>, i32, i32)>  loc(#loc71)
    %b_623 = llvm.shl %b, %41 : i32 loc(#loc71)
    %b_624 = llvm.or %offs_am_23, %b_623 : i32 loc(#loc71)
    %b_625 = llvm.and %b_624, %15 : i32 loc(#loc71)
    %b_626 = llvm.shl %b_625, %46 : i32 loc(#loc71)
    %b_627 = llvm.and %b_624, %38 : i32 loc(#loc71)
    %b_628 = llvm.shl %b_627, %45 : i32 loc(#loc71)
    %b_629 = llvm.and %b_624, %52 : i32 loc(#loc71)
    %b_630 = llvm.icmp "eq" %b_629, %47 : i32 loc(#loc71)
    %b_631 = llvm.select %b_630, %47, %49 : i1, i32 loc(#loc71)
    %b_632 = llvm.xor %b_626, %b_628 : i32 loc(#loc71)
    %b_633 = llvm.or disjoint %b_631, %b_632 : i32 loc(#loc71)
    %b_634 = llvm.xor %47, %b_633 : i32 loc(#loc71)
    %b_635 = llvm.xor %b_634, %a_177 : i32 loc(#loc71)
    %b_636 = llvm.xor %b_635, %47 : i32 loc(#loc71)
    %b_637 = llvm.add %b_636, %47 : i32 loc(#loc71)
    %b_638 = llvm.getelementptr inbounds %b_622[%b_637] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_639 = llvm.load %b_638 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_640 = llvm.extractelement %b_639[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_641 = llvm.add %b_636, %52 : i32 loc(#loc71)
    %b_642 = llvm.getelementptr inbounds %b_622[%b_641] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_643 = llvm.load %b_642 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_644 = llvm.extractelement %b_643[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_645 = llvm.add %b_636, %13 : i32 loc(#loc71)
    %b_646 = llvm.getelementptr inbounds %b_622[%b_645] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_647 = llvm.load %b_646 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_648 = llvm.extractelement %b_647[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_649 = llvm.add %b_636, %12 : i32 loc(#loc71)
    %b_650 = llvm.getelementptr inbounds %b_622[%b_649] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_651 = llvm.load %b_650 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_652 = llvm.extractelement %b_651[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_653 = llvm.add %b_636, %11 : i32 loc(#loc71)
    %b_654 = llvm.getelementptr inbounds %b_622[%b_653] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_655 = llvm.load %b_654 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_656 = llvm.extractelement %b_655[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_657 = llvm.add %b_636, %10 : i32 loc(#loc71)
    %b_658 = llvm.getelementptr inbounds %b_622[%b_657] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_659 = llvm.load %b_658 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_660 = llvm.extractelement %b_659[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_661 = llvm.add %b_636, %9 : i32 loc(#loc71)
    %b_662 = llvm.getelementptr inbounds %b_622[%b_661] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_663 = llvm.load %b_662 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_664 = llvm.extractelement %b_663[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_665 = llvm.add %b_636, %8 : i32 loc(#loc71)
    %b_666 = llvm.getelementptr inbounds %b_622[%b_665] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_667 = llvm.load %b_666 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_668 = llvm.extractelement %b_667[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_669 = llvm.add %b_636, %16 : i32 loc(#loc71)
    %b_670 = llvm.getelementptr inbounds %b_622[%b_669] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_671 = llvm.load %b_670 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_672 = llvm.extractelement %b_671[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_673 = llvm.add %b_636, %7 : i32 loc(#loc71)
    %b_674 = llvm.getelementptr inbounds %b_622[%b_673] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_675 = llvm.load %b_674 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_676 = llvm.extractelement %b_675[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_677 = llvm.add %b_636, %6 : i32 loc(#loc71)
    %b_678 = llvm.getelementptr inbounds %b_622[%b_677] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_679 = llvm.load %b_678 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_680 = llvm.extractelement %b_679[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_681 = llvm.add %b_636, %5 : i32 loc(#loc71)
    %b_682 = llvm.getelementptr inbounds %b_622[%b_681] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_683 = llvm.load %b_682 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_684 = llvm.extractelement %b_683[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_685 = llvm.add %b_636, %4 : i32 loc(#loc71)
    %b_686 = llvm.getelementptr inbounds %b_622[%b_685] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_687 = llvm.load %b_686 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_688 = llvm.extractelement %b_687[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_689 = llvm.add %b_636, %3 : i32 loc(#loc71)
    %b_690 = llvm.getelementptr inbounds %b_622[%b_689] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_691 = llvm.load %b_690 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_692 = llvm.extractelement %b_691[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_693 = llvm.add %b_636, %2 : i32 loc(#loc71)
    %b_694 = llvm.getelementptr inbounds %b_622[%b_693] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_695 = llvm.load %b_694 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_696 = llvm.extractelement %b_695[%47 : i32] : vector<1xf16> loc(#loc71)
    %b_697 = llvm.add %b_636, %1 : i32 loc(#loc71)
    %b_698 = llvm.getelementptr inbounds %b_622[%b_697] : (!llvm.ptr<3>, i32) -> !llvm.ptr<3>, i8 loc(#loc71)
    %b_699 = llvm.load %b_698 : !llvm.ptr<3> -> vector<1xf16> loc(#loc71)
    %b_700 = llvm.extractelement %b_699[%47 : i32] : vector<1xf16> loc(#loc71)
    llvm.cond_br %accumulator_574, ^bb4, ^bb5 loc(#loc102)
  ^bb4:  // pred: ^bb3
    %accumulator_701 = llvm.insertelement %a_594, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_702 = llvm.insertelement %a_595, %accumulator_701[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_703 = llvm.insertelement %a_596, %accumulator_702[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_704 = llvm.insertelement %a_597, %accumulator_703[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_705 = llvm.extractelement %accumulator_704[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_706 = llvm.insertelement %accumulator_705, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_707 = llvm.extractelement %accumulator_704[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_708 = llvm.insertelement %accumulator_707, %accumulator_706[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_709 = llvm.extractelement %accumulator_704[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_710 = llvm.insertelement %accumulator_709, %accumulator_708[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_711 = llvm.extractelement %accumulator_704[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_712 = llvm.insertelement %accumulator_711, %accumulator_710[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_713 = llvm.insertelement %a_602, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_714 = llvm.insertelement %a_603, %accumulator_713[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_715 = llvm.insertelement %a_604, %accumulator_714[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_716 = llvm.insertelement %a_605, %accumulator_715[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_717 = llvm.extractelement %accumulator_716[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_718 = llvm.insertelement %accumulator_717, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_719 = llvm.extractelement %accumulator_716[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_720 = llvm.insertelement %accumulator_719, %accumulator_718[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_721 = llvm.extractelement %accumulator_716[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_722 = llvm.insertelement %accumulator_721, %accumulator_720[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_723 = llvm.extractelement %accumulator_716[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_724 = llvm.insertelement %accumulator_723, %accumulator_722[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_725 = llvm.insertelement %a_610, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_726 = llvm.insertelement %a_611, %accumulator_725[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_727 = llvm.insertelement %a_612, %accumulator_726[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_728 = llvm.insertelement %a_613, %accumulator_727[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_729 = llvm.extractelement %accumulator_728[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_730 = llvm.insertelement %accumulator_729, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_731 = llvm.extractelement %accumulator_728[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_732 = llvm.insertelement %accumulator_731, %accumulator_730[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_733 = llvm.extractelement %accumulator_728[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_734 = llvm.insertelement %accumulator_733, %accumulator_732[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_735 = llvm.extractelement %accumulator_728[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_736 = llvm.insertelement %accumulator_735, %accumulator_734[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_737 = llvm.insertelement %a_618, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_738 = llvm.insertelement %a_619, %accumulator_737[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_739 = llvm.insertelement %a_620, %accumulator_738[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_740 = llvm.insertelement %a_621, %accumulator_739[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_741 = llvm.extractelement %accumulator_740[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_742 = llvm.insertelement %accumulator_741, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_743 = llvm.extractelement %accumulator_740[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_744 = llvm.insertelement %accumulator_743, %accumulator_742[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_745 = llvm.extractelement %accumulator_740[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_746 = llvm.insertelement %accumulator_745, %accumulator_744[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_747 = llvm.extractelement %accumulator_740[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_748 = llvm.insertelement %accumulator_747, %accumulator_746[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_749 = llvm.insertelement %b_640, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_750 = llvm.insertelement %b_644, %accumulator_749[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_751 = llvm.insertelement %b_648, %accumulator_750[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_752 = llvm.insertelement %b_652, %accumulator_751[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_753 = llvm.extractelement %accumulator_752[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_754 = llvm.insertelement %accumulator_753, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_755 = llvm.extractelement %accumulator_752[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_756 = llvm.insertelement %accumulator_755, %accumulator_754[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_757 = llvm.extractelement %accumulator_752[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_758 = llvm.insertelement %accumulator_757, %accumulator_756[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_759 = llvm.extractelement %accumulator_752[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_760 = llvm.insertelement %accumulator_759, %accumulator_758[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_761 = llvm.insertelement %b_656, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_762 = llvm.insertelement %b_660, %accumulator_761[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_763 = llvm.insertelement %b_664, %accumulator_762[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_764 = llvm.insertelement %b_668, %accumulator_763[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_765 = llvm.extractelement %accumulator_764[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_766 = llvm.insertelement %accumulator_765, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_767 = llvm.extractelement %accumulator_764[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_768 = llvm.insertelement %accumulator_767, %accumulator_766[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_769 = llvm.extractelement %accumulator_764[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_770 = llvm.insertelement %accumulator_769, %accumulator_768[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_771 = llvm.extractelement %accumulator_764[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_772 = llvm.insertelement %accumulator_771, %accumulator_770[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_773 = llvm.insertelement %b_672, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_774 = llvm.insertelement %b_676, %accumulator_773[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_775 = llvm.insertelement %b_680, %accumulator_774[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_776 = llvm.insertelement %b_684, %accumulator_775[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_777 = llvm.extractelement %accumulator_776[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_778 = llvm.insertelement %accumulator_777, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_779 = llvm.extractelement %accumulator_776[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_780 = llvm.insertelement %accumulator_779, %accumulator_778[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_781 = llvm.extractelement %accumulator_776[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_782 = llvm.insertelement %accumulator_781, %accumulator_780[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_783 = llvm.extractelement %accumulator_776[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_784 = llvm.insertelement %accumulator_783, %accumulator_782[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_785 = llvm.insertelement %b_688, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_786 = llvm.insertelement %b_692, %accumulator_785[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_787 = llvm.insertelement %b_696, %accumulator_786[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_788 = llvm.insertelement %b_700, %accumulator_787[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_789 = llvm.extractelement %accumulator_788[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_790 = llvm.insertelement %accumulator_789, %18[%47 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_791 = llvm.extractelement %accumulator_788[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_792 = llvm.insertelement %accumulator_791, %accumulator_790[%45 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_793 = llvm.extractelement %accumulator_788[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_794 = llvm.insertelement %accumulator_793, %accumulator_792[%36 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_795 = llvm.extractelement %accumulator_788[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_796 = llvm.insertelement %accumulator_795, %accumulator_794[%39 : i32] : vector<4xf16> loc(#loc102)
    %accumulator_797 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_798 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_799 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_800 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_801 = llvm.insertelement %accumulator_797, %0[%47 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_802 = llvm.insertelement %accumulator_798, %accumulator_801[%45 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_803 = llvm.insertelement %accumulator_799, %accumulator_802[%36 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_804 = llvm.insertelement %accumulator_800, %accumulator_803[%39 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_805 = rocdl.mfma.f32.16x16x16f16 %accumulator_760, %accumulator_712, %accumulator_804, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_806 = rocdl.mfma.f32.16x16x16f16 %accumulator_772, %accumulator_724, %accumulator_805, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_807 = rocdl.mfma.f32.16x16x16f16 %accumulator_784, %accumulator_736, %accumulator_806, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_808 = rocdl.mfma.f32.16x16x16f16 %accumulator_796, %accumulator_748, %accumulator_807, %47, %47, %47 : (vector<4xf16>, vector<4xf16>, vector<4xf32>, i32, i32, i32) -> vector<4xf32> loc(#loc102)
    %accumulator_809 = llvm.extractelement %accumulator_808[%47 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_810 = llvm.extractelement %accumulator_808[%45 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_811 = llvm.extractelement %accumulator_808[%36 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_812 = llvm.extractelement %accumulator_808[%39 : i32] : vector<4xf32> loc(#loc102)
    %accumulator_813 = llvm.insertvalue %accumulator_809, %43[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_814 = llvm.insertvalue %accumulator_810, %accumulator_813[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_815 = llvm.insertvalue %accumulator_811, %accumulator_814[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    %accumulator_816 = llvm.insertvalue %accumulator_812, %accumulator_815[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc102)
    llvm.br ^bb6(%accumulator_816 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc102)
  ^bb5:  // pred: ^bb3
    llvm.br ^bb6(%accumulator_214 : !llvm.struct<(f32, f32, f32, f32)>) loc(#loc102)
  ^bb6(%accumulator_817: !llvm.struct<(f32, f32, f32, f32)> loc("accumulator"(#loc50))):  // 2 preds: ^bb4, ^bb5
    llvm.br ^bb7 loc(#loc102)
  ^bb7:  // pred: ^bb6
    %accumulator_818 = llvm.extractvalue %accumulator_817[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_819 = llvm.extractvalue %accumulator_817[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_820 = llvm.extractvalue %accumulator_817[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_821 = llvm.extractvalue %accumulator_817[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_822 = llvm.extractvalue %accumulator_214[0] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_823 = llvm.extractvalue %accumulator_214[1] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_824 = llvm.extractvalue %accumulator_214[2] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_825 = llvm.extractvalue %accumulator_214[3] : !llvm.struct<(f32, f32, f32, f32)>  loc(#loc111)
    %accumulator_826 = llvm.select %accumulator_574, %accumulator_818, %accumulator_822 : i1, f32 loc(#loc111)
    %accumulator_827 = llvm.select %accumulator_574, %accumulator_819, %accumulator_823 : i1, f32 loc(#loc111)
    %accumulator_828 = llvm.select %accumulator_574, %accumulator_820, %accumulator_824 : i1, f32 loc(#loc111)
    %accumulator_829 = llvm.select %accumulator_574, %accumulator_821, %accumulator_825 : i1, f32 loc(#loc111)
    %c = llvm.fptrunc %accumulator_826 : f32 to f16 loc(#loc103)
    %c_830 = llvm.fptrunc %accumulator_827 : f32 to f16 loc(#loc103)
    %c_831 = llvm.fptrunc %accumulator_828 : f32 to f16 loc(#loc103)
    %c_832 = llvm.fptrunc %accumulator_829 : f32 to f16 loc(#loc103)
    %c_ptrs = llvm.mul %stride_cm, %offs_am_20 : i32 loc(#loc104)
    %c_ptrs_833 = llvm.mul %stride_cm, %offs_am_42 : i32 loc(#loc105)
    %c_ptrs_834 = llvm.add %c_ptrs, %offs_bn_46 : i32 loc(#loc105)
    %c_ptrs_835 = llvm.add %c_ptrs_833, %offs_bn_54 : i32 loc(#loc105)
    %c_ptrs_836 = llvm.add %c_ptrs_834, %c_ptrs_835 : i32 loc(#loc105)
    %c_mask = llvm.icmp "slt" %offs_am_44, %M : i32 loc(#loc106)
    %c_mask_837 = llvm.icmp "slt" %offs_bn_69, %N : i32 loc(#loc107)
    %c_mask_838 = llvm.and %c_mask, %c_mask_837 : i1 loc(#loc108)
    %60 = rocdl.make.buffer.rsrc %c_ptr, %33, %31, %32 : <1> to <8> loc(#loc7)
    %61 = llvm.and %48, %c_mask_838 : i1 loc(#loc7)
    %62 = llvm.insertelement %c, %18[%47 : i32] : vector<4xf16> loc(#loc7)
    %63 = llvm.insertelement %c_830, %62[%45 : i32] : vector<4xf16> loc(#loc7)
    %64 = llvm.insertelement %c_831, %63[%36 : i32] : vector<4xf16> loc(#loc7)
    %65 = llvm.insertelement %c_832, %64[%39 : i32] : vector<4xf16> loc(#loc7)
    %66 = llvm.bitcast %65 : vector<4xf16> to vector<2xi32> loc(#loc7)
    %67 = llvm.mul %c_ptrs_836, %36 : i32 loc(#loc7)
    %68 = llvm.select %61, %67, %30 : i1, i32 loc(#loc7)
    rocdl.raw.ptr.buffer.store %66, %60, %68, %47, %47 : vector<2xi32> loc(#loc7)
    llvm.return loc(#loc57)
  } loc(#loc112)
} loc(#loc)
#di_basic_type = #llvm.di_basic_type<tag = DW_TAG_base_type, name = "half", sizeInBits = 16, encoding = DW_ATE_float>
#di_basic_type1 = #llvm.di_basic_type<tag = DW_TAG_base_type, name = "int", sizeInBits = 32, encoding = DW_ATE_signed>
#di_basic_type2 = #llvm.di_basic_type<tag = DW_TAG_base_type, name = "unknown_type", encoding = DW_ATE_signed>
#di_file = #llvm.di_file<"03-matrix-multiplication.py" in "/root/workspace/dsl-lab/triton/matmul">
#di_file1 = #llvm.di_file<"standard.py" in "/opt/venv/lib/python3.11/site-packages/triton/language">
#di_file2 = #llvm.di_file<"<unknown>" in "">
#di_null_type = #llvm.di_null_type
#loc2 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":289:60)
#loc3 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:51)
#loc6 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":258:27)
#loc7 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:21)
#loc10 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":290:29)
#loc11 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:51)
#loc12 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":256:24)
#loc13 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:17)
#loc14 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":257:27)
#loc15 = loc("/opt/venv/lib/python3.11/site-packages/triton/language/standard.py":43:30)
#loc16 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":259:38)
#loc17 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":260:22)
#loc18 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":261:29)
#loc19 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:35)
#loc20 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":262:48)
#loc21 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:34)
#loc22 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:54)
#loc23 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":263:27)
#loc24 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":264:40)
#loc25 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":270:14)
#loc26 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":271:14)
#loc27 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":272:14)
#loc28 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":273:14)
#loc29 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":274:14)
#loc30 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":275:14)
#loc31 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":276:14)
#loc32 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":277:14)
#loc33 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:23)
#loc34 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:38)
#loc35 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":286:68)
#loc36 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:23)
#loc37 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:38)
#loc38 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":287:68)
#loc40 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":298:33)
#loc42 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:51)
#loc44 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":302:51)
#loc45 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:33)
#loc46 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":306:18)
#loc47 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":307:18)
#loc48 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:59)
#loc49 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":301:55)
#loc51 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":312:23)
#loc52 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:21)
#loc53 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":318:52)
#loc54 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:33)
#loc55 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:58)
#loc56 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":319:39)
#loc57 = loc("/root/workspace/dsl-lab/triton/matmul/03-matrix-multiplication.py":320:4)
#di_compile_unit = #llvm.di_compile_unit<id = distinct[0]<>, sourceLanguage = DW_LANG_C, file = #di_file, producer = "triton", isOptimized = true, emissionKind = LineTablesOnly>
#di_derived_type = #llvm.di_derived_type<tag = DW_TAG_pointer_type, name = "pointer", baseType = #di_basic_type, sizeInBits = 64, dwarfAddressSpace = 1>
#di_derived_type1 = #llvm.di_derived_type<tag = DW_TAG_pointer_type, name = "pointer", baseType = #di_basic_type2, sizeInBits = 64, dwarfAddressSpace = 1>
#loc67 = loc("a_ptrs"(#loc2))
#loc68 = loc("offs_bn"(#loc3))
#loc70 = loc("num_pid_n"(#loc6))
#loc73 = loc("b_ptrs"(#loc10))
#loc74 = loc("offs_am"(#loc11))
#loc75 = loc("pid"(#loc12))
#loc76 = loc("num_pid_m"(#loc14))
#loc77 = loc("num_pid_in_group"(#loc16))
#loc78 = loc("group_id"(#loc17))
#loc79 = loc("first_pid_m"(#loc18))
#loc80 = loc("group_size_m"(#loc19))
#loc81 = loc("group_size_m"(#loc20))
#loc82 = loc("pid_m"(#loc21))
#loc83 = loc("pid_m"(#loc22))
#loc84 = loc("pid_m"(#loc23))
#loc85 = loc("pid_n"(#loc24))
#loc86 = loc("offs_am"(#loc33))
#loc87 = loc("offs_am"(#loc34))
#loc88 = loc("offs_am"(#loc35))
#loc89 = loc("offs_bn"(#loc36))
#loc90 = loc("offs_bn"(#loc37))
#loc91 = loc("offs_bn"(#loc38))
#loc94 = loc("a"(#loc42))
#loc96 = loc("b"(#loc44))
#loc97 = loc("b_ptrs"(#loc45))
#loc98 = loc("a_ptrs"(#loc46))
#loc99 = loc("b_ptrs"(#loc47))
#loc100 = loc("a"(#loc48))
#loc101 = loc("a"(#loc49))
#loc103 = loc("c"(#loc51))
#loc104 = loc("c_ptrs"(#loc52))
#loc105 = loc("c_ptrs"(#loc53))
#loc106 = loc("c_mask"(#loc54))
#loc107 = loc("c_mask"(#loc55))
#loc108 = loc("c_mask"(#loc56))
#di_subroutine_type = #llvm.di_subroutine_type<callingConvention = DW_CC_normal, types = #di_null_type, #di_derived_type, #di_derived_type, #di_derived_type, #di_basic_type1, #di_basic_type1, #di_basic_type1, #di_basic_type1, #di_basic_type1, #di_basic_type1, #di_derived_type1, #di_derived_type1>
#di_subprogram = #llvm.di_subprogram<recId = distinct[0]<>, id = distinct[1]<>, compileUnit = #di_compile_unit, scope = #di_file, name = "matmul_kernel", linkageName = "matmul_kernel", file = #di_file, line = 233, scopeLine = 233, subprogramFlags = "Definition|Optimized", type = #di_subroutine_type>
#di_lexical_block_file = #llvm.di_lexical_block_file<scope = #di_subprogram, file = #di_file1, discriminator = 0>
#di_lexical_block_file1 = #llvm.di_lexical_block_file<scope = #di_subprogram, file = #di_file, discriminator = 0>
#di_lexical_block_file2 = #llvm.di_lexical_block_file<scope = #di_subprogram, file = #di_file2, discriminator = 0>
#loc112 = loc(fused<#di_subprogram>[#loc])
#loc113 = loc(fused<#di_lexical_block_file>[#loc4])
#loc114 = loc(fused<#di_lexical_block_file1>[#loc69])
#loc115 = loc(fused<#di_lexical_block_file2>[#loc1])
#loc116 = loc(fused<#di_lexical_block_file1>[#loc70])
#loc117 = loc(fused<#di_lexical_block_file>[#loc13])
#loc118 = loc(fused<#di_lexical_block_file1>[#loc76])
#loc119 = loc(fused<#di_lexical_block_file>[#loc15])
#loc120 = loc(fused<#di_lexical_block_file1>[#loc40])
#loc121 = loc(callsite(#loc113 at #loc114))
#loc122 = loc(callsite(#loc115 at #loc116))
#loc123 = loc(callsite(#loc117 at #loc118))
#loc124 = loc(callsite(#loc119 at #loc118))
#loc125 = loc(callsite(#loc117 at #loc116))
#loc126 = loc(callsite(#loc119 at #loc116))
#loc127 = loc(callsite(#loc117 at #loc120))
#loc128 = loc(callsite(#loc119 at #loc120))


